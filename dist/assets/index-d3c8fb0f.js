var N4=Object.defineProperty;var _4=(t,e,n)=>e in t?N4(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var Me=(t,e,n)=>(_4(t,typeof e!="symbol"?e+"":e,n),n);function K_(t,e){for(var n=0;n<e.length;n++){const s=e[n];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(s,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var _l=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Ow(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function mi(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(s){var r=Object.getOwnPropertyDescriptor(t,s);Object.defineProperty(n,s,r.get?r:{enumerable:!0,get:function(){return t[s]}})}),n}var X_={exports:{}},Ze={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rh=Symbol.for("react.element"),R4=Symbol.for("react.portal"),A4=Symbol.for("react.fragment"),D4=Symbol.for("react.strict_mode"),F4=Symbol.for("react.profiler"),O4=Symbol.for("react.provider"),P4=Symbol.for("react.context"),M4=Symbol.for("react.forward_ref"),L4=Symbol.for("react.suspense"),z4=Symbol.for("react.memo"),B4=Symbol.for("react.lazy"),CI=Symbol.iterator;function V4(t){return t===null||typeof t!="object"?null:(t=CI&&t[CI]||t["@@iterator"],typeof t=="function"?t:null)}var q_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},Y_=Object.assign,Q_={};function du(t,e,n){this.props=t,this.context=e,this.refs=Q_,this.updater=n||q_}du.prototype.isReactComponent={};du.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};du.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function Z_(){}Z_.prototype=du.prototype;function Pw(t,e,n){this.props=t,this.context=e,this.refs=Q_,this.updater=n||q_}var Mw=Pw.prototype=new Z_;Mw.constructor=Pw;Y_(Mw,du.prototype);Mw.isPureReactComponent=!0;var SI=Array.isArray,J_=Object.prototype.hasOwnProperty,Lw={current:null},eR={key:!0,ref:!0,__self:!0,__source:!0};function tR(t,e,n){var s,r={},o=null,i=null;if(e!=null)for(s in e.ref!==void 0&&(i=e.ref),e.key!==void 0&&(o=""+e.key),e)J_.call(e,s)&&!eR.hasOwnProperty(s)&&(r[s]=e[s]);var a=arguments.length-2;if(a===1)r.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(s in a=t.defaultProps,a)r[s]===void 0&&(r[s]=a[s]);return{$$typeof:Rh,type:t,key:o,ref:i,props:r,_owner:Lw.current}}function W4(t,e){return{$$typeof:Rh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function zw(t){return typeof t=="object"&&t!==null&&t.$$typeof===Rh}function U4(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var $I=/\/+/g;function fb(t,e){return typeof t=="object"&&t!==null&&t.key!=null?U4(""+t.key):e.toString(36)}function vm(t,e,n,s,r){var o=typeof t;(o==="undefined"||o==="boolean")&&(t=null);var i=!1;if(t===null)i=!0;else switch(o){case"string":case"number":i=!0;break;case"object":switch(t.$$typeof){case Rh:case R4:i=!0}}if(i)return i=t,r=r(i),t=s===""?"."+fb(i,0):s,SI(r)?(n="",t!=null&&(n=t.replace($I,"$&/")+"/"),vm(r,e,n,"",function(c){return c})):r!=null&&(zw(r)&&(r=W4(r,n+(!r.key||i&&i.key===r.key?"":(""+r.key).replace($I,"$&/")+"/")+t)),e.push(r)),1;if(i=0,s=s===""?".":s+":",SI(t))for(var a=0;a<t.length;a++){o=t[a];var l=s+fb(o,a);i+=vm(o,e,n,l,r)}else if(l=V4(t),typeof l=="function")for(t=l.call(t),a=0;!(o=t.next()).done;)o=o.value,l=s+fb(o,a++),i+=vm(o,e,n,l,r);else if(o==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return i}function fp(t,e,n){if(t==null)return t;var s=[],r=0;return vm(t,s,"","",function(o){return e.call(n,o,r++)}),s}function H4(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Ss={current:null},wm={transition:null},G4={ReactCurrentDispatcher:Ss,ReactCurrentBatchConfig:wm,ReactCurrentOwner:Lw};function nR(){throw Error("act(...) is not supported in production builds of React.")}Ze.Children={map:fp,forEach:function(t,e,n){fp(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return fp(t,function(){e++}),e},toArray:function(t){return fp(t,function(e){return e})||[]},only:function(t){if(!zw(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ze.Component=du;Ze.Fragment=A4;Ze.Profiler=F4;Ze.PureComponent=Pw;Ze.StrictMode=D4;Ze.Suspense=L4;Ze.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=G4;Ze.act=nR;Ze.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var s=Y_({},t.props),r=t.key,o=t.ref,i=t._owner;if(e!=null){if(e.ref!==void 0&&(o=e.ref,i=Lw.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)J_.call(e,l)&&!eR.hasOwnProperty(l)&&(s[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)s.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];s.children=a}return{$$typeof:Rh,type:t.type,key:r,ref:o,props:s,_owner:i}};Ze.createContext=function(t){return t={$$typeof:P4,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:O4,_context:t},t.Consumer=t};Ze.createElement=tR;Ze.createFactory=function(t){var e=tR.bind(null,t);return e.type=t,e};Ze.createRef=function(){return{current:null}};Ze.forwardRef=function(t){return{$$typeof:M4,render:t}};Ze.isValidElement=zw;Ze.lazy=function(t){return{$$typeof:B4,_payload:{_status:-1,_result:t},_init:H4}};Ze.memo=function(t,e){return{$$typeof:z4,type:t,compare:e===void 0?null:e}};Ze.startTransition=function(t){var e=wm.transition;wm.transition={};try{t()}finally{wm.transition=e}};Ze.unstable_act=nR;Ze.useCallback=function(t,e){return Ss.current.useCallback(t,e)};Ze.useContext=function(t){return Ss.current.useContext(t)};Ze.useDebugValue=function(){};Ze.useDeferredValue=function(t){return Ss.current.useDeferredValue(t)};Ze.useEffect=function(t,e){return Ss.current.useEffect(t,e)};Ze.useId=function(){return Ss.current.useId()};Ze.useImperativeHandle=function(t,e,n){return Ss.current.useImperativeHandle(t,e,n)};Ze.useInsertionEffect=function(t,e){return Ss.current.useInsertionEffect(t,e)};Ze.useLayoutEffect=function(t,e){return Ss.current.useLayoutEffect(t,e)};Ze.useMemo=function(t,e){return Ss.current.useMemo(t,e)};Ze.useReducer=function(t,e,n){return Ss.current.useReducer(t,e,n)};Ze.useRef=function(t){return Ss.current.useRef(t)};Ze.useState=function(t){return Ss.current.useState(t)};Ze.useSyncExternalStore=function(t,e,n){return Ss.current.useSyncExternalStore(t,e,n)};Ze.useTransition=function(){return Ss.current.useTransition()};Ze.version="18.3.1";X_.exports=Ze;var A=X_.exports;const me=Ow(A),C1=K_({__proto__:null,default:me},[A]);var S1={},sR={exports:{}},or={},rR={exports:{}},oR={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(N,B){var G=N.length;N.push(B);e:for(;0<G;){var X=G-1>>>1,Y=N[X];if(0<r(Y,B))N[X]=B,N[G]=Y,G=X;else break e}}function n(N){return N.length===0?null:N[0]}function s(N){if(N.length===0)return null;var B=N[0],G=N.pop();if(G!==B){N[0]=G;e:for(var X=0,Y=N.length,J=Y>>>1;X<J;){var q=2*(X+1)-1,ee=N[q],ne=q+1,ce=N[ne];if(0>r(ee,G))ne<Y&&0>r(ce,ee)?(N[X]=ce,N[ne]=G,X=ne):(N[X]=ee,N[q]=G,X=q);else if(ne<Y&&0>r(ce,G))N[X]=ce,N[ne]=G,X=ne;else break e}}return B}function r(N,B){var G=N.sortIndex-B.sortIndex;return G!==0?G:N.id-B.id}if(typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var i=Date,a=i.now();t.unstable_now=function(){return i.now()-a}}var l=[],c=[],u=1,d=null,h=3,f=!1,p=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function b(N){for(var B=n(c);B!==null;){if(B.callback===null)s(c);else if(B.startTime<=N)s(c),B.sortIndex=B.expirationTime,e(l,B);else break;B=n(c)}}function v(N){if(m=!1,b(N),!p)if(n(l)!==null)p=!0,P(w);else{var B=n(c);B!==null&&M(v,B.startTime-N)}}function w(N,B){p=!1,m&&(m=!1,g(S),S=-1),f=!0;var G=h;try{for(b(B),d=n(l);d!==null&&(!(d.expirationTime>B)||N&&!E());){var X=d.callback;if(typeof X=="function"){d.callback=null,h=d.priorityLevel;var Y=X(d.expirationTime<=B);B=t.unstable_now(),typeof Y=="function"?d.callback=Y:d===n(l)&&s(l),b(B)}else s(l);d=n(l)}if(d!==null)var J=!0;else{var q=n(c);q!==null&&M(v,q.startTime-B),J=!1}return J}finally{d=null,h=G,f=!1}}var k=!1,C=null,S=-1,I=5,$=-1;function E(){return!(t.unstable_now()-$<I)}function _(){if(C!==null){var N=t.unstable_now();$=N;var B=!0;try{B=C(!0,N)}finally{B?D():(k=!1,C=null)}}else k=!1}var D;if(typeof y=="function")D=function(){y(_)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,R=F.port2;F.port1.onmessage=_,D=function(){R.postMessage(null)}}else D=function(){x(_,0)};function P(N){C=N,k||(k=!0,D())}function M(N,B){S=x(function(){N(t.unstable_now())},B)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(N){N.callback=null},t.unstable_continueExecution=function(){p||f||(p=!0,P(w))},t.unstable_forceFrameRate=function(N){0>N||125<N?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):I=0<N?Math.floor(1e3/N):5},t.unstable_getCurrentPriorityLevel=function(){return h},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(N){switch(h){case 1:case 2:case 3:var B=3;break;default:B=h}var G=h;h=B;try{return N()}finally{h=G}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(N,B){switch(N){case 1:case 2:case 3:case 4:case 5:break;default:N=3}var G=h;h=N;try{return B()}finally{h=G}},t.unstable_scheduleCallback=function(N,B,G){var X=t.unstable_now();switch(typeof G=="object"&&G!==null?(G=G.delay,G=typeof G=="number"&&0<G?X+G:X):G=X,N){case 1:var Y=-1;break;case 2:Y=250;break;case 5:Y=1073741823;break;case 4:Y=1e4;break;default:Y=5e3}return Y=G+Y,N={id:u++,callback:B,priorityLevel:N,startTime:G,expirationTime:Y,sortIndex:-1},G>X?(N.sortIndex=G,e(c,N),n(l)===null&&N===n(c)&&(m?(g(S),S=-1):m=!0,M(v,G-X))):(N.sortIndex=Y,e(l,N),p||f||(p=!0,P(w))),N},t.unstable_shouldYield=E,t.unstable_wrapCallback=function(N){var B=h;return function(){var G=h;h=B;try{return N.apply(this,arguments)}finally{h=G}}}})(oR);rR.exports=oR;var j4=rR.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var K4=A,nr=j4;function ae(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var iR=new Set,Hd={};function Rl(t,e){Lc(t,e),Lc(t+"Capture",e)}function Lc(t,e){for(Hd[t]=e,t=0;t<e.length;t++)iR.add(e[t])}var ri=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$1=Object.prototype.hasOwnProperty,X4=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,II={},TI={};function q4(t){return $1.call(TI,t)?!0:$1.call(II,t)?!1:X4.test(t)?TI[t]=!0:(II[t]=!0,!1)}function Y4(t,e,n,s){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function Q4(t,e,n,s){if(e===null||typeof e>"u"||Y4(t,e,n,s))return!0;if(s)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function $s(t,e,n,s,r,o,i){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=o,this.removeEmptyString=i}var Kn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Kn[t]=new $s(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Kn[e]=new $s(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Kn[t]=new $s(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Kn[t]=new $s(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Kn[t]=new $s(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Kn[t]=new $s(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Kn[t]=new $s(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Kn[t]=new $s(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Kn[t]=new $s(t,5,!1,t.toLowerCase(),null,!1,!1)});var Bw=/[\-:]([a-z])/g;function Vw(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Bw,Vw);Kn[e]=new $s(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Bw,Vw);Kn[e]=new $s(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Bw,Vw);Kn[e]=new $s(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Kn[t]=new $s(t,1,!1,t.toLowerCase(),null,!1,!1)});Kn.xlinkHref=new $s("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Kn[t]=new $s(t,1,!1,t.toLowerCase(),null,!0,!0)});function Ww(t,e,n,s){var r=Kn.hasOwnProperty(e)?Kn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(Q4(e,n,r,s)&&(n=null),s||r===null?q4(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,s=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,s?t.setAttributeNS(s,e,n):t.setAttribute(e,n))))}var gi=K4.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,pp=Symbol.for("react.element"),cc=Symbol.for("react.portal"),uc=Symbol.for("react.fragment"),Uw=Symbol.for("react.strict_mode"),I1=Symbol.for("react.profiler"),aR=Symbol.for("react.provider"),lR=Symbol.for("react.context"),Hw=Symbol.for("react.forward_ref"),T1=Symbol.for("react.suspense"),E1=Symbol.for("react.suspense_list"),Gw=Symbol.for("react.memo"),$i=Symbol.for("react.lazy"),cR=Symbol.for("react.offscreen"),EI=Symbol.iterator;function Pu(t){return t===null||typeof t!="object"?null:(t=EI&&t[EI]||t["@@iterator"],typeof t=="function"?t:null)}var Xt=Object.assign,pb;function od(t){if(pb===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);pb=e&&e[1]||""}return`
`+pb+t}var mb=!1;function gb(t,e){if(!t||mb)return"";mb=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var s=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){s=c}t.call(e.prototype)}else{try{throw Error()}catch(c){s=c}t()}}catch(c){if(c&&s&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),o=s.stack.split(`
`),i=r.length-1,a=o.length-1;1<=i&&0<=a&&r[i]!==o[a];)a--;for(;1<=i&&0<=a;i--,a--)if(r[i]!==o[a]){if(i!==1||a!==1)do if(i--,a--,0>a||r[i]!==o[a]){var l=`
`+r[i].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=i&&0<=a);break}}}finally{mb=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?od(t):""}function Z4(t){switch(t.tag){case 5:return od(t.type);case 16:return od("Lazy");case 13:return od("Suspense");case 19:return od("SuspenseList");case 0:case 2:case 15:return t=gb(t.type,!1),t;case 11:return t=gb(t.type.render,!1),t;case 1:return t=gb(t.type,!0),t;default:return""}}function N1(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case uc:return"Fragment";case cc:return"Portal";case I1:return"Profiler";case Uw:return"StrictMode";case T1:return"Suspense";case E1:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case lR:return(t.displayName||"Context")+".Consumer";case aR:return(t._context.displayName||"Context")+".Provider";case Hw:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Gw:return e=t.displayName||null,e!==null?e:N1(t.type)||"Memo";case $i:e=t._payload,t=t._init;try{return N1(t(e))}catch{}}return null}function J4(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return N1(e);case 8:return e===Uw?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function ta(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function uR(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function eV(t){var e=uR(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),s=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,o=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(i){s=""+i,o.call(this,i)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return s},setValue:function(i){s=""+i},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function mp(t){t._valueTracker||(t._valueTracker=eV(t))}function dR(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),s="";return t&&(s=uR(t)?t.checked?"true":"false":t.value),t=s,t!==n?(e.setValue(t),!0):!1}function jm(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function _1(t,e){var n=e.checked;return Xt({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function NI(t,e){var n=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;n=ta(e.value!=null?e.value:n),t._wrapperState={initialChecked:s,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function hR(t,e){e=e.checked,e!=null&&Ww(t,"checked",e,!1)}function R1(t,e){hR(t,e);var n=ta(e.value),s=e.type;if(n!=null)s==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(s==="submit"||s==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?A1(t,e.type,n):e.hasOwnProperty("defaultValue")&&A1(t,e.type,ta(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function _I(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function A1(t,e,n){(e!=="number"||jm(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var id=Array.isArray;function kc(t,e,n,s){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&s&&(t[n].defaultSelected=!0)}else{for(n=""+ta(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,s&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function D1(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ae(91));return Xt({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function RI(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ae(92));if(id(n)){if(1<n.length)throw Error(ae(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:ta(n)}}function fR(t,e){var n=ta(e.value),s=ta(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),s!=null&&(t.defaultValue=""+s)}function AI(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function pR(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function F1(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?pR(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var gp,mR=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,s,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,s,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(gp=gp||document.createElement("div"),gp.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=gp.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Gd(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Sd={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},tV=["Webkit","ms","Moz","O"];Object.keys(Sd).forEach(function(t){tV.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Sd[e]=Sd[t]})});function gR(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Sd.hasOwnProperty(t)&&Sd[t]?(""+e).trim():e+"px"}function xR(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var s=n.indexOf("--")===0,r=gR(n,e[n],s);n==="float"&&(n="cssFloat"),s?t.setProperty(n,r):t[n]=r}}var nV=Xt({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function O1(t,e){if(e){if(nV[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ae(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ae(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ae(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ae(62))}}function P1(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var M1=null;function jw(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var L1=null,Cc=null,Sc=null;function DI(t){if(t=Fh(t)){if(typeof L1!="function")throw Error(ae(280));var e=t.stateNode;e&&(e=w0(e),L1(t.stateNode,t.type,e))}}function yR(t){Cc?Sc?Sc.push(t):Sc=[t]:Cc=t}function bR(){if(Cc){var t=Cc,e=Sc;if(Sc=Cc=null,DI(t),e)for(t=0;t<e.length;t++)DI(e[t])}}function vR(t,e){return t(e)}function wR(){}var xb=!1;function kR(t,e,n){if(xb)return t(e,n);xb=!0;try{return vR(t,e,n)}finally{xb=!1,(Cc!==null||Sc!==null)&&(wR(),bR())}}function jd(t,e){var n=t.stateNode;if(n===null)return null;var s=w0(n);if(s===null)return null;n=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(t=t.type,s=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!s;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ae(231,e,typeof n));return n}var z1=!1;if(ri)try{var Mu={};Object.defineProperty(Mu,"passive",{get:function(){z1=!0}}),window.addEventListener("test",Mu,Mu),window.removeEventListener("test",Mu,Mu)}catch{z1=!1}function sV(t,e,n,s,r,o,i,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var $d=!1,Km=null,Xm=!1,B1=null,rV={onError:function(t){$d=!0,Km=t}};function oV(t,e,n,s,r,o,i,a,l){$d=!1,Km=null,sV.apply(rV,arguments)}function iV(t,e,n,s,r,o,i,a,l){if(oV.apply(this,arguments),$d){if($d){var c=Km;$d=!1,Km=null}else throw Error(ae(198));Xm||(Xm=!0,B1=c)}}function Al(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function CR(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function FI(t){if(Al(t)!==t)throw Error(ae(188))}function aV(t){var e=t.alternate;if(!e){if(e=Al(t),e===null)throw Error(ae(188));return e!==t?null:t}for(var n=t,s=e;;){var r=n.return;if(r===null)break;var o=r.alternate;if(o===null){if(s=r.return,s!==null){n=s;continue}break}if(r.child===o.child){for(o=r.child;o;){if(o===n)return FI(r),t;if(o===s)return FI(r),e;o=o.sibling}throw Error(ae(188))}if(n.return!==s.return)n=r,s=o;else{for(var i=!1,a=r.child;a;){if(a===n){i=!0,n=r,s=o;break}if(a===s){i=!0,s=r,n=o;break}a=a.sibling}if(!i){for(a=o.child;a;){if(a===n){i=!0,n=o,s=r;break}if(a===s){i=!0,s=o,n=r;break}a=a.sibling}if(!i)throw Error(ae(189))}}if(n.alternate!==s)throw Error(ae(190))}if(n.tag!==3)throw Error(ae(188));return n.stateNode.current===n?t:e}function SR(t){return t=aV(t),t!==null?$R(t):null}function $R(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=$R(t);if(e!==null)return e;t=t.sibling}return null}var IR=nr.unstable_scheduleCallback,OI=nr.unstable_cancelCallback,lV=nr.unstable_shouldYield,cV=nr.unstable_requestPaint,un=nr.unstable_now,uV=nr.unstable_getCurrentPriorityLevel,Kw=nr.unstable_ImmediatePriority,TR=nr.unstable_UserBlockingPriority,qm=nr.unstable_NormalPriority,dV=nr.unstable_LowPriority,ER=nr.unstable_IdlePriority,x0=null,Io=null;function hV(t){if(Io&&typeof Io.onCommitFiberRoot=="function")try{Io.onCommitFiberRoot(x0,t,void 0,(t.current.flags&128)===128)}catch{}}var Zr=Math.clz32?Math.clz32:mV,fV=Math.log,pV=Math.LN2;function mV(t){return t>>>=0,t===0?32:31-(fV(t)/pV|0)|0}var xp=64,yp=4194304;function ad(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function Ym(t,e){var n=t.pendingLanes;if(n===0)return 0;var s=0,r=t.suspendedLanes,o=t.pingedLanes,i=n&268435455;if(i!==0){var a=i&~r;a!==0?s=ad(a):(o&=i,o!==0&&(s=ad(o)))}else i=n&~r,i!==0?s=ad(i):o!==0&&(s=ad(o));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,o=e&-e,r>=o||r===16&&(o&4194240)!==0))return e;if(s&4&&(s|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=s;0<e;)n=31-Zr(e),r=1<<n,s|=t[n],e&=~r;return s}function gV(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function xV(t,e){for(var n=t.suspendedLanes,s=t.pingedLanes,r=t.expirationTimes,o=t.pendingLanes;0<o;){var i=31-Zr(o),a=1<<i,l=r[i];l===-1?(!(a&n)||a&s)&&(r[i]=gV(a,e)):l<=e&&(t.expiredLanes|=a),o&=~a}}function V1(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function NR(){var t=xp;return xp<<=1,!(xp&4194240)&&(xp=64),t}function yb(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ah(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Zr(e),t[e]=n}function yV(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var s=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-Zr(n),o=1<<r;e[r]=0,s[r]=-1,t[r]=-1,n&=~o}}function Xw(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var s=31-Zr(n),r=1<<s;r&e|t[s]&e&&(t[s]|=e),n&=~r}}var xt=0;function _R(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var RR,qw,AR,DR,FR,W1=!1,bp=[],Vi=null,Wi=null,Ui=null,Kd=new Map,Xd=new Map,Ni=[],bV="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function PI(t,e){switch(t){case"focusin":case"focusout":Vi=null;break;case"dragenter":case"dragleave":Wi=null;break;case"mouseover":case"mouseout":Ui=null;break;case"pointerover":case"pointerout":Kd.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":Xd.delete(e.pointerId)}}function Lu(t,e,n,s,r,o){return t===null||t.nativeEvent!==o?(t={blockedOn:e,domEventName:n,eventSystemFlags:s,nativeEvent:o,targetContainers:[r]},e!==null&&(e=Fh(e),e!==null&&qw(e)),t):(t.eventSystemFlags|=s,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function vV(t,e,n,s,r){switch(e){case"focusin":return Vi=Lu(Vi,t,e,n,s,r),!0;case"dragenter":return Wi=Lu(Wi,t,e,n,s,r),!0;case"mouseover":return Ui=Lu(Ui,t,e,n,s,r),!0;case"pointerover":var o=r.pointerId;return Kd.set(o,Lu(Kd.get(o)||null,t,e,n,s,r)),!0;case"gotpointercapture":return o=r.pointerId,Xd.set(o,Lu(Xd.get(o)||null,t,e,n,s,r)),!0}return!1}function OR(t){var e=Ua(t.target);if(e!==null){var n=Al(e);if(n!==null){if(e=n.tag,e===13){if(e=CR(n),e!==null){t.blockedOn=e,FR(t.priority,function(){AR(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function km(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=U1(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var s=new n.constructor(n.type,n);M1=s,n.target.dispatchEvent(s),M1=null}else return e=Fh(n),e!==null&&qw(e),t.blockedOn=n,!1;e.shift()}return!0}function MI(t,e,n){km(t)&&n.delete(e)}function wV(){W1=!1,Vi!==null&&km(Vi)&&(Vi=null),Wi!==null&&km(Wi)&&(Wi=null),Ui!==null&&km(Ui)&&(Ui=null),Kd.forEach(MI),Xd.forEach(MI)}function zu(t,e){t.blockedOn===e&&(t.blockedOn=null,W1||(W1=!0,nr.unstable_scheduleCallback(nr.unstable_NormalPriority,wV)))}function qd(t){function e(r){return zu(r,t)}if(0<bp.length){zu(bp[0],t);for(var n=1;n<bp.length;n++){var s=bp[n];s.blockedOn===t&&(s.blockedOn=null)}}for(Vi!==null&&zu(Vi,t),Wi!==null&&zu(Wi,t),Ui!==null&&zu(Ui,t),Kd.forEach(e),Xd.forEach(e),n=0;n<Ni.length;n++)s=Ni[n],s.blockedOn===t&&(s.blockedOn=null);for(;0<Ni.length&&(n=Ni[0],n.blockedOn===null);)OR(n),n.blockedOn===null&&Ni.shift()}var $c=gi.ReactCurrentBatchConfig,Qm=!0;function kV(t,e,n,s){var r=xt,o=$c.transition;$c.transition=null;try{xt=1,Yw(t,e,n,s)}finally{xt=r,$c.transition=o}}function CV(t,e,n,s){var r=xt,o=$c.transition;$c.transition=null;try{xt=4,Yw(t,e,n,s)}finally{xt=r,$c.transition=o}}function Yw(t,e,n,s){if(Qm){var r=U1(t,e,n,s);if(r===null)Eb(t,e,s,Zm,n),PI(t,s);else if(vV(r,t,e,n,s))s.stopPropagation();else if(PI(t,s),e&4&&-1<bV.indexOf(t)){for(;r!==null;){var o=Fh(r);if(o!==null&&RR(o),o=U1(t,e,n,s),o===null&&Eb(t,e,s,Zm,n),o===r)break;r=o}r!==null&&s.stopPropagation()}else Eb(t,e,s,null,n)}}var Zm=null;function U1(t,e,n,s){if(Zm=null,t=jw(s),t=Ua(t),t!==null)if(e=Al(t),e===null)t=null;else if(n=e.tag,n===13){if(t=CR(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return Zm=t,null}function PR(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(uV()){case Kw:return 1;case TR:return 4;case qm:case dV:return 16;case ER:return 536870912;default:return 16}default:return 16}}var Ai=null,Qw=null,Cm=null;function MR(){if(Cm)return Cm;var t,e=Qw,n=e.length,s,r="value"in Ai?Ai.value:Ai.textContent,o=r.length;for(t=0;t<n&&e[t]===r[t];t++);var i=n-t;for(s=1;s<=i&&e[n-s]===r[o-s];s++);return Cm=r.slice(t,1<s?1-s:void 0)}function Sm(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function vp(){return!0}function LI(){return!1}function ir(t){function e(n,s,r,o,i){this._reactName=n,this._targetInst=r,this.type=s,this.nativeEvent=o,this.target=i,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(o):o[a]);return this.isDefaultPrevented=(o.defaultPrevented!=null?o.defaultPrevented:o.returnValue===!1)?vp:LI,this.isPropagationStopped=LI,this}return Xt(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=vp)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=vp)},persist:function(){},isPersistent:vp}),e}var hu={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zw=ir(hu),Dh=Xt({},hu,{view:0,detail:0}),SV=ir(Dh),bb,vb,Bu,y0=Xt({},Dh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jw,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Bu&&(Bu&&t.type==="mousemove"?(bb=t.screenX-Bu.screenX,vb=t.screenY-Bu.screenY):vb=bb=0,Bu=t),bb)},movementY:function(t){return"movementY"in t?t.movementY:vb}}),zI=ir(y0),$V=Xt({},y0,{dataTransfer:0}),IV=ir($V),TV=Xt({},Dh,{relatedTarget:0}),wb=ir(TV),EV=Xt({},hu,{animationName:0,elapsedTime:0,pseudoElement:0}),NV=ir(EV),_V=Xt({},hu,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RV=ir(_V),AV=Xt({},hu,{data:0}),BI=ir(AV),DV={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},FV={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OV={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function PV(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=OV[t])?!!e[t]:!1}function Jw(){return PV}var MV=Xt({},Dh,{key:function(t){if(t.key){var e=DV[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Sm(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?FV[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jw,charCode:function(t){return t.type==="keypress"?Sm(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Sm(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),LV=ir(MV),zV=Xt({},y0,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),VI=ir(zV),BV=Xt({},Dh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jw}),VV=ir(BV),WV=Xt({},hu,{propertyName:0,elapsedTime:0,pseudoElement:0}),UV=ir(WV),HV=Xt({},y0,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GV=ir(HV),jV=[9,13,27,32],ek=ri&&"CompositionEvent"in window,Id=null;ri&&"documentMode"in document&&(Id=document.documentMode);var KV=ri&&"TextEvent"in window&&!Id,LR=ri&&(!ek||Id&&8<Id&&11>=Id),WI=String.fromCharCode(32),UI=!1;function zR(t,e){switch(t){case"keyup":return jV.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function BR(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var dc=!1;function XV(t,e){switch(t){case"compositionend":return BR(e);case"keypress":return e.which!==32?null:(UI=!0,WI);case"textInput":return t=e.data,t===WI&&UI?null:t;default:return null}}function qV(t,e){if(dc)return t==="compositionend"||!ek&&zR(t,e)?(t=MR(),Cm=Qw=Ai=null,dc=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return LR&&e.locale!=="ko"?null:e.data;default:return null}}var YV={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function HI(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!YV[t.type]:e==="textarea"}function VR(t,e,n,s){yR(s),e=Jm(e,"onChange"),0<e.length&&(n=new Zw("onChange","change",null,n,s),t.push({event:n,listeners:e}))}var Td=null,Yd=null;function QV(t){ZR(t,0)}function b0(t){var e=pc(t);if(dR(e))return t}function ZV(t,e){if(t==="change")return e}var WR=!1;if(ri){var kb;if(ri){var Cb="oninput"in document;if(!Cb){var GI=document.createElement("div");GI.setAttribute("oninput","return;"),Cb=typeof GI.oninput=="function"}kb=Cb}else kb=!1;WR=kb&&(!document.documentMode||9<document.documentMode)}function jI(){Td&&(Td.detachEvent("onpropertychange",UR),Yd=Td=null)}function UR(t){if(t.propertyName==="value"&&b0(Yd)){var e=[];VR(e,Yd,t,jw(t)),kR(QV,e)}}function JV(t,e,n){t==="focusin"?(jI(),Td=e,Yd=n,Td.attachEvent("onpropertychange",UR)):t==="focusout"&&jI()}function eW(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return b0(Yd)}function tW(t,e){if(t==="click")return b0(e)}function nW(t,e){if(t==="input"||t==="change")return b0(e)}function sW(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var so=typeof Object.is=="function"?Object.is:sW;function Qd(t,e){if(so(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),s=Object.keys(e);if(n.length!==s.length)return!1;for(s=0;s<n.length;s++){var r=n[s];if(!$1.call(e,r)||!so(t[r],e[r]))return!1}return!0}function KI(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function XI(t,e){var n=KI(t);t=0;for(var s;n;){if(n.nodeType===3){if(s=t+n.textContent.length,t<=e&&s>=e)return{node:n,offset:e-t};t=s}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=KI(n)}}function HR(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?HR(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function GR(){for(var t=window,e=jm();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=jm(t.document)}return e}function tk(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function rW(t){var e=GR(),n=t.focusedElem,s=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&HR(n.ownerDocument.documentElement,n)){if(s!==null&&tk(n)){if(e=s.start,t=s.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,o=Math.min(s.start,r);s=s.end===void 0?o:Math.min(s.end,r),!t.extend&&o>s&&(r=s,s=o,o=r),r=XI(n,o);var i=XI(n,s);r&&i&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==i.node||t.focusOffset!==i.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),o>s?(t.addRange(e),t.extend(i.node,i.offset)):(e.setEnd(i.node,i.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oW=ri&&"documentMode"in document&&11>=document.documentMode,hc=null,H1=null,Ed=null,G1=!1;function qI(t,e,n){var s=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;G1||hc==null||hc!==jm(s)||(s=hc,"selectionStart"in s&&tk(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),Ed&&Qd(Ed,s)||(Ed=s,s=Jm(H1,"onSelect"),0<s.length&&(e=new Zw("onSelect","select",null,e,n),t.push({event:e,listeners:s}),e.target=hc)))}function wp(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var fc={animationend:wp("Animation","AnimationEnd"),animationiteration:wp("Animation","AnimationIteration"),animationstart:wp("Animation","AnimationStart"),transitionend:wp("Transition","TransitionEnd")},Sb={},jR={};ri&&(jR=document.createElement("div").style,"AnimationEvent"in window||(delete fc.animationend.animation,delete fc.animationiteration.animation,delete fc.animationstart.animation),"TransitionEvent"in window||delete fc.transitionend.transition);function v0(t){if(Sb[t])return Sb[t];if(!fc[t])return t;var e=fc[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in jR)return Sb[t]=e[n];return t}var KR=v0("animationend"),XR=v0("animationiteration"),qR=v0("animationstart"),YR=v0("transitionend"),QR=new Map,YI="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function da(t,e){QR.set(t,e),Rl(e,[t])}for(var $b=0;$b<YI.length;$b++){var Ib=YI[$b],iW=Ib.toLowerCase(),aW=Ib[0].toUpperCase()+Ib.slice(1);da(iW,"on"+aW)}da(KR,"onAnimationEnd");da(XR,"onAnimationIteration");da(qR,"onAnimationStart");da("dblclick","onDoubleClick");da("focusin","onFocus");da("focusout","onBlur");da(YR,"onTransitionEnd");Lc("onMouseEnter",["mouseout","mouseover"]);Lc("onMouseLeave",["mouseout","mouseover"]);Lc("onPointerEnter",["pointerout","pointerover"]);Lc("onPointerLeave",["pointerout","pointerover"]);Rl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Rl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Rl("onBeforeInput",["compositionend","keypress","textInput","paste"]);Rl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Rl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ld="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lW=new Set("cancel close invalid load scroll toggle".split(" ").concat(ld));function QI(t,e,n){var s=t.type||"unknown-event";t.currentTarget=n,iV(s,e,void 0,t),t.currentTarget=null}function ZR(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var s=t[n],r=s.event;s=s.listeners;e:{var o=void 0;if(e)for(var i=s.length-1;0<=i;i--){var a=s[i],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==o&&r.isPropagationStopped())break e;QI(r,a,c),o=l}else for(i=0;i<s.length;i++){if(a=s[i],l=a.instance,c=a.currentTarget,a=a.listener,l!==o&&r.isPropagationStopped())break e;QI(r,a,c),o=l}}}if(Xm)throw t=B1,Xm=!1,B1=null,t}function Dt(t,e){var n=e[Y1];n===void 0&&(n=e[Y1]=new Set);var s=t+"__bubble";n.has(s)||(JR(e,t,2,!1),n.add(s))}function Tb(t,e,n){var s=0;e&&(s|=4),JR(n,t,s,e)}var kp="_reactListening"+Math.random().toString(36).slice(2);function Zd(t){if(!t[kp]){t[kp]=!0,iR.forEach(function(n){n!=="selectionchange"&&(lW.has(n)||Tb(n,!1,t),Tb(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[kp]||(e[kp]=!0,Tb("selectionchange",!1,e))}}function JR(t,e,n,s){switch(PR(e)){case 1:var r=kV;break;case 4:r=CV;break;default:r=Yw}n=r.bind(null,e,n,t),r=void 0,!z1||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Eb(t,e,n,s,r){var o=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var i=s.tag;if(i===3||i===4){var a=s.stateNode.containerInfo;if(a===r||a.nodeType===8&&a.parentNode===r)break;if(i===4)for(i=s.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;i=i.return}for(;a!==null;){if(i=Ua(a),i===null)return;if(l=i.tag,l===5||l===6){s=o=i;continue e}a=a.parentNode}}s=s.return}kR(function(){var c=o,u=jw(n),d=[];e:{var h=QR.get(t);if(h!==void 0){var f=Zw,p=t;switch(t){case"keypress":if(Sm(n)===0)break e;case"keydown":case"keyup":f=LV;break;case"focusin":p="focus",f=wb;break;case"focusout":p="blur",f=wb;break;case"beforeblur":case"afterblur":f=wb;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=zI;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=IV;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=VV;break;case KR:case XR:case qR:f=NV;break;case YR:f=UV;break;case"scroll":f=SV;break;case"wheel":f=GV;break;case"copy":case"cut":case"paste":f=RV;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=VI}var m=(e&4)!==0,x=!m&&t==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,b;y!==null;){b=y;var v=b.stateNode;if(b.tag===5&&v!==null&&(b=v,g!==null&&(v=jd(y,g),v!=null&&m.push(Jd(y,v,b)))),x)break;y=y.return}0<m.length&&(h=new f(h,p,null,n,u),d.push({event:h,listeners:m}))}}if(!(e&7)){e:{if(h=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",h&&n!==M1&&(p=n.relatedTarget||n.fromElement)&&(Ua(p)||p[oi]))break e;if((f||h)&&(h=u.window===u?u:(h=u.ownerDocument)?h.defaultView||h.parentWindow:window,f?(p=n.relatedTarget||n.toElement,f=c,p=p?Ua(p):null,p!==null&&(x=Al(p),p!==x||p.tag!==5&&p.tag!==6)&&(p=null)):(f=null,p=c),f!==p)){if(m=zI,v="onMouseLeave",g="onMouseEnter",y="mouse",(t==="pointerout"||t==="pointerover")&&(m=VI,v="onPointerLeave",g="onPointerEnter",y="pointer"),x=f==null?h:pc(f),b=p==null?h:pc(p),h=new m(v,y+"leave",f,n,u),h.target=x,h.relatedTarget=b,v=null,Ua(u)===c&&(m=new m(g,y+"enter",p,n,u),m.target=b,m.relatedTarget=x,v=m),x=v,f&&p)t:{for(m=f,g=p,y=0,b=m;b;b=Kl(b))y++;for(b=0,v=g;v;v=Kl(v))b++;for(;0<y-b;)m=Kl(m),y--;for(;0<b-y;)g=Kl(g),b--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=Kl(m),g=Kl(g)}m=null}else m=null;f!==null&&ZI(d,h,f,m,!1),p!==null&&x!==null&&ZI(d,x,p,m,!0)}}e:{if(h=c?pc(c):window,f=h.nodeName&&h.nodeName.toLowerCase(),f==="select"||f==="input"&&h.type==="file")var w=ZV;else if(HI(h))if(WR)w=nW;else{w=eW;var k=JV}else(f=h.nodeName)&&f.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(w=tW);if(w&&(w=w(t,c))){VR(d,w,n,u);break e}k&&k(t,h,c),t==="focusout"&&(k=h._wrapperState)&&k.controlled&&h.type==="number"&&A1(h,"number",h.value)}switch(k=c?pc(c):window,t){case"focusin":(HI(k)||k.contentEditable==="true")&&(hc=k,H1=c,Ed=null);break;case"focusout":Ed=H1=hc=null;break;case"mousedown":G1=!0;break;case"contextmenu":case"mouseup":case"dragend":G1=!1,qI(d,n,u);break;case"selectionchange":if(oW)break;case"keydown":case"keyup":qI(d,n,u)}var C;if(ek)e:{switch(t){case"compositionstart":var S="onCompositionStart";break e;case"compositionend":S="onCompositionEnd";break e;case"compositionupdate":S="onCompositionUpdate";break e}S=void 0}else dc?zR(t,n)&&(S="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(S="onCompositionStart");S&&(LR&&n.locale!=="ko"&&(dc||S!=="onCompositionStart"?S==="onCompositionEnd"&&dc&&(C=MR()):(Ai=u,Qw="value"in Ai?Ai.value:Ai.textContent,dc=!0)),k=Jm(c,S),0<k.length&&(S=new BI(S,t,null,n,u),d.push({event:S,listeners:k}),C?S.data=C:(C=BR(n),C!==null&&(S.data=C)))),(C=KV?XV(t,n):qV(t,n))&&(c=Jm(c,"onBeforeInput"),0<c.length&&(u=new BI("onBeforeInput","beforeinput",null,n,u),d.push({event:u,listeners:c}),u.data=C))}ZR(d,e)})}function Jd(t,e,n){return{instance:t,listener:e,currentTarget:n}}function Jm(t,e){for(var n=e+"Capture",s=[];t!==null;){var r=t,o=r.stateNode;r.tag===5&&o!==null&&(r=o,o=jd(t,n),o!=null&&s.unshift(Jd(t,o,r)),o=jd(t,e),o!=null&&s.push(Jd(t,o,r))),t=t.return}return s}function Kl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function ZI(t,e,n,s,r){for(var o=e._reactName,i=[];n!==null&&n!==s;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===s)break;a.tag===5&&c!==null&&(a=c,r?(l=jd(n,o),l!=null&&i.unshift(Jd(n,l,a))):r||(l=jd(n,o),l!=null&&i.push(Jd(n,l,a)))),n=n.return}i.length!==0&&t.push({event:e,listeners:i})}var cW=/\r\n?/g,uW=/\u0000|\uFFFD/g;function JI(t){return(typeof t=="string"?t:""+t).replace(cW,`
`).replace(uW,"")}function Cp(t,e,n){if(e=JI(e),JI(t)!==e&&n)throw Error(ae(425))}function eg(){}var j1=null,K1=null;function X1(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var q1=typeof setTimeout=="function"?setTimeout:void 0,dW=typeof clearTimeout=="function"?clearTimeout:void 0,e2=typeof Promise=="function"?Promise:void 0,hW=typeof queueMicrotask=="function"?queueMicrotask:typeof e2<"u"?function(t){return e2.resolve(null).then(t).catch(fW)}:q1;function fW(t){setTimeout(function(){throw t})}function Nb(t,e){var n=e,s=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(s===0){t.removeChild(r),qd(e);return}s--}else n!=="$"&&n!=="$?"&&n!=="$!"||s++;n=r}while(n);qd(e)}function Hi(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function t2(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var fu=Math.random().toString(36).slice(2),Co="__reactFiber$"+fu,eh="__reactProps$"+fu,oi="__reactContainer$"+fu,Y1="__reactEvents$"+fu,pW="__reactListeners$"+fu,mW="__reactHandles$"+fu;function Ua(t){var e=t[Co];if(e)return e;for(var n=t.parentNode;n;){if(e=n[oi]||n[Co]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=t2(t);t!==null;){if(n=t[Co])return n;t=t2(t)}return e}t=n,n=t.parentNode}return null}function Fh(t){return t=t[Co]||t[oi],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function pc(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ae(33))}function w0(t){return t[eh]||null}var Q1=[],mc=-1;function ha(t){return{current:t}}function Ft(t){0>mc||(t.current=Q1[mc],Q1[mc]=null,mc--)}function Et(t,e){mc++,Q1[mc]=t.current,t.current=e}var na={},us=ha(na),Ms=ha(!1),il=na;function zc(t,e){var n=t.type.contextTypes;if(!n)return na;var s=t.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},o;for(o in n)r[o]=e[o];return s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Ls(t){return t=t.childContextTypes,t!=null}function tg(){Ft(Ms),Ft(us)}function n2(t,e,n){if(us.current!==na)throw Error(ae(168));Et(us,e),Et(Ms,n)}function eA(t,e,n){var s=t.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return n;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ae(108,J4(t)||"Unknown",r));return Xt({},n,s)}function ng(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||na,il=us.current,Et(us,t),Et(Ms,Ms.current),!0}function s2(t,e,n){var s=t.stateNode;if(!s)throw Error(ae(169));n?(t=eA(t,e,il),s.__reactInternalMemoizedMergedChildContext=t,Ft(Ms),Ft(us),Et(us,t)):Ft(Ms),Et(Ms,n)}var Xo=null,k0=!1,_b=!1;function tA(t){Xo===null?Xo=[t]:Xo.push(t)}function gW(t){k0=!0,tA(t)}function fa(){if(!_b&&Xo!==null){_b=!0;var t=0,e=xt;try{var n=Xo;for(xt=1;t<n.length;t++){var s=n[t];do s=s(!0);while(s!==null)}Xo=null,k0=!1}catch(r){throw Xo!==null&&(Xo=Xo.slice(t+1)),IR(Kw,fa),r}finally{xt=e,_b=!1}}return null}var gc=[],xc=0,sg=null,rg=0,gr=[],xr=0,al=null,Zo=1,Jo="";function Aa(t,e){gc[xc++]=rg,gc[xc++]=sg,sg=t,rg=e}function nA(t,e,n){gr[xr++]=Zo,gr[xr++]=Jo,gr[xr++]=al,al=t;var s=Zo;t=Jo;var r=32-Zr(s)-1;s&=~(1<<r),n+=1;var o=32-Zr(e)+r;if(30<o){var i=r-r%5;o=(s&(1<<i)-1).toString(32),s>>=i,r-=i,Zo=1<<32-Zr(e)+r|n<<r|s,Jo=o+t}else Zo=1<<o|n<<r|s,Jo=t}function nk(t){t.return!==null&&(Aa(t,1),nA(t,1,0))}function sk(t){for(;t===sg;)sg=gc[--xc],gc[xc]=null,rg=gc[--xc],gc[xc]=null;for(;t===al;)al=gr[--xr],gr[xr]=null,Jo=gr[--xr],gr[xr]=null,Zo=gr[--xr],gr[xr]=null}var Zs=null,qs=null,Bt=!1,Kr=null;function sA(t,e){var n=vr(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function r2(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Zs=t,qs=Hi(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Zs=t,qs=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=al!==null?{id:Zo,overflow:Jo}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=vr(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Zs=t,qs=null,!0):!1;default:return!1}}function Z1(t){return(t.mode&1)!==0&&(t.flags&128)===0}function J1(t){if(Bt){var e=qs;if(e){var n=e;if(!r2(t,e)){if(Z1(t))throw Error(ae(418));e=Hi(n.nextSibling);var s=Zs;e&&r2(t,e)?sA(s,n):(t.flags=t.flags&-4097|2,Bt=!1,Zs=t)}}else{if(Z1(t))throw Error(ae(418));t.flags=t.flags&-4097|2,Bt=!1,Zs=t}}}function o2(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Zs=t}function Sp(t){if(t!==Zs)return!1;if(!Bt)return o2(t),Bt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!X1(t.type,t.memoizedProps)),e&&(e=qs)){if(Z1(t))throw rA(),Error(ae(418));for(;e;)sA(t,e),e=Hi(e.nextSibling)}if(o2(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ae(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){qs=Hi(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}qs=null}}else qs=Zs?Hi(t.stateNode.nextSibling):null;return!0}function rA(){for(var t=qs;t;)t=Hi(t.nextSibling)}function Bc(){qs=Zs=null,Bt=!1}function rk(t){Kr===null?Kr=[t]:Kr.push(t)}var xW=gi.ReactCurrentBatchConfig;function Vu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ae(309));var s=n.stateNode}if(!s)throw Error(ae(147,t));var r=s,o=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===o?e.ref:(e=function(i){var a=r.refs;i===null?delete a[o]:a[o]=i},e._stringRef=o,e)}if(typeof t!="string")throw Error(ae(284));if(!n._owner)throw Error(ae(290,t))}return t}function $p(t,e){throw t=Object.prototype.toString.call(e),Error(ae(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function i2(t){var e=t._init;return e(t._payload)}function oA(t){function e(g,y){if(t){var b=g.deletions;b===null?(g.deletions=[y],g.flags|=16):b.push(y)}}function n(g,y){if(!t)return null;for(;y!==null;)e(g,y),y=y.sibling;return null}function s(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function r(g,y){return g=Xi(g,y),g.index=0,g.sibling=null,g}function o(g,y,b){return g.index=b,t?(b=g.alternate,b!==null?(b=b.index,b<y?(g.flags|=2,y):b):(g.flags|=2,y)):(g.flags|=1048576,y)}function i(g){return t&&g.alternate===null&&(g.flags|=2),g}function a(g,y,b,v){return y===null||y.tag!==6?(y=Mb(b,g.mode,v),y.return=g,y):(y=r(y,b),y.return=g,y)}function l(g,y,b,v){var w=b.type;return w===uc?u(g,y,b.props.children,v,b.key):y!==null&&(y.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===$i&&i2(w)===y.type)?(v=r(y,b.props),v.ref=Vu(g,y,b),v.return=g,v):(v=Rm(b.type,b.key,b.props,null,g.mode,v),v.ref=Vu(g,y,b),v.return=g,v)}function c(g,y,b,v){return y===null||y.tag!==4||y.stateNode.containerInfo!==b.containerInfo||y.stateNode.implementation!==b.implementation?(y=Lb(b,g.mode,v),y.return=g,y):(y=r(y,b.children||[]),y.return=g,y)}function u(g,y,b,v,w){return y===null||y.tag!==7?(y=Ja(b,g.mode,v,w),y.return=g,y):(y=r(y,b),y.return=g,y)}function d(g,y,b){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Mb(""+y,g.mode,b),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case pp:return b=Rm(y.type,y.key,y.props,null,g.mode,b),b.ref=Vu(g,null,y),b.return=g,b;case cc:return y=Lb(y,g.mode,b),y.return=g,y;case $i:var v=y._init;return d(g,v(y._payload),b)}if(id(y)||Pu(y))return y=Ja(y,g.mode,b,null),y.return=g,y;$p(g,y)}return null}function h(g,y,b,v){var w=y!==null?y.key:null;if(typeof b=="string"&&b!==""||typeof b=="number")return w!==null?null:a(g,y,""+b,v);if(typeof b=="object"&&b!==null){switch(b.$$typeof){case pp:return b.key===w?l(g,y,b,v):null;case cc:return b.key===w?c(g,y,b,v):null;case $i:return w=b._init,h(g,y,w(b._payload),v)}if(id(b)||Pu(b))return w!==null?null:u(g,y,b,v,null);$p(g,b)}return null}function f(g,y,b,v,w){if(typeof v=="string"&&v!==""||typeof v=="number")return g=g.get(b)||null,a(y,g,""+v,w);if(typeof v=="object"&&v!==null){switch(v.$$typeof){case pp:return g=g.get(v.key===null?b:v.key)||null,l(y,g,v,w);case cc:return g=g.get(v.key===null?b:v.key)||null,c(y,g,v,w);case $i:var k=v._init;return f(g,y,b,k(v._payload),w)}if(id(v)||Pu(v))return g=g.get(b)||null,u(y,g,v,w,null);$p(y,v)}return null}function p(g,y,b,v){for(var w=null,k=null,C=y,S=y=0,I=null;C!==null&&S<b.length;S++){C.index>S?(I=C,C=null):I=C.sibling;var $=h(g,C,b[S],v);if($===null){C===null&&(C=I);break}t&&C&&$.alternate===null&&e(g,C),y=o($,y,S),k===null?w=$:k.sibling=$,k=$,C=I}if(S===b.length)return n(g,C),Bt&&Aa(g,S),w;if(C===null){for(;S<b.length;S++)C=d(g,b[S],v),C!==null&&(y=o(C,y,S),k===null?w=C:k.sibling=C,k=C);return Bt&&Aa(g,S),w}for(C=s(g,C);S<b.length;S++)I=f(C,g,S,b[S],v),I!==null&&(t&&I.alternate!==null&&C.delete(I.key===null?S:I.key),y=o(I,y,S),k===null?w=I:k.sibling=I,k=I);return t&&C.forEach(function(E){return e(g,E)}),Bt&&Aa(g,S),w}function m(g,y,b,v){var w=Pu(b);if(typeof w!="function")throw Error(ae(150));if(b=w.call(b),b==null)throw Error(ae(151));for(var k=w=null,C=y,S=y=0,I=null,$=b.next();C!==null&&!$.done;S++,$=b.next()){C.index>S?(I=C,C=null):I=C.sibling;var E=h(g,C,$.value,v);if(E===null){C===null&&(C=I);break}t&&C&&E.alternate===null&&e(g,C),y=o(E,y,S),k===null?w=E:k.sibling=E,k=E,C=I}if($.done)return n(g,C),Bt&&Aa(g,S),w;if(C===null){for(;!$.done;S++,$=b.next())$=d(g,$.value,v),$!==null&&(y=o($,y,S),k===null?w=$:k.sibling=$,k=$);return Bt&&Aa(g,S),w}for(C=s(g,C);!$.done;S++,$=b.next())$=f(C,g,S,$.value,v),$!==null&&(t&&$.alternate!==null&&C.delete($.key===null?S:$.key),y=o($,y,S),k===null?w=$:k.sibling=$,k=$);return t&&C.forEach(function(_){return e(g,_)}),Bt&&Aa(g,S),w}function x(g,y,b,v){if(typeof b=="object"&&b!==null&&b.type===uc&&b.key===null&&(b=b.props.children),typeof b=="object"&&b!==null){switch(b.$$typeof){case pp:e:{for(var w=b.key,k=y;k!==null;){if(k.key===w){if(w=b.type,w===uc){if(k.tag===7){n(g,k.sibling),y=r(k,b.props.children),y.return=g,g=y;break e}}else if(k.elementType===w||typeof w=="object"&&w!==null&&w.$$typeof===$i&&i2(w)===k.type){n(g,k.sibling),y=r(k,b.props),y.ref=Vu(g,k,b),y.return=g,g=y;break e}n(g,k);break}else e(g,k);k=k.sibling}b.type===uc?(y=Ja(b.props.children,g.mode,v,b.key),y.return=g,g=y):(v=Rm(b.type,b.key,b.props,null,g.mode,v),v.ref=Vu(g,y,b),v.return=g,g=v)}return i(g);case cc:e:{for(k=b.key;y!==null;){if(y.key===k)if(y.tag===4&&y.stateNode.containerInfo===b.containerInfo&&y.stateNode.implementation===b.implementation){n(g,y.sibling),y=r(y,b.children||[]),y.return=g,g=y;break e}else{n(g,y);break}else e(g,y);y=y.sibling}y=Lb(b,g.mode,v),y.return=g,g=y}return i(g);case $i:return k=b._init,x(g,y,k(b._payload),v)}if(id(b))return p(g,y,b,v);if(Pu(b))return m(g,y,b,v);$p(g,b)}return typeof b=="string"&&b!==""||typeof b=="number"?(b=""+b,y!==null&&y.tag===6?(n(g,y.sibling),y=r(y,b),y.return=g,g=y):(n(g,y),y=Mb(b,g.mode,v),y.return=g,g=y),i(g)):n(g,y)}return x}var Vc=oA(!0),iA=oA(!1),og=ha(null),ig=null,yc=null,ok=null;function ik(){ok=yc=ig=null}function ak(t){var e=og.current;Ft(og),t._currentValue=e}function ev(t,e,n){for(;t!==null;){var s=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),t===n)break;t=t.return}}function Ic(t,e){ig=t,ok=yc=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Ds=!0),t.firstContext=null)}function Rr(t){var e=t._currentValue;if(ok!==t)if(t={context:t,memoizedValue:e,next:null},yc===null){if(ig===null)throw Error(ae(308));yc=t,ig.dependencies={lanes:0,firstContext:t}}else yc=yc.next=t;return e}var Ha=null;function lk(t){Ha===null?Ha=[t]:Ha.push(t)}function aA(t,e,n,s){var r=e.interleaved;return r===null?(n.next=n,lk(e)):(n.next=r.next,r.next=n),e.interleaved=n,ii(t,s)}function ii(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ii=!1;function ck(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lA(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ni(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Gi(t,e,n){var s=t.updateQueue;if(s===null)return null;if(s=s.shared,ot&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,ii(t,n)}return r=s.interleaved,r===null?(e.next=e,lk(s)):(e.next=r.next,r.next=e),s.interleaved=e,ii(t,n)}function $m(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Xw(t,n)}}function a2(t,e){var n=t.updateQueue,s=t.alternate;if(s!==null&&(s=s.updateQueue,n===s)){var r=null,o=null;if(n=n.firstBaseUpdate,n!==null){do{var i={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};o===null?r=o=i:o=o.next=i,n=n.next}while(n!==null);o===null?r=o=e:o=o.next=e}else r=o=e;n={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:o,shared:s.shared,effects:s.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function ag(t,e,n,s){var r=t.updateQueue;Ii=!1;var o=r.firstBaseUpdate,i=r.lastBaseUpdate,a=r.shared.pending;if(a!==null){r.shared.pending=null;var l=a,c=l.next;l.next=null,i===null?o=c:i.next=c,i=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==i&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(o!==null){var d=r.baseState;i=0,u=c=l=null,a=o;do{var h=a.lane,f=a.eventTime;if((s&h)===h){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=t,m=a;switch(h=e,f=n,m.tag){case 1:if(p=m.payload,typeof p=="function"){d=p.call(f,d,h);break e}d=p;break e;case 3:p.flags=p.flags&-65537|128;case 0:if(p=m.payload,h=typeof p=="function"?p.call(f,d,h):p,h==null)break e;d=Xt({},d,h);break e;case 2:Ii=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,h=r.effects,h===null?r.effects=[a]:h.push(a))}else f={eventTime:f,lane:h,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=d):u=u.next=f,i|=h;if(a=a.next,a===null){if(a=r.shared.pending,a===null)break;h=a,a=h.next,h.next=null,r.lastBaseUpdate=h,r.shared.pending=null}}while(1);if(u===null&&(l=d),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=u,e=r.shared.interleaved,e!==null){r=e;do i|=r.lane,r=r.next;while(r!==e)}else o===null&&(r.shared.lanes=0);cl|=i,t.lanes=i,t.memoizedState=d}}function l2(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var s=t[e],r=s.callback;if(r!==null){if(s.callback=null,s=n,typeof r!="function")throw Error(ae(191,r));r.call(s)}}}var Oh={},To=ha(Oh),th=ha(Oh),nh=ha(Oh);function Ga(t){if(t===Oh)throw Error(ae(174));return t}function uk(t,e){switch(Et(nh,e),Et(th,t),Et(To,Oh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:F1(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=F1(e,t)}Ft(To),Et(To,e)}function Wc(){Ft(To),Ft(th),Ft(nh)}function cA(t){Ga(nh.current);var e=Ga(To.current),n=F1(e,t.type);e!==n&&(Et(th,t),Et(To,n))}function dk(t){th.current===t&&(Ft(To),Ft(th))}var Gt=ha(0);function lg(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Rb=[];function hk(){for(var t=0;t<Rb.length;t++)Rb[t]._workInProgressVersionPrimary=null;Rb.length=0}var Im=gi.ReactCurrentDispatcher,Ab=gi.ReactCurrentBatchConfig,ll=0,Kt=null,Tn=null,Dn=null,cg=!1,Nd=!1,sh=0,yW=0;function es(){throw Error(ae(321))}function fk(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!so(t[n],e[n]))return!1;return!0}function pk(t,e,n,s,r,o){if(ll=o,Kt=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Im.current=t===null||t.memoizedState===null?kW:CW,t=n(s,r),Nd){o=0;do{if(Nd=!1,sh=0,25<=o)throw Error(ae(301));o+=1,Dn=Tn=null,e.updateQueue=null,Im.current=SW,t=n(s,r)}while(Nd)}if(Im.current=ug,e=Tn!==null&&Tn.next!==null,ll=0,Dn=Tn=Kt=null,cg=!1,e)throw Error(ae(300));return t}function mk(){var t=sh!==0;return sh=0,t}function po(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dn===null?Kt.memoizedState=Dn=t:Dn=Dn.next=t,Dn}function Ar(){if(Tn===null){var t=Kt.alternate;t=t!==null?t.memoizedState:null}else t=Tn.next;var e=Dn===null?Kt.memoizedState:Dn.next;if(e!==null)Dn=e,Tn=t;else{if(t===null)throw Error(ae(310));Tn=t,t={memoizedState:Tn.memoizedState,baseState:Tn.baseState,baseQueue:Tn.baseQueue,queue:Tn.queue,next:null},Dn===null?Kt.memoizedState=Dn=t:Dn=Dn.next=t}return Dn}function rh(t,e){return typeof e=="function"?e(t):e}function Db(t){var e=Ar(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var s=Tn,r=s.baseQueue,o=n.pending;if(o!==null){if(r!==null){var i=r.next;r.next=o.next,o.next=i}s.baseQueue=r=o,n.pending=null}if(r!==null){o=r.next,s=s.baseState;var a=i=null,l=null,c=o;do{var u=c.lane;if((ll&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),s=c.hasEagerState?c.eagerState:t(s,c.action);else{var d={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=d,i=s):l=l.next=d,Kt.lanes|=u,cl|=u}c=c.next}while(c!==null&&c!==o);l===null?i=s:l.next=a,so(s,e.memoizedState)||(Ds=!0),e.memoizedState=s,e.baseState=i,e.baseQueue=l,n.lastRenderedState=s}if(t=n.interleaved,t!==null){r=t;do o=r.lane,Kt.lanes|=o,cl|=o,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Fb(t){var e=Ar(),n=e.queue;if(n===null)throw Error(ae(311));n.lastRenderedReducer=t;var s=n.dispatch,r=n.pending,o=e.memoizedState;if(r!==null){n.pending=null;var i=r=r.next;do o=t(o,i.action),i=i.next;while(i!==r);so(o,e.memoizedState)||(Ds=!0),e.memoizedState=o,e.baseQueue===null&&(e.baseState=o),n.lastRenderedState=o}return[o,s]}function uA(){}function dA(t,e){var n=Kt,s=Ar(),r=e(),o=!so(s.memoizedState,r);if(o&&(s.memoizedState=r,Ds=!0),s=s.queue,gk(pA.bind(null,n,s,t),[t]),s.getSnapshot!==e||o||Dn!==null&&Dn.memoizedState.tag&1){if(n.flags|=2048,oh(9,fA.bind(null,n,s,r,e),void 0,null),Pn===null)throw Error(ae(349));ll&30||hA(n,e,r)}return r}function hA(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Kt.updateQueue,e===null?(e={lastEffect:null,stores:null},Kt.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function fA(t,e,n,s){e.value=n,e.getSnapshot=s,mA(e)&&gA(t)}function pA(t,e,n){return n(function(){mA(e)&&gA(t)})}function mA(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!so(t,n)}catch{return!0}}function gA(t){var e=ii(t,1);e!==null&&Jr(e,t,1,-1)}function c2(t){var e=po();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:rh,lastRenderedState:t},e.queue=t,t=t.dispatch=wW.bind(null,Kt,t),[e.memoizedState,t]}function oh(t,e,n,s){return t={tag:t,create:e,destroy:n,deps:s,next:null},e=Kt.updateQueue,e===null?(e={lastEffect:null,stores:null},Kt.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(s=n.next,n.next=t,t.next=s,e.lastEffect=t)),t}function xA(){return Ar().memoizedState}function Tm(t,e,n,s){var r=po();Kt.flags|=t,r.memoizedState=oh(1|e,n,void 0,s===void 0?null:s)}function C0(t,e,n,s){var r=Ar();s=s===void 0?null:s;var o=void 0;if(Tn!==null){var i=Tn.memoizedState;if(o=i.destroy,s!==null&&fk(s,i.deps)){r.memoizedState=oh(e,n,o,s);return}}Kt.flags|=t,r.memoizedState=oh(1|e,n,o,s)}function u2(t,e){return Tm(8390656,8,t,e)}function gk(t,e){return C0(2048,8,t,e)}function yA(t,e){return C0(4,2,t,e)}function bA(t,e){return C0(4,4,t,e)}function vA(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function wA(t,e,n){return n=n!=null?n.concat([t]):null,C0(4,4,vA.bind(null,e,t),n)}function xk(){}function kA(t,e){var n=Ar();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&fk(e,s[1])?s[0]:(n.memoizedState=[t,e],t)}function CA(t,e){var n=Ar();e=e===void 0?null:e;var s=n.memoizedState;return s!==null&&e!==null&&fk(e,s[1])?s[0]:(t=t(),n.memoizedState=[t,e],t)}function SA(t,e,n){return ll&21?(so(n,e)||(n=NR(),Kt.lanes|=n,cl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Ds=!0),t.memoizedState=n)}function bW(t,e){var n=xt;xt=n!==0&&4>n?n:4,t(!0);var s=Ab.transition;Ab.transition={};try{t(!1),e()}finally{xt=n,Ab.transition=s}}function $A(){return Ar().memoizedState}function vW(t,e,n){var s=Ki(t);if(n={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null},IA(t))TA(e,n);else if(n=aA(t,e,n,s),n!==null){var r=vs();Jr(n,t,s,r),EA(n,e,s)}}function wW(t,e,n){var s=Ki(t),r={lane:s,action:n,hasEagerState:!1,eagerState:null,next:null};if(IA(t))TA(e,r);else{var o=t.alternate;if(t.lanes===0&&(o===null||o.lanes===0)&&(o=e.lastRenderedReducer,o!==null))try{var i=e.lastRenderedState,a=o(i,n);if(r.hasEagerState=!0,r.eagerState=a,so(a,i)){var l=e.interleaved;l===null?(r.next=r,lk(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=aA(t,e,r,s),n!==null&&(r=vs(),Jr(n,t,s,r),EA(n,e,s))}}function IA(t){var e=t.alternate;return t===Kt||e!==null&&e===Kt}function TA(t,e){Nd=cg=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function EA(t,e,n){if(n&4194240){var s=e.lanes;s&=t.pendingLanes,n|=s,e.lanes=n,Xw(t,n)}}var ug={readContext:Rr,useCallback:es,useContext:es,useEffect:es,useImperativeHandle:es,useInsertionEffect:es,useLayoutEffect:es,useMemo:es,useReducer:es,useRef:es,useState:es,useDebugValue:es,useDeferredValue:es,useTransition:es,useMutableSource:es,useSyncExternalStore:es,useId:es,unstable_isNewReconciler:!1},kW={readContext:Rr,useCallback:function(t,e){return po().memoizedState=[t,e===void 0?null:e],t},useContext:Rr,useEffect:u2,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Tm(4194308,4,vA.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Tm(4194308,4,t,e)},useInsertionEffect:function(t,e){return Tm(4,2,t,e)},useMemo:function(t,e){var n=po();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var s=po();return e=n!==void 0?n(e):e,s.memoizedState=s.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},s.queue=t,t=t.dispatch=vW.bind(null,Kt,t),[s.memoizedState,t]},useRef:function(t){var e=po();return t={current:t},e.memoizedState=t},useState:c2,useDebugValue:xk,useDeferredValue:function(t){return po().memoizedState=t},useTransition:function(){var t=c2(!1),e=t[0];return t=bW.bind(null,t[1]),po().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var s=Kt,r=po();if(Bt){if(n===void 0)throw Error(ae(407));n=n()}else{if(n=e(),Pn===null)throw Error(ae(349));ll&30||hA(s,e,n)}r.memoizedState=n;var o={value:n,getSnapshot:e};return r.queue=o,u2(pA.bind(null,s,o,t),[t]),s.flags|=2048,oh(9,fA.bind(null,s,o,n,e),void 0,null),n},useId:function(){var t=po(),e=Pn.identifierPrefix;if(Bt){var n=Jo,s=Zo;n=(s&~(1<<32-Zr(s)-1)).toString(32)+n,e=":"+e+"R"+n,n=sh++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=yW++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},CW={readContext:Rr,useCallback:kA,useContext:Rr,useEffect:gk,useImperativeHandle:wA,useInsertionEffect:yA,useLayoutEffect:bA,useMemo:CA,useReducer:Db,useRef:xA,useState:function(){return Db(rh)},useDebugValue:xk,useDeferredValue:function(t){var e=Ar();return SA(e,Tn.memoizedState,t)},useTransition:function(){var t=Db(rh)[0],e=Ar().memoizedState;return[t,e]},useMutableSource:uA,useSyncExternalStore:dA,useId:$A,unstable_isNewReconciler:!1},SW={readContext:Rr,useCallback:kA,useContext:Rr,useEffect:gk,useImperativeHandle:wA,useInsertionEffect:yA,useLayoutEffect:bA,useMemo:CA,useReducer:Fb,useRef:xA,useState:function(){return Fb(rh)},useDebugValue:xk,useDeferredValue:function(t){var e=Ar();return Tn===null?e.memoizedState=t:SA(e,Tn.memoizedState,t)},useTransition:function(){var t=Fb(rh)[0],e=Ar().memoizedState;return[t,e]},useMutableSource:uA,useSyncExternalStore:dA,useId:$A,unstable_isNewReconciler:!1};function Hr(t,e){if(t&&t.defaultProps){e=Xt({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function tv(t,e,n,s){e=t.memoizedState,n=n(s,e),n=n==null?e:Xt({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var S0={isMounted:function(t){return(t=t._reactInternals)?Al(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var s=vs(),r=Ki(t),o=ni(s,r);o.payload=e,n!=null&&(o.callback=n),e=Gi(t,o,r),e!==null&&(Jr(e,t,r,s),$m(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var s=vs(),r=Ki(t),o=ni(s,r);o.tag=1,o.payload=e,n!=null&&(o.callback=n),e=Gi(t,o,r),e!==null&&(Jr(e,t,r,s),$m(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=vs(),s=Ki(t),r=ni(n,s);r.tag=2,e!=null&&(r.callback=e),e=Gi(t,r,s),e!==null&&(Jr(e,t,s,n),$m(e,t,s))}};function d2(t,e,n,s,r,o,i){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(s,o,i):e.prototype&&e.prototype.isPureReactComponent?!Qd(n,s)||!Qd(r,o):!0}function NA(t,e,n){var s=!1,r=na,o=e.contextType;return typeof o=="object"&&o!==null?o=Rr(o):(r=Ls(e)?il:us.current,s=e.contextTypes,o=(s=s!=null)?zc(t,r):na),e=new e(n,o),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=S0,t.stateNode=e,e._reactInternals=t,s&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=o),e}function h2(t,e,n,s){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,s),e.state!==t&&S0.enqueueReplaceState(e,e.state,null)}function nv(t,e,n,s){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},ck(t);var o=e.contextType;typeof o=="object"&&o!==null?r.context=Rr(o):(o=Ls(e)?il:us.current,r.context=zc(t,o)),r.state=t.memoizedState,o=e.getDerivedStateFromProps,typeof o=="function"&&(tv(t,e,o,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&S0.enqueueReplaceState(r,r.state,null),ag(t,n,r,s),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function Uc(t,e){try{var n="",s=e;do n+=Z4(s),s=s.return;while(s);var r=n}catch(o){r=`
Error generating stack: `+o.message+`
`+o.stack}return{value:t,source:e,stack:r,digest:null}}function Ob(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function sv(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var $W=typeof WeakMap=="function"?WeakMap:Map;function _A(t,e,n){n=ni(-1,n),n.tag=3,n.payload={element:null};var s=e.value;return n.callback=function(){hg||(hg=!0,fv=s),sv(t,e)},n}function RA(t,e,n){n=ni(-1,n),n.tag=3;var s=t.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;n.payload=function(){return s(r)},n.callback=function(){sv(t,e)}}var o=t.stateNode;return o!==null&&typeof o.componentDidCatch=="function"&&(n.callback=function(){sv(t,e),typeof s!="function"&&(ji===null?ji=new Set([this]):ji.add(this));var i=e.stack;this.componentDidCatch(e.value,{componentStack:i!==null?i:""})}),n}function f2(t,e,n){var s=t.pingCache;if(s===null){s=t.pingCache=new $W;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(n)||(r.add(n),t=zW.bind(null,t,e,n),e.then(t,t))}function p2(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function m2(t,e,n,s,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ni(-1,1),e.tag=2,Gi(n,e,1))),n.lanes|=1),t)}var IW=gi.ReactCurrentOwner,Ds=!1;function gs(t,e,n,s){e.child=t===null?iA(e,null,n,s):Vc(e,t.child,n,s)}function g2(t,e,n,s,r){n=n.render;var o=e.ref;return Ic(e,r),s=pk(t,e,n,s,o,r),n=mk(),t!==null&&!Ds?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ai(t,e,r)):(Bt&&n&&nk(e),e.flags|=1,gs(t,e,s,r),e.child)}function x2(t,e,n,s,r){if(t===null){var o=n.type;return typeof o=="function"&&!$k(o)&&o.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=o,AA(t,e,o,s,r)):(t=Rm(n.type,null,s,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(o=t.child,!(t.lanes&r)){var i=o.memoizedProps;if(n=n.compare,n=n!==null?n:Qd,n(i,s)&&t.ref===e.ref)return ai(t,e,r)}return e.flags|=1,t=Xi(o,s),t.ref=e.ref,t.return=e,e.child=t}function AA(t,e,n,s,r){if(t!==null){var o=t.memoizedProps;if(Qd(o,s)&&t.ref===e.ref)if(Ds=!1,e.pendingProps=s=o,(t.lanes&r)!==0)t.flags&131072&&(Ds=!0);else return e.lanes=t.lanes,ai(t,e,r)}return rv(t,e,n,s,r)}function DA(t,e,n){var s=e.pendingProps,r=s.children,o=t!==null?t.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Et(vc,js),js|=n;else{if(!(n&1073741824))return t=o!==null?o.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Et(vc,js),js|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=o!==null?o.baseLanes:n,Et(vc,js),js|=s}else o!==null?(s=o.baseLanes|n,e.memoizedState=null):s=n,Et(vc,js),js|=s;return gs(t,e,r,n),e.child}function FA(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function rv(t,e,n,s,r){var o=Ls(n)?il:us.current;return o=zc(e,o),Ic(e,r),n=pk(t,e,n,s,o,r),s=mk(),t!==null&&!Ds?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,ai(t,e,r)):(Bt&&s&&nk(e),e.flags|=1,gs(t,e,n,r),e.child)}function y2(t,e,n,s,r){if(Ls(n)){var o=!0;ng(e)}else o=!1;if(Ic(e,r),e.stateNode===null)Em(t,e),NA(e,n,s),nv(e,n,s,r),s=!0;else if(t===null){var i=e.stateNode,a=e.memoizedProps;i.props=a;var l=i.context,c=n.contextType;typeof c=="object"&&c!==null?c=Rr(c):(c=Ls(n)?il:us.current,c=zc(e,c));var u=n.getDerivedStateFromProps,d=typeof u=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==s||l!==c)&&h2(e,i,s,c),Ii=!1;var h=e.memoizedState;i.state=h,ag(e,s,i,r),l=e.memoizedState,a!==s||h!==l||Ms.current||Ii?(typeof u=="function"&&(tv(e,n,u,s),l=e.memoizedState),(a=Ii||d2(e,n,a,s,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(e.flags|=4194308)):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=l),i.props=s,i.state=l,i.context=c,s=a):(typeof i.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{i=e.stateNode,lA(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Hr(e.type,a),i.props=c,d=e.pendingProps,h=i.context,l=n.contextType,typeof l=="object"&&l!==null?l=Rr(l):(l=Ls(n)?il:us.current,l=zc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(a!==d||h!==l)&&h2(e,i,s,l),Ii=!1,h=e.memoizedState,i.state=h,ag(e,s,i,r);var p=e.memoizedState;a!==d||h!==p||Ms.current||Ii?(typeof f=="function"&&(tv(e,n,f,s),p=e.memoizedState),(c=Ii||d2(e,n,c,s,h,p,l)||!1)?(u||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(s,p,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(s,p,l)),typeof i.componentDidUpdate=="function"&&(e.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=p),i.props=s,i.state=p,i.context=l,s=c):(typeof i.componentDidUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&h===t.memoizedState||(e.flags|=1024),s=!1)}return ov(t,e,n,s,o,r)}function ov(t,e,n,s,r,o){FA(t,e);var i=(e.flags&128)!==0;if(!s&&!i)return r&&s2(e,n,!1),ai(t,e,o);s=e.stateNode,IW.current=e;var a=i&&typeof n.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,t!==null&&i?(e.child=Vc(e,t.child,null,o),e.child=Vc(e,null,a,o)):gs(t,e,a,o),e.memoizedState=s.state,r&&s2(e,n,!0),e.child}function OA(t){var e=t.stateNode;e.pendingContext?n2(t,e.pendingContext,e.pendingContext!==e.context):e.context&&n2(t,e.context,!1),uk(t,e.containerInfo)}function b2(t,e,n,s,r){return Bc(),rk(r),e.flags|=256,gs(t,e,n,s),e.child}var iv={dehydrated:null,treeContext:null,retryLane:0};function av(t){return{baseLanes:t,cachePool:null,transitions:null}}function PA(t,e,n){var s=e.pendingProps,r=Gt.current,o=!1,i=(e.flags&128)!==0,a;if((a=i)||(a=t!==null&&t.memoizedState===null?!1:(r&2)!==0),a?(o=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Et(Gt,r&1),t===null)return J1(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(i=s.children,t=s.fallback,o?(s=e.mode,o=e.child,i={mode:"hidden",children:i},!(s&1)&&o!==null?(o.childLanes=0,o.pendingProps=i):o=T0(i,s,0,null),t=Ja(t,s,n,null),o.return=e,t.return=e,o.sibling=t,e.child=o,e.child.memoizedState=av(n),e.memoizedState=iv,t):yk(e,i));if(r=t.memoizedState,r!==null&&(a=r.dehydrated,a!==null))return TW(t,e,i,s,a,r,n);if(o){o=s.fallback,i=e.mode,r=t.child,a=r.sibling;var l={mode:"hidden",children:s.children};return!(i&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=l,e.deletions=null):(s=Xi(r,l),s.subtreeFlags=r.subtreeFlags&14680064),a!==null?o=Xi(a,o):(o=Ja(o,i,n,null),o.flags|=2),o.return=e,s.return=e,s.sibling=o,e.child=s,s=o,o=e.child,i=t.child.memoizedState,i=i===null?av(n):{baseLanes:i.baseLanes|n,cachePool:null,transitions:i.transitions},o.memoizedState=i,o.childLanes=t.childLanes&~n,e.memoizedState=iv,s}return o=t.child,t=o.sibling,s=Xi(o,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=n),s.return=e,s.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=s,e.memoizedState=null,s}function yk(t,e){return e=T0({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function Ip(t,e,n,s){return s!==null&&rk(s),Vc(e,t.child,null,n),t=yk(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function TW(t,e,n,s,r,o,i){if(n)return e.flags&256?(e.flags&=-257,s=Ob(Error(ae(422))),Ip(t,e,i,s)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(o=s.fallback,r=e.mode,s=T0({mode:"visible",children:s.children},r,0,null),o=Ja(o,r,i,null),o.flags|=2,s.return=e,o.return=e,s.sibling=o,e.child=s,e.mode&1&&Vc(e,t.child,null,i),e.child.memoizedState=av(i),e.memoizedState=iv,o);if(!(e.mode&1))return Ip(t,e,i,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var a=s.dgst;return s=a,o=Error(ae(419)),s=Ob(o,s,void 0),Ip(t,e,i,s)}if(a=(i&t.childLanes)!==0,Ds||a){if(s=Pn,s!==null){switch(i&-i){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|i)?0:r,r!==0&&r!==o.retryLane&&(o.retryLane=r,ii(t,r),Jr(s,t,r,-1))}return Sk(),s=Ob(Error(ae(421))),Ip(t,e,i,s)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=BW.bind(null,t),r._reactRetry=e,null):(t=o.treeContext,qs=Hi(r.nextSibling),Zs=e,Bt=!0,Kr=null,t!==null&&(gr[xr++]=Zo,gr[xr++]=Jo,gr[xr++]=al,Zo=t.id,Jo=t.overflow,al=e),e=yk(e,s.children),e.flags|=4096,e)}function v2(t,e,n){t.lanes|=e;var s=t.alternate;s!==null&&(s.lanes|=e),ev(t.return,e,n)}function Pb(t,e,n,s,r){var o=t.memoizedState;o===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:n,tailMode:r}:(o.isBackwards=e,o.rendering=null,o.renderingStartTime=0,o.last=s,o.tail=n,o.tailMode=r)}function MA(t,e,n){var s=e.pendingProps,r=s.revealOrder,o=s.tail;if(gs(t,e,s.children,n),s=Gt.current,s&2)s=s&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&v2(t,n,e);else if(t.tag===19)v2(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}s&=1}if(Et(Gt,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&lg(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),Pb(e,!1,r,n,o);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&lg(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}Pb(e,!0,n,null,o);break;case"together":Pb(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Em(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ai(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),cl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ae(153));if(e.child!==null){for(t=e.child,n=Xi(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Xi(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function EW(t,e,n){switch(e.tag){case 3:OA(e),Bc();break;case 5:cA(e);break;case 1:Ls(e.type)&&ng(e);break;case 4:uk(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;Et(og,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Et(Gt,Gt.current&1),e.flags|=128,null):n&e.child.childLanes?PA(t,e,n):(Et(Gt,Gt.current&1),t=ai(t,e,n),t!==null?t.sibling:null);Et(Gt,Gt.current&1);break;case 19:if(s=(n&e.childLanes)!==0,t.flags&128){if(s)return MA(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Et(Gt,Gt.current),s)break;return null;case 22:case 23:return e.lanes=0,DA(t,e,n)}return ai(t,e,n)}var LA,lv,zA,BA;LA=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};lv=function(){};zA=function(t,e,n,s){var r=t.memoizedProps;if(r!==s){t=e.stateNode,Ga(To.current);var o=null;switch(n){case"input":r=_1(t,r),s=_1(t,s),o=[];break;case"select":r=Xt({},r,{value:void 0}),s=Xt({},s,{value:void 0}),o=[];break;case"textarea":r=D1(t,r),s=D1(t,s),o=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(t.onclick=eg)}O1(n,s);var i;n=null;for(c in r)if(!s.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var a=r[c];for(i in a)a.hasOwnProperty(i)&&(n||(n={}),n[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Hd.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in s){var l=s[c];if(a=r!=null?r[c]:void 0,s.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(i in a)!a.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(n||(n={}),n[i]="");for(i in l)l.hasOwnProperty(i)&&a[i]!==l[i]&&(n||(n={}),n[i]=l[i])}else n||(o||(o=[]),o.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(o=o||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(o=o||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Hd.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Dt("scroll",t),o||a===l||(o=[])):(o=o||[]).push(c,l))}n&&(o=o||[]).push("style",n);var c=o;(e.updateQueue=c)&&(e.flags|=4)}};BA=function(t,e,n,s){n!==s&&(e.flags|=4)};function Wu(t,e){if(!Bt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var s=null;n!==null;)n.alternate!==null&&(s=n),n=n.sibling;s===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:s.sibling=null}}function ts(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,s=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=s,t.childLanes=n,e}function NW(t,e,n){var s=e.pendingProps;switch(sk(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ts(e),null;case 1:return Ls(e.type)&&tg(),ts(e),null;case 3:return s=e.stateNode,Wc(),Ft(Ms),Ft(us),hk(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(t===null||t.child===null)&&(Sp(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Kr!==null&&(gv(Kr),Kr=null))),lv(t,e),ts(e),null;case 5:dk(e);var r=Ga(nh.current);if(n=e.type,t!==null&&e.stateNode!=null)zA(t,e,n,s,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ae(166));return ts(e),null}if(t=Ga(To.current),Sp(e)){s=e.stateNode,n=e.type;var o=e.memoizedProps;switch(s[Co]=e,s[eh]=o,t=(e.mode&1)!==0,n){case"dialog":Dt("cancel",s),Dt("close",s);break;case"iframe":case"object":case"embed":Dt("load",s);break;case"video":case"audio":for(r=0;r<ld.length;r++)Dt(ld[r],s);break;case"source":Dt("error",s);break;case"img":case"image":case"link":Dt("error",s),Dt("load",s);break;case"details":Dt("toggle",s);break;case"input":NI(s,o),Dt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!o.multiple},Dt("invalid",s);break;case"textarea":RI(s,o),Dt("invalid",s)}O1(n,o),r=null;for(var i in o)if(o.hasOwnProperty(i)){var a=o[i];i==="children"?typeof a=="string"?s.textContent!==a&&(o.suppressHydrationWarning!==!0&&Cp(s.textContent,a,t),r=["children",a]):typeof a=="number"&&s.textContent!==""+a&&(o.suppressHydrationWarning!==!0&&Cp(s.textContent,a,t),r=["children",""+a]):Hd.hasOwnProperty(i)&&a!=null&&i==="onScroll"&&Dt("scroll",s)}switch(n){case"input":mp(s),_I(s,o,!0);break;case"textarea":mp(s),AI(s);break;case"select":case"option":break;default:typeof o.onClick=="function"&&(s.onclick=eg)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{i=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=pR(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=i.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof s.is=="string"?t=i.createElement(n,{is:s.is}):(t=i.createElement(n),n==="select"&&(i=t,s.multiple?i.multiple=!0:s.size&&(i.size=s.size))):t=i.createElementNS(t,n),t[Co]=e,t[eh]=s,LA(t,e,!1,!1),e.stateNode=t;e:{switch(i=P1(n,s),n){case"dialog":Dt("cancel",t),Dt("close",t),r=s;break;case"iframe":case"object":case"embed":Dt("load",t),r=s;break;case"video":case"audio":for(r=0;r<ld.length;r++)Dt(ld[r],t);r=s;break;case"source":Dt("error",t),r=s;break;case"img":case"image":case"link":Dt("error",t),Dt("load",t),r=s;break;case"details":Dt("toggle",t),r=s;break;case"input":NI(t,s),r=_1(t,s),Dt("invalid",t);break;case"option":r=s;break;case"select":t._wrapperState={wasMultiple:!!s.multiple},r=Xt({},s,{value:void 0}),Dt("invalid",t);break;case"textarea":RI(t,s),r=D1(t,s),Dt("invalid",t);break;default:r=s}O1(n,r),a=r;for(o in a)if(a.hasOwnProperty(o)){var l=a[o];o==="style"?xR(t,l):o==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&mR(t,l)):o==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Gd(t,l):typeof l=="number"&&Gd(t,""+l):o!=="suppressContentEditableWarning"&&o!=="suppressHydrationWarning"&&o!=="autoFocus"&&(Hd.hasOwnProperty(o)?l!=null&&o==="onScroll"&&Dt("scroll",t):l!=null&&Ww(t,o,l,i))}switch(n){case"input":mp(t),_I(t,s,!1);break;case"textarea":mp(t),AI(t);break;case"option":s.value!=null&&t.setAttribute("value",""+ta(s.value));break;case"select":t.multiple=!!s.multiple,o=s.value,o!=null?kc(t,!!s.multiple,o,!1):s.defaultValue!=null&&kc(t,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=eg)}switch(n){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return ts(e),null;case 6:if(t&&e.stateNode!=null)BA(t,e,t.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ae(166));if(n=Ga(nh.current),Ga(To.current),Sp(e)){if(s=e.stateNode,n=e.memoizedProps,s[Co]=e,(o=s.nodeValue!==n)&&(t=Zs,t!==null))switch(t.tag){case 3:Cp(s.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&Cp(s.nodeValue,n,(t.mode&1)!==0)}o&&(e.flags|=4)}else s=(n.nodeType===9?n:n.ownerDocument).createTextNode(s),s[Co]=e,e.stateNode=s}return ts(e),null;case 13:if(Ft(Gt),s=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Bt&&qs!==null&&e.mode&1&&!(e.flags&128))rA(),Bc(),e.flags|=98560,o=!1;else if(o=Sp(e),s!==null&&s.dehydrated!==null){if(t===null){if(!o)throw Error(ae(318));if(o=e.memoizedState,o=o!==null?o.dehydrated:null,!o)throw Error(ae(317));o[Co]=e}else Bc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;ts(e),o=!1}else Kr!==null&&(gv(Kr),Kr=null),o=!0;if(!o)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(s=s!==null,s!==(t!==null&&t.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(t===null||Gt.current&1?Nn===0&&(Nn=3):Sk())),e.updateQueue!==null&&(e.flags|=4),ts(e),null);case 4:return Wc(),lv(t,e),t===null&&Zd(e.stateNode.containerInfo),ts(e),null;case 10:return ak(e.type._context),ts(e),null;case 17:return Ls(e.type)&&tg(),ts(e),null;case 19:if(Ft(Gt),o=e.memoizedState,o===null)return ts(e),null;if(s=(e.flags&128)!==0,i=o.rendering,i===null)if(s)Wu(o,!1);else{if(Nn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(i=lg(t),i!==null){for(e.flags|=128,Wu(o,!1),s=i.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=n,n=e.child;n!==null;)o=n,t=s,o.flags&=14680066,i=o.alternate,i===null?(o.childLanes=0,o.lanes=t,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=i.childLanes,o.lanes=i.lanes,o.child=i.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=i.memoizedProps,o.memoizedState=i.memoizedState,o.updateQueue=i.updateQueue,o.type=i.type,t=i.dependencies,o.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Et(Gt,Gt.current&1|2),e.child}t=t.sibling}o.tail!==null&&un()>Hc&&(e.flags|=128,s=!0,Wu(o,!1),e.lanes=4194304)}else{if(!s)if(t=lg(i),t!==null){if(e.flags|=128,s=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Wu(o,!0),o.tail===null&&o.tailMode==="hidden"&&!i.alternate&&!Bt)return ts(e),null}else 2*un()-o.renderingStartTime>Hc&&n!==1073741824&&(e.flags|=128,s=!0,Wu(o,!1),e.lanes=4194304);o.isBackwards?(i.sibling=e.child,e.child=i):(n=o.last,n!==null?n.sibling=i:e.child=i,o.last=i)}return o.tail!==null?(e=o.tail,o.rendering=e,o.tail=e.sibling,o.renderingStartTime=un(),e.sibling=null,n=Gt.current,Et(Gt,s?n&1|2:n&1),e):(ts(e),null);case 22:case 23:return Ck(),s=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?js&1073741824&&(ts(e),e.subtreeFlags&6&&(e.flags|=8192)):ts(e),null;case 24:return null;case 25:return null}throw Error(ae(156,e.tag))}function _W(t,e){switch(sk(e),e.tag){case 1:return Ls(e.type)&&tg(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Wc(),Ft(Ms),Ft(us),hk(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return dk(e),null;case 13:if(Ft(Gt),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ae(340));Bc()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ft(Gt),null;case 4:return Wc(),null;case 10:return ak(e.type._context),null;case 22:case 23:return Ck(),null;case 24:return null;default:return null}}var Tp=!1,is=!1,RW=typeof WeakSet=="function"?WeakSet:Set,ke=null;function bc(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(s){Zt(t,e,s)}else n.current=null}function cv(t,e,n){try{n()}catch(s){Zt(t,e,s)}}var w2=!1;function AW(t,e){if(j1=Qm,t=GR(),tk(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var s=n.getSelection&&n.getSelection();if(s&&s.rangeCount!==0){n=s.anchorNode;var r=s.anchorOffset,o=s.focusNode;s=s.focusOffset;try{n.nodeType,o.nodeType}catch{n=null;break e}var i=0,a=-1,l=-1,c=0,u=0,d=t,h=null;t:for(;;){for(var f;d!==n||r!==0&&d.nodeType!==3||(a=i+r),d!==o||s!==0&&d.nodeType!==3||(l=i+s),d.nodeType===3&&(i+=d.nodeValue.length),(f=d.firstChild)!==null;)h=d,d=f;for(;;){if(d===t)break t;if(h===n&&++c===r&&(a=i),h===o&&++u===s&&(l=i),(f=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(K1={focusedElem:t,selectionRange:n},Qm=!1,ke=e;ke!==null;)if(e=ke,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,ke=t;else for(;ke!==null;){e=ke;try{var p=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(p!==null){var m=p.memoizedProps,x=p.memoizedState,g=e.stateNode,y=g.getSnapshotBeforeUpdate(e.elementType===e.type?m:Hr(e.type,m),x);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var b=e.stateNode.containerInfo;b.nodeType===1?b.textContent="":b.nodeType===9&&b.documentElement&&b.removeChild(b.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ae(163))}}catch(v){Zt(e,e.return,v)}if(t=e.sibling,t!==null){t.return=e.return,ke=t;break}ke=e.return}return p=w2,w2=!1,p}function _d(t,e,n){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&t)===t){var o=r.destroy;r.destroy=void 0,o!==void 0&&cv(e,n,o)}r=r.next}while(r!==s)}}function $0(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var s=n.create;n.destroy=s()}n=n.next}while(n!==e)}}function uv(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function VA(t){var e=t.alternate;e!==null&&(t.alternate=null,VA(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[Co],delete e[eh],delete e[Y1],delete e[pW],delete e[mW])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function WA(t){return t.tag===5||t.tag===3||t.tag===4}function k2(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||WA(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function dv(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=eg));else if(s!==4&&(t=t.child,t!==null))for(dv(t,e,n),t=t.sibling;t!==null;)dv(t,e,n),t=t.sibling}function hv(t,e,n){var s=t.tag;if(s===5||s===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(s!==4&&(t=t.child,t!==null))for(hv(t,e,n),t=t.sibling;t!==null;)hv(t,e,n),t=t.sibling}var Un=null,Gr=!1;function ki(t,e,n){for(n=n.child;n!==null;)UA(t,e,n),n=n.sibling}function UA(t,e,n){if(Io&&typeof Io.onCommitFiberUnmount=="function")try{Io.onCommitFiberUnmount(x0,n)}catch{}switch(n.tag){case 5:is||bc(n,e);case 6:var s=Un,r=Gr;Un=null,ki(t,e,n),Un=s,Gr=r,Un!==null&&(Gr?(t=Un,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):Un.removeChild(n.stateNode));break;case 18:Un!==null&&(Gr?(t=Un,n=n.stateNode,t.nodeType===8?Nb(t.parentNode,n):t.nodeType===1&&Nb(t,n),qd(t)):Nb(Un,n.stateNode));break;case 4:s=Un,r=Gr,Un=n.stateNode.containerInfo,Gr=!0,ki(t,e,n),Un=s,Gr=r;break;case 0:case 11:case 14:case 15:if(!is&&(s=n.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var o=r,i=o.destroy;o=o.tag,i!==void 0&&(o&2||o&4)&&cv(n,e,i),r=r.next}while(r!==s)}ki(t,e,n);break;case 1:if(!is&&(bc(n,e),s=n.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=n.memoizedProps,s.state=n.memoizedState,s.componentWillUnmount()}catch(a){Zt(n,e,a)}ki(t,e,n);break;case 21:ki(t,e,n);break;case 22:n.mode&1?(is=(s=is)||n.memoizedState!==null,ki(t,e,n),is=s):ki(t,e,n);break;default:ki(t,e,n)}}function C2(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new RW),e.forEach(function(s){var r=VW.bind(null,t,s);n.has(s)||(n.add(s),s.then(r,r))})}}function Vr(t,e){var n=e.deletions;if(n!==null)for(var s=0;s<n.length;s++){var r=n[s];try{var o=t,i=e,a=i;e:for(;a!==null;){switch(a.tag){case 5:Un=a.stateNode,Gr=!1;break e;case 3:Un=a.stateNode.containerInfo,Gr=!0;break e;case 4:Un=a.stateNode.containerInfo,Gr=!0;break e}a=a.return}if(Un===null)throw Error(ae(160));UA(o,i,r),Un=null,Gr=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){Zt(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)HA(e,t),e=e.sibling}function HA(t,e){var n=t.alternate,s=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Vr(e,t),ho(t),s&4){try{_d(3,t,t.return),$0(3,t)}catch(m){Zt(t,t.return,m)}try{_d(5,t,t.return)}catch(m){Zt(t,t.return,m)}}break;case 1:Vr(e,t),ho(t),s&512&&n!==null&&bc(n,n.return);break;case 5:if(Vr(e,t),ho(t),s&512&&n!==null&&bc(n,n.return),t.flags&32){var r=t.stateNode;try{Gd(r,"")}catch(m){Zt(t,t.return,m)}}if(s&4&&(r=t.stateNode,r!=null)){var o=t.memoizedProps,i=n!==null?n.memoizedProps:o,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&o.type==="radio"&&o.name!=null&&hR(r,o),P1(a,i);var c=P1(a,o);for(i=0;i<l.length;i+=2){var u=l[i],d=l[i+1];u==="style"?xR(r,d):u==="dangerouslySetInnerHTML"?mR(r,d):u==="children"?Gd(r,d):Ww(r,u,d,c)}switch(a){case"input":R1(r,o);break;case"textarea":fR(r,o);break;case"select":var h=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!o.multiple;var f=o.value;f!=null?kc(r,!!o.multiple,f,!1):h!==!!o.multiple&&(o.defaultValue!=null?kc(r,!!o.multiple,o.defaultValue,!0):kc(r,!!o.multiple,o.multiple?[]:"",!1))}r[eh]=o}catch(m){Zt(t,t.return,m)}}break;case 6:if(Vr(e,t),ho(t),s&4){if(t.stateNode===null)throw Error(ae(162));r=t.stateNode,o=t.memoizedProps;try{r.nodeValue=o}catch(m){Zt(t,t.return,m)}}break;case 3:if(Vr(e,t),ho(t),s&4&&n!==null&&n.memoizedState.isDehydrated)try{qd(e.containerInfo)}catch(m){Zt(t,t.return,m)}break;case 4:Vr(e,t),ho(t);break;case 13:Vr(e,t),ho(t),r=t.child,r.flags&8192&&(o=r.memoizedState!==null,r.stateNode.isHidden=o,!o||r.alternate!==null&&r.alternate.memoizedState!==null||(wk=un())),s&4&&C2(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?(is=(c=is)||u,Vr(e,t),is=c):Vr(e,t),ho(t),s&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(ke=t,u=t.child;u!==null;){for(d=ke=u;ke!==null;){switch(h=ke,f=h.child,h.tag){case 0:case 11:case 14:case 15:_d(4,h,h.return);break;case 1:bc(h,h.return);var p=h.stateNode;if(typeof p.componentWillUnmount=="function"){s=h,n=h.return;try{e=s,p.props=e.memoizedProps,p.state=e.memoizedState,p.componentWillUnmount()}catch(m){Zt(s,n,m)}}break;case 5:bc(h,h.return);break;case 22:if(h.memoizedState!==null){$2(d);continue}}f!==null?(f.return=h,ke=f):$2(d)}u=u.sibling}e:for(u=null,d=t;;){if(d.tag===5){if(u===null){u=d;try{r=d.stateNode,c?(o=r.style,typeof o.setProperty=="function"?o.setProperty("display","none","important"):o.display="none"):(a=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=gR("display",i))}catch(m){Zt(t,t.return,m)}}}else if(d.tag===6){if(u===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){Zt(t,t.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===t)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===t)break e;for(;d.sibling===null;){if(d.return===null||d.return===t)break e;u===d&&(u=null),d=d.return}u===d&&(u=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Vr(e,t),ho(t),s&4&&C2(t);break;case 21:break;default:Vr(e,t),ho(t)}}function ho(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(WA(n)){var s=n;break e}n=n.return}throw Error(ae(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Gd(r,""),s.flags&=-33);var o=k2(t);hv(t,o,r);break;case 3:case 4:var i=s.stateNode.containerInfo,a=k2(t);dv(t,a,i);break;default:throw Error(ae(161))}}catch(l){Zt(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function DW(t,e,n){ke=t,GA(t)}function GA(t,e,n){for(var s=(t.mode&1)!==0;ke!==null;){var r=ke,o=r.child;if(r.tag===22&&s){var i=r.memoizedState!==null||Tp;if(!i){var a=r.alternate,l=a!==null&&a.memoizedState!==null||is;a=Tp;var c=is;if(Tp=i,(is=l)&&!c)for(ke=r;ke!==null;)i=ke,l=i.child,i.tag===22&&i.memoizedState!==null?I2(r):l!==null?(l.return=i,ke=l):I2(r);for(;o!==null;)ke=o,GA(o),o=o.sibling;ke=r,Tp=a,is=c}S2(t)}else r.subtreeFlags&8772&&o!==null?(o.return=r,ke=o):S2(t)}}function S2(t){for(;ke!==null;){var e=ke;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:is||$0(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!is)if(n===null)s.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:Hr(e.type,n.memoizedProps);s.componentDidUpdate(r,n.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var o=e.updateQueue;o!==null&&l2(e,o,s);break;case 3:var i=e.updateQueue;if(i!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}l2(e,i,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var d=u.dehydrated;d!==null&&qd(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ae(163))}is||e.flags&512&&uv(e)}catch(h){Zt(e,e.return,h)}}if(e===t){ke=null;break}if(n=e.sibling,n!==null){n.return=e.return,ke=n;break}ke=e.return}}function $2(t){for(;ke!==null;){var e=ke;if(e===t){ke=null;break}var n=e.sibling;if(n!==null){n.return=e.return,ke=n;break}ke=e.return}}function I2(t){for(;ke!==null;){var e=ke;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{$0(4,e)}catch(l){Zt(e,n,l)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(l){Zt(e,r,l)}}var o=e.return;try{uv(e)}catch(l){Zt(e,o,l)}break;case 5:var i=e.return;try{uv(e)}catch(l){Zt(e,i,l)}}}catch(l){Zt(e,e.return,l)}if(e===t){ke=null;break}var a=e.sibling;if(a!==null){a.return=e.return,ke=a;break}ke=e.return}}var FW=Math.ceil,dg=gi.ReactCurrentDispatcher,bk=gi.ReactCurrentOwner,Nr=gi.ReactCurrentBatchConfig,ot=0,Pn=null,bn=null,Gn=0,js=0,vc=ha(0),Nn=0,ih=null,cl=0,I0=0,vk=0,Rd=null,_s=null,wk=0,Hc=1/0,Ko=null,hg=!1,fv=null,ji=null,Ep=!1,Di=null,fg=0,Ad=0,pv=null,Nm=-1,_m=0;function vs(){return ot&6?un():Nm!==-1?Nm:Nm=un()}function Ki(t){return t.mode&1?ot&2&&Gn!==0?Gn&-Gn:xW.transition!==null?(_m===0&&(_m=NR()),_m):(t=xt,t!==0||(t=window.event,t=t===void 0?16:PR(t.type)),t):1}function Jr(t,e,n,s){if(50<Ad)throw Ad=0,pv=null,Error(ae(185));Ah(t,n,s),(!(ot&2)||t!==Pn)&&(t===Pn&&(!(ot&2)&&(I0|=n),Nn===4&&_i(t,Gn)),zs(t,s),n===1&&ot===0&&!(e.mode&1)&&(Hc=un()+500,k0&&fa()))}function zs(t,e){var n=t.callbackNode;xV(t,e);var s=Ym(t,t===Pn?Gn:0);if(s===0)n!==null&&OI(n),t.callbackNode=null,t.callbackPriority=0;else if(e=s&-s,t.callbackPriority!==e){if(n!=null&&OI(n),e===1)t.tag===0?gW(T2.bind(null,t)):tA(T2.bind(null,t)),hW(function(){!(ot&6)&&fa()}),n=null;else{switch(_R(s)){case 1:n=Kw;break;case 4:n=TR;break;case 16:n=qm;break;case 536870912:n=ER;break;default:n=qm}n=JA(n,jA.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function jA(t,e){if(Nm=-1,_m=0,ot&6)throw Error(ae(327));var n=t.callbackNode;if(Tc()&&t.callbackNode!==n)return null;var s=Ym(t,t===Pn?Gn:0);if(s===0)return null;if(s&30||s&t.expiredLanes||e)e=pg(t,s);else{e=s;var r=ot;ot|=2;var o=XA();(Pn!==t||Gn!==e)&&(Ko=null,Hc=un()+500,Za(t,e));do try{MW();break}catch(a){KA(t,a)}while(1);ik(),dg.current=o,ot=r,bn!==null?e=0:(Pn=null,Gn=0,e=Nn)}if(e!==0){if(e===2&&(r=V1(t),r!==0&&(s=r,e=mv(t,r))),e===1)throw n=ih,Za(t,0),_i(t,s),zs(t,un()),n;if(e===6)_i(t,s);else{if(r=t.current.alternate,!(s&30)&&!OW(r)&&(e=pg(t,s),e===2&&(o=V1(t),o!==0&&(s=o,e=mv(t,o))),e===1))throw n=ih,Za(t,0),_i(t,s),zs(t,un()),n;switch(t.finishedWork=r,t.finishedLanes=s,e){case 0:case 1:throw Error(ae(345));case 2:Da(t,_s,Ko);break;case 3:if(_i(t,s),(s&130023424)===s&&(e=wk+500-un(),10<e)){if(Ym(t,0)!==0)break;if(r=t.suspendedLanes,(r&s)!==s){vs(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=q1(Da.bind(null,t,_s,Ko),e);break}Da(t,_s,Ko);break;case 4:if(_i(t,s),(s&4194240)===s)break;for(e=t.eventTimes,r=-1;0<s;){var i=31-Zr(s);o=1<<i,i=e[i],i>r&&(r=i),s&=~o}if(s=r,s=un()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*FW(s/1960))-s,10<s){t.timeoutHandle=q1(Da.bind(null,t,_s,Ko),s);break}Da(t,_s,Ko);break;case 5:Da(t,_s,Ko);break;default:throw Error(ae(329))}}}return zs(t,un()),t.callbackNode===n?jA.bind(null,t):null}function mv(t,e){var n=Rd;return t.current.memoizedState.isDehydrated&&(Za(t,e).flags|=256),t=pg(t,e),t!==2&&(e=_s,_s=n,e!==null&&gv(e)),t}function gv(t){_s===null?_s=t:_s.push.apply(_s,t)}function OW(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var s=0;s<n.length;s++){var r=n[s],o=r.getSnapshot;r=r.value;try{if(!so(o(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function _i(t,e){for(e&=~vk,e&=~I0,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Zr(e),s=1<<n;t[n]=-1,e&=~s}}function T2(t){if(ot&6)throw Error(ae(327));Tc();var e=Ym(t,0);if(!(e&1))return zs(t,un()),null;var n=pg(t,e);if(t.tag!==0&&n===2){var s=V1(t);s!==0&&(e=s,n=mv(t,s))}if(n===1)throw n=ih,Za(t,0),_i(t,e),zs(t,un()),n;if(n===6)throw Error(ae(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Da(t,_s,Ko),zs(t,un()),null}function kk(t,e){var n=ot;ot|=1;try{return t(e)}finally{ot=n,ot===0&&(Hc=un()+500,k0&&fa())}}function ul(t){Di!==null&&Di.tag===0&&!(ot&6)&&Tc();var e=ot;ot|=1;var n=Nr.transition,s=xt;try{if(Nr.transition=null,xt=1,t)return t()}finally{xt=s,Nr.transition=n,ot=e,!(ot&6)&&fa()}}function Ck(){js=vc.current,Ft(vc)}function Za(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,dW(n)),bn!==null)for(n=bn.return;n!==null;){var s=n;switch(sk(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&tg();break;case 3:Wc(),Ft(Ms),Ft(us),hk();break;case 5:dk(s);break;case 4:Wc();break;case 13:Ft(Gt);break;case 19:Ft(Gt);break;case 10:ak(s.type._context);break;case 22:case 23:Ck()}n=n.return}if(Pn=t,bn=t=Xi(t.current,null),Gn=js=e,Nn=0,ih=null,vk=I0=cl=0,_s=Rd=null,Ha!==null){for(e=0;e<Ha.length;e++)if(n=Ha[e],s=n.interleaved,s!==null){n.interleaved=null;var r=s.next,o=n.pending;if(o!==null){var i=o.next;o.next=r,s.next=i}n.pending=s}Ha=null}return t}function KA(t,e){do{var n=bn;try{if(ik(),Im.current=ug,cg){for(var s=Kt.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}cg=!1}if(ll=0,Dn=Tn=Kt=null,Nd=!1,sh=0,bk.current=null,n===null||n.return===null){Nn=1,ih=e,bn=null;break}e:{var o=t,i=n.return,a=n,l=e;if(e=Gn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,d=u.tag;if(!(u.mode&1)&&(d===0||d===11||d===15)){var h=u.alternate;h?(u.updateQueue=h.updateQueue,u.memoizedState=h.memoizedState,u.lanes=h.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=p2(i);if(f!==null){f.flags&=-257,m2(f,i,a,o,e),f.mode&1&&f2(o,c,e),e=f,l=c;var p=e.updateQueue;if(p===null){var m=new Set;m.add(l),e.updateQueue=m}else p.add(l);break e}else{if(!(e&1)){f2(o,c,e),Sk();break e}l=Error(ae(426))}}else if(Bt&&a.mode&1){var x=p2(i);if(x!==null){!(x.flags&65536)&&(x.flags|=256),m2(x,i,a,o,e),rk(Uc(l,a));break e}}o=l=Uc(l,a),Nn!==4&&(Nn=2),Rd===null?Rd=[o]:Rd.push(o),o=i;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var g=_A(o,l,e);a2(o,g);break e;case 1:a=l;var y=o.type,b=o.stateNode;if(!(o.flags&128)&&(typeof y.getDerivedStateFromError=="function"||b!==null&&typeof b.componentDidCatch=="function"&&(ji===null||!ji.has(b)))){o.flags|=65536,e&=-e,o.lanes|=e;var v=RA(o,a,e);a2(o,v);break e}}o=o.return}while(o!==null)}YA(n)}catch(w){e=w,bn===n&&n!==null&&(bn=n=n.return);continue}break}while(1)}function XA(){var t=dg.current;return dg.current=ug,t===null?ug:t}function Sk(){(Nn===0||Nn===3||Nn===2)&&(Nn=4),Pn===null||!(cl&268435455)&&!(I0&268435455)||_i(Pn,Gn)}function pg(t,e){var n=ot;ot|=2;var s=XA();(Pn!==t||Gn!==e)&&(Ko=null,Za(t,e));do try{PW();break}catch(r){KA(t,r)}while(1);if(ik(),ot=n,dg.current=s,bn!==null)throw Error(ae(261));return Pn=null,Gn=0,Nn}function PW(){for(;bn!==null;)qA(bn)}function MW(){for(;bn!==null&&!lV();)qA(bn)}function qA(t){var e=ZA(t.alternate,t,js);t.memoizedProps=t.pendingProps,e===null?YA(t):bn=e,bk.current=null}function YA(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=_W(n,e),n!==null){n.flags&=32767,bn=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{Nn=6,bn=null;return}}else if(n=NW(n,e,js),n!==null){bn=n;return}if(e=e.sibling,e!==null){bn=e;return}bn=e=t}while(e!==null);Nn===0&&(Nn=5)}function Da(t,e,n){var s=xt,r=Nr.transition;try{Nr.transition=null,xt=1,LW(t,e,n,s)}finally{Nr.transition=r,xt=s}return null}function LW(t,e,n,s){do Tc();while(Di!==null);if(ot&6)throw Error(ae(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ae(177));t.callbackNode=null,t.callbackPriority=0;var o=n.lanes|n.childLanes;if(yV(t,o),t===Pn&&(bn=Pn=null,Gn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||Ep||(Ep=!0,JA(qm,function(){return Tc(),null})),o=(n.flags&15990)!==0,n.subtreeFlags&15990||o){o=Nr.transition,Nr.transition=null;var i=xt;xt=1;var a=ot;ot|=4,bk.current=null,AW(t,n),HA(n,t),rW(K1),Qm=!!j1,K1=j1=null,t.current=n,DW(n),cV(),ot=a,xt=i,Nr.transition=o}else t.current=n;if(Ep&&(Ep=!1,Di=t,fg=r),o=t.pendingLanes,o===0&&(ji=null),hV(n.stateNode),zs(t,un()),e!==null)for(s=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],s(r.value,{componentStack:r.stack,digest:r.digest});if(hg)throw hg=!1,t=fv,fv=null,t;return fg&1&&t.tag!==0&&Tc(),o=t.pendingLanes,o&1?t===pv?Ad++:(Ad=0,pv=t):Ad=0,fa(),null}function Tc(){if(Di!==null){var t=_R(fg),e=Nr.transition,n=xt;try{if(Nr.transition=null,xt=16>t?16:t,Di===null)var s=!1;else{if(t=Di,Di=null,fg=0,ot&6)throw Error(ae(331));var r=ot;for(ot|=4,ke=t.current;ke!==null;){var o=ke,i=o.child;if(ke.flags&16){var a=o.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(ke=c;ke!==null;){var u=ke;switch(u.tag){case 0:case 11:case 15:_d(8,u,o)}var d=u.child;if(d!==null)d.return=u,ke=d;else for(;ke!==null;){u=ke;var h=u.sibling,f=u.return;if(VA(u),u===c){ke=null;break}if(h!==null){h.return=f,ke=h;break}ke=f}}}var p=o.alternate;if(p!==null){var m=p.child;if(m!==null){p.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}ke=o}}if(o.subtreeFlags&2064&&i!==null)i.return=o,ke=i;else e:for(;ke!==null;){if(o=ke,o.flags&2048)switch(o.tag){case 0:case 11:case 15:_d(9,o,o.return)}var g=o.sibling;if(g!==null){g.return=o.return,ke=g;break e}ke=o.return}}var y=t.current;for(ke=y;ke!==null;){i=ke;var b=i.child;if(i.subtreeFlags&2064&&b!==null)b.return=i,ke=b;else e:for(i=y;ke!==null;){if(a=ke,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:$0(9,a)}}catch(w){Zt(a,a.return,w)}if(a===i){ke=null;break e}var v=a.sibling;if(v!==null){v.return=a.return,ke=v;break e}ke=a.return}}if(ot=r,fa(),Io&&typeof Io.onPostCommitFiberRoot=="function")try{Io.onPostCommitFiberRoot(x0,t)}catch{}s=!0}return s}finally{xt=n,Nr.transition=e}}return!1}function E2(t,e,n){e=Uc(n,e),e=_A(t,e,1),t=Gi(t,e,1),e=vs(),t!==null&&(Ah(t,1,e),zs(t,e))}function Zt(t,e,n){if(t.tag===3)E2(t,t,n);else for(;e!==null;){if(e.tag===3){E2(e,t,n);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(ji===null||!ji.has(s))){t=Uc(n,t),t=RA(e,t,1),e=Gi(e,t,1),t=vs(),e!==null&&(Ah(e,1,t),zs(e,t));break}}e=e.return}}function zW(t,e,n){var s=t.pingCache;s!==null&&s.delete(e),e=vs(),t.pingedLanes|=t.suspendedLanes&n,Pn===t&&(Gn&n)===n&&(Nn===4||Nn===3&&(Gn&130023424)===Gn&&500>un()-wk?Za(t,0):vk|=n),zs(t,e)}function QA(t,e){e===0&&(t.mode&1?(e=yp,yp<<=1,!(yp&130023424)&&(yp=4194304)):e=1);var n=vs();t=ii(t,e),t!==null&&(Ah(t,e,n),zs(t,n))}function BW(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),QA(t,n)}function VW(t,e){var n=0;switch(t.tag){case 13:var s=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:s=t.stateNode;break;default:throw Error(ae(314))}s!==null&&s.delete(e),QA(t,n)}var ZA;ZA=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Ms.current)Ds=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Ds=!1,EW(t,e,n);Ds=!!(t.flags&131072)}else Ds=!1,Bt&&e.flags&1048576&&nA(e,rg,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;Em(t,e),t=e.pendingProps;var r=zc(e,us.current);Ic(e,n),r=pk(null,e,s,t,r,n);var o=mk();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Ls(s)?(o=!0,ng(e)):o=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,ck(e),r.updater=S0,e.stateNode=r,r._reactInternals=e,nv(e,s,t,n),e=ov(null,e,s,!0,o,n)):(e.tag=0,Bt&&o&&nk(e),gs(null,e,r,n),e=e.child),e;case 16:s=e.elementType;e:{switch(Em(t,e),t=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=UW(s),t=Hr(s,t),r){case 0:e=rv(null,e,s,t,n);break e;case 1:e=y2(null,e,s,t,n);break e;case 11:e=g2(null,e,s,t,n);break e;case 14:e=x2(null,e,s,Hr(s.type,t),n);break e}throw Error(ae(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Hr(s,r),rv(t,e,s,r,n);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Hr(s,r),y2(t,e,s,r,n);case 3:e:{if(OA(e),t===null)throw Error(ae(387));s=e.pendingProps,o=e.memoizedState,r=o.element,lA(t,e),ag(e,s,null,n);var i=e.memoizedState;if(s=i.element,o.isDehydrated)if(o={element:s,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},e.updateQueue.baseState=o,e.memoizedState=o,e.flags&256){r=Uc(Error(ae(423)),e),e=b2(t,e,s,n,r);break e}else if(s!==r){r=Uc(Error(ae(424)),e),e=b2(t,e,s,n,r);break e}else for(qs=Hi(e.stateNode.containerInfo.firstChild),Zs=e,Bt=!0,Kr=null,n=iA(e,null,s,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Bc(),s===r){e=ai(t,e,n);break e}gs(t,e,s,n)}e=e.child}return e;case 5:return cA(e),t===null&&J1(e),s=e.type,r=e.pendingProps,o=t!==null?t.memoizedProps:null,i=r.children,X1(s,r)?i=null:o!==null&&X1(s,o)&&(e.flags|=32),FA(t,e),gs(t,e,i,n),e.child;case 6:return t===null&&J1(e),null;case 13:return PA(t,e,n);case 4:return uk(e,e.stateNode.containerInfo),s=e.pendingProps,t===null?e.child=Vc(e,null,s,n):gs(t,e,s,n),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Hr(s,r),g2(t,e,s,r,n);case 7:return gs(t,e,e.pendingProps,n),e.child;case 8:return gs(t,e,e.pendingProps.children,n),e.child;case 12:return gs(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,o=e.memoizedProps,i=r.value,Et(og,s._currentValue),s._currentValue=i,o!==null)if(so(o.value,i)){if(o.children===r.children&&!Ms.current){e=ai(t,e,n);break e}}else for(o=e.child,o!==null&&(o.return=e);o!==null;){var a=o.dependencies;if(a!==null){i=o.child;for(var l=a.firstContext;l!==null;){if(l.context===s){if(o.tag===1){l=ni(-1,n&-n),l.tag=2;var c=o.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}o.lanes|=n,l=o.alternate,l!==null&&(l.lanes|=n),ev(o.return,n,e),a.lanes|=n;break}l=l.next}}else if(o.tag===10)i=o.type===e.type?null:o.child;else if(o.tag===18){if(i=o.return,i===null)throw Error(ae(341));i.lanes|=n,a=i.alternate,a!==null&&(a.lanes|=n),ev(i,n,e),i=o.sibling}else i=o.child;if(i!==null)i.return=o;else for(i=o;i!==null;){if(i===e){i=null;break}if(o=i.sibling,o!==null){o.return=i.return,i=o;break}i=i.return}o=i}gs(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Ic(e,n),r=Rr(r),s=s(r),e.flags|=1,gs(t,e,s,n),e.child;case 14:return s=e.type,r=Hr(s,e.pendingProps),r=Hr(s.type,r),x2(t,e,s,r,n);case 15:return AA(t,e,e.type,e.pendingProps,n);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Hr(s,r),Em(t,e),e.tag=1,Ls(s)?(t=!0,ng(e)):t=!1,Ic(e,n),NA(e,s,r),nv(e,s,r,n),ov(null,e,s,!0,t,n);case 19:return MA(t,e,n);case 22:return DA(t,e,n)}throw Error(ae(156,e.tag))};function JA(t,e){return IR(t,e)}function WW(t,e,n,s){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vr(t,e,n,s){return new WW(t,e,n,s)}function $k(t){return t=t.prototype,!(!t||!t.isReactComponent)}function UW(t){if(typeof t=="function")return $k(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Hw)return 11;if(t===Gw)return 14}return 2}function Xi(t,e){var n=t.alternate;return n===null?(n=vr(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Rm(t,e,n,s,r,o){var i=2;if(s=t,typeof t=="function")$k(t)&&(i=1);else if(typeof t=="string")i=5;else e:switch(t){case uc:return Ja(n.children,r,o,e);case Uw:i=8,r|=8;break;case I1:return t=vr(12,n,e,r|2),t.elementType=I1,t.lanes=o,t;case T1:return t=vr(13,n,e,r),t.elementType=T1,t.lanes=o,t;case E1:return t=vr(19,n,e,r),t.elementType=E1,t.lanes=o,t;case cR:return T0(n,r,o,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case aR:i=10;break e;case lR:i=9;break e;case Hw:i=11;break e;case Gw:i=14;break e;case $i:i=16,s=null;break e}throw Error(ae(130,t==null?t:typeof t,""))}return e=vr(i,n,e,r),e.elementType=t,e.type=s,e.lanes=o,e}function Ja(t,e,n,s){return t=vr(7,t,s,e),t.lanes=n,t}function T0(t,e,n,s){return t=vr(22,t,s,e),t.elementType=cR,t.lanes=n,t.stateNode={isHidden:!1},t}function Mb(t,e,n){return t=vr(6,t,null,e),t.lanes=n,t}function Lb(t,e,n){return e=vr(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function HW(t,e,n,s,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yb(0),this.expirationTimes=yb(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yb(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function Ik(t,e,n,s,r,o,i,a,l){return t=new HW(t,e,n,a,l),e===1?(e=1,o===!0&&(e|=8)):e=0,o=vr(3,null,null,e),t.current=o,o.stateNode=t,o.memoizedState={element:s,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ck(o),t}function GW(t,e,n){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:cc,key:s==null?null:""+s,children:t,containerInfo:e,implementation:n}}function eD(t){if(!t)return na;t=t._reactInternals;e:{if(Al(t)!==t||t.tag!==1)throw Error(ae(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Ls(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ae(171))}if(t.tag===1){var n=t.type;if(Ls(n))return eA(t,n,e)}return e}function tD(t,e,n,s,r,o,i,a,l){return t=Ik(n,s,!0,t,r,o,i,a,l),t.context=eD(null),n=t.current,s=vs(),r=Ki(n),o=ni(s,r),o.callback=e??null,Gi(n,o,r),t.current.lanes=r,Ah(t,r,s),zs(t,s),t}function E0(t,e,n,s){var r=e.current,o=vs(),i=Ki(r);return n=eD(n),e.context===null?e.context=n:e.pendingContext=n,e=ni(o,i),e.payload={element:t},s=s===void 0?null:s,s!==null&&(e.callback=s),t=Gi(r,e,i),t!==null&&(Jr(t,r,i,o),$m(t,r,i)),i}function mg(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function N2(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Tk(t,e){N2(t,e),(t=t.alternate)&&N2(t,e)}function jW(){return null}var nD=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ek(t){this._internalRoot=t}N0.prototype.render=Ek.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ae(409));E0(t,e,null,null)};N0.prototype.unmount=Ek.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;ul(function(){E0(null,t,null,null)}),e[oi]=null}};function N0(t){this._internalRoot=t}N0.prototype.unstable_scheduleHydration=function(t){if(t){var e=DR();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ni.length&&e!==0&&e<Ni[n].priority;n++);Ni.splice(n,0,t),n===0&&OR(t)}};function Nk(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function _2(){}function KW(t,e,n,s,r){if(r){if(typeof s=="function"){var o=s;s=function(){var c=mg(i);o.call(c)}}var i=tD(e,s,t,0,null,!1,!1,"",_2);return t._reactRootContainer=i,t[oi]=i.current,Zd(t.nodeType===8?t.parentNode:t),ul(),i}for(;r=t.lastChild;)t.removeChild(r);if(typeof s=="function"){var a=s;s=function(){var c=mg(l);a.call(c)}}var l=Ik(t,0,!1,null,null,!1,!1,"",_2);return t._reactRootContainer=l,t[oi]=l.current,Zd(t.nodeType===8?t.parentNode:t),ul(function(){E0(e,l,n,s)}),l}function R0(t,e,n,s,r){var o=n._reactRootContainer;if(o){var i=o;if(typeof r=="function"){var a=r;r=function(){var l=mg(i);a.call(l)}}E0(e,i,t,r)}else i=KW(n,e,t,r,s);return mg(i)}RR=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=ad(e.pendingLanes);n!==0&&(Xw(e,n|1),zs(e,un()),!(ot&6)&&(Hc=un()+500,fa()))}break;case 13:ul(function(){var s=ii(t,1);if(s!==null){var r=vs();Jr(s,t,1,r)}}),Tk(t,1)}};qw=function(t){if(t.tag===13){var e=ii(t,134217728);if(e!==null){var n=vs();Jr(e,t,134217728,n)}Tk(t,134217728)}};AR=function(t){if(t.tag===13){var e=Ki(t),n=ii(t,e);if(n!==null){var s=vs();Jr(n,t,e,s)}Tk(t,e)}};DR=function(){return xt};FR=function(t,e){var n=xt;try{return xt=t,e()}finally{xt=n}};L1=function(t,e,n){switch(e){case"input":if(R1(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var s=n[e];if(s!==t&&s.form===t.form){var r=w0(s);if(!r)throw Error(ae(90));dR(s),R1(s,r)}}}break;case"textarea":fR(t,n);break;case"select":e=n.value,e!=null&&kc(t,!!n.multiple,e,!1)}};vR=kk;wR=ul;var XW={usingClientEntryPoint:!1,Events:[Fh,pc,w0,yR,bR,kk]},Uu={findFiberByHostInstance:Ua,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},qW={bundleType:Uu.bundleType,version:Uu.version,rendererPackageName:Uu.rendererPackageName,rendererConfig:Uu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:gi.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=SR(t),t===null?null:t.stateNode},findFiberByHostInstance:Uu.findFiberByHostInstance||jW,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Np=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Np.isDisabled&&Np.supportsFiber)try{x0=Np.inject(qW),Io=Np}catch{}}or.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=XW;or.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Nk(e))throw Error(ae(200));return GW(t,e,null,n)};or.createRoot=function(t,e){if(!Nk(t))throw Error(ae(299));var n=!1,s="",r=nD;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=Ik(t,1,!1,null,null,n,!1,s,r),t[oi]=e.current,Zd(t.nodeType===8?t.parentNode:t),new Ek(e)};or.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ae(188)):(t=Object.keys(t).join(","),Error(ae(268,t)));return t=SR(e),t=t===null?null:t.stateNode,t};or.flushSync=function(t){return ul(t)};or.hydrate=function(t,e,n){if(!_0(e))throw Error(ae(200));return R0(null,t,e,!0,n)};or.hydrateRoot=function(t,e,n){if(!Nk(t))throw Error(ae(405));var s=n!=null&&n.hydratedSources||null,r=!1,o="",i=nD;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(o=n.identifierPrefix),n.onRecoverableError!==void 0&&(i=n.onRecoverableError)),e=tD(e,null,t,1,n??null,r,!1,o,i),t[oi]=e.current,Zd(t),s)for(t=0;t<s.length;t++)n=s[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new N0(e)};or.render=function(t,e,n){if(!_0(e))throw Error(ae(200));return R0(null,t,e,!1,n)};or.unmountComponentAtNode=function(t){if(!_0(t))throw Error(ae(40));return t._reactRootContainer?(ul(function(){R0(null,null,t,!1,function(){t._reactRootContainer=null,t[oi]=null})}),!0):!1};or.unstable_batchedUpdates=kk;or.unstable_renderSubtreeIntoContainer=function(t,e,n,s){if(!_0(n))throw Error(ae(200));if(t==null||t._reactInternals===void 0)throw Error(ae(38));return R0(t,e,n,!1,s)};or.version="18.3.1-next-f1338f8080-20240426";function sD(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(sD)}catch(t){console.error(t)}}sD(),sR.exports=or;var _k=sR.exports;const _p=Ow(_k);var R2=_k;S1.createRoot=R2.createRoot,S1.hydrateRoot=R2.hydrateRoot;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YW=1e-7,QW=1e-4;class rD{constructor(e,n){this.backend=e,this.dataMover=n,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,n){this.dataIdsCount++,this.data.set(e,n)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class Rk{refCount(e){return Ts("refCount")}incRef(e){return Ts("incRef")}timerAvailable(){return!0}time(e){return Ts("time")}read(e){return Ts("read")}readSync(e){return Ts("readSync")}readToGPU(e,n){return Ts("readToGPU")}numDataIds(){return Ts("numDataIds")}disposeData(e,n){return Ts("disposeData")}write(e,n,s){return Ts("write")}move(e,n,s,r,o){return Ts("move")}createTensorFromGPUData(e,n,s){return Ts("createTensorFromGPUData")}memory(){return Ts("memory")}floatPrecision(){return Ts("floatPrecision")}epsilon(){return this.floatPrecision()===32?YW:QW}dispose(){return Ts("dispose")}}function Ts(t){throw new Error(`'${t}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZW(t){let e=t.length,n=0;for(;e>0;)n=Math.random()*e|0,e--,rc(t,e,n)}function dl(t,e,n){return Math.max(t,Math.min(e,n))}function Ak(t){return t%2===0?t:t+1}function rc(t,e,n){const s=t[e];t[e]=t[n],t[n]=s}function JW(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e}function T(t,e){if(!t)throw new Error(typeof e=="string"?e:e())}function Dk(t,e,n=""){T(lt(t,e),()=>n+` Shapes ${t} and ${e} must match`)}function oD(t){T(t!=null,()=>"The input to the tensor constructor must be a non-null value.")}function Z(t){if(t.length===0)return 1;let e=t[0];for(let n=1;n<t.length;n++)e*=t[n];return e}function lt(t,e){if(t===e)return!0;if(t==null||e==null||t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}function Gc(t){return t%1===0}function xv(t){const e=Math.ceil(Math.sqrt(t));return[e,Math.ceil(t/e)]}function Ec(t,e){return e<=t.length?t:t+" ".repeat(e-t.length)}function A2(t,e=r=>0,n,s){return new Promise((r,o)=>{let i=0;const a=()=>{if(t()){r();return}i++;const l=e(i);if(n!=null&&i>=n){o();return}s!=null?s(a,l):setTimeout(a,l)};a()})}function iD(t,e){let n=1,s=-1;for(let o=0;o<t.length;++o)if(t[o]>=0)n*=t[o];else if(t[o]===-1){if(s!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${s} and dim ${o}`);s=o}else if(t[o]<0)throw Error(`Shapes can not be < 0. Found ${t[o]} at dim ${o}`);if(s===-1){if(e>0&&e!==n)throw Error(`Size(${e}) must match the product of shape ${t}`);return t}if(n===0)throw Error(`Cannot infer the missing size in [${t}] when there are 0 elements`);if(e%n!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${n}`);const r=t.slice();return r[s]=e/n,r}function je(t,e){const n=e.length;return t=t==null?e.map((s,r)=>r):[].concat(t),T(t.every(s=>s>=-n&&s<n),()=>`All values in axis param must be in range [-${n}, ${n}) but got axis ${t}`),T(t.every(s=>Gc(s)),()=>`All values in axis param must be integers but got axis ${t}`),t.map(s=>s<0?n+s:s)}function pa(t,e){const n=[],s=[],r=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||r?null:je(e,t).sort();let i=0;for(let a=0;a<t.length;++a){if(o!=null){if(o[i]===a&&t[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${t[a]}' is not 1`);(o[i]==null||o[i]>a)&&t[a]===1&&(n.push(t[a]),s.push(a)),o[i]<=a&&i++}t[a]!==1&&(n.push(t[a]),s.push(a))}return{newShape:n,keptDims:s}}function Xn(t,e){return Jt(t,e)}function Jt(t,e){let n=null;if(t==null||t==="float32")n=new Float32Array(e);else if(t==="int32")n=new Int32Array(e);else if(t==="bool")n=new Uint8Array(e);else if(t==="string")n=new Array(e);else throw new Error(`Unknown data type ${t}`);return n}function eU(t,e){for(let n=0;n<t.length;n++){const s=t[n];if(isNaN(s)||!isFinite(s))throw Error(`A tensor of type ${e} being uploaded contains ${s}.`)}}function tU(t){return t==="bool"||t==="complex64"||t==="float32"||t==="int32"||t==="string"}function aD(t,e){return!(e==="complex64"||e==="float32"&&t!=="complex64"||e==="int32"&&t!=="float32"&&t!=="complex64"||e==="bool"&&t==="bool")}function gg(t){if(t==="float32"||t==="int32")return 4;if(t==="complex64")return 8;if(t==="bool")return 1;throw new Error(`Unknown dtype ${t}`)}function nU(t){if(t==null)return 0;let e=0;return t.forEach(n=>e+=n.length),e}function Ph(t){return typeof t=="string"||t instanceof String}function sU(t){return typeof t=="boolean"}function yv(t){return typeof t=="number"}function pu(t){return Array.isArray(t)?pu(t[0]):t instanceof Float32Array?"float32":t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray?"int32":yv(t)?"float32":Ph(t)?"string":sU(t)?"bool":"float32"}function bv(t){return!!(t&&t.constructor&&t.call&&t.apply)}function vv(t,e){for(let n=e;n<t;++n)if(t%n===0)return n;return t}function Te(t){const e=t.length;if(e<2)return[];const n=new Array(e-1);n[e-2]=t[e-1];for(let s=e-3;s>=0;--s)n[s]=n[s+1]*t[s+1];return n}function lD(t,e,n,s=!1){const r=new Array;if(e.length===1){const o=e[0]*(s?2:1);for(let i=0;i<o;i++)r[i]=n[t+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((l,c)=>l*c)*(s?2:1);for(let l=0;l<o;l++)r[l]=lD(t+l*a,i,n,s)}return r}function eo(t,e,n=!1){if(t.length===0)return e[0];const s=t.reduce((r,o)=>r*o)*(n?2:1);if(s===0)return[];if(s!==e.length)throw new Error(`[${t}] does not match the input size ${e.length}${n?" for a complex tensor":""}.`);return lD(0,t,e,n)}function rU(t,e){if(Array.isArray(t))return t;if(e==="float32")return t instanceof Float32Array?t:new Float32Array(t);if(e==="int32")return t instanceof Int32Array?t:new Int32Array(t);if(e==="bool"||e==="string")return Uint8Array.from(new Int32Array(t));throw new Error(`Unknown dtype ${e}`)}function Fk(t,e){const n=qn(t,e);for(let s=0;s<n.length;s++)n[s]=1;return n}function qn(t,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool")return new Uint8Array(t);throw new Error(`Unknown data type ${e}`)}function cD(t,e){const n=t.reduce((s,r)=>s*r,1);if(e==null||e==="float32")return eo(t,new Float32Array(n));if(e==="int32")return eo(t,new Int32Array(n));if(e==="bool")return eo(t,new Uint8Array(n));throw new Error(`Unknown data type ${e}`)}function xi(t){t.forEach(e=>{T(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${t}].`)})}function Eo(t,e,n){if(e===0)return 0;if(e===1)return t[0];let s=t[t.length-1];for(let r=0;r<t.length-1;++r)s+=n[r]*t[r];return s}function mu(t,e,n){if(e===0)return[];if(e===1)return[t];const s=new Array(e);for(let r=0;r<s.length-1;++r)s[r]=Math.floor(t/n[r]),t-=s[r]*n[r];return s[s.length-1]=t,s}function Ok(t){return t&&t.then&&typeof t.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D2="tfjsflags";class oU{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=iU,this.populateURLFlags()}setPlatform(e,n){this.platform!=null&&(K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=n}registerFlag(e,n,s){if(this.flagRegistry[e]={evaluationFn:n,setHook:s},this.urlFlags[e]!=null){const r=this.urlFlags[e];K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${r}.`),this.set(e,r)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const n=this.evaluateFlag(e);if(Ok(n))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=n,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getString(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,n){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=n,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(n)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);D2 in e&&e[D2].split(",").forEach(s=>{const[r,o]=s.split(":");this.urlFlags[r]=lU(r,o)})}}function iU(t){const e={};return t.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(n,...s)=>(aU(e,s[0],s[1]),s.join("="))),e}function aU(t,e,n){t[decodeURIComponent(e)]=decodeURIComponent(n||"")}function lU(t,e){const n=e.toLowerCase();return n==="true"||n==="false"?n==="true":`${+n}`===n?+n:e}function K(){return uD}let uD=null;function cU(t){uD=t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let zb;function dD(){if(zb==null){let t;if(typeof window<"u")t=window;else if(typeof global<"u")t=global;else if(typeof process<"u")t=process;else if(typeof self<"u")t=self;else throw new Error("Could not find a global object");zb=t}return zb}function uU(){const t=dD();return t._tfGlobals==null&&(t._tfGlobals=new Map),t._tfGlobals}function Pk(t,e){const n=uU();if(n.has(t))return n.get(t);{const s=e();return n.set(t,s),n.get(t)}}const A0="Abs",Mh="Acos",Lh="Acosh",gu="Add",Mk="AddN",Lk="All",zk="Any",D0="ArgMax",F0="ArgMin",zh="Asin",Bh="Asinh",Vh="Atan",Wh="Atanh",Uh="Atan2",O0="AvgPool",Bk="AvgPoolGrad",P0="AvgPool3D",Vk="AvgPool3DGrad",M0="BatchMatMul",L0="BatchToSpaceND",Wk="Bincount",Uk="BitwiseAnd",dU="BroadcastTo",hD="BroadcastArgs",Hh="Cast",Gh="Ceil",jh="ClipByValue",Hk="Complex",z0="ComplexAbs",B0="Concat",V0="Conv2D",Gk="Conv2DBackpropFilter",W0="Conv2DBackpropInput",U0="Conv3D",jk="Conv3DBackpropFilterV2",Kk="Conv3DBackpropInputV2",Kh="Cos",Xh="Cosh",Xk="Cumprod",H0="Cumsum",qk="CropAndResize",Yk="DenseBincount",Qk="DepthToSpace",G0="DepthwiseConv2dNative",Zk="DepthwiseConv2dNativeBackpropFilter",Jk="DepthwiseConv2dNativeBackpropInput",fD="Diag",j0="Dilation2D",wv="Dilation2DBackpropInput",kv="Dilation2DBackpropFilter",hU="Draw",qh="RealDiv",eC="Einsum",Yh="Elu",tC="EluGrad",Qh="Erf",K0="Equal",Zh="Exp",X0="ExpandDims",Jh="Expm1",nC="FFT",sC="Fill",rC="FlipLeftRight",ef="Floor",tf="FloorDiv",q0="FusedBatchNorm",Y0="GatherV2",pD="GatherNd",Q0="Greater",nf="GreaterEqual",sf="Identity",oC="IFFT",iC="Imag",rf="IsFinite",of="IsInf",af="IsNan",Z0="LeakyRelu",J0="Less",ex="LessEqual",mD="LinSpace",lf="Log",cf="Log1p",tx="LogicalAnd",nx="LogicalNot",sx="LogicalOr",fU="LogSoftmax",rx="LRN",aC="LRNGrad",ox="Max",uf="Maximum",ix="MaxPool",lC="MaxPoolGrad",ax="MaxPool3D",cC="MaxPool3DGrad",gD="MaxPoolWithArgmax",lx="Mean",cx="Min",df="Minimum",ux="MirrorPad",hf="Mod",xD="Multinomial",ff="Multiply",dx="Neg",hx="NotEqual",uC="NonMaxSuppressionV3",dC="NonMaxSuppressionV4",hC="NonMaxSuppressionV5",fx="OnesLike",px="OneHot",mx="Pack",gx="PadV2",pf="Pow",xx="Prelu",yx="Prod",yD="RaggedGather",bD="RaggedRange",vD="RaggedTensorToTensor",fC="Range",pC="Real",mf="Reciprocal",gf="Relu",bx="Reshape",vx="ResizeNearestNeighbor",mC="ResizeNearestNeighborGrad",wx="ResizeBilinear",gC="ResizeBilinearGrad",xf="Relu6",kx="Reverse",yf="Round",bf="Rsqrt",wD="ScatterNd",kD="TensorScatterUpdate",CD="SearchSorted",Cx="Select",vf="Selu",Sx="Slice",wf="Sin",kf="Sinh",Cf="Sign",Sf="Sigmoid",$f="Softplus",If="Sqrt",$x="Sum",Ix="SpaceToBatchND",Tx="SplitV",Ex="Softmax",SD="SparseFillEmptyRows",$D="SparseReshape",ID="SparseSegmentMean",TD="SparseSegmentSum",ED="SparseToDense",Tf="SquaredDifference",xC="Square",yC="StaticRegexReplace",bC="StridedSlice",ND="StringNGrams",_D="StringSplit",RD="StringToHashBucketFast",Ef="Sub",Nf="Tan",_f="Tanh",Rf="Tile",vC="TopK",wC="Transform",Nc="Transpose",kC="Unique",Nx="Unpack",_x="UnsortedSegmentSum",Rx="ZerosLike",Af="Step",pU="FromPixels",CC="RotateWithOffset",xg="_FusedMatMul",yg="FusedConv2D",AD="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ks(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.warn(...t)}function mU(...t){K().getBool("IS_TEST")||K().getBool("PROD")||console.log(...t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bg=Pk("kernelRegistry",()=>new Map),Cv=Pk("gradRegistry",()=>new Map);function F2(t,e){const n=FD(t,e);return bg.get(n)}function O2(t){return Cv.get(t)}function P2(t){const e=bg.entries(),n=[];for(;;){const{done:s,value:r}=e.next();if(s)break;const[o,i]=r,[a]=o.split("_");a===t&&n.push(i)}return n}function DD(t){const{kernelName:e,backendName:n}=t,s=FD(e,n);bg.has(s)&&Ks(`The kernel '${e}' for backend '${n}' is already registered`),bg.set(s,t)}function gU(t){const{kernelName:e}=t;Cv.has(e)&&K().getBool("DEBUG")&&Ks(`Overriding the gradient for '${e}'`),Cv.set(e,t)}function FD(t,e){return`${e}_${t}`}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OD(t){return t instanceof Float32Array||t instanceof Int32Array||t instanceof Uint8Array||t instanceof Uint8ClampedArray}var PD=_t,wr=null;try{wr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function _t(t,e,n){this.low=t|0,this.high=e|0,this.unsigned=!!n}_t.prototype.__isLong__;Object.defineProperty(_t.prototype,"__isLong__",{value:!0});function Hs(t){return(t&&t.__isLong__)===!0}_t.isLong=Hs;var M2={},L2={};function Dl(t,e){var n,s,r;return e?(t>>>=0,(r=0<=t&&t<256)&&(s=L2[t],s)?s:(n=Rt(t,(t|0)<0?-1:0,!0),r&&(L2[t]=n),n)):(t|=0,(r=-128<=t&&t<128)&&(s=M2[t],s)?s:(n=Rt(t,t<0?-1:0,!1),r&&(M2[t]=n),n))}_t.fromInt=Dl;function kr(t,e){if(isNaN(t))return e?ja:Cr;if(e){if(t<0)return ja;if(t>=MD)return BD}else{if(t<=-B2)return Fs;if(t+1>=B2)return zD}return t<0?kr(-t,e).neg():Rt(t%jc|0,t/jc|0,e)}_t.fromNumber=kr;function Rt(t,e,n){return new _t(t,e,n)}_t.fromBits=Rt;var vg=Math.pow;function SC(t,e,n){if(t.length===0)throw Error("empty string");if(t==="NaN"||t==="Infinity"||t==="+Infinity"||t==="-Infinity")return Cr;if(typeof e=="number"?(n=e,e=!1):e=!!e,n=n||10,n<2||36<n)throw RangeError("radix");var s;if((s=t.indexOf("-"))>0)throw Error("interior hyphen");if(s===0)return SC(t.substring(1),e,n).neg();for(var r=kr(vg(n,8)),o=Cr,i=0;i<t.length;i+=8){var a=Math.min(8,t.length-i),l=parseInt(t.substring(i,i+a),n);if(a<8){var c=kr(vg(n,a));o=o.mul(c).add(kr(l))}else o=o.mul(r),o=o.add(kr(l))}return o.unsigned=e,o}_t.fromString=SC;function ao(t,e){return typeof t=="number"?kr(t,e):typeof t=="string"?SC(t,e):Rt(t.low,t.high,typeof e=="boolean"?e:t.unsigned)}_t.fromValue=ao;var z2=65536,xU=1<<24,jc=z2*z2,MD=jc*jc,B2=MD/2,V2=Dl(xU),Cr=Dl(0);_t.ZERO=Cr;var ja=Dl(0,!0);_t.UZERO=ja;var wc=Dl(1);_t.ONE=wc;var LD=Dl(1,!0);_t.UONE=LD;var Sv=Dl(-1);_t.NEG_ONE=Sv;var zD=Rt(-1,2147483647,!1);_t.MAX_VALUE=zD;var BD=Rt(-1,-1,!0);_t.MAX_UNSIGNED_VALUE=BD;var Fs=Rt(0,-2147483648,!1);_t.MIN_VALUE=Fs;var he=_t.prototype;he.toInt=function(){return this.unsigned?this.low>>>0:this.low};he.toNumber=function(){return this.unsigned?(this.high>>>0)*jc+(this.low>>>0):this.high*jc+(this.low>>>0)};he.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Fs)){var n=kr(e),s=this.div(n),r=s.mul(n).sub(this);return s.toString(e)+r.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=kr(vg(e,6),this.unsigned),i=this,a="";;){var l=i.div(o),c=i.sub(l.mul(o)).toInt()>>>0,u=c.toString(e);if(i=l,i.isZero())return u+a;for(;u.length<6;)u="0"+u;a=""+u+a}};he.getHighBits=function(){return this.high};he.getHighBitsUnsigned=function(){return this.high>>>0};he.getLowBits=function(){return this.low};he.getLowBitsUnsigned=function(){return this.low>>>0};he.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Fs)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,n=31;n>0&&!(e&1<<n);n--);return this.high!=0?n+33:n+1};he.isZero=function(){return this.high===0&&this.low===0};he.eqz=he.isZero;he.isNegative=function(){return!this.unsigned&&this.high<0};he.isPositive=function(){return this.unsigned||this.high>=0};he.isOdd=function(){return(this.low&1)===1};he.isEven=function(){return(this.low&1)===0};he.equals=function(e){return Hs(e)||(e=ao(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};he.eq=he.equals;he.notEquals=function(e){return!this.eq(e)};he.neq=he.notEquals;he.ne=he.notEquals;he.lessThan=function(e){return this.comp(e)<0};he.lt=he.lessThan;he.lessThanOrEqual=function(e){return this.comp(e)<=0};he.lte=he.lessThanOrEqual;he.le=he.lessThanOrEqual;he.greaterThan=function(e){return this.comp(e)>0};he.gt=he.greaterThan;he.greaterThanOrEqual=function(e){return this.comp(e)>=0};he.gte=he.greaterThanOrEqual;he.ge=he.greaterThanOrEqual;he.compare=function(e){if(Hs(e)||(e=ao(e)),this.eq(e))return 0;var n=this.isNegative(),s=e.isNegative();return n&&!s?-1:!n&&s?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};he.comp=he.compare;he.negate=function(){return!this.unsigned&&this.eq(Fs)?Fs:this.not().add(wc)};he.neg=he.negate;he.add=function(e){Hs(e)||(e=ao(e));var n=this.high>>>16,s=this.high&65535,r=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,l=e.low>>>16,c=e.low&65535,u=0,d=0,h=0,f=0;return f+=o+c,h+=f>>>16,f&=65535,h+=r+l,d+=h>>>16,h&=65535,d+=s+a,u+=d>>>16,d&=65535,u+=n+i,u&=65535,Rt(h<<16|f,u<<16|d,this.unsigned)};he.subtract=function(e){return Hs(e)||(e=ao(e)),this.add(e.neg())};he.sub=he.subtract;he.multiply=function(e){if(this.isZero())return Cr;if(Hs(e)||(e=ao(e)),wr){var n=wr.mul(this.low,this.high,e.low,e.high);return Rt(n,wr.get_high(),this.unsigned)}if(e.isZero())return Cr;if(this.eq(Fs))return e.isOdd()?Fs:Cr;if(e.eq(Fs))return this.isOdd()?Fs:Cr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(V2)&&e.lt(V2))return kr(this.toNumber()*e.toNumber(),this.unsigned);var s=this.high>>>16,r=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,l=e.high&65535,c=e.low>>>16,u=e.low&65535,d=0,h=0,f=0,p=0;return p+=i*u,f+=p>>>16,p&=65535,f+=o*u,h+=f>>>16,f&=65535,f+=i*c,h+=f>>>16,f&=65535,h+=r*u,d+=h>>>16,h&=65535,h+=o*c,d+=h>>>16,h&=65535,h+=i*l,d+=h>>>16,h&=65535,d+=s*u+r*c+o*l+i*a,d&=65535,Rt(f<<16|p,d<<16|h,this.unsigned)};he.mul=he.multiply;he.divide=function(e){if(Hs(e)||(e=ao(e)),e.isZero())throw Error("division by zero");if(wr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var n=(this.unsigned?wr.div_u:wr.div_s)(this.low,this.high,e.low,e.high);return Rt(n,wr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?ja:Cr;var s,r,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return ja;if(e.gt(this.shru(1)))return LD;o=ja}else{if(this.eq(Fs)){if(e.eq(wc)||e.eq(Sv))return Fs;if(e.eq(Fs))return wc;var i=this.shr(1);return s=i.div(e).shl(1),s.eq(Cr)?e.isNegative()?wc:Sv:(r=this.sub(e.mul(s)),o=s.add(r.div(e)),o)}else if(e.eq(Fs))return this.unsigned?ja:Cr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=Cr}for(r=this;r.gte(e);){s=Math.max(1,Math.floor(r.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(s)/Math.LN2),l=a<=48?1:vg(2,a-48),c=kr(s),u=c.mul(e);u.isNegative()||u.gt(r);)s-=l,c=kr(s,this.unsigned),u=c.mul(e);c.isZero()&&(c=wc),o=o.add(c),r=r.sub(u)}return o};he.div=he.divide;he.modulo=function(e){if(Hs(e)||(e=ao(e)),wr){var n=(this.unsigned?wr.rem_u:wr.rem_s)(this.low,this.high,e.low,e.high);return Rt(n,wr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};he.mod=he.modulo;he.rem=he.modulo;he.not=function(){return Rt(~this.low,~this.high,this.unsigned)};he.and=function(e){return Hs(e)||(e=ao(e)),Rt(this.low&e.low,this.high&e.high,this.unsigned)};he.or=function(e){return Hs(e)||(e=ao(e)),Rt(this.low|e.low,this.high|e.high,this.unsigned)};he.xor=function(e){return Hs(e)||(e=ao(e)),Rt(this.low^e.low,this.high^e.high,this.unsigned)};he.shiftLeft=function(e){return Hs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Rt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Rt(0,this.low<<e-32,this.unsigned)};he.shl=he.shiftLeft;he.shiftRight=function(e){return Hs(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Rt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Rt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};he.shr=he.shiftRight;he.shiftRightUnsigned=function(e){if(Hs(e)&&(e=e.toInt()),e&=63,e===0)return this;var n=this.high;if(e<32){var s=this.low;return Rt(s>>>e|n<<32-e,n>>>e,this.unsigned)}else return e===32?Rt(n,0,this.unsigned):Rt(n>>>e-32,0,this.unsigned)};he.shru=he.shiftRightUnsigned;he.shr_u=he.shiftRightUnsigned;he.toSigned=function(){return this.unsigned?Rt(this.low,this.high,!1):this};he.toUnsigned=function(){return this.unsigned?this:Rt(this.low,this.high,!0)};he.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};he.toBytesLE=function(){var e=this.high,n=this.low;return[n&255,n>>>8&255,n>>>16&255,n>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};he.toBytesBE=function(){var e=this.high,n=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,n>>>24,n>>>16&255,n>>>8&255,n&255]};_t.fromBytes=function(e,n,s){return s?_t.fromBytesLE(e,n):_t.fromBytesBE(e,n)};_t.fromBytesLE=function(e,n){return new _t(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,n)};_t.fromBytesBE=function(e,n){return new _t(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],n)};const VD=Ow(PD),yU=K_({__proto__:null,default:VD},[PD]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ba=VD||yU;function Ax(t){return Ba.fromString(t,!0,16)}const WD=Ax("c3a5c85c97cb3127"),Fa=Ax("b492b66fbe98f273"),as=Ax("9ae16a3b2f90404f");function $v(t){return t.xor(t.shru(47))}function UD(t,e,n){const s=t.slice(e,e+n);return Ba.fromBytes(Array.from(s),!0,!0)}function kt(t,e){return UD(t,e,8)}function W2(t,e){return UD(t,e,4)}function En(t,e){return e===0?t:t.shru(e).or(t.shl(64-e))}function qi(t,e,n=Ax("9ddfea08eb382d69")){let s=t.xor(e).mul(n);s=s.xor(s.shru(47));let r=e.xor(s).mul(n);return r=r.xor(r.shru(47)),r=r.mul(n),r}function bU(t,e,n,s,r,o){r=r.add(t),o=En(o.add(r).add(s),21);const i=r;return r=r.add(e),r=r.add(n),o=o.add(En(r,44)),[r.add(s),o.add(i)]}function Rp(t,e,n,s){return bU(kt(t,e),kt(t,e+8),kt(t,e+16),kt(t,e+24),n,s)}function vU(t,e=t.length){if(e>=8){const n=as.add(e*2),s=kt(t,0).add(as),r=kt(t,e-8),o=En(r,37).mul(n).add(s),i=En(s,25).add(r).mul(n);return qi(o,i,n)}if(e>=4){const n=as.add(e*2),s=W2(t,0);return qi(s.shl(3).add(e),W2(t,e-4),n)}if(e>0){const n=t[0],s=t[e>>1],r=t[e-1],o=n+(s<<8),i=e+(r<<2);return $v(as.mul(o).xor(WD.mul(i))).mul(as)}return as}function wU(t,e=t.length){const n=as.add(e*2),s=kt(t,0).mul(Fa),r=kt(t,8),o=kt(t,e-8).mul(n),i=kt(t,e-16).mul(as);return qi(En(s.add(r),43).add(En(o,30)).add(i),s.add(En(r.add(as),18)).add(o),n)}function kU(t,e=t.length){const n=as.add(e*2),s=kt(t,0).mul(as),r=kt(t,8),o=kt(t,e-8).mul(n),i=kt(t,e-16).mul(as),a=En(s.add(r),43).add(En(o,30)).add(i),l=qi(a,s.add(En(r.add(as),18)).add(o),n),c=kt(t,16).mul(n),u=kt(t,24),d=a.add(kt(t,e-32)).mul(n),h=l.add(kt(t,e-24)).mul(n);return qi(En(c.add(u),43).add(En(d,30)).add(h),c.add(En(u.add(s),18)).add(d),n)}function CU(t,e=t.length){const n=Ba.fromNumber(81,!0);if(e<=32)return e<=16?vU(t,e):wU(t,e);if(e<=64)return kU(t,e);let s=n,r=n.mul(Fa).add(113),o=$v(r.mul(as).add(113)).mul(as),i=[Ba.UZERO,Ba.UZERO],a=[Ba.UZERO,Ba.UZERO];s=s.mul(as).add(kt(t,0));let l=0;const c=(e-1>>6)*64,u=c+(e-1&63)-63;do s=En(s.add(r).add(i[0]).add(kt(t,l+8)),37).mul(Fa),r=En(r.add(i[1]).add(kt(t,l+48)),42).mul(Fa),s=s.xor(a[1]),r=r.add(i[0]).add(kt(t,l+40)),o=En(o.add(a[0]),33).mul(Fa),i=Rp(t,l,i[1].mul(Fa),s.add(a[0])),a=Rp(t,l+32,o.add(a[1]),r.add(kt(t,l+16))),[o,s]=[s,o],l+=64;while(l!==c);const d=Fa.add(o.and(255).shl(1));return l=u,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),s=En(s.add(r).add(i[0]).add(kt(t,l+8)),37).mul(d),r=En(r.add(i[1]).add(kt(t,l+48)),42).mul(d),s=s.xor(a[1].mul(9)),r=r.add(i[0].mul(9).add(kt(t,l+40))),o=En(o.add(a[0]),33).mul(d),i=Rp(t,l,i[1].mul(d),s.add(a[0])),a=Rp(t,l+32,o.add(a[1]),r.add(kt(t,l+16))),[o,s]=[s,o],qi(qi(i[0],a[0],d).add($v(r).mul(WD)).add(o),qi(i[1],a[1],d).add(s),d)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ma(t,e){return e==="string"?Yi(t):Fl([t],e)}function SU(t,e){return t instanceof Float32Array&&e==="float32"||t instanceof Int32Array&&e==="int32"||t instanceof Uint8Array&&e==="bool"}function Fl(t,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(t)&&(t=hl(t)),K().getBool("DEBUG")&&eU(t,e),SU(t,e))return t;if(e==null||e==="float32"||e==="complex64")return new Float32Array(t);if(e==="int32")return new Int32Array(t);if(e==="bool"){const n=new Uint8Array(t.length);for(let s=0;s<n.length;++s)Math.round(t[s])!==0&&(n[s]=1);return n}else throw new Error(`Unknown data type ${e}`)}function xs(){return K().platform.now()}function Yi(t,e="utf-8"){return e=e||"utf-8",K().platform.encode(t,e)}function sa(t,e="utf-8"){return e=e||"utf-8",K().platform.decode(t,e)}function Dr(t){return K().platform.isTypedArray!=null?K().platform.isTypedArray(t):OD(t)}function hl(t,e=[],n=!1){if(e==null&&(e=[]),typeof t=="boolean"||typeof t=="number"||typeof t=="string"||Ok(t)||t==null||Dr(t)&&n)e.push(t);else if(Array.isArray(t)||Dr(t))for(let s=0;s<t.length;++s)hl(t[s],e,n);else{let s=-1;for(const r of Object.keys(t))/^([1-9]+[0-9]*|0)$/.test(r)&&(s=Math.max(s,Number(r)));for(let r=0;r<=s;r++)hl(t[r],e,n)}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $U{constructor(e,n){this.backendTimer=e,this.logger=n,n==null&&(this.logger=new TU)}profileKernel(e,n,s){let r;const o=()=>{r=s()};let i;const a=xs();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const c of r)c.dataSync();i=Promise.resolve({kernelMs:xs()-a})}if(K().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<r.length;c++){const u=r[c];u.data().then(d=>{IU(d,u.dtype,e)})}return{kernelName:e,outputs:r,inputs:n,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:n,outputs:s,timeMs:r,inputs:o,extraInfo:i}=e;s.forEach(a=>{Promise.all([a.data(),r,i]).then(l=>{this.logger.logKernelProfile(n,a,l[0],l[1],o,l[2])})})}}function IU(t,e,n){if(e!=="float32")return!1;for(let s=0;s<t.length;s++){const r=t[s];if(isNaN(r)||!isFinite(r))return console.warn(`Found ${r} in the result of '${n}'`),!0}return!1}class TU{logKernelProfile(e,n,s,r,o,i){const a=typeof r=="number"?Ec(`${r}ms`,9):r.error,l=Ec(e,25),c=n.rank,u=n.size,d=Ec(n.shape.toString(),14);let h="";for(const f in o){const p=o[f];if(p!=null){const m=p.shape||n.shape,x=m.length;h+=`${f}: ${x}D ${x>0?m:""} `}}console.log(`%c${l}	%c${a}	%c${c}D ${d}	%c${u}	%c${h}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EU(t,e,n){const s={},r={};for(let l=0;l<e.length;l++)s[e[l].id]=!0;for(let l=0;l<t.length;l++){const c=t[l],u=c.inputs;for(const d in u){const h=u[d];let f=!1;for(let p=0;p<e.length;p++)if(s[h.id]){c.outputs.forEach(m=>s[m.id]=!0),f=!0,r[c.id]=!0;break}if(f)break}}const o={};o[n.id]=!0;const i={};for(let l=t.length-1;l>=0;l--){const c=t[l],u=c.inputs;for(let d=0;d<c.outputs.length;d++)if(o[c.outputs[d].id]){for(const h in u)o[u[h].id]=!0,i[c.id]=!0;break}}const a=[];for(let l=0;l<t.length;l++){const c=t[l];if(r[c.id]&&i[c.id]){const u={};for(const h in c.inputs){const f=c.inputs[h];s[f.id]&&(u[h]=f)}const d=Object.assign({},c);d.inputs=u,d.outputs=c.outputs,a.push(d)}}return a}function NU(t,e,n,s){for(let r=e.length-1;r>=0;r--){const o=e[r],i=[];if(o.outputs.forEach(l=>{const c=t[l.id];c!=null?i.push(c):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const l in o.inputs){if(!(l in a))throw new Error(`Cannot backprop through input ${l}. Available gradients found: ${Object.keys(a)}.`);const c=n(()=>a[l]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${l} must have 'float32' dtype, but has '${c.dtype}'`);const u=o.inputs[l];if(!lt(c.shape,u.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${l}' has shape '${c.shape}', which does not match the shape of the input '${u.shape}'`);if(t[u.id]==null)t[u.id]=c;else{const d=t[u.id];t[u.id]=s(d,c),d.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U2=20,Hu=3,Bb=7;function _U(t,e,n,s){const r=Te(e),o=RU(t,e,n,r),i=e.length,a=Am(t,e,n,r,o),l=["Tensor"];return s&&(l.push(`  dtype: ${n}`),l.push(`  rank: ${i}`),l.push(`  shape: [${e}]`),l.push("  values:")),l.push(a.map(c=>"    "+c).join(`
`)),l.join(`
`)}function RU(t,e,n,s){const r=Z(e),o=s[s.length-1],i=new Array(o).fill(0),a=e.length,l=n==="complex64"?ud(t):t;if(a>1)for(let c=0;c<r/o;c++){const u=c*o;for(let d=0;d<o;d++)i[d]=Math.max(i[d],cd(l[u+d],0,n).length)}return i}function cd(t,e,n){let s;return Array.isArray(t)?s=`${parseFloat(t[0].toFixed(Bb))} + ${parseFloat(t[1].toFixed(Bb))}j`:Ph(t)?s=`'${t}'`:n==="bool"?s=HD(t):s=parseFloat(t.toFixed(Bb)).toString(),Ec(s,e)}function HD(t){return t===0?"false":"true"}function Am(t,e,n,s,r,o=!0){const i=n==="complex64"?2:1,a=e[0],l=e.length;if(l===0){if(n==="complex64"){const m=ud(t);return[cd(m[0],0,n)]}return n==="bool"?[HD(t[0])]:[t[0].toString()]}if(l===1){if(a>U2){const x=Hu*i;let g=Array.from(t.slice(0,x)),y=Array.from(t.slice((a-Hu)*i,a*i));return n==="complex64"&&(g=ud(g),y=ud(y)),["["+g.map((b,v)=>cd(b,r[v],n)).join(", ")+", ..., "+y.map((b,v)=>cd(b,r[a-Hu+v],n)).join(", ")+"]"]}return["["+(n==="complex64"?ud(t):Array.from(t)).map((x,g)=>cd(x,r[g],n)).join(", ")+"]"]}const c=e.slice(1),u=s.slice(1),d=s[0]*i,h=[];if(a>U2){for(let m=0;m<Hu;m++){const x=m*d,g=x+d;h.push(...Am(t.slice(x,g),c,n,u,r,!1))}h.push("...");for(let m=a-Hu;m<a;m++){const x=m*d,g=x+d;h.push(...Am(t.slice(x,g),c,n,u,r,m===a-1))}}else for(let m=0;m<a;m++){const x=m*d,g=x+d;h.push(...Am(t.slice(x,g),c,n,u,r,m===a-1))}const f=l===2?",":"";h[0]="["+(a>0?h[0]+f:"");for(let m=1;m<h.length-1;m++)h[m]=" "+h[m]+f;let p=`,
`;for(let m=2;m<l;m++)p+=`
`;return h[h.length-1]=" "+h[h.length-1]+"]"+(o?"":p),h}function ud(t){const e=[];for(let n=0;n<t.length;n+=2)e.push([t[n],t[n+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mn{constructor(e,n,s){if(this.dtype=n,this.shape=e.slice(),this.size=Z(e),s!=null){const r=s.length;T(r===this.size,()=>`Length of values '${r}' does not match the size inferred by the shape '${this.size}'.`)}if(n==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=s||Jt(n,this.size),this.strides=Te(e)}set(e,...n){n.length===0&&(n=[0]),T(n.length===this.rank,()=>`The number of provided coordinates (${n.length}) must match the rank (${this.rank})`);const s=this.locToIndex(n);this.values[s]=e}get(...e){e.length===0&&(e=[0]);let n=0;for(const r of e){if(r<0||r>=this.shape[n]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}n++}let s=e[e.length-1];for(let r=0;r<e.length-1;++r)s+=this.strides[r]*e[r];return this.values[s]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let n=e[e.length-1];for(let s=0;s<e.length-1;++s)n+=this.strides[s]*e[s];return n}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const n=new Array(this.shape.length);for(let s=0;s<n.length-1;++s)n[s]=Math.floor(e/this.strides[s]),e-=n[s]*this.strides[s];return n[n.length-1]=e,n}get rank(){return this.shape.length}toTensor(){return Xr().makeTensor(this.values,this.shape,this.dtype)}}let Xr=null,oc=null;function AU(t){Xr=t}function DU(t){oc=t}class xn{constructor(e,n,s,r){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=n||"float32",this.size=Z(e),this.strides=Te(e),this.dataId=s,this.id=r,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return oc.buffer(this.shape,this.dtype,e)}bufferSync(){return oc.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return eo(this.shape,e,this.dtype==="complex64")}arraySync(){return eo(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Xr().read(this.dataId);if(this.dtype==="string"){const n=await e;try{return n.map(s=>sa(s))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Xr().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Xr().readSync(this.dataId);if(this.dtype==="string")try{return e.map(n=>sa(n))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Xr().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(this.kerasMask&&this.kerasMask.dispose(),Xr().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return oc.print(this,e)}clone(){return this.throwIfDisposed(),oc.clone(this)}toString(e=!1){const n=this.dataSync();return _U(n,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),oc.cast(this,e)}variable(e=!0,n,s){return this.throwIfDisposed(),Xr().makeVariable(this,e,n,s)}}Object.defineProperty(xn,Symbol.hasInstance,{value:t=>!!t&&t.data!=null&&t.dataSync!=null&&t.throwIfDisposed!=null});function Q(){return Pk("Tensor",()=>xn)}Q();class wg extends xn{constructor(e,n,s,r){super(e.shape,e.dtype,e.dataId,r),this.trainable=n,this.name=s}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!lt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Xr().disposeTensor(this),this.dataId=e.dataId,Xr().incRef(this,null)}dispose(){Xr().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(wg,Symbol.hasInstance,{value:t=>t instanceof xn&&t.assign!=null&&t.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var H2;(function(t){t.R0="R0",t.R1="R1",t.R2="R2",t.R3="R3",t.R4="R4",t.R5="R5",t.R6="R6"})(H2||(H2={}));var Iv;(function(t){t.float32="float32",t.int32="int32",t.bool="int32",t.complex64="complex64"})(Iv||(Iv={}));var Tv;(function(t){t.float32="float32",t.int32="int32",t.bool="bool",t.complex64="complex64"})(Tv||(Tv={}));var Ev;(function(t){t.float32="float32",t.int32="float32",t.bool="float32",t.complex64="complex64"})(Ev||(Ev={}));var Nv;(function(t){t.float32="complex64",t.int32="complex64",t.bool="complex64",t.complex64="complex64"})(Nv||(Nv={}));const FU={float32:Ev,int32:Iv,bool:Tv,complex64:Nv};function Bs(t,e){if(t==="string"||e==="string"){if(t==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${t} with ${e}`)}return FU[t][e]}function $C(t){return Bs(t,"int32")}function GD(t){return t!=null&&typeof t=="object"&&"texture"in t&&t.texture instanceof WebGLTexture}function jD(t){return typeof GPUBuffer<"u"&&t!=null&&typeof t=="object"&&"buffer"in t&&t.buffer instanceof GPUBuffer}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nn(t,e){if(t.dtype===e.dtype)return[t,e];const n=Bs(t.dtype,e.dtype);return[t.cast(n),e.cast(n)]}function KD(t){const e=[];return XD(t,e,new Set),e}function XD(t,e,n){if(t==null)return;if(t instanceof xn){e.push(t);return}if(!OU(t))return;const s=t;for(const r in s){const o=s[r];n.has(o)||(n.add(o),XD(o,e,n))}}function OU(t){return Array.isArray(t)||typeof t=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vb(t){return t.kernelName!=null}class G2{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class Kc{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new G2}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n];if(await this.initializeBackend(s).success){await this.setBackend(s);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:n}=this.initializeBackendsAndReturnBest();if(n)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:n}=this.initializeBackend(e);if(n)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,n,s=1){return e in this.registryFactory?(Ks(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:n,priority:s},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:n,asyncInit:s}=this.initializeBackend(e);if(!(s?await n:n))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new $U(this.backendInstance),!0}setupRegisteredKernels(){P2(this.backendName).forEach(n=>{n.setupFunc!=null&&n.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){P2(e).forEach(s=>{s.disposeFunc!=null&&s.disposeFunc(this.registry[e])})}initializeBackend(e){const n=this.registryFactory[e];if(n==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const s=n.factory();if(s&&!(s instanceof Rk)&&typeof s.then=="function"){const r=++this.pendingBackendInitId,o=s.then(i=>r<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(r<this.pendingBackendInitId||(this.pendingBackendInit=null,Ks(`Initialization of backend ${e} failed`),Ks(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=s,{success:!0,asyncInit:!1}}catch(s){return Ks(`Initialization of backend ${e} failed`),Ks(s.stack||s.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,n)=>this.registryFactory[n].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let n=0;n<e.length;n++){const s=e[n],{success:r,asyncInit:o}=this.initializeBackend(s);if(o||r)return{name:s,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,n){const s=this.state.tensorInfo.get(n),r=s.backend,o=this.readSync(n),i=r.refCount(n);r.disposeData(n,!0),s.backend=e,e.move(n,o,s.shape,s.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,n){let s=null;if(n==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");n=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof n!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");s=e}let r;return this.scopedRun(()=>this.startScope(s),()=>this.endScope(r),()=>(r=n(),r instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),r))}scopedRun(e,n,s){e();try{const r=s();return n(),r}catch(r){throw n(),r}}nextTensorId(){return Kc.nextTensorId++}nextVariableId(){return Kc.nextVariableId++}clone(e){const n=W.runKernel(sf,{x:e}),s={x:e},r=i=>({x:()=>{const a="float32",l={x:i},c={dtype:a};return W.runKernel(Hh,l,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,s,[n],r,o,{}),n}runKernel(e,n,s){if(this.backendName==null&&this.backend,!(F2(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:n,attrs:s})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,n,s){const r=this.backend.numDataIds();let o=0;s.forEach(l=>{o+=l.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=r-n-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let n,s=[];const r=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let l;const c=Vb(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Vb(e)){const{kernelName:p,inputs:m,attrs:x}=e;this.backendName==null&&this.backend;const g=F2(p,this.backendName);T(g!=null,()=>`Cannot find registered kernel '${p}' for backend '${this.backendName}'`),a=()=>{const y=this.backend.numDataIds();l=g.kernelFunc({inputs:m,attrs:x,backend:this.backend});const b=Array.isArray(l)?l:[l];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(p,y,b);const v=b.map(w=>w.rank!=null?w:this.makeTensorFromTensorInfo(w));if(r){const w=this.getTensorsForGradient(p,m,v);s=this.saveTensorsForBackwardMode(w)}return v}}else{const{forwardFunc:p}=e,m=x=>{r&&(s=x.map(g=>this.keep(this.clone(g))))};a=()=>{const x=this.backend.numDataIds();l=this.tidy(()=>p(this.backend,m));const g=Array.isArray(l)?l:[l];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,x,g),g}}const{inputs:u,attrs:d}=e,h=Vb(e)?null:e.backwardsFunc;let f;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?n=a():(f=this.profiler.profileKernel(c,u,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(f),n=f.outputs)}),r&&this.addTapeNode(c,u,n,h,s,d),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(u).map(p=>u[p]!=null?u[p].shape:null),outputShapes:n.map(p=>p.shape),kernelTimeMs:f.timeMs,extraInfo:f.extraInfo}),Array.isArray(l)?n:n[0]}saveTensorsForBackwardMode(e){return e.map(s=>this.keep(this.clone(s)))}getTensorsForGradient(e,n,s){const r=O2(e);if(r!=null){const o=r.inputsToSave||[],i=r.outputsToSave||[];let a;r.saveAllInputs?(T(Array.isArray(n),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(n).map(c=>n[c])):a=o.map(c=>n[c]);const l=s.filter((c,u)=>i[u]);return a.concat(l)}return[]}makeTensor(e,n,s,r){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");s=s||"float32",r=r||this.backend;let o=e;s==="string"&&Ph(e[0])&&(o=e.map(l=>Yi(l)));const i=r.write(o,n,s),a=new xn(n,s,i,this.nextTensorId());if(this.trackTensor(a,r),s==="string"){const l=this.state.tensorInfo.get(i),c=nU(o);this.state.numBytes+=c-l.bytes,l.bytes=c}return a}makeTensorFromDataId(e,n,s,r){s=s||"float32";const o={dataId:e,shape:n,dtype:s};return this.makeTensorFromTensorInfo(o,r)}makeTensorFromTensorInfo(e,n){const{dataId:s,shape:r,dtype:o}=e,i=new xn(r,o,s,this.nextTensorId());return this.trackTensor(i,n),i}makeVariable(e,n=!0,s,r){s=s||this.nextVariableId().toString(),r!=null&&r!==e.dtype&&(e=e.cast(r));const o=new wg(e,n,s,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,n){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let s=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(s=e.size*gg(e.dtype)),this.state.numBytes+=s,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:n||this.backend,dtype:e.dtype,shape:e.shape,bytes:s})),e instanceof wg||this.track(e)}incRef(e,n){this.trackTensor(e,n),this.backend.incRef(e.dataId)}removeDataId(e,n){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===n&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const n=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=n.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const s=e.size*gg(e.dtype);this.state.numBytes-=s}n.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,n.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const n=this.state.registeredVariables[e];this.disposeVariable(n)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const n=this.state.numBytes,s=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(r=>r.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-n,this.state.activeProfile.newTensors=this.state.numTensors-s;for(const r of this.state.activeProfile.kernels)r.kernelTimeMs=await r.kernelTimeMs,r.extraInfo=await r.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,n,s,r,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:n,outputs:s,saved:o},l=O2(e);l!=null&&(r=l.gradFunc),r!=null&&(a.gradient=c=>(c=c.map((u,d)=>{if(u==null){const h=s[d],f=qn(h.size,h.dtype);return this.makeTensor(f,h.shape,h.dtype)}return u}),r(c.length>1?c:c[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const n={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(n.name=e),this.state.scopeStack.push(n),this.state.activeScope=n}endScope(e){const n=KD(e),s=new Set(n.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!s.has(i.id)&&i.dispose()}const r=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],n.forEach(o=>{!o.kept&&o.scopeId===r.id&&this.track(o)})}gradients(e,n,s,r=!1){if(T(n.length>0,()=>"gradients() received an empty list of xs."),s!=null&&s.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${s.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));T(o instanceof xn,()=>"The result y returned by f() must be a tensor.");const i=EU(this.state.activeTape,n,o);if(!r&&i.length===0&&n.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=s??PU(o.shape),NU(a,i,c=>this.tidy(c),MU);const l=n.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const u of c.saved)u.dispose()}),this.state.activeTape=null),{value:o,grads:l}})}customGrad(e){return T(bv(e),()=>"The f passed in customGrad(f) must be a function."),(...n)=>{T(n.every(a=>a instanceof xn),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let s;const r={};n.forEach((a,l)=>{r[l]=a});const o=(a,l)=>(s=e(...n,l),T(s.value instanceof xn,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),T(bv(s.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),s.value),i=(a,l)=>{const c=s.gradFunc(a,l),u=Array.isArray(c)?c:[c];T(u.length===n.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),T(u.every(h=>h instanceof xn),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const d={};return u.forEach((h,f)=>{d[f]=()=>h}),d};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:r})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,n){return this.state.tensorInfo.get(e).backend.readToGPU(e,n)}async time(e){const n=xs(),s=await this.backend.time(e);return s.wallMs=xs()-n,s}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new G2;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}Kc.nextTensorId=0;Kc.nextVariableId=0;function PU(t){const e=Fk(Z(t),"float32");return W.makeTensor(e,t,"float32")}function qD(){const t=dD();if(t._tfengine==null){const e=new oU(t);t._tfengine=new Kc(e)}return cU(t._tfengine.ENV),AU(()=>t._tfengine),t._tfengine}const W=qD();function MU(t,e){const n={a:t,b:e};return W.runKernel(gu,n)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LU(){return typeof navigator<"u"&&navigator!=null}function YD(t){if(t||LU()){if(t||(t=navigator),t.product==="ReactNative")return!0;const e=t.userAgent||t.vendor||(typeof window<"u"?window.opera:"");if(!e){const n=t;return n.userAgentData&&n.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function QD(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ks=K();ks.registerFlag("DEBUG",()=>!1,t=>{t&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});ks.registerFlag("IS_BROWSER",()=>QD());ks.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");ks.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));ks.registerFlag("IS_SAFARI",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Safari/.test(navigator.userAgent)&&/Apple/.test(navigator.vendor));ks.registerFlag("PROD",()=>!1);ks.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>ks.getBool("DEBUG"));ks.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);ks.registerFlag("IS_TEST",()=>!1);ks.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>ks.getBool("DEBUG"));ks.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);ks.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);ks.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dx(t,e){let n=t;if(Dr(t))return e==="string"?[]:[t.length];if(GD(t)){const r=t.channels||"RGBA";return[t.height,t.width*r.length]}else if(jD(t))return[t.buffer.size/(e==null?4:gg(e))];if(!Array.isArray(t))return[];const s=[];for(;Array.isArray(n)||Dr(n)&&e!=="string";)s.push(n.length),n=n[0];return Array.isArray(t)&&K().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&ZD(t,s,[]),s}function ZD(t,e,n){if(n=n||[],!Array.isArray(t)&&!Dr(t)){T(e.length===0,()=>`Element arr[${n.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}T(e.length>0,()=>`Element arr[${n.join("][")}] should be a primitive, but is an array of ${t.length} elements`),T(t.length===e[0],()=>`Element arr[${n.join("][")}] should have ${e[0]} elements, but has ${t.length} elements`);const s=e.slice(1);for(let r=0;r<t.length;++r)ZD(t[r],s,n.concat(r))}function j2(t,e,n,s){if(t!=="string_or_numeric"){if(t==null)throw new Error("Expected dtype cannot be null.");if(t!=="numeric"&&t!==e||t==="numeric"&&e==="string")throw new Error(`Argument '${n}' passed to '${s}' must be ${t} tensor, but got ${e} tensor`)}}function O(t,e,n,s="numeric"){if(t instanceof Q())return j2(s,t.dtype,e,n),t;let r=pu(t);if(r!=="string"&&["bool","int32","float32"].indexOf(s)>=0&&(r=s),j2(s,r,e,n),t==null||!Dr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string"){const l=t==null?"null":t.constructor.name;throw new Error(`Argument '${e}' passed to '${n}' must be a Tensor or TensorLike, but got '${l}'`)}const o=Dx(t,r);!Dr(t)&&!Array.isArray(t)&&(t=[t]);const a=r!=="string"?Fl(t,r):hl(t,[],!0);return W.makeTensor(a,o,r)}function JD(t,e,n,s="numeric"){if(!Array.isArray(t))throw new Error(`Argument ${e} passed to ${n} must be a \`Tensor[]\` or \`TensorLike[]\``);return t.map((o,i)=>O(o,`${e}[${i}]`,n,s))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zU="__op";function H(t){const e=Object.keys(t);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let n=e[0];const s=t[n];n.endsWith("_")&&(n=n.substring(0,n.length-1)),n=n+zU;const r=(...o)=>{W.startScope(n);try{const i=s(...o);return Ok(i)&&console.error("Cannot return a Promise inside of tidy."),W.endScope(i),i}catch(i){throw W.endScope(null),i}};return Object.defineProperty(r,"name",{value:n,configurable:!0}),r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BU(t,e){const n=O(t,"real","complex"),s=O(e,"imag","complex");Dk(n.shape,s.shape,`real and imag shapes, ${n.shape} and ${s.shape}, must match in call to tf.complex().`);const r={real:n,imag:s};return W.runKernel(Hk,r)}const Xc=H({complex_:BU});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(t,e,n,s){if(s==null)s=pu(t);else if(s==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(jD(t)||GD(t)){if(s!=="float32"&&s!=="int32")throw new Error(`Creating tensor from GPU data only supports 'float32'|'int32' dtype, while the dtype is ${s}.`);return W.backend.createTensorFromGPUData(t,e||n,s)}if(!Dr(t)&&!Array.isArray(t)&&typeof t!="number"&&typeof t!="boolean"&&typeof t!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){xi(e);const r=Z(e),o=Z(n);T(r===o,()=>`Based on the provided shape, [${e}], the tensor should have ${r} values but has ${o}`);for(let i=0;i<n.length;++i){const a=n[i],l=i===n.length-1?a!==Z(e.slice(i)):!0;T(n[i]===e[i]||!l,()=>`Error creating a new Tensor. Inferred shape (${n}) does not match the provided shape (${e}). `)}}return!Dr(t)&&!Array.isArray(t)&&(t=[t]),e=e||n,t=s!=="string"?Fl(t,s):hl(t,[],!0),W.makeTensor(t,e,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eF(t,e,n){const s=Dx(t,n);return Fx(t,e,s,n)}class xu{static join(e){return new xu(e).slice()}constructor(e){if(this.shards=[],this.previousShardIndex=0,e==null||(e instanceof Array||(e=[e]),e=e.map(s=>Dr(s)?s.buffer:s),e.length===0))return;this.bufferUniformSize=e[0].byteLength;let n=0;for(let s=0;s<e.length;s++){const r=e[s];s!==e.length-1&&r.byteLength!==this.bufferUniformSize&&(this.bufferUniformSize=void 0);const o=n+r.byteLength;this.shards.push({buffer:r,start:n,end:o}),n=o}this.shards.length===0&&(this.byteLength=0),this.byteLength=this.shards[this.shards.length-1].end}slice(e=0,n=this.byteLength){if(this.shards.length===0)return new ArrayBuffer(0);if(e=isNaN(Number(e))?0:e,n=isNaN(Number(n))?0:n,e=Math.max(0,e),n=Math.min(this.byteLength,n),n<=e)return new ArrayBuffer(0);const s=this.findShardForByte(e);if(s===-1)throw new Error(`Could not find start shard for byte ${e}`);const r=n-e,o=new ArrayBuffer(r),i=new Uint8Array(o);let a=0;for(let l=s;l<this.shards.length;l++){const c=this.shards[l],d=e+a-c.start,h=a,p=Math.min(n,c.end)-c.start,m=new Uint8Array(c.buffer,d,p-d);if(i.set(m,h),a+=m.length,n<c.end)break}return o}findShardForByte(e){if(this.shards.length===0||e<0||e>=this.byteLength)return-1;if(this.bufferUniformSize!=null)return this.previousShardIndex=Math.floor(e/this.bufferUniformSize),this.previousShardIndex;function n(r){return e<r.start?-1:e>=r.end?1:0}if(n(this.shards[this.previousShardIndex])===0)return this.previousShardIndex;const s=VU(this.shards,n);return s===-1?-1:(this.previousShardIndex=s,this.previousShardIndex)}}function VU(t,e){let n=0,s=t.length;for(;n<=s;){const r=Math.floor((s-n)/2)+n,o=e(t[r]);if(o===0)return r;o<0?s=r:n=r+1}return-1}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mo(){return W}function _v(){return W.memory()}function j(t,e){return W.tidy(t,e)}function Qe(t){KD(t).forEach(n=>n.dispose())}function No(t){return W.keep(t)}function tF(t,e,n=1){return W.registerBackend(t,e,n)}function WU(){return W.backend}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K2=4;async function X2(t,e){const n=[],s=[],r=Array.isArray(t)?t.map(i=>i.name):Object.keys(t);for(let i=0;i<r.length;++i){const a=r[i],l=Array.isArray(t)?t[i].tensor:t[a];if(l.dtype!=="float32"&&l.dtype!=="int32"&&l.dtype!=="bool"&&l.dtype!=="string"&&l.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${l.dtype}`);const c={name:a,shape:l.shape,dtype:l.dtype};if(l.dtype==="string"){const u=new Promise(async d=>{const h=await l.bytes(),f=h.reduce((x,g)=>x+g.length,0)+K2*h.length,p=new Uint8Array(f);let m=0;for(let x=0;x<h.length;x++){const g=h[x],y=new Uint8Array(new Uint32Array([g.length]).buffer);p.set(y,m),m+=K2,p.set(g,m),m+=g.length}d(p)});s.push(u)}else s.push(l.data());e!=null&&(c.group=e),n.push(c)}const o=await Promise.all(s);return{data:UU(o),specs:n}}function UU(t){if(t===null)throw new Error(`Invalid input value: ${JSON.stringify(t)}`);let e=0;const n=[];t.forEach(o=>{if(e+=o.byteLength,n.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const s=new Uint8Array(e);let r=0;return n.forEach(o=>{s.set(new Uint8Array(o.buffer),r),r+=o.byteLength}),s.buffer}const IC=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function q2(t){return IC?Buffer.byteLength(t,"utf8"):new Blob([t]).size}function HU(t){if(IC)return Buffer.from(t).toString("base64");const e=new Uint8Array(t);let n="";for(let s=0,r=e.length;s<r;s++)n+=String.fromCharCode(e[s]);return btoa(n)}function GU(t){if(IC){const s=Buffer.from(t,"base64");return s.buffer.slice(s.byteOffset,s.byteOffset+s.byteLength)}const e=atob(t),n=new Uint8Array(e.length);for(let s=0;s<e.length;++s)n.set([e.charCodeAt(s)],s);return n.buffer}function jU(t){return xu.join(t)}function nF(t){if(t.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:t.modelTopology==null?0:q2(JSON.stringify(t.modelTopology)),weightSpecsBytes:t.weightSpecs==null?0:q2(JSON.stringify(t.weightSpecs)),weightDataBytes:t.weightData==null?0:new xu(t.weightData).byteLength}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rs{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return rs.instance==null&&(rs.instance=new rs),rs.instance}static registerSaveRouter(e){rs.getInstance().saveRouters.push(e)}static registerLoadRouter(e){rs.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return rs.getHandlers(e,"save")}static getLoadHandlers(e,n){return rs.getHandlers(e,"load",n)}static getHandlers(e,n,s){const r=[];return(n==="load"?rs.getInstance().loadRouters:rs.getInstance().saveRouters).forEach(i=>{const a=i(e,s);a!==null&&r.push(a)}),r}}const KU=t=>rs.getSaveHandlers(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rv="tensorflowjs",Av=1,Ka="models_store",Fi="model_info_store";function sF(){if(!K().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const t=typeof window>"u"?self:window,e=t.indexedDB||t.mozIndexedDB||t.webkitIndexedDB||t.msIndexedDB||t.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function Dv(t){const e=t.result;e.createObjectStore(Ka,{keyPath:"modelPath"}),e.createObjectStore(Fi,{keyPath:"modelPath"})}class fl{constructor(e){if(this.indexedDB=sF(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,n){return new Promise((s,r)=>{const o=this.indexedDB.open(Rv,Av);o.onupgradeneeded=()=>Dv(o),o.onsuccess=()=>{const i=o.result;if(n==null){const a=i.transaction(Ka,"readonly"),c=a.objectStore(Ka).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),r(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));s(c.result.modelArtifacts)},c.onerror=u=>(i.close(),r(c.error)),a.oncomplete=()=>i.close()}else{n.weightData=xu.join(n.weightData);const a=nF(n),l=i.transaction(Fi,"readwrite");let c=l.objectStore(Fi),u;try{u=c.put({modelPath:this.modelPath,modelArtifactsInfo:a})}catch(h){return r(h)}let d;u.onsuccess=()=>{d=i.transaction(Ka,"readwrite");const h=d.objectStore(Ka);let f;try{f=h.put({modelPath:this.modelPath,modelArtifacts:n,modelArtifactsInfo:a})}catch(p){return r(p)}f.onsuccess=()=>s({modelArtifactsInfo:a}),f.onerror=p=>{c=l.objectStore(Fi);const m=c.delete(this.modelPath);m.onsuccess=()=>(i.close(),r(f.error)),m.onerror=x=>(i.close(),r(f.error))}},u.onerror=h=>(i.close(),r(u.error)),l.oncomplete=()=>{d==null?i.close():d.oncomplete=()=>i.close()}}},o.onerror=i=>r(o.error)})}}fl.URL_SCHEME="indexeddb://";const rF=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(fl.URL_SCHEME)?XU(t.slice(fl.URL_SCHEME.length)):null;rs.registerSaveRouter(rF);rs.registerLoadRouter(rF);function XU(t){return new fl(t)}function qU(t){return t.startsWith(fl.URL_SCHEME)?t.slice(fl.URL_SCHEME.length):t}class YU{constructor(){this.indexedDB=sF()}async listModels(){return new Promise((e,n)=>{const s=this.indexedDB.open(Rv,Av);s.onupgradeneeded=()=>Dv(s),s.onsuccess=()=>{const r=s.result,o=r.transaction(Fi,"readonly"),a=o.objectStore(Fi).getAll();a.onsuccess=()=>{const l={};for(const c of a.result)l[c.modelPath]=c.modelArtifactsInfo;e(l)},a.onerror=l=>(r.close(),n(a.error)),o.oncomplete=()=>r.close()},s.onerror=r=>n(s.error)})}async removeModel(e){return e=qU(e),new Promise((n,s)=>{const r=this.indexedDB.open(Rv,Av);r.onupgradeneeded=()=>Dv(r),r.onsuccess=()=>{const o=r.result,i=o.transaction(Fi,"readwrite"),a=i.objectStore(Fi),l=a.get(e);let c;l.onsuccess=()=>{if(l.result==null)return o.close(),s(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const u=a.delete(e),d=()=>{c=o.transaction(Ka,"readwrite");const f=c.objectStore(Ka).delete(e);f.onsuccess=()=>n(l.result.modelArtifactsInfo),f.onerror=p=>s(l.error)};u.onsuccess=d,u.onerror=h=>(d(),o.close(),s(l.error))}},l.onerror=u=>(o.close(),s(l.error)),i.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},r.onerror=o=>s(r.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qo="/",ic="tensorflowjs_models",oF="info",QU="model_topology",ZU="weight_specs",JU="weight_data",e5="model_metadata";function iF(t){return{info:[ic,t,oF].join(Qo),topology:[ic,t,QU].join(Qo),weightSpecs:[ic,t,ZU].join(Qo),weightData:[ic,t,JU].join(Qo),modelMetadata:[ic,t,e5].join(Qo)}}function aF(t){for(const e of Object.values(t))window.localStorage.removeItem(e)}function t5(t){const e=t.split(Qo);if(e.length<3)throw new Error(`Invalid key format: ${t}`);return e.slice(1,e.length-1).join(Qo)}function n5(t){return t.startsWith(pl.URL_SCHEME)?t.slice(pl.URL_SCHEME.length):t}class pl{constructor(e){if(!K().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=iF(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const n=JSON.stringify(e.modelTopology),s=JSON.stringify(e.weightSpecs),r=nF(e),o=xu.join(e.weightData);try{this.LS.setItem(this.keys.info,JSON.stringify(r)),this.LS.setItem(this.keys.topology,n),this.LS.setItem(this.keys.weightSpecs,s),this.LS.setItem(this.keys.weightData,HU(o));const i={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,initializerSignature:e.initializerSignature!=null?e.initializerSignature:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(i)),{modelArtifactsInfo:r}}catch{throw aF(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${r.modelTopologyBytes}, weightSpecsBytes=${r.weightSpecsBytes}, weightDataBytes=${r.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const n={},s=JSON.parse(this.LS.getItem(this.keys.topology));if(s==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);n.modelTopology=s;const r=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(r==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);n.weightSpecs=r;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);n.format=a.format,n.generatedBy=a.generatedBy,n.convertedBy=a.convertedBy,a.signature!=null&&(n.signature=a.signature),a.userDefinedMetadata!=null&&(n.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(n.modelInitializer=a.modelInitializer),a.initializerSignature!=null&&(n.initializerSignature=a.initializerSignature),a.trainingConfig!=null&&(n.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return n.weightData=GU(i),n}}pl.URL_SCHEME="localstorage://";const lF=t=>K().getBool("IS_BROWSER")&&!Array.isArray(t)&&t.startsWith(pl.URL_SCHEME)?s5(t.slice(pl.URL_SCHEME.length)):null;rs.registerSaveRouter(lF);rs.registerLoadRouter(lF);function s5(t){return new pl(t)}class r5{constructor(){T(K().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),T(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},n=ic+Qo,s=Qo+oF;for(let r=0;r<this.LS.length;++r){const o=this.LS.key(r);if(o.startsWith(n)&&o.endsWith(s)){const i=t5(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=n5(e);const n=iF(e);if(this.LS.getItem(n.info)==null)throw new Error(`Cannot find model at path '${e}'`);const s=JSON.parse(this.LS.getItem(n.info));return aF(n),s}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y2="://";class xo{constructor(){this.managers={}}static getInstance(){return xo.instance==null&&(xo.instance=new xo),xo.instance}static registerManager(e,n){T(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(Y2)&&(e=e.slice(0,e.indexOf(Y2))),T(e.length>0,()=>"scheme must not be an empty string.");const s=xo.getInstance();T(s.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),s.managers[e]=n}static getManager(e){const n=xo.getInstance().managers[e];if(n==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return n}static getSchemes(){return Object.keys(xo.getInstance().managers)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class o5{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,n){return fetch(e,n)}now(){return performance.now()}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${n}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,n){return new TextDecoder(n).decode(e)}setTimeoutCustom(e,n){if(typeof window>"u"||!K().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,n);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},n),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",s=>{if(s.source===window&&s.data.name===this.messageName){s.stopPropagation();const r=this.functionRefs[s.data.index];r(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}isTypedArray(e){return OD(e)}}if(K().get("IS_BROWSER")){K().setPlatform("browser",new o5);try{xo.registerManager(pl.URL_SCHEME,new r5)}catch{}try{xo.registerManager(fl.URL_SCHEME,new YU)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i5={importFetch:()=>require("node-fetch")};let Wb;class a5{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,n){return K().global.fetch!=null?K().global.fetch(e,n):(Wb==null&&(Wb=i5.importFetch()),Wb(e,n))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,n){if(n!=="utf-8"&&n!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${n}`);return this.textEncoder.encode(e)}decode(e,n){return e.length===0?"":new this.util.TextDecoder(n).decode(e)}isTypedArray(e){return this.util.types.isFloat32Array(e)||this.util.types.isInt32Array(e)||this.util.types.isUint8Array(e)||this.util.types.isUint8ClampedArray(e)}}K().get("IS_NODE")&&!K().get("IS_BROWSER")&&K().setPlatform("node",new a5);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ge(t,e="float32",n){return e=e||"float32",xi(t),new Mn(t,e,n)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l5(t,e){const n=O(t,"x","cast");if(!tU(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&n.dtype!=="string"||e!=="string"&&n.dtype==="string")throw new Error("Only strings can be casted to strings");const s={x:n},r={dtype:e};return W.runKernel(Hh,s,r)}const ve=H({cast_:l5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(t){const n={x:O(t,"x","clone","string_or_numeric")};return W.runKernel(sf,n)}const el=H({clone_:c5});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u5(t,e=!1){console.log(t.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */qD();const d5={buffer:Ge,cast:ve,clone:el,print:u5};DU(d5);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(t,e){let n=O(t,"a","add"),s=O(e,"b","add");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(gu,r)}const ie=H({add_:h5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f5(t,e){let n=O(t,"a","floorDiv"),s=O(e,"b","floorDiv");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(tf,r)}const cF=H({floorDiv_:f5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p5(t,e){let n=O(t,"a","div"),s=O(e,"b","div");if([n,s]=nn(n,s),n.dtype==="int32"&&s.dtype==="int32")return cF(n,s);const r={a:n,b:s},o={};return W.runKernel(qh,r,o)}const Ne=H({div_:p5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(t,e){let n=O(t,"a","mul"),s=O(e,"b","mul");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(ff,r)}const V=H({mul_:m5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g5(t){const e=O(t,"x","abs");if(e.dtype==="complex64"){const n={x:e};return W.runKernel(z0,n)}else{const n={x:e};return W.runKernel(A0,n)}}const os=H({abs_:g5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(t){const n={x:O(t,"x","acos")};return W.runKernel(Mh,n)}const y5=H({acos_:x5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b5(t){const n={x:O(t,"x","acosh")};return W.runKernel(Lh,n)}const v5=H({acosh_:b5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(t,e=null,n=!1){const r={x:O(t,"x","all","bool")},o={axis:e,keepDims:n};return W.runKernel(Lk,r,o)}const uF=H({all_:w5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k5(t,e=null,n=!1){const r={x:O(t,"x","any","bool")},o={axis:e,keepDims:n};return W.runKernel(zk,r,o)}const Fv=H({any_:k5});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C5(t,e=0){const s={x:O(t,"x","argMax")},r={axis:e};return W.runKernel(D0,s,r)}const ah=H({argMax_:C5});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5(t,e=0){const s={x:O(t,"x","argMin")},r={axis:e};return W.runKernel(F0,s,r)}const $5=H({argMin_:S5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(t){const n={x:O(t,"x","asin")};return W.runKernel(zh,n)}const T5=H({asin_:I5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E5(t){const n={x:O(t,"x","asinh")};return W.runKernel(Bh,n)}const N5=H({asinh_:E5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _5(t){const n={x:O(t,"x","atan")};return W.runKernel(Vh,n)}const R5=H({atan_:_5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A5(t,e){let n=O(t,"a","atan2"),s=O(e,"b","atan2");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(Uh,r)}const D5=H({atan2_:A5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F5(t){const n={x:O(t,"x","atanh")};return W.runKernel(Wh,n)}const O5=H({atanh_:F5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Df(t,e,n,s,r="NHWC",o){const i=t[3],a=[...e,i],l=bi(r);return Ln(t,a,n,o,s,null,null,l)}function Pr(t,e,n,s,r,o,i="channelsLast"){const[a,l]=lh(e);let c;if(i==="channelsLast")c=[a,l,t[3],t[3]];else if(i==="channelsFirst")c=[a,l,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return Ln(t,c,n,s,r,o,!1,i)}function yi(t,e,n,s,r,o,i="NDHWC"){const[a,l,c]=Ov(e);let u,d;if(i==="NDHWC")d="channelsLast",u=[a,l,c,t[4],t[4]];else if(i==="NCDHW")d="channelsFirst",u=[a,l,c,t[1],t[1]];else throw new Error(`Unknown dataFormat ${i}`);return ga(t,u,n,s,r,!1,d,o)}function Ln(t,e,n,s,r,o,i=!1,a="channelsLast"){let[l,c,u,d]=[-1,-1,-1,-1];if(a==="channelsLast")[l,c,u,d]=t;else if(a==="channelsFirst")[l,d,c,u]=t;else throw new Error(`Unknown dataFormat ${a}`);const[h,f,,p]=e,[m,x]=lh(n),[g,y]=lh(s),b=_c(h,g),v=_c(f,y),{padInfo:w,outHeight:k,outWidth:C}=L5(r,c,u,m,x,b,v,o,a),S=i?p*d:p;let I;return a==="channelsFirst"?I=[l,S,k,C]:a==="channelsLast"&&(I=[l,k,C,S]),{batchSize:l,dataFormat:a,inHeight:c,inWidth:u,inChannels:d,outHeight:k,outWidth:C,outChannels:S,padInfo:w,strideHeight:m,strideWidth:x,filterHeight:h,filterWidth:f,effectiveFilterHeight:b,effectiveFilterWidth:v,dilationHeight:g,dilationWidth:y,inShape:t,outShape:I,filterShape:e}}function ga(t,e,n,s,r,o=!1,i="channelsLast",a){let[l,c,u,d,h]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[l,c,u,d,h]=t;else if(i==="channelsFirst")[l,h,c,u,d]=t;else throw new Error(`Unknown dataFormat ${i}`);const[f,p,m,,x]=e,[g,y,b]=Ov(n),[v,w,k]=Ov(s),C=_c(f,v),S=_c(p,w),I=_c(m,k),{padInfo:$,outDepth:E,outHeight:_,outWidth:D}=z5(r,c,u,d,g,y,b,C,S,I,a),F=o?x*h:x;let R;return i==="channelsFirst"?R=[l,F,E,_,D]:i==="channelsLast"&&(R=[l,E,_,D,F]),{batchSize:l,dataFormat:i,inDepth:c,inHeight:u,inWidth:d,inChannels:h,outDepth:E,outHeight:_,outWidth:D,outChannels:F,padInfo:$,strideDepth:g,strideHeight:y,strideWidth:b,filterDepth:f,filterHeight:p,filterWidth:m,effectiveFilterDepth:C,effectiveFilterHeight:S,effectiveFilterWidth:I,dilationDepth:v,dilationHeight:w,dilationWidth:k,inShape:t,outShape:R,filterShape:e}}function P5(t,e,n,s,r){s==null&&(s=TC(t,e,n));const o=t[0],i=t[1],a=ch((o-e+2*s)/n+1,r),l=ch((i-e+2*s)/n+1,r);return[a,l]}function M5(t,e,n,s,r,o){r==null&&(r=TC(t,e[0],s[0]));const i=[0,0,0,n];for(let a=0;a<3;a++)t[a]+2*r>=e[a]&&(i[a]=ch((t[a]-e[a]+2*r)/s[a]+1,o));return i}function TC(t,e,n,s=1){const r=_c(e,s);return Math.floor((t[0]*(n-1)-n+r)/2)}function lh(t){return typeof t=="number"?[t,t,t]:t.length===2?[t[0],t[1],1]:t}function Ov(t){return typeof t=="number"?[t,t,t]:t}function _c(t,e){return e<=1?t:t+(t-1)*(e-1)}function L5(t,e,n,s,r,o,i,a,l){let c,u,d;if(typeof t=="number"){c={top:t,bottom:t,left:t,right:t,type:t===0?"VALID":"NUMBER"};const f=P5([e,n],o,s,t,a);u=f[0],d=f[1]}else if(t==="same"){u=Math.ceil(e/s),d=Math.ceil(n/r);const h=Math.max(0,(u-1)*s+o-e),f=Math.max(0,(d-1)*r+i-n),p=Math.floor(h/2),m=h-p,x=Math.floor(f/2),g=f-x;c={top:p,bottom:m,left:x,right:g,type:"SAME"}}else if(t==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},u=Math.ceil((e-o+1)/s),d=Math.ceil((n-i+1)/r);else if(typeof t=="object"){const h=l==="channelsLast"?t[1][0]:t[2][0],f=l==="channelsLast"?t[1][1]:t[2][1],p=l==="channelsLast"?t[2][0]:t[3][0],m=l==="channelsLast"?t[2][1]:t[3][1];c={top:h,bottom:f,left:p,right:m,type:h===0&&f===0&&p===0&&m===0?"VALID":"EXPLICIT"},u=ch((e-o+h+f)/s+1,a),d=ch((n-i+p+m)/r+1,a)}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:c,outHeight:u,outWidth:d}}function z5(t,e,n,s,r,o,i,a,l,c,u){let d,h,f,p;if(t==="valid"&&(t=0),typeof t=="number"){d={top:t,bottom:t,left:t,right:t,front:t,back:t,type:t===0?"VALID":"NUMBER"};const x=M5([e,n,s,1],[a,l,c],1,[r,o,i],t,u);h=x[0],f=x[1],p=x[2]}else if(t==="same"){h=Math.ceil(e/r),f=Math.ceil(n/o),p=Math.ceil(s/i);const m=(h-1)*r+a-e,x=(f-1)*o+l-n,g=(p-1)*i+c-s,y=Math.floor(m/2),b=m-y,v=Math.floor(x/2),w=x-v,k=Math.floor(g/2),C=g-k;d={top:v,bottom:w,left:k,right:C,front:y,back:b,type:"SAME"}}else throw Error(`Unknown padding parameter: ${t}`);return{padInfo:d,outDepth:h,outHeight:f,outWidth:p}}function ch(t,e){if(!e)return Math.trunc(t);switch(e){case"round":return Math.round(t);case"ceil":return Math.ceil(t);case"floor":return Math.floor(t);default:throw new Error(`Unknown roundingMode ${e}`)}}function ml(t){const[e,n,s]=lh(t);return e===1&&n===1&&s===1}function Qn(t,e){return ml(t)||ml(e)}function gl(t){return lh(t).every(e=>e>0)}function bi(t){if(t==="NHWC")return"channelsLast";if(t==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${t}`)}function Is(t,e,n){if(n!=null){if(typeof e=="string")throw Error(`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);if(typeof e=="number")T(Gc(e),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${e}.`);else if(typeof e=="object")e.forEach(s=>{s.forEach(r=>{T(Gc(r),()=>`Error in ${t}: pad must be an integer when using dimRoundingMode ${n} but got pad ${r}.`)})});else throw Error(`Error in ${t}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B5(t,e){const s={x:O(t,"x","reshape","string_or_numeric")},r={shape:e};return W.runKernel(bx,s,r)}const U=H({reshape_:B5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V5(t,e,n,s,r){const o=O(t,"x","avgPool","float32"),i=1;T(Qn(n,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`);let a=o,l=!1;o.rank===3&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),Is("avgPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r};let d=W.runKernel(O0,c,u);return d=ve(d,o.dtype),l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const EC=H({avgPool_:V5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W5(t,e,n,s,r,o="NDHWC"){const i=O(t,"x","avgPool3d","float32");let a=i,l=!1;i.rank===4&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),T(typeof n=="number"&&n>0||Array.isArray(n)&&n[0]>0&&n[1]>0&&n[2]>0,()=>`Error in avgPool3d: Stride must be > 0, but got '${n}'`),Is("avgPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o};let d=W.runKernel(P0,c,u);return d=ve(d,a.dtype),l?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const U5=H({avgPool3d_:W5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H5(t,e=0){T(t.length>=1,()=>"Pass at least one tensor to concat");const n=JD(t,"tensors","concat","string_or_numeric");if(n[0].dtype==="complex64"&&n.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),n.length===1)return el(n[0]);const s=n,r={axis:e};return W.runKernel(B0,s,r)}const ws=H({concat_:H5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G5(t,e,n=!1,s=!1){let r=O(t,"a","matMul"),o=O(e,"b","matMul");[r,o]=nn(r,o);const i={a:r,b:o},a={transposeA:n,transposeB:s};return W.runKernel(M0,i,a)}const it=H({matMul_:G5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j5(t){const n={x:O(t,"x","sigmoid","float32")};return W.runKernel(Sf,n)}const yu=H({sigmoid_:j5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K5(t,e,n){const s=O(t,"x","slice","string_or_numeric");if(s.rank===0)throw new Error("Slicing scalar is not possible");const r={x:s},o={begin:e,size:n};return W.runKernel(Sx,r,o)}const Ct=H({slice_:K5});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X5(t){const n={x:O(t,"x","tanh","float32")};return W.runKernel(_f,n)}const Ox=H({tanh_:X5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q5(t,e,n){const s=O(t,"x","batchToSpaceND"),r=e.reduce((a,l)=>a*l);T(s.rank>=1+e.length,()=>`input rank is ${s.rank} but should be > than blockShape.length ${e.length}`),T(n.length===e.length,()=>`crops.length is ${n.length} but should be equal to blockShape.length  ${e.length}`),T(s.shape[0]%r===0,()=>`input tensor batch is ${s.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${r}`);const o={x:s},i={blockShape:e,crops:n};return W.runKernel(L0,o,i)}const NC=H({batchToSpaceND_:q5});function Y5(t){let e;return t.rank===0||t.rank===1?e=U(t,[1,1,1,t.size]):t.rank===2?e=U(t,[1,1,t.shape[0],t.shape[1]]):t.rank===3?e=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]):e=t,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q5(t,e,n,s,r,o){o==null&&(o=.001);const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;s!=null&&(u=O(s,"offset","batchNorm")),T(a.rank===l.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(u==null||a.rank===u.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const h={x:Y5(i),scale:c,offset:u,mean:a,variance:l},f={varianceEpsilon:o},p=W.runKernel(q0,h,f);return U(p,i.shape)}const Px=H({batchNorm_:Q5});function Z5(t,e,n,s,r,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;return s!=null&&(u=O(s,"offset","batchNorm")),T(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),T(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),T(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${u.rank}.`),Px(i,a,l,u,c,o)}const J5=H({batchNorm2d_:Z5});function eH(t,e,n,s,r,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;return s!=null&&(u=O(s,"offset","batchNorm")),T(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),T(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),T(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${u.rank}.`),Px(i,a,l,u,c,o)}const tH=H({batchNorm3d_:eH});function nH(t,e,n,s,r,o){const i=O(t,"x","batchNorm"),a=O(e,"mean","batchNorm"),l=O(n,"variance","batchNorm");let c;r!=null&&(c=O(r,"scale","batchNorm"));let u;return s!=null&&(u=O(s,"offset","batchNorm")),T(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),T(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),T(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${l.rank}.`),c!=null&&T(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),u!=null&&T(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${u.rank}.`),Px(i,a,l,u,c,o)}const sH=H({batchNorm4d_:nH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rH(t,e,n){const s=O(t,"x","bincount"),r=O(e,"weights","bincount");T(s.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${s.dtype}`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(r.size===s.size||r.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${s.shape}, weights shape: ${r.shape}.`);const o={x:s,weights:r},i={size:n};return W.runKernel(Wk,o,i)}const oH=H({bincount_:rH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iH(t,e){let n=O(t,"broadcastTo","x");const s=n.shape;if(xi(e),e.length<n.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${n.rank}.`);if(e.length>n.rank){const c=n.shape.slice();for(;c.length<e.length;)c.unshift(1);n=U(n,c)}const r=n.shape,o=Array.from(e);for(let c=e.length-1;c>=0;c--)if(r[c]===e[c])o[c]=1;else if(n.shape[c]!==1)throw new Error(`broadcastTo(): [${s}] cannot be broadcast to [${e}].`);if(o.map((c,u)=>c>1?u:-1).filter(c=>c>=0).length===0)return el(n);const a={x:n},l={reps:o};return W.runKernel(Rf,a,l)}const Dd=H({broadcastTo_:iH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aH(t){const n={x:O(t,"x","ceil","float32")};return W.runKernel(Gh,n)}const lH=H({ceil_:aH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mx(t,e,n){xi(t),n=n||pu(e);const s={shape:t,value:e,dtype:n};return W.runKernel(sC,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cH(t,e,n){const s=O(t,"x","clipByValue");if(T(e<=n,()=>`Error in clip: min (${e}) must be less than or equal to max (${n}).`),e===n)return Mx(s.shape,e,s.dtype);const r={x:s},o={clipValueMin:e,clipValueMax:n};return W.runKernel(jh,r,o)}const sr=H({clipByValue_:cH});function uH(t){return ws(t,0)}const dH=H({concat1d_:uH});function hH(t,e){return ws(t,e)}const fH=H({concat2d_:hH});function pH(t,e){return ws(t,e)}const mH=H({concat3d_:pH});function gH(t,e){return ws(t,e)}const xH=H({concat4d_:gH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yH(t,e,n,s,r="NHWC",o=[1,1],i){const a=O(t,"x","conv2d","float32"),l=O(e,"filter","conv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${l.rank}.`),Is("conv2d",s,i);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in conv2d: depth of input (${d}) must match input depth for filter ${l.shape[2]}.`),T(Qn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(gl(o),()=>"Error in conv2D: Dilated rates should be larger than 0."),T(gl(n),()=>"Error in conv2D: Strides should be larger than 0.");const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=W.runKernel(V0,h,f);return u?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const xl=H({conv2d_:yH});function bH(t,e,n,s,r="NWC",o=1,i){const a=O(t,"x","conv1d"),l=O(e,"filter","conv1d");let c=a,u=!1;a.rank===2&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1]])),T(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),T(l.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${l.rank}.`),Is("conv1d",s,i),T(c.shape[2]===l.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${l.shape[1]}.`),T(Qn(n,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${n} and dilation '${o}'`),T(gl(o),()=>"Error in conv1D: Dilated rates should be larger than 0."),T(gl(n),()=>"Error in conv1D: Stride should be larger than 0."),T(r==="NWC",()=>`Error in conv1d: got dataFormat of ${r} but only NWC is currently supported.`);const d=U(l,[1,l.shape[0],l.shape[1],l.shape[2]]),h=U(c,[c.shape[0],1,c.shape[1],c.shape[2]]),x=xl(h,d,[1,n],s,"NHWC",[1,o],i);return u?U(x,[x.shape[2],x.shape[3]]):U(x,[x.shape[0],x.shape[2],x.shape[3]])}const dF=H({conv1d_:bH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vH(t,e,n,s,r,o="NHWC",i){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let a=t,l=e,c=!1;e.rank===3&&(c=!0,l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,t[0],t[1],t[2]]),T(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),T(l.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${l.rank}`),T(n.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${n.rank}`);const u=o==="NHWC"?a[3]:a[1],d=o==="NHWC"?l.shape[3]:l.shape[1];T(u===n.shape[2],()=>`Error in conv2dDerInput: depth of input (${u}) must match input depth for filter ${n.shape[2]}.`),T(d===n.shape[3],()=>`Error in conv2dDerInput: depth of output (${d}) must match output depth for filter ${n.shape[3]}.`),Is("conv2dDerInput",r,i);const h={dy:l,filter:n},f={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,inputShape:a},p=W.runKernel(W0,h,f);return c?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const _C=H({conv2DBackpropInput_:vH});function wH(t,e,n,s,r,o){const i=O(t,"x","conv2dTranspose"),a=O(e,"filter","conv2dTranspose");return _C(n,i,a,s,r,"NHWC",o)}const hF=H({conv2dTranspose_:wH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kH(t,e,n,s,r="NDHWC",o=[1,1,1]){const i=O(t,"x","conv3d"),a=O(e,"filter","conv3d");let l=i,c=!1;i.rank===4&&(c=!0,l=U(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(l.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${l.rank}.`),T(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),T(l.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${l.shape[4]}) must match input depth for filter ${a.shape[3]}.`),T(Qn(n,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`),T(r==="NDHWC",()=>`Error in conv3d: got dataFormat of ${r} but only NDHWC is currently supported.`),T(gl(o),()=>"Error in conv3D: Dilated rates should be larger than 0."),T(gl(n),()=>"Error in conv3D: Strides should be larger than 0.");const u={x:l,filter:a},d={strides:n,pad:s,dataFormat:r,dilations:o},h=W.runKernel(U0,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const CH=H({conv3d_:kH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SH(t,e,n,s,r){T(t.length===e.rank,()=>`Length of inShape (${t.length}) and rank of dy (${e.rank}) must match`);let o=t,i=e,a=!1;e.rank===4&&(a=!0,i=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,t[0],t[1],t[2],t[3]]);const l=o[4],c=i.shape[4];T(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),T(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),T(n.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${n.rank}`),T(l===n.shape[3],()=>`Error in conv3dDerInput: depth of input (${l}) must match input depth for filter ${n.shape[3]}.`),T(c===n.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${n.shape[4]}.`);const u={dy:i,filter:n},d={pad:r,strides:s,inputShape:o},h=W.runKernel(Kk,u,d);return a?U(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const fF=H({conv3DBackpropInput_:SH});function $H(t,e,n,s,r){const o=O(t,"x","conv3dTranspose"),i=O(e,"filter","conv3dTranspose");return fF(n,o,i,s,r)}const IH=H({conv3dTranspose_:$H});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TH(t){const n={x:O(t,"x","cos","float32")};return W.runKernel(Kh,n)}const RC=H({cos_:TH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EH(t){const n={x:O(t,"x","cosh","float32")};return W.runKernel(Xh,n)}const pF=H({cosh_:EH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NH(t,e=0,n=!1,s=!1){const o={x:O(t,"x","cumprod")},i={axis:e,exclusive:n,reverse:s};return W.runKernel(Xk,o,i)}const Pv=H({cumprod_:NH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _H(t,e=0,n=!1,s=!1){const o={x:O(t,"x","cumsum")},i={axis:e,exclusive:n,reverse:s};return W.runKernel(H0,o,i)}const mF=H({cumsum_:_H});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RH(t,e,n,s=!1){const r=O(t,"x","denseBincount"),o=O(e,"weights","denseBincount");T(r.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${r.dtype}`),T(r.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${r.rank}.`),T(n>=0,()=>`size must be non-negative, but got ${n}.`),T(o.size===r.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${r.shape}, weights shape: ${o.shape}.`);const i={x:r,weights:o},a={size:n,binaryOutput:s};return W.runKernel(Yk,i,a)}const Q2=H({denseBincount_:RH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AH(t,e,n="NHWC"){const s=O(t,"x","depthToSpace","float32"),r=n==="NHWC"?s.shape[1]:s.shape[2],o=n==="NHWC"?s.shape[2]:s.shape[3],i=n==="NHWC"?s.shape[3]:s.shape[1];T(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),T(r*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${r} and ${e}  for depthToSpace with input shape
    ${s.shape}`),T(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${s.shape}`),T(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${s.shape}`);const a={x:s},l={blockSize:e,dataFormat:n};return W.runKernel(Qk,a,l)}const DH=H({depthToSpace_:AH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FH(t,e,n,s,r="NHWC",o=[1,1],i){const a=O(t,"x","depthwiseConv2d","float32"),l=O(e,"filter","depthwiseConv2d","float32");let c=a,u=!1;a.rank===3&&(u=!0,c=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),T(l.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${l.rank}.`);const d=r==="NHWC"?c.shape[3]:c.shape[1];T(d===l.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${d}) must match the inChannels dimension in filter ${l.shape[2]}.`),Is("depthwiseConv2d",s,i);const h={x:c,filter:l},f={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i},p=W.runKernel(G0,h,f);return u?U(p,[p.shape[1],p.shape[2],p.shape[3]]):p}const AC=H({depthwiseConv2d_:FH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OH(t,e,n,s,r=[1,1],o="NHWC"){const i=O(t,"x","dilation2d"),a=O(e,"filter","dilation2d");T(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),T(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),T(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let l=i,c=!1;i.rank===3&&(l=U(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0),T(l.shape[3]===a.shape[2],()=>`Error in dilation2d:  input and filter must have the same depth: ${l.shape[3]} vs ${a.shape[2]}`);const u={x:l,filter:a},d={strides:n,pad:s,dilations:r},h=W.runKernel(j0,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const PH=H({dilation2d_:OH});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qc(t,e){const n=t.length,s=[];for(let r=0;r<n;r++){const o=n-1-r,i=t[o]||1;(e[e.length-1-r]||1)>1&&i===1&&s.unshift(o)}return s}function $n(t,e){const n=[];for(let s=0;s<e.length;s++){const r=t[t.length-s-1],o=e.length-s-1,i=e[o];(r==null||r===1&&i>1)&&n.unshift(o)}return n}function Le(t,e){const n=Math.max(t.length,e.length),s=new Array(n);for(let r=0;r<n;r++){let o=t[t.length-r-1];o==null&&(o=1);let i=e[e.length-r-1];if(i==null&&(i=1),o===1)s[n-r-1]=i;else if(i===1)s[n-r-1]=o;else if(o!==i){const a=`Operands could not be broadcast together with shapes ${t} and ${e}.`;throw Error(a)}else s[n-r-1]=o}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MH(t,e){let n=O(t,"a","equal","string_or_numeric"),s=O(e,"b","equal","string_or_numeric");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(K0,r)}const Oo=H({equal_:MH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LH(t,e,n){const s=O(e,"a","where"),r=O(n,"b","where"),o=O(t,"condition","where","bool"),i=Le(Le(o.shape,s.shape),r.shape),a=Dd(o,i),l=Dd(s,i),c=Dd(r,i),u={condition:a,t:l,e:c};return W.runKernel(Cx,u)}const cs=H({where_:LH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zH(t){const n={x:O(t,"x","zerosLike")};return W.runKernel(Rx,n)}const nt=H({zerosLike_:zH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BH(t,e){let n=O(t,"a","div"),s=O(e,"b","div");[n,s]=nn(n,s);const r=Ne(n,s),o=nt(r),i=Oo(s,o);return cs(i,o,r)}const VH=H({divNoNan_:BH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WH(t,e){const n=O(t,"t1","dot"),s=O(e,"t2","dot");T((n.rank===1||n.rank===2)&&(s.rank===1||s.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${n.rank} and ${s.rank}.`);const r=n.rank===1?n.size:n.shape[1],o=s.rank===1?s.size:s.shape[0];if(T(r===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${r} and ${o}.`),n.rank===1&&s.rank===1){const i=U(n,[1,-1]),a=U(s,[-1,1]),l=it(i,a);return U(l,[])}else if(n.rank===1&&s.rank===2){const i=U(n,[1,-1]),a=U(s,[s.shape[0],s.shape[1]]),l=it(i,a);return U(l,[l.size])}else if(n.rank===2&&s.rank===1){const i=U(s,[-1,1]),a=it(n,i);return U(a,[a.size])}else{const i=U(s,[s.shape[0],s.shape[1]]);return it(n,i)}}const UH=H({dot_:WH});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HH(t,...e){const n=e.map((r,o)=>O(r,`tensors${o}`,"einsum")),s={equation:t};return W.runKernel(eC,n,s)}const Gu=H({einsum_:HH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GH(t){const n={x:O(t,"x","elu","float32")};return W.runKernel(Yh,n)}const Lx=H({elu_:GH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jH(t){let e=O(t,"x","erf");T(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=ve(e,"float32"));const n={x:e};return W.runKernel(Qh,n)}const gF=H({erf_:jH});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DC(t,e){for(let n=0;n<t.length;++n)if(t[t.length-n-1]!==e-1-n)return!1;return!0}function xF(t,e,n){const s=t.length+e.length,r=[];let o=0,i=0;for(let a=0;a<s;a++)n.indexOf(a)===-1?r.push(t[o++]):r.push(e[i++]);return r}function An(t,e){const n=[],s=t.length;for(let o=0;o<s;o++)e.indexOf(o)===-1&&n.push(t[o]);const r=e.map(o=>t[o]);return[n,r]}function fn(t,e){const n=e.map(s=>1);return xF(t,n,e)}function zn(t,e,n){T(DC(e,n),()=>`${t} supports only inner-most axes for now. Got axes ${e} and rank-${n} input.`)}function Wt(t,e){if(DC(t,e))return null;const n=[];for(let s=0;s<e;++s)t.indexOf(s)===-1&&n.push(s);return t.forEach(s=>n.push(s)),n}function xa(t){return t.map((e,n)=>[n,e]).sort((e,n)=>e[1]-n[1]).map(e=>e[0])}function sn(t,e){const n=[];for(let s=e-t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KH(t,e=null,n=!1){const r={x:O(t,"x","max")},o={reductionIndices:e,keepDims:n};return W.runKernel(ox,r,o)}const to=H({max_:KH});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XH(t,e=null,n=!1){const r={x:O(t,"x","min")},o={axis:e,keepDims:n};return W.runKernel(cx,r,o)}const kg=H({min_:XH});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qH(t,e){let n=O(t,"base","pow"),s=O(e,"exp","pow");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(pf,r)}const yl=H({pow_:qH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function at(t,e){if((Dr(t)&&e!=="string"||Array.isArray(t))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&Dr(t)&&!(t instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Fx(t,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YH(t){const n={x:O(t,"x","sqrt","float32")};return W.runKernel(If,n)}const Yn=H({sqrt_:YH});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QH(t){const e=O(t,"x","square"),n={};return W.runKernel("Square",{x:e},n)}const Nt=H({square_:QH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZH(t,e=null,n=!1){let s=O(t,"x","sum");s.dtype==="bool"&&(s=ve(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return W.runKernel($x,r,o)}const Ee=H({sum_:ZH});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JH(t,e="euclidean",n=null,s=!1){t=O(t,"x","norm");const r=yF(t,e,n);let o=r.shape;if(s){const i=je(n,t.shape);o=fn(r.shape,i)}return U(r,o)}function yF(t,e,n=null){if(t.rank===0)return os(t);if(t.rank!==1&&n===null)return yF(U(t,[-1]),e,n);if(t.rank===1||typeof n=="number"||Array.isArray(n)&&n.length===1){if(e===1)return Ee(os(t),n);if(e===1/0)return to(os(t),n);if(e===-1/0)return kg(os(t),n);if(e==="euclidean"||e===2)return Yn(Ee(yl(os(t),at(2,"int32")),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(n)&&n.length===2){if(e===1)return to(Ee(os(t),n[0]),n[1]-1);if(e===1/0)return to(Ee(os(t),n[1]),n[0]);if(e===-1/0)return kg(Ee(os(t),n[1]),n[0]);if(e==="fro"||e==="euclidean")return Yn(Ee(Nt(t),n));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${n}`)}const zx=H({norm_:JH});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eG(t,e=null,n=!1){return zx(t,"euclidean",e,n)}const tG=H({euclideanNorm_:eG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nG(t){const n={x:O(t,"x","exp")};return W.runKernel(Zh,n)}const Po=H({exp_:nG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sG(t,e=0){const n=O(t,"x","expandDims","string_or_numeric");T(e<=n.rank,()=>"Axis must be <= rank of the tensor");const s={input:n},r={dim:e};return W.runKernel(X0,s,r)}const ys=H({expandDims_:sG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rG(t){const n={x:O(t,"x","expm1")};return W.runKernel(Jh,n)}const oG=H({expm1_:rG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iG(t,e){const n=O(t,"x","tile","string_or_numeric");T(n.rank===e.length,()=>`Error in transpose: rank of input ${n.rank} must match length of reps ${e}.`);const s={x:n},r={reps:e};return W.runKernel(Rf,s,r)}const Qr=H({tile_:iG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aG(t,e,n,s="float32"){e==null&&(e=t);const r=Ge([t,e],s),o=t<=e?t:e;for(let a=0;a<o;++a)r.set(1,a,a);const i=U(r.toTensor(),[t,e]);if(n==null)return i;if(n.length===1)return Qr(ys(i,0),[n[0],1,1]);if(n.length===2)return Qr(ys(ys(i,0),0),[n[0],n[1],1,1]);if(n.length===3)return Qr(ys(ys(ys(i,0),0),0),[n[0],n[1],n[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${n.length}D.`)}const bF=H({eye_:aG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lG(t){const n={x:O(t,"x","floor","float32")};return W.runKernel(ef,n)}const Bx=H({floor_:lG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cG(t,e,n=0,s=0){const r=O(t,"x","gather"),o=O(e,"indices","gather","int32"),i={x:r,indices:o},a={axis:n,batchDims:s};return W.runKernel(Y0,i,a)}const FC=H({gather_:cG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uG(t,e){let n=O(t,"a","greater","string_or_numeric"),s=O(e,"b","greater","string_or_numeric");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(Q0,r)}const ar=H({greater_:uG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dG(t,e){let n=O(t,"a","greaterEqual","string_or_numeric"),s=O(e,"b","greaterEqual","string_or_numeric");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(nf,r)}const Ol=H({greaterEqual_:dG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hG(t){const n={input:O(t,"input","imag")};return W.runKernel(iC,n)}const OC=H({imag_:hG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fG(t){const n={x:O(t,"x","isFinite")};return W.runKernel(rf,n)}const pG=H({isFinite_:fG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mG(t){const n={x:O(t,"x","isInf")};return W.runKernel(of,n)}const gG=H({isInf_:mG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xG(t){const n={x:O(t,"x","isNaN")};return W.runKernel(af,n)}const yG=H({isNaN_:xG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bG(t,e=.2){const s={x:O(t,"x","leakyRelu")},r={alpha:e};return W.runKernel(Z0,s,r)}const PC=H({leakyRelu_:bG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vG(t,e){let n=O(t,"a","less","string_or_numeric"),s=O(e,"b","less","string_or_numeric");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(J0,r)}const Cg=H({less_:vG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wG(t,e){let n=O(t,"a","lessEqual","string_or_numeric"),s=O(e,"b","lessEqual","string_or_numeric");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(ex,r)}const bu=H({lessEqual_:wG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kG(t,e=5,n=1,s=1,r=.5){const o=O(t,"x","localResponseNormalization");T(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),T(Gc(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=U(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const l={x:i},c={depthRadius:e,bias:n,alpha:s,beta:r},u=W.runKernel(rx,l,c);return a?U(u,[u.shape[1],u.shape[2],u.shape[3]]):u}const CG=H({localResponseNormalization_:kG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SG(t){const n={x:O(t,"x","log","float32")};return W.runKernel(lf,n)}const Mo=H({log_:SG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $G(t){const n={x:O(t,"x","log1p")};return W.runKernel(cf,n)}const vF=H({log1p_:$G});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IG(t,e){T(bv(t),()=>"The f passed in variableGrads(f) must be a function"),T(e==null||Array.isArray(e)&&e.every(c=>c instanceof wg),()=>"The varList passed in variableGrads(f, varList) must be an array of variables");const n=e!=null;if(!n){e=[];for(const c in W.registeredVariables)e.push(W.registeredVariables[c])}const s=n?e.filter(c=>!c.trainable):null,r=e.length;e=e.filter(c=>c.trainable),T(e.length>0,()=>`variableGrads() expects at least one of the input variables to be trainable, but none of the ${r} variables is trainable.`);const o=!0,{value:i,grads:a}=W.gradients(t,e,null,o);T(a.some(c=>c!=null),()=>"Cannot find a connection between any variable and the result of the loss function y=f(x). Please make sure the operations that use variables are inside the function f passed to minimize()."),T(i.rank===0,()=>`The f passed in variableGrads(f) must return a scalar, but it returned a rank-${i.rank} tensor`);const l={};return e.forEach((c,u)=>{a[u]!=null&&(l[c.name]=a[u])}),s!=null&&s.forEach(c=>l[c.name]=null),{value:i,grads:l}}function Yc(t){return W.customGrad(t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TG(t){const n={x:O(t,"x","neg")};return W.runKernel(dx,n)}const tn=H({neg_:TG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EG(t){const n={x:O(t,"x","softplus")};return W.runKernel($f,n)}const Ff=H({softplus_:EG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NG(t){const e=O(t,"x","logSigmoid");return Yc(s=>({value:tn(Ff(tn(s))),gradFunc:i=>V(i,yu(tn(s)))}))(e)}const _G=H({logSigmoid_:NG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RG(t,e){let n=O(t,"a","sub"),s=O(e,"b","sub");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(Ef,r)}const _e=H({sub_:RG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AG(t,e=-1){const n=O(t,"logits","logSoftmax");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and axis was ${e}`);return Yc((r,o)=>{const a=to(r,e,!0),l=_e(r,a),c=_e(ve(l,"float32"),Mo(Ee(Po(l),e,!0)));return o([c]),{value:c,gradFunc:(d,h)=>{const[f]=h,p=!0,m=Po(f);return _e(d,V(Ee(d,e,p),m))}}})(n)}const wF=H({logSoftmax_:AG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DG(t,e=null,n=!1){const s=O(t,"x","logSumExp"),r=je(e,s.shape),o=to(s,r,!0),i=_e(s,o),a=Po(i),l=Ee(a,r),c=Mo(l),u=ie(U(o,c.shape),c);if(n){const d=fn(u.shape,r);return U(u,d)}return u}const kF=H({logSumExp_:DG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FG(t,e){const n=O(t,"a","logicalAnd","bool"),s=O(e,"b","logicalAnd","bool");Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(tx,r)}const li=H({logicalAnd_:FG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OG(t){const n={x:O(t,"x","logicalNot","bool")};return W.runKernel(nx,n)}const MC=H({logicalNot_:OG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PG(t,e){const n=O(t,"a","logicalOr","bool"),s=O(e,"b","logicalOr","bool");Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(sx,r)}const CF=H({logicalOr_:PG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MG(t,e){const n=O(t,"a","logicalXor","bool"),s=O(e,"b","logicalXor","bool");return Le(n.shape,s.shape),li(CF(t,e),MC(li(t,e)))}const LG=H({logicalXor_:MG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zG(t,e,n,s,r){const o=O(t,"x","maxPool"),i=1;let a=o,l=!1;o.rank===3&&(l=!0,a=U(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),T(Qn(n,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${n} and dilations '${i}'`),Is("maxPool",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r},d=W.runKernel(ix,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const LC=H({maxPool_:zG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BG(t,e=[1,1,1],n,s,r,o="NDHWC"){const i=O(t,"x","maxPool3d");let a=i,l=!1;i.rank===4&&(l=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),T(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),T(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),Is("maxPool3d",s,r);const c={x:a},u={filterSize:e,strides:n,pad:s,dimRoundingMode:r,dataFormat:o},d=W.runKernel(ax,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const VG=H({maxPool3d_:BG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WG(t,e){let n=O(t,"a","maximum"),s=O(e,"b","maximum");[n,s]=nn(n,s),n.dtype==="bool"&&(n=ve(n,"int32"),s=ve(s,"int32")),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(uf,r)}const ya=H({maximum_:WG});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UG(t,e=null,n=!1){const r={x:O(t,"x","mean")},o={axis:e,keepDims:n};return W.runKernel(lx,r,o)}const dn=H({mean_:UG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hn(t,e="float32"){if(xi(t),e==="complex64"){const s=hn(t,"float32"),r=hn(t,"float32");return Xc(s,r)}const n=qn(Z(t),e);return W.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ba(t,e="float32"){if(xi(t),e==="complex64"){const s=ba(t,"float32"),r=hn(t,"float32");return Xc(s,r)}const n=Fk(Z(t),e);return W.makeTensor(n,t,e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HG(t,e){let n=O(t,"a","minimum"),s=O(e,"b","minimum");[n,s]=nn(n,s),n.dtype==="bool"&&(n=ve(n,"int32"),s=ve(s,"int32")),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(df,r)}const uh=H({minimum_:HG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GG(t,e,n){T(n==="reflect"||n==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${n}.`);const s=O(t,"x","mirrorPad");if(s.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");T(e.length===s.rank,()=>`Padding doesn't match input. Must be ${s.rank}. Got ${e.length}.`);const r=n==="reflect"?1:0;for(let a=0;a<s.rank;a++)T(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),T(e[a][0]>=0&&e[a][0]<=s.shape[a]-r&&e[a][1]>=0&&e[a][1]<=s.shape[a]-r,()=>`Padding in dimension ${a} cannot be greater than or equal to ${s.shape[a]-r} or less than 0 for input of shape ${s.shape}`);const o={paddings:e,mode:n},i={x:s};return W.runKernel(ux,i,o)}const jG=H({mirrorPad_:GG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KG(t,e){let n=O(t,"a","mod"),s=O(e,"b","mod");[n,s]=nn(n,s);const r={a:n,b:s};return W.runKernel(hf,r)}const XG=H({mod_:KG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qG(t,e=null,n=!1){t=O(t,"x","moments");const s=je(e,t.shape),r=dn(t,s,n);let o=r.shape;n||(o=fn(r.shape,s));const i=Nt(_e(ve(t,"float32"),U(r,o))),a=dn(i,s,n);return{mean:r,variance:a}}const zC=H({moments_:qG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YG(t,e){let n=O(t,"a","notEqual","string_or_numeric"),s=O(e,"b","notEqual","string_or_numeric");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s};return W.runKernel(hx,r)}const Sg=H({notEqual_:YG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QG(t,e,n=1,s=0,r="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:O(t,"indices","oneHot","int32")},a={dtype:r,depth:e,onValue:n,offValue:s};return W.runKernel(px,i,a)}const SF=H({oneHot_:QG});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZG(t){const n={x:O(t,"x","onesLike")};return W.runKernel(fx,n)}const Fr=H({onesLike_:ZG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JG(t,e,n=0){const s=O(t,"x","pad");if(s.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const r={paddings:e,constantValue:n},o={x:s};return W.runKernel(gx,o,r)}const BC=H({pad_:JG});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(t,e,n){const s=O(t,"x","spaceToBatchND");T(s.rank>=1+e.length,()=>`input rank ${s.rank} should be > than [blockShape] ${e.length}`),T(n.length===e.length,()=>`paddings.shape[0] ${n.length} must be equal to [blockShape] ${e.length}`),T(s.shape.reduce((i,a,l)=>l>0&&l<=e.length?i&&(a+n[l-1][0]+n[l-1][1])%e[l-1]===0:i,!0),()=>`input spatial dimensions ${s.shape.slice(1)} with paddings ${n.toString()} must be divisible by blockShapes ${e.toString()}`);const r={x:s},o={blockShape:e,paddings:n};return W.runKernel(Ix,r,o)}const VC=H({spaceToBatchND_:e6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t6(t,e,n,s,r,o,i){r==null&&(r=[1,1]),o==null&&(o=1),s===0&&(s="valid");const a=O(t,"x","maxPool");let l=a,c=!1;a.rank===3&&(c=!0,l=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),T(Qn(o,r),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${r}'`);const u=Pr(l.shape,e,o,r,s),d=[u.dilationHeight,u.dilationWidth];let h;s==="same"?h=s6([u.filterHeight,u.filterWidth],d):h=[[0,0],[0,0]];const f=d[0]===1&&d[1]===1,[p,m]=n6([u.inHeight,u.inWidth],d,h),x=f?s:"valid",g=f?l:VC(l,d,p),b=(n==="avg"?()=>EC(g,e,o,x,i):()=>LC(g,e,o,x,i))(),v=f?b:NC(b,d,m);return c?U(v,[v.shape[1],v.shape[2],v.shape[3]]):v}function n6(t,e,n){const s=n.map(u=>u[0]),r=n.map(u=>u[1]),o=t.concat(s,r),i=e.map((u,d)=>(u-o[d]%u)%u),a=r.map((u,d)=>u+i[d]),l=e.map((u,d)=>[s[d],a[d]]),c=e.map((u,d)=>[0,i[d]]);return[l,c]}function s6(t,e){const s=t.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),r=s.map(i=>Math.floor(i/2)),o=s.map((i,a)=>i-r[a]);return s.map((i,a)=>[r[a],o[a]])}const r6=H({pool_:t6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o6(t,e){const n=O(t,"x","prelu"),s=O(e,"alpha","prelu"),r={x:n,alpha:s};return W.runKernel(xx,r)}const WC=H({prelu_:o6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6(t,e=null,n=!1){let s=O(t,"x","prod");s.dtype==="bool"&&(s=ve(s,"int32"));const r={x:s},o={axis:e,keepDims:n};return W.runKernel(yx,r,o)}const a6=H({prod_:i6});var UC={exports:{}};UC.exports;(function(t){(function(e,n,s){function r(l){var c=this,u=a();c.next=function(){var d=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=d-(c.c=d|0)},c.c=1,c.s0=u(" "),c.s1=u(" "),c.s2=u(" "),c.s0-=u(l),c.s0<0&&(c.s0+=1),c.s1-=u(l),c.s1<0&&(c.s1+=1),c.s2-=u(l),c.s2<0&&(c.s2+=1),u=null}function o(l,c){return c.c=l.c,c.s0=l.s0,c.s1=l.s1,c.s2=l.s2,c}function i(l,c){var u=new r(l),d=c&&c.state,h=u.next;return h.int32=function(){return u.next()*4294967296|0},h.double=function(){return h()+(h()*2097152|0)*11102230246251565e-32},h.quick=h,d&&(typeof d=="object"&&o(d,u),h.state=function(){return o(u,{})}),h}function a(){var l=4022871197,c=function(u){u=String(u);for(var d=0;d<u.length;d++){l+=u.charCodeAt(d);var h=.02519603282416938*l;l=h>>>0,h-=l,h*=l,l=h>>>0,h-=l,l+=h*4294967296}return(l>>>0)*23283064365386963e-26};return c}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.alea=i})(_l,t,!1)})(UC);var l6=UC.exports,HC={exports:{}};HC.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.x=0,l.y=0,l.z=0,l.w=0,l.next=function(){var d=l.x^l.x<<11;return l.x=l.y,l.y=l.z,l.z=l.w,l.w^=l.w>>>19^d^d>>>8},a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xor128=i})(_l,t,!1)})(HC);var c6=HC.exports,GC={exports:{}};GC.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.x^l.x>>>2;return l.x=l.y,l.y=l.z,l.z=l.w,l.w=l.v,(l.d=l.d+362437|0)+(l.v=l.v^l.v<<4^(d^d<<1))|0},l.x=0,l.y=0,l.z=0,l.w=0,l.v=0,a===(a|0)?l.x=a:c+=a;for(var u=0;u<c.length+64;u++)l.x^=c.charCodeAt(u)|0,u==c.length&&(l.d=l.x<<10^l.x>>>4),l.next()}function o(a,l){return l.x=a.x,l.y=a.y,l.z=a.z,l.w=a.w,l.v=a.v,l.d=a.d,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xorwow=i})(_l,t,!1)})(GC);var u6=GC.exports,jC={exports:{}};jC.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.x,d=l.i,h,f;return h=u[d],h^=h>>>7,f=h^h<<24,h=u[d+1&7],f^=h^h>>>10,h=u[d+3&7],f^=h^h>>>3,h=u[d+4&7],f^=h^h<<7,h=u[d+7&7],h=h^h<<13,f^=h^h<<9,u[d]=f,l.i=d+1&7,f};function c(u,d){var h,f=[];if(d===(d|0))f[0]=d;else for(d=""+d,h=0;h<d.length;++h)f[h&7]=f[h&7]<<15^d.charCodeAt(h)+f[h+1&7]<<13;for(;f.length<8;)f.push(0);for(h=0;h<8&&f[h]===0;++h);for(h==8?f[7]=-1:f[h],u.x=f,u.i=0,h=256;h>0;--h)u.next()}c(l,a)}function o(a,l){return l.x=a.x.slice(),l.i=a.i,l}function i(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.x&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xorshift7=i})(_l,t,!1)})(jC);var d6=jC.exports,KC={exports:{}};KC.exports;(function(t){(function(e,n,s){function r(a){var l=this;l.next=function(){var u=l.w,d=l.X,h=l.i,f,p;return l.w=u=u+1640531527|0,p=d[h+34&127],f=d[h=h+1&127],p^=p<<13,f^=f<<17,p^=p>>>15,f^=f>>>12,p=d[h]=p^f,l.i=h,p+(u^u>>>16)|0};function c(u,d){var h,f,p,m,x,g=[],y=128;for(d===(d|0)?(f=d,d=null):(d=d+"\0",f=0,y=Math.max(y,d.length)),p=0,m=-32;m<y;++m)d&&(f^=d.charCodeAt((m+32)%d.length)),m===0&&(x=f),f^=f<<10,f^=f>>>15,f^=f<<4,f^=f>>>13,m>=0&&(x=x+1640531527|0,h=g[m&127]^=f+x,p=h==0?p+1:0);for(p>=128&&(g[(d&&d.length||0)&127]=-1),p=127,m=4*128;m>0;--m)f=g[p+34&127],h=g[p=p+1&127],f^=f<<13,h^=h<<17,f^=f>>>15,h^=h>>>12,g[p]=f^h;u.w=x,u.X=g,u.i=p}c(l,a)}function o(a,l){return l.i=a.i,l.w=a.w,l.X=a.X.slice(),l}function i(a,l){a==null&&(a=+new Date);var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(u.X&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.xor4096=i})(_l,t,!1)})(KC);var h6=KC.exports,XC={exports:{}};XC.exports;(function(t){(function(e,n,s){function r(a){var l=this,c="";l.next=function(){var d=l.b,h=l.c,f=l.d,p=l.a;return d=d<<25^d>>>7^h,h=h-f|0,f=f<<24^f>>>8^p,p=p-d|0,l.b=d=d<<20^d>>>12^h,l.c=h=h-f|0,l.d=f<<16^h>>>16^p,l.a=p-d|0},l.a=0,l.b=0,l.c=-1640531527,l.d=1367130551,a===Math.floor(a)?(l.a=a/4294967296|0,l.b=a|0):c+=a;for(var u=0;u<c.length+20;u++)l.b^=c.charCodeAt(u)|0,l.next()}function o(a,l){return l.a=a.a,l.b=a.b,l.c=a.c,l.d=a.d,l}function i(a,l){var c=new r(a),u=l&&l.state,d=function(){return(c.next()>>>0)/4294967296};return d.double=function(){do var h=c.next()>>>11,f=(c.next()>>>0)/4294967296,p=(h+f)/(1<<21);while(p===0);return p},d.int32=c.next,d.quick=d,u&&(typeof u=="object"&&o(u,c),d.state=function(){return o(c,{})}),d}n&&n.exports?n.exports=i:s&&s.amd?s(function(){return i}):this.tychei=i})(_l,t,!1)})(XC);var f6=XC.exports,$F={exports:{}};const p6={},m6=Object.freeze(Object.defineProperty({__proto__:null,default:p6},Symbol.toStringTag,{value:"Module"})),g6=mi(m6);(function(t){(function(e,n,s){var r=256,o=6,i=52,a="random",l=s.pow(r,o),c=s.pow(2,i),u=c*2,d=r-1,h;function f(v,w,k){var C=[];w=w==!0?{entropy:!0}:w||{};var S=g(x(w.entropy?[v,b(n)]:v??y(),3),C),I=new p(C),$=function(){for(var E=I.g(o),_=l,D=0;E<c;)E=(E+D)*r,_*=r,D=I.g(1);for(;E>=u;)E/=2,_/=2,D>>>=1;return(E+D)/_};return $.int32=function(){return I.g(4)|0},$.quick=function(){return I.g(4)/4294967296},$.double=$,g(b(I.S),n),(w.pass||k||function(E,_,D,F){return F&&(F.S&&m(F,I),E.state=function(){return m(I,{})}),D?(s[a]=E,_):E})($,S,"global"in w?w.global:this==s,w.state)}function p(v){var w,k=v.length,C=this,S=0,I=C.i=C.j=0,$=C.S=[];for(k||(v=[k++]);S<r;)$[S]=S++;for(S=0;S<r;S++)$[S]=$[I=d&I+v[S%k]+(w=$[S])],$[I]=w;(C.g=function(E){for(var _,D=0,F=C.i,R=C.j,P=C.S;E--;)_=P[F=d&F+1],D=D*r+P[d&(P[F]=P[R=d&R+_])+(P[R]=_)];return C.i=F,C.j=R,D})(r)}function m(v,w){return w.i=v.i,w.j=v.j,w.S=v.S.slice(),w}function x(v,w){var k=[],C=typeof v,S;if(w&&C=="object")for(S in v)try{k.push(x(v[S],w-1))}catch{}return k.length?k:C=="string"?v:v+"\0"}function g(v,w){for(var k=v+"",C,S=0;S<k.length;)w[d&S]=d&(C^=w[d&S]*19)+k.charCodeAt(S++);return b(w)}function y(){try{var v;return h&&(v=h.randomBytes)?v=v(r):(v=new Uint8Array(r),(e.crypto||e.msCrypto).getRandomValues(v)),b(v)}catch{var w=e.navigator,k=w&&w.plugins;return[+new Date,e,k,e.screen,b(n)]}}function b(v){return String.fromCharCode.apply(0,v)}if(g(s.random(),n),t.exports){t.exports=f;try{h=g6}catch{}}else s["seed"+a]=f})(typeof self<"u"?self:_l,[],Math)})($F);var x6=$F.exports,y6=l6,b6=c6,v6=u6,w6=d6,k6=h6,C6=f6,Pl=x6;Pl.alea=y6;Pl.xor128=b6;Pl.xorwow=v6;Pl.xorshift7=w6;Pl.xor4096=k6;Pl.tychei=C6;var qC=Pl;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IF{constructor(e,n,s,r,o){this.mean=e,this.stdDev=n,this.dtype=s,this.nextVal=NaN,this.truncated=r,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=qC.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const r=this.nextVal;return this.nextVal=NaN,r}let e,n,s=!1;for(;!s;){let r,o,i;do r=2*this.random()-1,o=2*this.random()-1,i=r*r+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*r*a,n=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(s=!0)}return(!this.truncated||this.isValidTruncated(n))&&(this.nextVal=this.convertValue(n)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class S6{constructor(e=0,n=1,s,r){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=n-e,this.dtype=s,r==null&&(r=Math.random()),typeof r=="number"&&(r=r.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${n} <= 1 and dtype is not float`);this.random=qC.alea(r)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $6(t,e=0,n=1,s,r){if(xi(t),s!=null&&s==="bool")throw new Error(`Unsupported data type ${s}`);const o=new IF(e,n,s,!1,r),i=Ge(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const I6=H({randomNormal_:$6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(t,e=0,n=1,s="float32",r){xi(t);const o=Ge(t,s),i=new S6(e,n,null,r);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const Of=H({randomUniform_:T6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dh(t,e,n=1,s="float32"){if(n===0)throw new Error("Cannot have a step of zero");const r={start:t,stop:e,step:n,dtype:s};return W.runKernel(fC,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E6(t){const n={input:O(t,"input","real")};return W.runKernel(pC,n)}const $g=H({real_:E6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N6(t){const n={x:O(t,"x","reciprocal")};return W.runKernel(mf,n)}const _6=H({reciprocal_:N6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R6(t){const n={x:O(t,"x","relu")};return W.runKernel(gf,n)}const Ml=H({relu_:R6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A6(t){const n={x:O(t,"x","relu6")};return W.runKernel(xf,n)}const TF=H({relu6_:A6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D6(t,e){const s={x:O(t,"x","reverse")},r={dims:e};return W.runKernel(kx,s,r)}const bl=H({reverse_:D6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F6(t){const n={x:O(t,"x","round")};return W.runKernel(yf,n)}const EF=H({round_:F6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(t){const n={x:O(t,"x","rsqrt","float32")};return W.runKernel(bf,n)}const NF=H({rsqrt_:O6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P6(t){const n={x:O(t,"x","selu")};return W.runKernel(vf,n)}const _F=H({selu_:P6});function M6(t,e,n,s,r,o=[1,1],i="NHWC"){const a=O(t,"x","separableConv2d"),l=O(e,"depthwiseFilter","separableConv2d"),c=O(n,"pointwiseFilter","separableConv2d");let u=a,d=!1;if(a.rank===3&&(d=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");T(u.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${u.rank}.`),T(l.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${l.rank}.`),T(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),T(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const h=l.shape[2],f=l.shape[3];T(c.shape[2]===h*f,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${h*f}, but got ${c.shape[2]}.`);const p=AC(u,l,s,r,i,o),x=xl(p,c,1,"valid",i);return d?U(x,[x.shape[1],x.shape[2],x.shape[3]]):x}const RF=H({separableConv2d_:M6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(t){const n={x:O(t,"x","sign")};return W.runKernel(Cf,n)}const z6=H({sign_:L6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B6(t){const n={x:O(t,"x","sin","float32")};return W.runKernel(wf,n)}const AF=H({sin_:B6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V6(t){const n={x:O(t,"x","sinh")};return W.runKernel(kf,n)}const DF=H({sinh_:V6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W6(t,e,n){const s=O(t,"x","slice1d");return T(s.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${s.rank} tensor`),Ct(s,[e],[n])}const YC=H({slice1d_:W6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(t,e,n){const s=O(t,"x","slice2d");return T(s.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${s.rank} tensor`),Ct(s,e,n)}const FF=H({slice2d_:U6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H6(t,e,n){const s=O(t,"x","slice3d");return T(s.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${s.rank} tensor`),Ct(s,e,n)}const QC=H({slice3d_:H6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G6(t,e,n){const s=O(t,"x","slice4d");return T(s.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${s.rank} tensor`),Ct(s,e,n)}const Ig=H({slice4d_:G6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(t,e=-1){const n=O(t,"logits","softmax","float32");if(e===-1&&(e=n.rank-1),e!==n.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${n.rank} and dim was ${e}`);const s={logits:n},r={dim:e};return W.runKernel(Ex,s,r)}const ZC=H({softmax_:j6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K6(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${t.dtype}.`);const e={input:t};return W.runKernel(nC,e)}const OF=H({fft_:K6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(t){T(t.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${t.dtype}.`);const e={input:t};return W.runKernel(oC,e)}const Mv=H({ifft_:X6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q6(t){const e=t.shape[t.shape.length-1],n=t.size/e;let s;if(e<=2){const r=U(t,[n,e]);s=Mv(r)}else{const r=[n,2*(e-1)],o=U($g(t),[n,e]),i=U(OC(t),[n,e]),a=bl(Ct(o,[0,1],[n,e-2]),1),l=V(bl(Ct(i,[0,1],[n,e-2]),1),at(-1)),c=ws([o,a],1),u=ws([i,l],1),d=U(Xc(c,u),[r[0],r[1]]);s=Mv(d)}if(s=$g(s),t.rank===3&&t.shape[0]!==0){const r=s,o=t.shape[0];s=U(s,[o,s.shape[0]/o,s.shape[1]]),r.dispose()}return s}const Y6=H({irfft_:q6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q6(t,e,n=0){const r={x:O(t,"x","split")},o={numOrSizeSplits:e,axis:n};return W.runKernel(Tx,r,o)}const Js=H({split_:Q6});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(t,e){T(t.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${t.dtype}`);let n=t.shape[t.shape.length-1];const s=t.size/n;let r;if(e!=null&&e<n){const p=t.shape.map(x=>0),m=t.shape.map(x=>x);m[t.shape.length-1]=e,r=Ct(t,p,m),n=e}else if(e!=null&&e>n){const p=t.shape.map(m=>m);p[t.shape.length-1]=e-n,r=ws([t,hn(p)],t.shape.length-1),n=e}else r=t;const o=nt(r),i=U(Xc(r,o),[s,n]),a=OF(i),l=Math.floor(n/2)+1,c=$g(a),u=OC(a),d=Js(c,[l,n-l],c.shape.length-1),h=Js(u,[l,n-l],u.shape.length-1),f=r.shape.slice();return f[r.shape.length-1]=l,U(Xc(d[0],h[0]),f)}const J6=H({rfft_:Z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ej(t,e){let n=O(t,"a","squaredDifference"),s=O(e,"b","squaredDifference");[n,s]=nn(n,s),Le(n.shape,s.shape);const r={a:n,b:s},o={};return W.runKernel(Tf,r,o)}const tj=H({squaredDifference_:ej});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nj(t,e){const n=O(t,"x","squeeze","string_or_numeric");return U(n,pa(n.shape,e).newShape)}const Pf=H({squeeze_:nj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sj(t,e=0){const n=JD(t,"tensors","stack","string_or_numeric");T(n.length>=1,()=>"Pass at least one tensor to tf.stack"),n.length>0&&T(e<=n[0].rank,()=>"Axis must be <= rank of the tensor");const s=n,r={axis:e};return W.runKernel(mx,s,r)}const ci=H({stack_:sj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rj(t,e=0){const s={x:O(t,"x","step")},r={alpha:e};return W.runKernel(Af,s,r)}const Mf=H({step_:rj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oj(t,e,n,s,r=0,o=0,i=0,a=0,l=0){const u={x:O(t,"x","stridedSlice","string_or_numeric")},d={begin:e,end:n,strides:s,beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};return W.runKernel(bC,u,d)}const ij=H({stridedSlice_:oj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aj(t){const n={x:O(t,"x","tan","float32")};return W.runKernel(Nf,n)}const lj=H({tan_:aj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Os(t,e){oD(t);const n=Dx(t,e);if(n.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Fx(t,null,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rc(t,e,n){if(oD(t),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const s=Dx(t,n);if(s.length!==2&&s.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(s.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Fx(t,e,s,n)}function PF(t,e,n){const s=e.rank>1?e.shape[e.rank-1]:1,r=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${n.shape}, indices.shape: ${e.shape}, shape: ${t}, sliceDim: ${s}, and batchDim: ${r}.`;if(n.rank<r)throw new Error(o+` update.rank < ${r}. `);if(t.length<s+(n.rank-r))throw new Error(o+` Output shape length < ${s+(n.rank-r)}`);if(n.rank!==r+t.length-s)throw new Error(o+` update.rank != ${r+t.length-s}`);for(let i=0;i<r;++i)if(n.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${n.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<n.rank-r;++i)if(n.shape[i+r]!==t[i+s])throw new Error(o+` updates.shape[${i+r}] (${n.shape[i+r]}) != shape[${i+r}] (${t[i+r]})`)}function cj(t,e,n){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(t.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${t.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(n.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${n}`);if(n.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(t.size===0)throw new Error(`Updates specified for empty output. updates shape: ${t.shape}`)}PF(n,e,t)}function Ll(t,e,n){const s=e.shape.length,r=s>1?e.shape[s-1]:1,o=n.length;let i=1;for(let d=r;d<o;++d)i*=n[d];const a=r<1?1:r,l=Z(e.shape)/a,c=[...Te(n.slice(0,r)),1],u=Z(n);return{sliceRank:r,numUpdates:l,sliceSize:i,strides:c,outputSize:u}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uj(t,e=1,n=!0){const s=O(t,"x","topk");if(s.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const r=s.shape[s.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>r)throw new Error(`'k' passed to topk() must be <= the last dimension (${r}) but got ${e}`);const o={x:s},i={k:e,sorted:n},[a,l]=W.runKernel(vC,o,i);return{values:a,indices:l}}const dj=H({topk_:uj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hj(t,e=0,n=1,s,r){if(xi(t),s!=null&&s==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new IF(e,n,s,!0,r),i=Ge(t,s);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const MF=H({truncatedNormal_:hj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fj(t,e=0){const n=O(t,"x","unique","string_or_numeric");T(n.rank>0,()=>"The input tensor must be at least 1D");const s={x:n},r={axis:e},[o,i]=W.runKernel(kC,s,r);return{values:o,indices:i}}const pj=H({unique_:fj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mj(t,e,n){const s=O(t,"x","unsortedSegmentSum"),r=O(e,"segmentIds","unsortedSegmentSum","int32");T(Gc(n),()=>"numSegments must be of dtype int");const o={x:s,segmentIds:r},i={numSegments:n};return W.runKernel(_x,o,i)}const LF=H({unsortedSegmentSum_:mj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gj(t,e=0){const n=O(t,"x","unstack","string_or_numeric");T(e>=-n.shape.length&&e<n.shape.length,()=>`Axis = ${e} is not in [-${n.shape.length}, ${n.shape.length})`);const s={value:n},r={axis:e};return W.runKernel(Nx,s,r)}const vl=H({unstack_:gj});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xj(t,e=!0,n,s){return W.makeVariable(t,e,n,s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zF(t,e){const n=[];for(let o=0;o<e.length;o++)e[o]&&n.push(o);const s=Ge(t,"int32"),r=Ge([n.length,t.length],"int32");for(let o=0;o<n.length;o++){const i=s.indexToLoc(n[o]),a=o*t.length;r.values.set(i,a)}return r.toTensor()}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yj(t,e,n){const s=O(t,"x","transpose");if(e==null&&(e=s.shape.map((i,a)=>a).reverse()),T(s.rank===e.length,()=>`Error in transpose: rank of input ${s.rank} must match length of perm ${e}.`),e.forEach(i=>{T(i>=0&&i<s.rank,()=>`All entries in 'perm' must be between 0 and ${s.rank-1} but got ${e}`)}),s.rank<=1)return s.clone();const r={x:s},o={perm:e};return s.dtype==="complex64"?j(()=>{let i=$g(s),a=OC(s);return i=W.runKernel(Nc,{x:i},o),a=W.runKernel(Nc,{x:a},o),n&&(a=tn(a)),Xc(i,a)}):W.runKernel(Nc,r,o)}const tt=H({transpose_:yj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bj(t,e){if(e==null)return t.shape.slice();if(lt(t.shape,e))return e;if(t.shape.length===e.length){const n=[];for(let s=0;s<t.shape.length;s++)e[s]==null&&t.shape[s]!=null?n.push(t.shape[s]):n.push(e[s]);return n}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vj(t,e,n,s){const r=O(t,"x","dropout");if(T(r.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${r.dtype} tensor instead.`),T(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return t instanceof xn?r.clone():r;const o=bj(r,n),i=1-e,a=Ne(Bx(ie(Of(o,0,1,"float32",s),i)),i);return V(r,a)}const wj=H({dropout_:vj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kj(t,e,n,s,r,o="NHWC",i){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]])),T(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),T(l.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${l.shape}.`),T(n.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${n}.`);const c=o==="NHWC"?a.shape[3]:a.shape[1],u=o==="NHWC"?l.shape[3]:l.shape[1];T(c===n[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${n[2]}.`),T(u===n[3],()=>`Error in conv2dDerFilter: depth of dy (${u}) must match output depth for filter (${n[3]}).`),Is("conv2dDerFilter",r,i);const d={x:a,dy:l},h={strides:s,pad:r,dataFormat:o,dimRoundingMode:i,filterShape:n};return W.runKernel(Gk,d,h)}const JC=H({conv2DBackpropFilter_:kj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eS(t,e,n){if(n==null||n==="linear")return t;if(n==="relu")return V(t,Mf(e));throw new Error(`Cannot compute gradient for fused activation ${n}.`)}function tS(t,e){let n=e;const s=$n(t.shape,e.shape);return s.length>0&&(n=Ee(n,s)),U(n,t.shape)}function nS(t,e,n,s){if(e==="linear")return t;if(e==="relu")return Ml(t);if(e==="elu")return Lx(t);if(e==="relu6")return TF(t);if(e==="prelu")return WC(t,n);if(e==="leakyrelu")return PC(t,s);if(e==="sigmoid")return yu(t);throw new Error(`Unknown fused activation ${e}.`)}const sS=(t,e)=>!(t>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cj({x:t,filter:e,strides:n,pad:s,dataFormat:r="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:l="linear",preluActivationWeights:c,leakyreluAlpha:u}){if(l=l||"linear",sS(W.state.gradientDepth,l)===!1){T(r==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${r} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let k=xl(t,e,n,s,r,o,i);return a!=null&&(k=ie(k,a)),nS(k,l,c,u)}const d=O(t,"x","conv2d","float32"),h=O(e,"filter","conv2d","float32");let f=d,p=!1;d.rank===3&&(p=!0,f=U(d,[1,d.shape[0],d.shape[1],d.shape[2]])),T(f.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${f.rank}.`),T(h.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${h.rank}.`),Is("fused conv2d",s,i);const m=r==="NHWC"?f.shape[3]:f.shape[1];T(h.shape[2]===m,()=>`Error in conv2d: depth of input (${m}) must match input depth for filter ${h.shape[2]}.`),T(Qn(n,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${n} and dilations '${o}'`);const x=Ln(f.shape,h.shape,n,o,s,i);let g;a!=null&&(g=O(a,"bias","fused conv2d"),[g]=nn(g,d),r==="NHWC"?Le(x.outShape,g.shape):(T(g.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${g.shape.length}.`),T(g.shape.length===0||g.shape[0]===x.outChannels||g.shape[0]===1,()=>`Error in fused conv2d: bias shape (${g.shape}) is not compatible with the number of output channels (${x.outChannels})`)));let y;if(c!=null){const k=c.shape;if(T(k.length<=1||k.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${k.length}.`),k.length===1)T(k[0]===1||k[0]===x.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the number of output channels (${x.outChannels}).`);else if(k.length===3)try{Le(k,x.outShape)}catch{const S=`Error in fused conv2d: PReLU activation weights (${k}) is not compatible with the output shape of the conv2d (${x.outShape}).`;throw Error(S)}y=O(c,"prelu weights","fused conv2d")}const b=(k,C)=>{T(r==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${r} but only NHWC is currently supported.`);const[S,I,$,E]=C,_=eS(k,$,l);T(ml(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const D=_C(I.shape,_,S,n,s),F=JC(I,_,S.shape,n,s),R=[D,F];if(E!=null){const P=tS(E,_);R.push(P)}return R},v={x:f,filter:h,bias:g,preluActivationWeights:y},w={strides:n,pad:s,dataFormat:r,dilations:o,dimRoundingMode:i,activation:l,leakyreluAlpha:u};return a==null?Yc((C,S,I)=>{let $=W.runKernel(yg,v,w);return I([S,C,$]),p&&($=U($,[$.shape[1],$.shape[2],$.shape[3]])),{value:$,gradFunc:b}})(f,h):Yc((C,S,I,$)=>{let E=W.runKernel(yg,v,w);return $([S,C,E,I]),p&&(E=U(E,[E.shape[1],E.shape[2],E.shape[3]])),{value:E,gradFunc:b}})(f,h,g)}const Sj=H({fusedConv2d_:Cj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $j(t,e,n,s,r,o=[1,1],i){let a=t;t.rank===3&&(a=U(t,[1,t.shape[0],t.shape[1],t.shape[2]]));let l=e;l.rank===3&&(l=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:l},u={strides:s,pad:r,dimRoundingMode:i,dilations:o,filterShape:n};return W.runKernel(Zk,c,u)}const Ij=H({depthwiseConv2dNativeBackpropFilter_:$j});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tj(t,e,n,s,r,o=[1,1],i){let a=e,l=!1;e.rank===3&&(l=!0,a=U(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:n},u={strides:s,pad:r,dimRoundingMode:i,dilations:o,inputShape:t},d=W.runKernel(Jk,c,u);return l?U(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const Ej=H({depthwiseConv2dNativeBackpropInput_:Tj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nj({a:t,b:e,transposeA:n=!1,transposeB:s=!1,bias:r,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(sS(W.state.gradientDepth,o)===!1){let E=it(t,e,n,s);return r!=null&&(E=ie(E,r)),nS(E,o,i,a)}let l=O(t,"a","fused matMul"),c=O(e,"b","fused matMul");[l,c]=nn(l,c);const u=n?l.shape[l.rank-2]:l.shape[l.rank-1],d=s?c.shape[c.rank-1]:c.shape[c.rank-2],h=n?l.shape[l.rank-1]:l.shape[l.rank-2],f=s?c.shape[c.rank-2]:c.shape[c.rank-1],p=l.shape.slice(0,-2),m=c.shape.slice(0,-2),x=Z(p),g=Z(m);T(u===d,()=>`Error in fused matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${l.shape} and ${c.shape} and transposeA=${n} and transposeB=${s} must match.`);const b=Le(l.shape.slice(0,-2),c.shape.slice(0,-2)).concat([h,f]),v=n?U(l,[x,u,h]):U(l,[x,h,u]),w=s?U(c,[g,f,d]):U(c,[g,d,f]);let k;r!=null&&(k=O(r,"bias","fused matMul"),[k]=nn(k,l),Le(b,k.shape));let C;i!=null&&(C=O(i,"prelu weights","fused matMul"));const S=(E,_)=>{const[D,F,R,P]=_,M=eS(U(E,R.shape),R,o);let N,B;if(!n&&!s?(N=it(M,F,!1,!0),B=it(D,M,!0,!1)):!n&&s?(N=it(M,F,!1,!1),B=it(M,D,!0,!1)):n&&!s?(N=it(F,M,!1,!0),B=it(D,M,!1,!1)):(N=it(F,M,!0,!0),B=it(M,D,!0,!0)),r!=null){const G=tS(P,M);return[N,B,G]}else return[N,B]},I={a:v,b:w,bias:k,preluActivationWeights:C},$={transposeA:n,transposeB:s,activation:o,leakyreluAlpha:a};return r==null?Yc((_,D,F)=>{const R=W.runKernel(xg,I,$);return F([_,D,R]),{value:U(R,b),gradFunc:S}})(v,w):Yc((_,D,F,R)=>{const P=W.runKernel(xg,I,$);return R([_,D,P,F]),{value:U(P,b),gradFunc:S}})(v,w,k)}const Z2=H({fusedMatMul_:Nj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _j(t,e,n,s,r="bilinear",o=0){const i=O(t,"image","cropAndResize"),a=O(e,"boxes","cropAndResize","float32"),l=O(n,"boxInd","cropAndResize","int32"),c=a.shape[0];T(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),T(l.rank===1&&l.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),T(s.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${s.length}.`),T(s[0]>=1&&s[1]>=1,()=>`cropSize must be atleast [1,1], but was ${s}`),T(r==="bilinear"||r==="nearest",()=>`method must be bilinear or nearest, but was ${r}`);const u={image:i,boxes:a,boxInd:l},d={method:r,extrapolationValue:o,cropSize:s};return W.runKernel(qk,u,d)}const Rj=H({cropAndResize_:_j});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aj(t){const e=O(t,"image","flipLeftRight","float32");T(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const n={image:e};return W.runKernel(rC,n,{})}const Dj=H({flipLeftRight_:Aj});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fj(t){const e=O(t,"image","grayscaleToRGB"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),T(s===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${s}.`);const r=new Array(e.rank);return r.fill(1,0,n),r[n]=3,Qr(e,r)}const Oj=H({grayscaleToRGB_:Fj});/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pj(t){const e=O(t,"image","RGBToGrayscale"),n=e.rank-1,s=e.shape[n];T(e.rank>=2,()=>`Error in RGBToGrayscale: images must be at least rank 2, but got rank ${e.rank}.`),T(s===3,()=>`Error in RGBToGrayscale: last dimension of an RGB image should be size 3, but got size ${s}.`);const r=e.dtype,o=ve(e,"float32"),i=Os([.2989,.587,.114]);let a;switch(e.rank){case 2:a=Gu("ij,j->i",o,i);break;case 3:a=Gu("ijk,k->ij",o,i);break;case 4:a=Gu("ijkl,l->ijk",o,i);break;case 5:a=Gu("ijklm,m->ijkl",o,i);break;case 6:a=Gu("ijklmn,n->ijklm",o,i);break;default:throw new Error("Not a valid tensor rank.")}return a=ys(a,-1),ve(a,r)}const Mj=H({rgbToGrayscale_:Pj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lj(t,e,n=0,s=.5){const r=O(t,"image","rotateWithOffset","float32");T(r.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${r.rank}.`);const o={image:r},i={radians:e,fillValue:n,center:s};return W.runKernel(CC,o,i)}const zj=H({rotateWithOffset_:Lj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vu(t,e,n,s,r,o){s==null&&(s=.5),r==null&&(r=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=t.shape[0];return n=Math.min(n,i),T(0<=s&&s<=1,()=>`iouThreshold must be in [0, 1], but was '${s}'`),T(t.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${t.rank}'`),T(t.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${t.shape[1]}`),T(e.rank===1,()=>"scores must be a 1D tensor"),T(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),T(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bj(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=O(t,"boxes","nonMaxSuppression","float32"),i=O(e,"scores","nonMaxSuppression","float32"),a=vu(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l={maxOutputSize:n,iouThreshold:s,scoreThreshold:r};return W.runKernel(uC,{boxes:o,scores:i},l)}const Vj=H({nonMaxSuppression_:Bj});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wj(t,e,n){const s=Uj(t,e,n),r=s<0?-(s+1):s;t.splice(r,0,e)}function Uj(t,e,n){return Gj(t,e,n||Hj)}function Hj(t,e){return t>e?1:t<e?-1:0}function Gj(t,e,n){let s=0,r=t.length,o=0,i=!1;for(;s<r;){o=s+(r-s>>>1);const a=n(e,t[o]);a>0?s=o+1:(r=o,i=!a)}return i?s:-s-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rS(t,e,n,s,r){return aS(t,e,n,s,r,0)}function oS(t,e,n,s,r,o){return aS(t,e,n,s,r,0,!1,o,!0)}function iS(t,e,n,s,r,o){return aS(t,e,n,s,r,o,!0)}function aS(t,e,n,s,r,o,i=!1,a=!1,l=!1){const c=[];for(let x=0;x<e.length;x++)e[x]>r&&c.push({score:e[x],boxIndex:x,suppressBeginIndex:0});c.sort(J2);const u=o>0?-.5/o:0,d=[],h=[];for(;d.length<n&&c.length>0;){const x=c.pop(),{score:g,boxIndex:y,suppressBeginIndex:b}=x;if(g<r)break;let v=!1;for(let w=d.length-1;w>=b;--w){const k=jj(t,y,d[w]);if(k>=s){v=!0;break}if(x.score=x.score*Kj(s,u,k),x.score<=r)break}x.suppressBeginIndex=d.length,v||(x.score===g?(d.push(y),h.push(x.score)):x.score>r&&Wj(c,x,J2))}const f=d.length,p=n-f;a&&p>0&&(d.push(...new Array(p).fill(0)),h.push(...new Array(p).fill(0)));const m={selectedIndices:d};return i&&(m.selectedScores=h),l&&(m.validOutputs=f),m}function jj(t,e,n){const s=t.subarray(e*4,e*4+4),r=t.subarray(n*4,n*4+4),o=Math.min(s[0],s[2]),i=Math.min(s[1],s[3]),a=Math.max(s[0],s[2]),l=Math.max(s[1],s[3]),c=Math.min(r[0],r[2]),u=Math.min(r[1],r[3]),d=Math.max(r[0],r[2]),h=Math.max(r[1],r[3]),f=(a-o)*(l-i),p=(d-c)*(h-u);if(f<=0||p<=0)return 0;const m=Math.max(o,c),x=Math.max(i,u),g=Math.min(a,d),y=Math.min(l,h),b=Math.max(g-m,0)*Math.max(y-x,0);return b/(f+p-b)}function Kj(t,e,n){const s=Math.exp(e*n*n);return n<=t?s:0}function J2(t,e){return t.score-e.score||t.score===e.score&&e.boxIndex-t.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xj(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY){const o=O(t,"boxes","nonMaxSuppressionAsync"),i=O(e,"scores","nonMaxSuppressionAsync"),a=vu(o,i,n,s,r);n=a.maxOutputSize,s=a.iouThreshold,r=a.scoreThreshold;const l=await Promise.all([o.data(),i.data()]),c=l[0],u=l[1],{selectedIndices:d}=rS(c,u,n,s,r);return o!==t&&o.dispose(),i!==e&&i.dispose(),Os(d,"int32")}const qj=Xj;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yj(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=vu(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const c={boxes:i,scores:a},u={maxOutputSize:n,iouThreshold:s,scoreThreshold:r,softNmsSigma:o},d=W.runKernel(hC,c,u);return{selectedIndices:d[0],selectedScores:d[1]}}const Qj=H({nonMaxSuppressionWithScore_:Yj});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Zj(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=0){const i=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=vu(i,a,n,s,r,o);n=l.maxOutputSize,s=l.iouThreshold,r=l.scoreThreshold,o=l.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),u=c[0],d=c[1],{selectedIndices:h,selectedScores:f}=iS(u,d,n,s,r,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Os(h,"int32"),selectedScores:Os(f)}}const Jj=Zj;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e8(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=O(t,"boxes","nonMaxSuppression"),a=O(e,"scores","nonMaxSuppression"),l=vu(i,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,h={boxes:i,scores:a},f={maxOutputSize:c,iouThreshold:u,scoreThreshold:d,padToMaxOutputSize:o},p=W.runKernel(dC,h,f);return{selectedIndices:p[0],validOutputs:p[1]}}const t8=H({nonMaxSuppressionPadded_:e8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function n8(t,e,n,s=.5,r=Number.NEGATIVE_INFINITY,o=!1){const i=O(t,"boxes","nonMaxSuppressionAsync"),a=O(e,"scores","nonMaxSuppressionAsync"),l=vu(i,a,n,s,r,null),c=l.maxOutputSize,u=l.iouThreshold,d=l.scoreThreshold,[h,f]=await Promise.all([i.data(),a.data()]),{selectedIndices:p,validOutputs:m}=oS(h,f,c,u,d,o);return i!==t&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Os(p,"int32"),validOutputs:at(m,"int32")}}const s8=n8;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r8(t,e,n=!1,s=!1){const r=O(t,"images","resizeBilinear");T(r.rank===3||r.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),T(s===!1||n===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},c=W.runKernel(wx,a,l);return i?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const BF=H({resizeBilinear_:r8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function o8(t,e,n=!1,s=!1){const r=O(t,"images","resizeNearestNeighbor");T(r.rank===3||r.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${r.rank}.`),T(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),T(r.dtype==="float32"||r.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),T(s===!1||n===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=r,i=!1;r.rank===3&&(i=!0,o=U(r,[1,r.shape[0],r.shape[1],r.shape[2]]));const a={images:o},l={alignCorners:n,halfPixelCenters:s,size:e},c=W.runKernel(vx,a,l);return i?U(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const VF=H({resizeNearestNeighbor_:o8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i8(t,e="binary",n=!1,s=.5){const r=O(t,"image","threshold"),o=.2989,i=.587,a=.114,l=r.shape[0]*r.shape[1];let c=V(Os([s]),255),u,d,h,f;if(T(r.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${r.rank}.`),T(r.shape[2]===3||r.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${r.shape[2]}.`),T(r.dtype==="int32"||r.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${r.dtype}.`),T(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),r.shape[2]===3){[u,d,h]=Js(r,[1,1,1],-1);const x=V(u,o),g=V(d,i),y=V(h,a);f=ie(ie(x,g),y)}else f=t;if(e==="otsu"){const x=oH(ve(EF(f),"int32"),eF([]),256);c=a8(x,l)}const p=n?bu(f,c):ar(f,c);return ve(V(p,255),"int32")}function a8(t,e){let n=Os([-1]),s=Os([0]),r=Os([0]),o,i,a,l,c,u;for(let d=0;d<t.size-1;d++){o=Ct(t,0,d+1),i=Ct(t,d+1),c=Ne(Ee(o),e),u=Ne(Ee(i),e);const h=Ee(V(o,dh(0,o.size)));a=Ne(h,Ee(o));const f=Mx(i.shape,o.size),p=ie(dh(0,i.size),f),m=V(i,p);l=Ne(Ee(m),Ee(i));const x=_e(a,l),g=_e(a,l),y=V(c,u);r=V(V(y,x),g);const b=ar(r,s);s=cs(b,r,s),n=cs(b,Os([d]),n)}return n}const l8=H({threshold_:i8});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(t,e,n="nearest",s="constant",r=0,o){const i=O(t,"image","transform","float32"),a=O(e,"transforms","transform","float32");T(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),T(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),T(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const l={image:i,transforms:a},c={interpolation:n,fillMode:s,fillValue:r,outputShape:o};return W.runKernel(wC,l,c)}const u8=H({transform_:c8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d8(t,e,n){const s=O(t,"a","bandPart");T(s.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${s.rank}.`);const r=s.shape,[o,i]=s.shape.slice(-2);let a,l;typeof e=="number"?(T(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),T(e<=o,()=>`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`),a=O(e<0?o:e,"numLower","bandPart")):(T(e.dtype==="int32",()=>"bandPart(): numLower's dtype must be an int32."),a=cs(Cg(e,0),o,uh(e,o))),typeof n=="number"?(T(n%1===0,()=>`bandPart(): numUpper must be an integer, got ${n}.`),T(n<=i,()=>`bandPart(): numUpper (${n}) must not be greater than the number of columns (${i}).`),l=O(n<0?i:n,"numUpper","bandPart")):(T(n.dtype==="int32",()=>"bandPart(): numUpper's dtype must be an int32."),l=cs(Cg(n,0),i,uh(n,i)));const c=U(dh(0,o,1,"int32"),[-1,1]),u=dh(0,i,1,"int32"),d=_e(c,u),h=li(bu(d,a),Ol(d,tn(l))),f=hn([o,i],s.dtype);return U(ci(vl(U(s,[-1,o,i])).map(p=>cs(h,p,f))),r)}const h8=H({bandPart_:d8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f8(t){let e;if(Array.isArray(t)){e=!1,T(t!=null&&t.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const r=t[0].shape[0];for(let o=1;o<t.length;++o)T(t[o].shape[0]===r,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${t[o].shape[0]} vs. ${r})`)}else e=!0,t=Js(t,t.shape[0],0).map(r=>Pf(r,[0]));T(t.length<=t[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${t.length}) exceeds number of dimensions (${t[0].shape[0]}).`);const n=[],s=t;for(let r=0;r<t.length;++r)n.push(W.tidy(()=>{let o=s[r];if(r>0)for(let i=0;i<r;++i){const a=V(Ee(V(n[i],o)),n[i]);o=_e(o,a)}return Ne(o,zx(o,"euclidean"))}));return e?ci(n,0):n}const p8=H({gramSchmidt_:f8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(t,e=!1){if(T(t.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${t.rank}`),t.rank===2)return eT(t,e);{const n=t.shape.slice(0,t.shape.length-2).reduce((l,c)=>l*c),s=vl(U(t,[n,t.shape[t.shape.length-2],t.shape[t.shape.length-1]]),0),r=[],o=[];s.forEach(l=>{const[c,u]=eT(l,e);r.push(c),o.push(u)});const i=U(ci(r,0),t.shape),a=U(ci(o,0),t.shape);return[i,a]}}function eT(t,e=!1){return W.tidy(()=>{T(t.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${t.shape.length}D Tensor.`);const n=t.shape[0],s=t.shape[1];let r=bF(n),o=el(t);const i=Rc([[1]],[1,1]);let a=el(i);const l=n>=s?s:n;for(let c=0;c<l;++c){const u=o,d=a,h=r;[a,o,r]=W.tidy(()=>{const f=Ct(o,[c,c],[n-c,1]),p=zx(f),m=Ct(o,[c,c],[1,1]),x=cs(ar(m,0),Rc([[-1]]),Rc([[1]])),g=_e(m,V(x,p)),y=Ne(f,g);y.shape[0]===1?a=el(i):a=ws([i,Ct(y,[1,0],[y.shape[0]-1,y.shape[1]])],0);const b=tn(Ne(it(x,g),p)),v=Ct(o,[c,0],[n-c,s]),w=V(b,a),k=tt(a);if(c===0)o=_e(v,it(w,it(k,v)));else{const I=_e(v,it(w,it(k,v)));o=ws([Ct(o,[0,0],[c,s]),I],0)}const C=tt(w),S=Ct(r,[0,c],[n,r.shape[1]-c]);if(c===0)r=_e(S,it(it(S,a),C));else{const I=_e(S,it(it(S,a),C));r=ws([Ct(r,[0,0],[n,c]),I],1)}return[a,o,r]}),Qe([u,d,h])}return!e&&n>s&&(r=Ct(r,[0,0],[n,s]),o=Ct(o,[0,0],[s,s])),[r,o]})}const g8=H({qr_:m8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ei={flipLeftRight:Dj,grayscaleToRGB:Oj,resizeNearestNeighbor:VF,resizeBilinear:BF,rgbToGrayscale:Mj,rotateWithOffset:zj,cropAndResize:Rj,nonMaxSuppression:Vj,nonMaxSuppressionAsync:qj,nonMaxSuppressionWithScore:Qj,nonMaxSuppressionWithScoreAsync:Jj,nonMaxSuppressionPadded:t8,nonMaxSuppressionPaddedAsync:s8,threshold:l8,transform:u8},x8={bandPart:h8,gramSchmidt:p8,qr:g8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const y8=new Map,b8=new Map;class wu{getClassName(){return this.constructor.className}static fromConfig(e,n){return new e(n)}}class br{constructor(){this.classNameMap={}}static getMap(){return br.instance==null&&(br.instance=new br),br.instance}static register(e){br.getMap().classNameMap[e.className]=[e,e.fromConfig]}}function re(t,e,n){T(t.className!=null,()=>"Class being registered does not have the static className property defined."),T(typeof t.className=="string",()=>"className is required to be a string, but got type "+typeof t.className),T(t.className.length>0,()=>"Class being registered has an empty-string as its className, which is disallowed."),typeof e>"u"&&(e="Custom"),typeof n>"u"&&(n=t.className);const s=n,r=e+">"+s;return br.register(t),y8.set(r,t),b8.set(t,r),t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class va extends wu{minimize(e,n=!1,s){const{value:r,grads:o}=this.computeGradients(e,s);if(s!=null){const i=s.map(a=>({name:a.name,tensor:o[a.name]}));this.applyGradients(i)}else this.applyGradients(o);return Qe(o),n?r:(r.dispose(),null)}get iterations(){return this.iterations_==null&&(this.iterations_=0),this.iterations_}incrementIterations(){this.iterations_=this.iterations+1}computeGradients(e,n){return IG(e,n)}dispose(){this.iterations_!=null&&Qe(this.iterations_)}async saveIterations(){return this.iterations_==null&&(this.iterations_=0),{name:"iter",tensor:at(this.iterations_,"int32")}}async getWeights(){throw new Error("getWeights() is not implemented for this optimizer yet.")}async setWeights(e){throw new Error(`setWeights() is not implemented for this optimizer class ${this.getClassName()}`)}async extractIterations(e){return this.iterations_=(await e[0].tensor.data())[0],e.slice(1)}}Object.defineProperty(va,Symbol.hasInstance,{value:t=>t.minimize!=null&&t.computeGradients!=null&&t.applyGradients!=null});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class WF extends va{static get className(){return"Adadelta"}constructor(e,n,s=null){super(),this.learningRate=e,this.rho=n,this.epsilon=s,this.accumulatedGrads=[],this.accumulatedUpdates=[],s==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=W.registeredVariables[s],i=!1;this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accum_grad`,variable:j(()=>nt(o).variable(i))}),this.accumulatedUpdates[r]==null&&(this.accumulatedUpdates[r]={originalName:`${s}/accum_var`,variable:j(()=>nt(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedGrads[r].variable,c=this.accumulatedUpdates[r].variable;j(()=>{const u=ie(V(l,this.rho),V(Nt(a),1-this.rho)),d=V(Ne(Yn(ie(c,this.epsilon)),Yn(ie(l,this.epsilon))),a),h=ie(V(c,this.rho),V(Nt(d),1-this.rho));l.assign(u),c.assign(h);const f=ie(V(d,-this.learningRate),o);o.assign(f)})}),this.incrementIterations()}dispose(){this.accumulatedUpdates!=null&&(Qe(this.accumulatedGrads.map(e=>e.variable)),Qe(this.accumulatedUpdates.map(e=>e.variable)))}async getWeights(){const e=[...this.accumulatedGrads,...this.accumulatedUpdates];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=e.length/2,s=!1;this.accumulatedGrads=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedUpdates=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,rho:this.rho,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.rho,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UF extends va{static get className(){return"Adagrad"}constructor(e,n=.1){super(),this.learningRate=e,this.initialAccumulatorValue=n,this.accumulatedGrads=[]}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=W.registeredVariables[s];this.accumulatedGrads[r]==null&&(this.accumulatedGrads[r]={originalName:`${s}/accumulator`,variable:j(()=>Mx(o.shape,this.initialAccumulatorValue).variable(!1))});const i=Array.isArray(e)?e[r].tensor:e[s];if(i==null)return;const a=this.accumulatedGrads[r].variable;j(()=>{const l=ie(a,Nt(i));a.assign(l);const c=ie(V(Ne(i,Yn(ie(l,W.backend.epsilon()))),-this.learningRate),o);o.assign(c)})}),this.incrementIterations()}dispose(){this.accumulatedGrads!=null&&Qe(this.accumulatedGrads.map(e=>e.variable))}async getWeights(){return[await this.saveIterations()].concat(this.accumulatedGrads.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulatedGrads=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,initialAccumulatorValue:this.initialAccumulatorValue}}static fromConfig(e,n){return new e(n.learningRate,n.initialAccumulatorValue)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class HF extends va{static get className(){return"Adam"}constructor(e,n,s,r=null){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.accumulatedFirstMoment=[],this.accumulatedSecondMoment=[],j(()=>{this.accBeta1=at(n).variable(),this.accBeta2=at(s).variable()}),r==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);j(()=>{const s=_e(1,this.accBeta1),r=_e(1,this.accBeta2);n.forEach((o,i)=>{const a=W.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:j(()=>nt(a).variable(l))}),this.accumulatedSecondMoment[i]==null&&(this.accumulatedSecondMoment[i]={originalName:`${o}/v`,variable:j(()=>nt(a).variable(l))});const c=Array.isArray(e)?e[i].tensor:e[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedSecondMoment[i].variable,h=ie(V(u,this.beta1),V(c,1-this.beta1)),f=ie(V(d,this.beta2),V(Nt(c),1-this.beta2)),p=Ne(h,s),m=Ne(f,r);u.assign(h),d.assign(f);const x=ie(V(Ne(p,ie(Yn(m),this.epsilon)),-this.learningRate),a);a.assign(x)}),this.accBeta1.assign(V(this.accBeta1,this.beta1)),this.accBeta2.assign(V(this.accBeta2,this.beta2))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.accBeta2.dispose(),this.accumulatedFirstMoment!=null&&Qe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedSecondMoment!=null&&Qe(this.accumulatedSecondMoment.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedFirstMoment,...this.accumulatedSecondMoment];return[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e),j(()=>{this.accBeta1.assign(yl(this.beta1,this.iterations_+1)),this.accBeta2.assign(yl(this.beta2,this.iterations_+1))});const n=e.length/2,s=!1;this.accumulatedFirstMoment=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedSecondMoment=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)}))}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GF extends va{static get className(){return"Adamax"}constructor(e,n,s,r=null,o=0){super(),this.learningRate=e,this.beta1=n,this.beta2=s,this.epsilon=r,this.decay=o,this.accumulatedFirstMoment=[],this.accumulatedWeightedInfNorm=[],j(()=>{this.iteration=at(0).variable(),this.accBeta1=at(n).variable()}),r==null&&(this.epsilon=W.backend.epsilon())}applyGradients(e){const n=Array.isArray(e)?e.map(s=>s.name):Object.keys(e);j(()=>{const s=_e(1,this.accBeta1),r=Ne(-this.learningRate,ie(V(this.iteration,this.decay),1));n.forEach((o,i)=>{const a=W.registeredVariables[o],l=!1;this.accumulatedFirstMoment[i]==null&&(this.accumulatedFirstMoment[i]={originalName:`${o}/m`,variable:nt(a).variable(l)}),this.accumulatedWeightedInfNorm[i]==null&&(this.accumulatedWeightedInfNorm[i]={originalName:`${o}/v`,variable:nt(a).variable(l)});const c=Array.isArray(e)?e[i].tensor:e[o];if(c==null)return;const u=this.accumulatedFirstMoment[i].variable,d=this.accumulatedWeightedInfNorm[i].variable,h=ie(V(u,this.beta1),V(c,1-this.beta1)),f=V(d,this.beta2),p=os(c),m=ya(f,p);u.assign(h),d.assign(m);const x=ie(V(Ne(r,s),Ne(h,ie(m,this.epsilon))),a);a.assign(x)}),this.iteration.assign(ie(this.iteration,1)),this.accBeta1.assign(V(this.accBeta1,this.beta1))}),this.incrementIterations()}dispose(){this.accBeta1.dispose(),this.iteration.dispose(),this.accumulatedFirstMoment!=null&&Qe(this.accumulatedFirstMoment.map(e=>e.variable)),this.accumulatedWeightedInfNorm!=null&&Qe(this.accumulatedWeightedInfNorm.map(e=>e.variable))}async getWeights(){throw new Error("getWeights() is not implemented for Adamax yet.")}async setWeights(e){throw new Error("setWeights() is not implemented for Adamax yet.")}getConfig(){return{learningRate:this.learningRate,beta1:this.beta1,beta2:this.beta2,epsilon:this.epsilon,decay:this.decay}}static fromConfig(e,n){return new e(n.learningRate,n.beta1,n.beta2,n.epsilon,n.decay)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lS extends va{static get className(){return"SGD"}constructor(e){super(),this.learningRate=e,this.setLearningRate(e)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=Array.isArray(e)?e[r].tensor:e[s];if(o==null)return;const i=W.registeredVariables[s];j(()=>{const a=ie(V(this.c,o),i);i.assign(a)})}),this.incrementIterations()}setLearningRate(e){this.learningRate=e,this.c!=null&&this.c.dispose(),this.c=No(at(-e))}dispose(){this.c.dispose()}async getWeights(){return[await this.saveIterations()]}async setWeights(e){if(e=await this.extractIterations(e),e.length!==0)throw new Error("SGD optimizer does not have settable weights.")}getConfig(){return{learningRate:this.learningRate}}static fromConfig(e,n){return new e(n.learningRate)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jF extends lS{static get className(){return"Momentum"}constructor(e,n,s=!1){super(e),this.learningRate=e,this.momentum=n,this.useNesterov=s,this.accumulations=[],this.m=at(this.momentum)}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=W.registeredVariables[s];this.accumulations[r]==null&&(this.accumulations[r]={originalName:`${s}/momentum`,variable:j(()=>nt(o).variable(!1))});const i=this.accumulations[r].variable,a=Array.isArray(e)?e[r].tensor:e[s];a!=null&&j(()=>{let l;const c=ie(V(this.m,i),a);this.useNesterov?l=ie(V(this.c,ie(a,V(c,this.m))),o):l=ie(V(this.c,c),o),i.assign(c),o.assign(l)})}),this.incrementIterations()}dispose(){this.m.dispose(),this.accumulations!=null&&Qe(this.accumulations.map(e=>e.variable))}setMomentum(e){this.momentum=e}async getWeights(){return[await this.saveIterations()].concat(this.accumulations.map(e=>({name:e.originalName,tensor:e.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=!1;this.accumulations=e.map(s=>({originalName:s.name,variable:s.tensor.variable(n)}))}getConfig(){return{learningRate:this.learningRate,momentum:this.momentum,useNesterov:this.useNesterov}}static fromConfig(e,n){return new e(n.learningRate,n.momentum,n.useNesterov)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class KF extends va{static get className(){return"RMSProp"}constructor(e,n=.9,s=0,r=null,o=!1){if(super(),this.learningRate=e,this.decay=n,this.momentum=s,this.epsilon=r,this.accumulatedMeanSquares=[],this.accumulatedMoments=[],this.accumulatedMeanGrads=[],this.centered=o,r==null&&(this.epsilon=W.backend.epsilon()),e==null)throw new Error("learningRate for RMSPropOptimizer must be defined.")}applyGradients(e){(Array.isArray(e)?e.map(s=>s.name):Object.keys(e)).forEach((s,r)=>{const o=W.registeredVariables[s],i=!1;this.accumulatedMeanSquares[r]==null&&(this.accumulatedMeanSquares[r]={originalName:`${s}/rms`,variable:j(()=>nt(o).variable(i))}),this.accumulatedMoments[r]==null&&(this.accumulatedMoments[r]={originalName:`${s}/momentum`,variable:j(()=>nt(o).variable(i))}),this.accumulatedMeanGrads[r]==null&&this.centered&&(this.accumulatedMeanGrads[r]={originalName:`${s}/mg`,variable:j(()=>nt(o).variable(i))});const a=Array.isArray(e)?e[r].tensor:e[s];if(a==null)return;const l=this.accumulatedMeanSquares[r].variable,c=this.accumulatedMoments[r].variable;j(()=>{const u=ie(V(l,this.decay),V(Nt(a),1-this.decay));if(this.centered){const d=this.accumulatedMeanGrads[r].variable,h=ie(V(d,this.decay),V(a,1-this.decay)),f=Ne(V(a,this.learningRate),Yn(_e(u,ie(Nt(h),this.epsilon)))),p=ie(V(c,this.momentum),f);l.assign(u),d.assign(h),c.assign(p);const m=_e(o,p);o.assign(m)}else{const d=ie(V(l,this.decay),V(Nt(a),1-this.decay)),h=ie(V(c,this.momentum),Ne(V(a,this.learningRate),Yn(ie(d,this.epsilon))));l.assign(d),c.assign(h);const f=_e(o,h);o.assign(f)}})}),this.incrementIterations()}dispose(){this.accumulatedMeanSquares!=null&&Qe(this.accumulatedMeanSquares.map(e=>e.variable)),this.accumulatedMeanGrads!=null&&this.centered&&Qe(this.accumulatedMeanGrads.map(e=>e.variable)),this.accumulatedMoments!=null&&Qe(this.accumulatedMoments.map(e=>e.variable))}async getWeights(){const e=[...this.accumulatedMeanSquares,...this.accumulatedMoments];return this.centered&&e.push(...this.accumulatedMeanGrads),[await this.saveIterations()].concat(e.map(n=>({name:n.originalName,tensor:n.variable})))}async setWeights(e){e=await this.extractIterations(e);const n=this.centered?e.length/3:e.length/2,s=!1;this.accumulatedMeanSquares=e.slice(0,n).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.accumulatedMoments=e.slice(n,n*2).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})),this.centered&&(this.accumulatedMeanGrads=e.slice(n*2,n*3).map(r=>({originalName:r.name,variable:r.tensor.variable(s)})))}getConfig(){return{learningRate:this.learningRate,decay:this.decay,momentum:this.momentum,epsilon:this.epsilon,centered:this.centered}}static fromConfig(e,n){return new e(n.learningRate,n.decay,n.momentum,n.epsilon,n.centered)}}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v8=[WF,UF,HF,GF,jF,KF,lS];function w8(){for(const t of v8)re(t)}function cS(t,e){const n=t.shape.length,s=e.shape.length;if(n<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${n}.`);if(s<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${s}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[s-1]>n)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[s-1]} vs. ${n}`);if(Z(t.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${t.shape}.`);const r=e.shape,o=r[r.length-1];let i=1;for(let d=0;d<r.length-1;++d)i*=r[d];const a=t.shape,l=r.slice();l.pop();let c=1;for(let d=o;d<n;++d)c*=a[d],l.push(a[d]);const u=[...Te(t.shape).map(d=>d/c),1].slice(0,o);return[l,i,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lv=-2,k8=-1;function uS(t,e,n){const s=t.shape.length;T(s===e.length,()=>`Error in slice${s}D: Length of begin ${e} must match the rank of the array (${s}).`),T(s===n.length,()=>`Error in slice${s}D: Length of size ${n} must match the rank of the array (${s}).`);for(let r=0;r<s;++r)T(e[r]+n[r]<=t.shape[r],()=>`Error in slice${s}D: begin[${r}] + size[${r}] (${e[r]+n[r]}) would overflow input.shape[${r}] (${t.shape[r]})`)}function C8(t){const e=[];let n=0;for(;t>0;)t&1&&e.push(n),t/=2,n++;return e}function dS(t,e,n){const s=[];for(let r=0;r<t.length;r++)s[r]=Math.ceil((e[r]-t[r])/n[r]);return s}function XF(t,e,n,s){const r=[...t];for(let o=r.length;o<s.length;o++)r.push(1);for(let o=0;o<n;o++)o===0?r[e]=1:(r.splice(e,0,1),r.pop());return r}function qF(t,e,n){return n<=t?n:n-(e-1)}function YF(t,e){const n=[];for(let s=0;s<t;s++)n.push(e+s);return n}function S8(t,e,n,s,r,o,i,a,l){const c=t.length;let u=new Array(c),d=new Array(c),h=new Array(c);if(e.length&&n>0){const f=e[0],p=n+1;u=QF(i,f,p,s,t),d=ZF(a,f,p,r,t),h=XF(o,f,p,t)}else for(let f=0;f<c;f++)u[f]=eO(i,s,o,t,f,l),d[f]=tO(a,r,o,t,f,l),h[f]=JF(o,f,l);return{begin:u,end:d,strides:h}}function QF(t,e,n,s,r){const o=[...r],i=YF(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const l=qF(e,n,a);let c=s[l];t&1<<l&&(c=0),o[a]=c}return o}function ZF(t,e,n,s,r){const o=[...r],i=YF(n,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const l=qF(e,n,a);let c=s[l];t&1<<l&&(c=Number.MAX_SAFE_INTEGER),o[a]=c}for(let a=0;a<o.length;a++){const l=r[a];o[a]<0&&(o[a]+=l),o[a]=dl(0,o[a],r[a])}return o}function JF(t,e,n){let s=t[e];return(n&1<<e||s==null)&&(s=1),s}function eO(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),i=dl(0,i,l-1),i}function tO(t,e,n,s,r,o){let i=e[r];const a=n[r]||1;(t&1<<r||o&1<<r||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const l=s[r];return i<0&&(i+=l),a>0?i=dl(0,i,l):i=dl(-1,i,l-1),i}function hS(t,e,n){let s=n.length;for(let r=0;r<n.length;r++)if(n[r]>1){s=r;break}for(let r=s+1;r<n.length;r++)if(e[r]>0||n[r]!==t[r])return!1;return!0}function fS(t,e){let n=t.length>0?t[t.length-1]:1;for(let s=0;s<t.length-1;s++)n+=t[s]*e[s];return n}function Vx(t,e,n){let s;const r=t.shape.length;typeof e=="number"?s=[e,...new Array(r-1).fill(0)]:e.length<r?s=e.concat(new Array(r-e.length).fill(0)):s=e.slice(),s.forEach(i=>{T(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return n==null?o=new Array(r).fill(-1):typeof n=="number"?o=[n,...new Array(r-1).fill(-1)]:n.length<r?o=n.concat(new Array(r-n.length).fill(-1)):o=n,o=o.map((i,a)=>i>=0?i:(T(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),t.shape[a]-s[a])),[s,o]}function pS(t,e,n,s,r,o,i,a,l){let c;if(s==null?(c=new Array(e.length),c.fill(1)):c=s,i!=null&&i&i-1)throw new Error("Multiple ellipses in slice is not allowed.");let u=!1;const d={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:n.slice(),strides:c.slice(),beginMask:r,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:l};for(let b=0;b<d.dims;b++)u&&1<<b&a&&d.numAddAxisAfterEllipsis++,1<<b&i&&(u=!0);u||(d.ellipsisMask|=1<<d.dims,d.dims++);const h={dims:t.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};$8(d,h);let f=!0,p=!0,m=!0;const x=[],g=[];for(let b=0;b<t.length;++b){if(h.strides[b]===0)throw Error(`strides[${b}] must be non-zero`);const v=!!(h.shrinkAxisMask&1<<b),w=t[b];if(w===-1){x.push(v?1:-1);continue}const k=[h.beginMask&1<<b,h.endMask&1<<b],C=[h.strides[b]>0?0:-1,h.strides[b]>0?w:w-1];if(v&&h.strides[b]<=0)throw Error("only stride 1 allowed on non-range indexing.");m=m&&h.strides[b]===1;const S=!!(h.beginMask&1<<b&&h.endMask&1<<b);if(h.beginValid&&h.endValid){if(v){const _=h.begin[b]<0?w+h.begin[b]:h.begin[b];if(h.begin[b]=_,h.end[b]=h.begin[b]+1,_<0||_>=w)throw Error(`slice index ${h.begin[b]} of dimension ${b} out of bounds.`)}else h.begin[b]=tT(h.begin[b],0,h.strides[b],w,k,C),h.end[b]=tT(h.end[b],1,h.strides[b],w,k,C);const E=h.strides[b]===1&&h.begin[b]===0&&h.end[b]===w;f=f&&E,p=p&&(b===0&&h.strides[b]===1||E)}else f=f&&h.strides[b]===1&&S,p=p&&(b===0&&h.strides[b]===1||S);let I,$=!1;if(h.beginValid&&h.endValid?(I=h.end[b]-h.begin[b],$=!0):v?(I=1,$=!0):S&&w>=0&&(h.strides[b]<0?I=-w:I=w,$=!0),$){let E;I===0||I<0!=h.strides[b]<0?E=0:E=Math.trunc(I/h.strides[b])+(I%h.strides[b]!==0?1:0),x.push(E)}else x.push(-1)}for(let b=0;b<h.finalShapeGatherIndices.length;++b){const v=h.finalShapeGatherIndices[b];v>=0?g.push(x[v]):v===Lv&&g.push(1)}return{finalShapeSparse:g.filter((b,v)=>h.finalShapeGatherIndices[v]!==Lv),finalShape:g,isIdentity:f,sliceDim0:p,isSimpleSlice:m,begin:h.begin,end:h.end,strides:h.strides}}function $8(t,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let n=0;e.beginValid=t.begin!=null,e.endValid=t.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let s=0;s<t.dims;s++)if(1<<s&t.ellipsisMask){const r=Math.min(e.dims-(t.dims-s)+1+t.numAddAxisAfterEllipsis,e.dims);for(;n<r;n++)e.begin[n]=0,e.end[n]=0,e.strides[n]=1,e.beginMask|=1<<n,e.endMask|=1<<n,e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[n]=s}else if(1<<s&t.newAxisMask)e.finalShapeGatherIndices.push(Lv),e.finalShapeGatherIndicesSparse.push(-1);else{if(n===e.begin.length)throw Error(`Index out of range using input dim ${n}; input has only ${e.dims} dims, ${e.begin.length}.`);t.begin!=null&&(e.begin[n]=t.begin[s]),t.end!=null&&(e.end[n]=t.end[s]),e.strides[n]=t.strides[s],t.beginMask&1<<s&&(e.beginMask|=1<<n),t.endMask&1<<s&&(e.endMask|=1<<n),t.shrinkAxisMask&1<<s?(e.finalShapeGatherIndices.push(k8),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<n):(e.finalShapeGatherIndices.push(n),e.finalShapeGatherIndicesSparse.push(s)),e.inputShapeGatherIndicesSparse[n]=s,n++}}function tT(t,e,n,s,r,o){if(r[e])return n>0?o[e]:o[e+1&1];{const i=t<0?s+t:t;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const I8=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:uS,computeFlatOffset:fS,computeOutShape:dS,getNormalizedAxes:S8,isSliceContinous:hS,maskToAxes:C8,parseSliceParams:Vx,sliceInfo:pS,startForAxis:eO,startIndicesWithElidedDims:QF,stopForAxis:tO,stopIndicesWithElidedDims:ZF,stridesForAxis:JF,stridesWithElidedDims:XF},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T8{static sgd(e){return new lS(e)}static momentum(e,n,s=!1){return new jF(e,n,s)}static rmsprop(e,n=.9,s=0,r=null,o=!1){return new KF(e,n,s,r,o)}static adam(e=.001,n=.9,s=.999,r=null){return new HF(e,n,s,r)}static adadelta(e=.001,n=.95,s=null){return new WF(e,n,s)}static adamax(e=.002,n=.9,s=.999,r=null,o=0){return new GF(e,n,s,r,o)}static adagrad(e,n=.1){return new UF(e,n)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Xl=T8;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E8=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:t=>t())();function nO(){return new Promise(t=>E8(()=>t()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mS(t,e){const n=t[0].length;t.forEach((r,o)=>{T(r.length===n,()=>`Error in concat${n}D: rank of tensors[${o}] must be the same as the rank of the rest (${n})`)}),T(e>=0&&e<n,()=>`Error in concat${n}D: axis must be between 0 and ${n-1}.`);const s=t[0];t.forEach((r,o)=>{for(let i=0;i<n;i++)T(i===e||r[i]===s[i],()=>`Error in concat${n}D: Shape of tensors[${o}] (${r}) does not match the shape of the rest (${s}) along the non-concatenated axis ${o}.`)})}function _o(t,e){const n=t[0].slice();for(let s=1;s<t.length;s++)n[e]+=t[s][e];return n}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var qr;(function(t){t[t.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",t[t.VALUE_ROWIDS=1]="VALUE_ROWIDS",t[t.ROW_LENGTHS=2]="ROW_LENGTHS",t[t.ROW_SPLITS=3]="ROW_SPLITS",t[t.ROW_LIMITS=4]="ROW_LIMITS",t[t.ROW_STARTS=5]="ROW_STARTS"})(qr||(qr={}));function sO(t,e,n){let s=new Array;if(n==null&&e==null)return s;if(e==null)for(;s.length<t+n.length;)s.push(-1);else s=e.slice();if(n==null)return s;if(t+n.length!==s.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${t+n.length}, but shape.rank = ${s.length}`);for(let r=1;r<n.length;++r){const o=n[r],i=s[s.length-n.length+r],a=s[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${r+t}] = ${o} but shape[${r+t}] = ${a}`)}else s[i]=o}return s}function rO(t){const e={FIRST_DIM_SIZE:qr.FIRST_DIM_SIZE,VALUE_ROWIDS:qr.VALUE_ROWIDS,ROW_LENGTHS:qr.ROW_LENGTHS,ROW_SPLITS:qr.ROW_SPLITS,ROW_LIMITS:qr.ROW_LIMITS,ROW_STARTS:qr.ROW_STARTS},n=[];for(const s of t)if(s in e)n.push(e[s]);else break;return n}function oO(t){return t.length===0?0:t[0]===qr.FIRST_DIM_SIZE?t.length-1:t.length}function iO(t,e){if(t==null||e==null)return;const n=t.length,s=e.length;if(n>=s)throw new Error(`defaultValue.shape=${t} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${n} must be less than ragged tensor input flatValues.rank = ${s})`);for(let r=0;r<Math.min(n,s-1);++r){const o=t[r],i=e[r+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${t}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${r-t.length}] = ${o} but ragged tensor input.flatValues.shape[${r-t.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gS=30;function Wx(t){return t<=gS?t:vv(t,Math.floor(Math.sqrt(t)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xS(t,e,n){const s=n*(typeof t=="number"?t:t[0]),r=e*(typeof t=="number"?t:t[1]);return[s,r]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lf(t,e,n,s=!0){let r=[];if(s)r=r.concat(e.slice(0)),r.push(t[0]/n),r=r.concat(t.slice(1));else{r=r.concat(t[0]);const o=e.length;for(let i=0;i<o;++i)r=r.concat([t[i+1]/e[i],e[i]]);r=r.concat(t.slice(o+1))}return r}function zf(t,e,n=!0){const s=[];if(n){s.push(e);for(let r=e+1;r<t;++r)r<=2*e?(s.push(r),s.push(r-(e+1))):s.push(r)}else{const r=[],o=[];for(let i=1;i<t;++i)i>=e*2+1||i%2===1?o.push(i):r.push(i);s.push(...r),s.push(0),s.push(...o)}return s}function Bf(t,e,n,s=!0){const r=[];s?r.push(t[0]/n):r.push(t[0]*n);for(let o=1;o<t.length;++o)o<=e.length?s?r.push(e[o-1]*t[o]):r.push(t[o]/e[o-1]):r.push(t[o]);return r}function yS(t,e){const n=[0];for(let s=0;s<e;++s)n.push(t[s][0]);return n}function bS(t,e,n){const s=t.slice(0,1);for(let r=0;r<n;++r)s.push(t[r+1]-e[r][0]-e[r][1]);return s}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ux=1.7580993408473768,Hx=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vS=.3275911,wS=.254829592,kS=-.284496736,CS=1.421413741,SS=-1.453152027,$S=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ui(t,e){if(t.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${t.length}, imag: ${e.length}.`);const n=new Float32Array(t.length*2);for(let s=0;s<n.length;s+=2)n[s]=t[s/2],n[s+1]=e[s/2];return n}function aO(t){const e=new Float32Array(t.length/2),n=new Float32Array(t.length/2);for(let s=0;s<t.length;s+=2)e[s/2]=t[s],n[s/2]=t[s+1];return{real:e,imag:n}}function lO(t){const e=Math.ceil(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=0;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function cO(t){const e=Math.floor(t.length/4),n=new Float32Array(e),s=new Float32Array(e);for(let r=2;r<t.length;r+=4)n[Math.floor(r/4)]=t[r],s[Math.floor(r/4)]=t[r+1];return{real:n,imag:s}}function IS(t,e){const n=t[e*2],s=t[e*2+1];return{real:n,imag:s}}function uO(t,e,n,s){t[s*2]=e,t[s*2+1]=n}function dO(t,e){const n=new Float32Array(t/2),s=new Float32Array(t/2);for(let r=0;r<Math.ceil(t/2);r++){const o=(e?2:-2)*Math.PI*(r/t);n[r]=Math.cos(o),s[r]=Math.sin(o)}return{real:n,imag:s}}function hO(t,e,n){const s=(n?2:-2)*Math.PI*(t/e),r=Math.cos(s),o=Math.sin(s);return{real:r,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ub="->",N8=/->/g,nT=",",sT="...";function TS(t,e){t=t.replace(/\s/g,"");const n=(t.length-t.replace(N8,"").length)/Ub.length;if(n<1)throw new Error("Equations without an arrow are not supported.");if(n>1)throw new Error(`Equation must contain exactly one arrow ("${Ub}").`);const[s,r]=t.split(Ub);T(s.indexOf(sT)===-1,()=>`The ellipsis notation ("${sT}") is not supported yet.`);const o=s.split(nT),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let h=0;h<r.length;++h){const f=r[h];if(!o.some(p=>p.indexOf(f)!==-1))throw new Error(`Output subscripts contain the label ${f} not present in the input subscripts.`);a.indexOf(f)===-1&&a.push(f)}for(let h=0;h<s.length;++h){const f=s[h];a.indexOf(f)===-1&&f!==nT&&a.push(f)}const l=new Array(o.length);for(let h=0;h<i;++h){if(new Set(o[h].split("")).size!==o[h].length)throw new Error(`Found duplicate axes in input component ${o[h]}. Support for duplicate axes in input is not implemented yet.`);l[h]=[];for(let f=0;f<o[h].length;++f)l[h].push(a.indexOf(o[h][f]))}const c=a.length,u=r.length,d=[];for(let h=u;h<c;++h)d.push(h);return{allDims:a,summedDims:d,idDims:l}}function ES(t,e){let n=new Array(t);n.fill(-1);for(let r=0;r<e.length;++r)n[e[r]]=r;const s=[];for(let r=0;r<t;++r)n[r]===-1&&s.push(r);return n=n.filter(r=>r!==-1),{permutationIndices:n,expandDims:s}}function NS(t,e,n){const s=new Array(t);for(let r=0;r<n.length;++r){const o=n[r].shape;for(let i=0;i<e[r].length;++i)s[e[r][i]]===void 0?s[e[r][i]]=o[i]:T(s[e[r][i]]===o[i],()=>`Expected dimension ${s[e[r][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function _S(t,e){const n=t,s=[];let r=0;t.length===0&&n.push(-1),r=t.length+1;for(let i=0;i<r;++i)s.push([]);const o=[];for(let i=0;i<n.length;++i){const a=n[i],l=_8(e,a);for(const c of l)o.indexOf(c)===-1&&(s[i].push(c),o.push(c))}return{path:n,steps:s}}function RS(t){return t.every((e,n)=>e===n)}function _8(t,e){const n=[];for(let s=0;s<t.length;++s)(t[s].length===0||t[s].indexOf(e)!==-1||e===-1)&&n.push(s);return n}function AS(t,e,n=0){let s=[];if(typeof e=="number")T(t.shape[n]%e===0,()=>"Number of splits must evenly divide the axis."),s=new Array(e).fill(t.shape[n]/e);else{const r=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);T(r<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,l)=>l>0?a+l:a);e[o]=t.shape[n]-i}T(t.shape[n]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),s=e}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fO(t){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${t}`}function pO(t,e){return`indices(${t}, 0) is invalid: ${e} < 0`}function mO(t,e,n){return`indices(${t}, 0) is invalid: ${e} >= ${n}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gO(t,e){return`only one output dimension may be -1, not both ${t} and ${e}`}function xO(t,e){return`size ${t} must be non-negative, not ${e}`}function yO(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function bO(t,e){const n=Z(t),s=Z(e);return`Input to reshape is a SparseTensor with ${n}
  dense values, but the requested shape requires a multiple of ${s}. inputShape=${t} outputShape= ${e}`}function vO(t,e){const n=Z(t),s=Z(e);return`Input to reshape is a tensor with ${n} dense values, but the requested shape has ${s}. inputShape=${t} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zv(){return"segment ids must be >= 0"}function wO(){return"segment ids are not increasing"}function kO(t,e){return`Segment id ${t} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function CO(t,e,n){return`Bad: indices[${t}] == ${e} out of range [0, ${n})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SO(t,e){let n=!1,s;for(t<=gS?(s=t,n=!0):s=vv(t,Math.floor(Math.sqrt(t)));!n;)s>e||s===t?n=!0:s=vv(t,s+1);return s}function $O(t,e,n){const s=[],r=t.length;for(let o=0;o<r;o++)o!==e?s.push(t[o]):s.push(n);return s}function DS(t,e,n,s){const r=e.shape.length,o=t.shape.length;if(s!==0&&(s<-r||s>r))throw new Error(`Expect batchDims in the range of [-${r}, ${r}], but got ${s}`);if(s<0&&(s+=r),s>o)throw new Error(`batchDims (${s}) must be less than rank(x) (
    ${o}).`);if(n<s)throw new Error(`batchDims (${s}) must be less than or equal to axis (${n}).`);for(let d=0;d<s;++d)if(t.shape[d]!==e.shape[d])throw new Error(`x.shape[${d}]: ${t.shape[d]} should be equal to indices.shape[${d}]: ${e.shape[d]}.`);const i=t.shape[n],a=[];let l=1,c=1,u=1;for(let d=0;d<s;++d)a.push(t.shape[d]),l*=t.shape[d];for(let d=s;d<n;d++)a.push(t.shape[d]),c*=t.shape[d];for(let d=s;d<r;d++)a.push(e.shape[d]);for(let d=n+1;d<o;d++)a.push(t.shape[d]),u*=t.shape[d];return{batchSize:l,sliceSize:u,outerSize:c,dimSize:i,outputShape:a}}const R8=Object.freeze(Object.defineProperty({__proto__:null,collectGatherOpShapeInfo:DS,computeOutShape:$O,segOpComputeOptimalWindowSize:SO},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function di(t){try{return t.map(e=>sa(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function IO(t){return t.map(e=>Yi(e))}const A8=Object.freeze(Object.defineProperty({__proto__:null,ERF_A1:wS,ERF_A2:kS,ERF_A3:CS,ERF_A4:SS,ERF_A5:$S,ERF_P:vS,PARALLELIZE_THRESHOLD:gS,get RowPartitionType(){return qr},SELU_SCALE:Hx,SELU_SCALEALPHA:Ux,applyActivation:nS,assertAndGetBroadcastShape:Le,assertAxesAreInnerMostDims:zn,assertParamsConsistent:mS,assignToTypedArray:uO,axesAreInnerMostDims:DC,calculateShapes:Ll,checkEinsumDimSizes:NS,checkPadOnDimRoundingMode:Is,combineLocations:xF,combineRaggedTensorToTensorShapes:sO,complexWithEvenIndex:lO,complexWithOddIndex:cO,computeConv2DInfo:Ln,computeConv3DInfo:ga,computeDefaultPad:TC,computeDilation2DInfo:Df,computeOptimalWindowSize:Wx,computeOutAndReduceShapes:An,computeOutShape:_o,computePool2DInfo:Pr,computePool3DInfo:yi,convertConv2DDataFormat:bi,decodeEinsumEquation:TS,eitherStridesOrDilationsAreOne:Qn,expandShapeToKeepDim:fn,exponent:hO,exponents:dO,fromStringArrayToUint8:IO,fromUint8ToStringArray:di,getAxesPermutation:Wt,getBroadcastDims:qc,getComplexWithIndex:IS,getEinsumComputePath:_S,getEinsumPermutation:ES,getFusedBiasGradient:tS,getFusedDyActivation:eS,getImageCenter:xS,getInnerMostAxes:sn,getPermuted:zf,getRaggedRank:oO,getReductionAxes:$n,getReshaped:Lf,getReshapedPermuted:Bf,getRowPartitionTypesHelper:rO,getSliceBeginCoords:yS,getSliceSize:bS,getSparseFillEmptyRowsIndicesDenseShapeMismatch:fO,getSparseFillEmptyRowsNegativeIndexErrorMessage:pO,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:mO,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:yO,getSparseReshapeInputOutputMismatchErrorMessage:vO,getSparseReshapeInputOutputMultipleErrorMessage:bO,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:gO,getSparseReshapeNegativeOutputDimErrorMessage:xO,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:CO,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:zv,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:wO,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:kO,getUndoAxesPermutation:xa,isIdentityPermutation:RS,log:mU,mergeRealAndImagArrays:ui,prepareAndValidate:cS,prepareSplitSize:AS,segment_util:R8,shouldFuse:sS,slice_util:I8,splitRealAndImagArrays:aO,stridesOrDilationsArePositive:gl,tupleValuesAreOne:ml,upcastType:Bs,validateDefaultValueShape:iO,validateInput:cj,validateUpdateShape:PF,warn:Ks},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */w8();/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TO={kernelName:A0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,Mf(ve(n,"float32"),-1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D8={kernelName:Mh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Nt(ve(n,"float32")),r=Yn(_e(at(1),s));return tn(Ne(t,r))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F8={kernelName:Lh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Yn(_e(Nt(ve(n,"float32")),1));return Ne(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O8={kernelName:gu,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{let a=t;const l=$n(n.shape,r);return l.length>0&&(a=Ee(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=$n(s.shape,r);return l.length>0&&(a=Ee(a,l)),U(a,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P8={kernelName:Mk,saveAllInputs:!0,gradFunc:(t,e)=>{const n={};return e.forEach((s,r)=>{n[r]=()=>t.clone()}),n}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8={kernelName:D0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(n)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L8={kernelName:F0,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>nt(n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const z8={kernelName:zh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,Yn(_e(at(1),Nt(ve(n,"float32")))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const B8={kernelName:Bh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=Yn(ie(at(1),Nt(ve(n,"float32"))));return Ne(t,s)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V8={kernelName:Uh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=ie(Nt(n),Nt(s));let l=V(t,Ne(s,a));const c=$n(n.shape,r);return c.length>0&&(l=Ee(l,c)),U(l,n.shape)},b:()=>{const a=ie(Nt(n),Nt(s));let l=tn(V(t,Ne(n,a)));const c=$n(s.shape,r);return c.length>0&&(l=Ee(l,c)),U(l,s.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W8={kernelName:Vh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,ie(Nt(ve(n,"float32")),1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U8={kernelName:Wh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,_e(at(1),Nt(ve(n,"float32"))))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(t,e,n,s,r,o){const i=O(t,"dy","avgPool3dGrad"),a=O(e,"input","avgPool3dGrad");let l=i,c=a,u=!1;a.rank===4&&(u=!0,l=U(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]]),c=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]])),T(l.rank===5,()=>`Error in avgPool3dGrad: dy must be rank 5 but got rank ${l.rank}.`),T(c.rank===5,()=>`Error in avgPool3dGrad: input must be rank 5 but got rank ${c.rank}.`),Is("avgPool3dGrad",r,o);const d={dy:l,input:c},h={filterSize:n,strides:s,pad:r,dimRoundingMode:o},f=W.runKernel(Vk,d,h);return u?U(f,[f.shape[1],f.shape[2],f.shape[3],f.shape[4]]):f}const G8=H({avgPool3dGrad_:H8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j8={kernelName:P0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i,dimRoundingMode:a}=n;return{x:()=>G8(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K8(t,e,n,s,r){const o=O(t,"dy","avgPoolGrad"),i=O(e,"input","avgPoolGrad");T(i.rank===o.rank,()=>`Rank of input (${i.rank}) does not match rank of dy (${o.rank})`);let a=i,l=o,c=!1;i.rank===3&&(c=!0,a=U(i,[1,i.shape[0],i.shape[1],i.shape[2]]),l=U(o,[1,o.shape[0],o.shape[1],o.shape[2]])),T(l.rank===4,()=>`Error in avgPoolGrad: dy must be rank 4 but got rank ${l.rank}.`),T(a.rank===4,()=>`Error in avgPoolGrad: input must be rank 4 but got rank ${a.rank}.`);const u={dy:l,input:a},d={filterSize:n,strides:s,pad:r},h=W.runKernel(Bk,u,d);return c?U(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const X8=H({avgPoolGrad_:K8});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q8={kernelName:O0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{filterSize:r,strides:o,pad:i}=n;return{x:()=>X8(t,s,r,o,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y8={kernelName:M0,inputsToSave:["a","b"],gradFunc:(t,e,n)=>{const[s,r]=e,{transposeA:o,transposeB:i}=n;return!o&&!i?{a:()=>it(t,r,!1,!0),b:()=>it(s,t,!0,!1)}:!o&&i?{a:()=>it(t,r,!1,!1),b:()=>it(t,s,!0,!1)}:o&&!i?{a:()=>it(r,t,!1,!0),b:()=>it(s,t,!1,!1)}:{a:()=>it(r,t,!0,!0),b:()=>it(t,s,!0,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Q8={kernelName:L0,gradFunc:(t,e,n)=>{const{blockShape:s,crops:r}=n;return{x:()=>VC(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Z8={kernelName:dU,gradFunc:(t,e,n)=>{const s=n,r=s.inputShape,o=s.shape,i=Array.from(o);for(let l=r.length-1;l>=0;l--)if(r[l]===o[l])i[l]=1;else if(r[l]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${o}].`);const a=[];for(let l=0;l<i.length;l++)i[l]>1&&a.push(l);return{x:()=>Ee(t,a,!0)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J8={kernelName:Hh,gradFunc:t=>({x:()=>t.clone()})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eK={kernelName:Gh,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tK={kernelName:jh,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{clipValueMin:r,clipValueMax:o}=n;return{x:()=>cs(li(Ol(s,r),bu(s,o)),t,nt(t))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nK={kernelName:z0,inputsToSave:["x"],gradFunc:TO.gradFunc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sK={kernelName:B0,saveAllInputs:!0,gradFunc:(t,e,n)=>{const s=e.map(l=>l.shape),{axis:r}=n,o=je(r,e[0].shape)[0],i=s.map(l=>l[o]);return Js(t,i,o).map(l=>()=>l)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rK={kernelName:V0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{dilations:o,strides:i,pad:a,dataFormat:l}=n;return T(ml(o),()=>`Error in gradient of conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`),{x:()=>_C(s.shape,t,r,i,a,l),filter:()=>JC(s,t,r.shape,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oK={kernelName:W0,inputsToSave:["dy","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,{strides:o,pad:i,dataFormat:a,dimRoundingMode:l}=n;return{dy:()=>xl(t,r,o,i,a,1,l),filter:()=>JC(t,s,r.shape,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iK(t,e,n,s,r){let o=t;t.rank===4&&(o=U(t,[1,t.shape[0],t.shape[1],t.shape[2],t.shape[3]]));let i=e;i.rank===4&&(i=U(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]])),T(o.rank===5,()=>`Error in conv3dDerFilter: input must be rank 5, but got shape ${o.shape}.`),T(i.rank===5,()=>`Error in conv3dDerFilter: dy must be rank 5, but got shape ${i.shape}.`),T(n.length===5,()=>`Error in conv3dDerFilter: filterShape must be length 5, but got ${n}.`),T(o.shape[4]===n[3],()=>`Error in conv3dDerFilter: depth of input ${o.shape[4]}) must match input depth in filter (${n[3]}.`),T(i.shape[4]===n[4],()=>`Error in conv3dDerFilter: depth of dy (${i.shape[4]}) must match output depth for filter (${n[4]}).`);const a={x:o,dy:i},l={strides:s,pad:r,filterShape:n};return W.runKernel(jk,a,l)}const aK=H({conv3DBackpropFilter_:iK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lK={kernelName:U0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o}=n;T(ml(s),()=>`Error in gradient of conv3D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${s}'`);const[i,a]=e;return{x:()=>fF(i.shape,t,a,r,o),filter:()=>aK(i,t,a.shape,r,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cK={kernelName:Kh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(tn(AF(ve(n,"float32"))),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uK={kernelName:Xh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(DF(ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dK={kernelName:H0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r,exclusive:o,reverse:i}=n;return{x:()=>{const a=Wt([r],s.rank);let l=mF(t,r,o,!i);return a!=null&&(l=tt(l,a)),l}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hK={kernelName:G0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const{dilations:s,strides:r,pad:o,dimRoundingMode:i}=n,a=s??[1,1];T(ml(a),()=>`Error in gradient of depthwiseConv2dNative: dilation rates greater than 1 are not yet supported. Got dilations '${a}'`);const[l,c]=e;return T(l.rank===4,()=>`Error in gradient of depthwiseConv2dNative: input must be rank 4, but got rank ${l.rank}.`),T(c.rank===4,()=>`Error in gradient of depthwiseConv2dNative: filter must be rank 4, but got rank ${c.rank}.`),T(l.shape[3]===c.shape[2],()=>`Error in gradient of depthwiseConv2d: number of input channels (${l.shape[3]}) must match the inChannels dimension in filter ${c.shape[2]}.`),T(Qn(r,a),()=>`Error in gradient of depthwiseConv2d: Either strides or dilations must be  1. Got strides ${r} and dilations '${a}'.`),Is("depthwiseConv2d",o,i),{x:()=>Ej(l.shape,t,c,r,o,a,i),filter:()=>Ij(l,t,c.shape,r,o,a,i)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fK={kernelName:j0,inputsToSave:["x","filter"],gradFunc:(t,e,n)=>{const[s,r]=e,o={x:s,filter:r,dy:t},i={x:s,filter:r,dy:t};return{x:()=>W.runKernel(wv,o,n),filter:()=>W.runKernel(kv,i,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pK={kernelName:Yh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e,s={dy:t,y:n};return{x:()=>W.runKernel(tC,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mK={kernelName:Qh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=V(Po(tn(Nt(n))),2/Math.sqrt(Math.PI));return{x:()=>V(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gK={kernelName:Zh,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xK={kernelName:X0,inputsToSave:["input"],gradFunc:(t,e)=>{const[n]=e;return{input:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yK={kernelName:Jh,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,Po(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bK={kernelName:ef,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vK={kernelName:tf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=Ne(t,ve(s,"float32")),l=$n(n.shape,r);return l.length>0?U(Ee(a,l),n.shape):a},b:()=>{let a=V(t,ve(n,"float32"));const l=$n(s.shape,r);l.length>0&&(a=U(Ee(a,l),s.shape));const c=Nt(s);return tn(Ne(a,ve(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wK={kernelName:q0,inputsToSave:["x","mean","variance","scale"],gradFunc:(t,e,n)=>{const{varianceEpsilon:s}=n,[r,o,i,a]=e,l=a??at(1),c=$n(o.shape,r.shape),u=[];if(o.rank===1){for(let v=0;v<r.shape.length-1;++v)u.push(r.shape[v]);u.push(1)}const d=_e(r,o),h=V(t,l),f=NF(ie(i,at(s))),p=V(V(V(f,f),f),at(-.5));return{x:()=>o.rank===1?U(V(V(t,Qr(U(f,[1,1,1,o.shape[0]]),u)),l),r.shape):U(V(V(t,f),l),r.shape),mean:()=>{let v=V(V(f,at(-1)),h);return o.rank===1&&(v=Ee(v,c)),U(v,o.shape)},variance:()=>{let v=V(V(p,d),h);return o.rank===1&&(v=Ee(v,c)),U(v,o.shape)},scale:()=>{const v=V(d,f);let w=V(t,v);return o.rank===1&&(w=Ee(w,c)),U(w,o.shape)},offset:()=>{let v=t;return o.rank===1&&(v=Ee(v,c)),U(v,o.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kK={kernelName:Y0,inputsToSave:["x","indices"],gradFunc:(t,e,n)=>{const[s,r]=e,{axis:o,batchDims:i}=n,a=je(o,s.shape)[0],l=(c,u,d)=>()=>{const h=c.shape,f=u.size,p=h.slice(0,a),m=p.length,x=h.slice(o,h.length).slice(1),g=x.length,y=rT(0,m),b=rT(m+1,m+1+g),v=oT([p,[f],x]),w=U(d,v),k=U(u,[f]),C=oT([[m],y,b]),S=tt(w,C);let I=LF(S,k,c.shape[a]);const $=xa(C);return I=tt(I,$),I};if(i===1){const c=s.shape[0],u=s.split(c,0);return{x:()=>ci(u.map((f,p)=>l(f,r.slice(p,1),t.slice(p,1))())).reshape(s.shape),indices:()=>r}}else return{x:l(s,r,t),indices:()=>r}}};function rT(t,e){const n=[];for(let s=t;s<e;++s)n.push(s);return n}function oT(t){const e=[];for(let n=0;n<t.length;++n)for(let s=0;s<t[n].length;++s)e.push(t[n][s]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CK={kernelName:nf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>nt(n),b:()=>nt(s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SK={kernelName:sf,gradFunc:t=>({x:()=>ve(t,"float32")})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $K={kernelName:rf,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IK={kernelName:of,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TK={kernelName:af,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EK={kernelName:Z0,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{alpha:r}=n,o=ar(s,0);return{x:()=>cs(o,t,V(t,r))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NK={kernelName:cf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,ie(n,1))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _K={kernelName:lf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,ve(n,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RK={kernelName:fU,inputsToSave:[],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;return{logits:()=>{const i=Po(s);return _e(t,V(Ee(t,r,!0),i))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AK(t,e,n,s=5,r=1,o=1,i=.5){const a={x:t,y:e,dy:n},l={depthRadius:s,bias:r,alpha:o,beta:i};return W.runKernel(aC,a,l)}const DK=H({localResponseNormalizationBackprop_:AK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FK={kernelName:rx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{depthRadius:o,bias:i,alpha:a,beta:l}=n;return{x:()=>DK(s,r,t,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EO(t,e,n,s){return e.rank<n.rank&&(e=U(e,fn(e.shape,s))),t.rank<n.rank&&(t=U(t,fn(t.shape,s))),{x:()=>V(t,ve(Oo(n,e),t.dtype))}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iT={kernelName:ox,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{reductionIndices:r}=s,o=e[0],i=e[1],a=je(r,o.shape),l=EO(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OK={kernelName:uf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>V(t,ve(Ol(n,s),"float32")),b:()=>V(t,ve(Cg(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PK(t,e,n,s,r,o,i){const a=O(t,"dy","maxPool3dGrad"),l=O(e,"input","maxPool3dGrad"),c=O(n,"output","maxPool3dGrad");let u=a,d=l,h=c,f=!1;l.rank===4&&(f=!0,u=U(a,[1,a.shape[0],a.shape[1],a.shape[2],a.shape[3]]),d=U(l,[1,l.shape[0],l.shape[1],l.shape[2],l.shape[3]]),h=U(c,[1,c.shape[0],c.shape[1],c.shape[2],c.shape[3]])),T(u.rank===5,()=>`Error in maxPool3dGrad: dy must be rank 5 but got rank ${u.rank}.`),T(d.rank===5,()=>`Error in maxPool3dGrad: input must be rank 5 but got rank ${d.rank}.`),T(h.rank===5,()=>`Error in maxPool3dGrad: output must be rank 5 but got rank ${h.rank}.`),Is("maxPool3dGrad",o,i);const p={dy:u,input:d,output:h},m={filterSize:s,strides:r,pad:o,dimRoundingMode:i},x=W.runKernel(cC,p,m);return f?U(x,[x.shape[1],x.shape[2],x.shape[3],x.shape[4]]):x}const MK=H({maxPool3dGrad_:PK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LK={kernelName:ax,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=n;return{x:()=>MK(t,s,r,o,i,a,l)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zK(t,e,n,s,r,o,i){const a=O(t,"dy","maxPoolGrad"),l=O(e,"input","maxPoolGrad"),c=O(n,"output","maxPoolGrad");T(l.rank===a.rank,()=>`Rank of input (${l.rank}) does not match rank of dy (${a.rank})`),T(a.rank===4,()=>`Error in maxPoolGrad: dy must be rank 4 but got rank ${a.rank}.`),T(l.rank===4,()=>`Error in maxPoolGrad: input must be rank 4 but got rank ${l.rank}.`),Is("maxPoolGrad",o,i);const u={dy:a,input:l,output:c},d={filterSize:s,strides:r,pad:o,dimRoundingMode:i};return W.runKernel(lC,u,d)}const BK=H({maxPoolGrad_:zK});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VK={kernelName:ix,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s,r]=e,{filterSize:o,strides:i,pad:a}=n;return{x:()=>BK(t,s,r,o,i,a)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WK={kernelName:lx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n,o=je(r,s.shape),a=An(s.shape,o)[1],l=Z(a);return{x:()=>{const u=s.shape.slice();o.forEach(f=>{u[f]=1});const d=U(t,u);return Ne(V(d,ba(s.shape,"float32")),l)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UK={kernelName:cx,inputsToSave:["x"],outputsToSave:[!0],gradFunc:(t,e,n)=>{const s=n,{axis:r}=s,[o,i]=e,a=je(r,o.shape),l=EO(t,i,o,a);return{x:()=>l.x()}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HK={kernelName:df,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e;return{a:()=>V(t,ve(bu(n,s),"float32")),b:()=>V(t,ve(ar(n,s),"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GK={kernelName:ux,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>Ct(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jK={kernelName:hf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=$n(n.shape,r);return a.length>0?U(Ee(t,a),n.shape):t},b:()=>{const a=V(t,tn(Bx(Ne(n,s)))),l=$n(s.shape,r);return l.length>0?U(Ee(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KK={kernelName:ff,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=V(t,ve(s,"float32")),l=$n(n.shape,r);return l.length>0?U(Ee(a,l),n.shape):a},b:()=>{const a=V(t,ve(n,"float32")),l=$n(s.shape,r);return l.length>0?U(Ee(a,l),s.shape):a}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XK={kernelName:dx,gradFunc:t=>({x:()=>tn(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qK={kernelName:px,inputsToSave:["indices"],gradFunc:(t,e)=>{const n=e[0];return{indices:()=>hn(n.shape,"float32")}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YK={kernelName:fx,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QK={kernelName:mx,saveAllInputs:!0,gradFunc:(t,e,n)=>{const{axis:s}=n;return vl(t,s).map(o=>()=>o)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aT={kernelName:gx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const s=e[0],{paddings:r}=n,o=r.map(i=>i[0]);return{x:()=>Ct(t,o,s.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZK={kernelName:pf,inputsToSave:["a","b"],outputsToSave:[!0],gradFunc:(t,e)=>{const[n,s,r]=e,o=n,i=s,a=Le(o.shape,i.shape);return{a:()=>{const u=ve(i,"float32");let d=V(t,V(u,yl(o,_e(u,at(1)))));const h=$n(o.shape,a);return h.length>0&&(d=Ee(d,h)),U(d,o.shape)},b:()=>{const u=ar(o,0),d=cs(u,Mo(o),nt(o));let h=V(t,V(r,d));const f=$n(i.shape,a);return f.length>0&&(h=Ee(h,f)),U(h,i.shape)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JK={kernelName:xx,inputsToSave:["x","alpha"],gradFunc:(t,e)=>{const[n,s]=e,r=ar(n,0);return{x:()=>cs(r,t,V(t,s)),alpha:()=>{let o=cs(r,nt(t),V(t,n));const i=$n(s.shape,t.shape);return i.length>0&&(o=Ee(o,i)),U(o,s.shape)}}}};/**
 * @license
 * Copyright 2022 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eX(t,e,n){const s=t.shape.slice();s[n]=1;const r=U(e,s),o=Pv(t,n,!0,!1),i=Pv(t,n,!0,!0),a=V(o,i);return V(r,a)}function tX(t,e,n){const s=t.shape.length,r=s-n.length,o=Wt(n,s);let i=t;o!=null&&(i=tt(t,o));const a=i.shape.slice(),c=a.splice(s-n.length,n.length).reduce((h,f)=>h*f,1);a.push(c);const u=i.reshape(a);let d=eX(u,e,r);if(d=d.reshape(i.shape),o!=null){const h=xa(o);d=tt(d,h)}return d}const nX={kernelName:yx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{axis:r}=n;let o=[];return r==null?o=s.shape.map((i,a)=>a):typeof r=="number"?o=[r]:o=r,{x:()=>tX(s,t,o)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sX={kernelName:qh,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{const a=Ne(t,ve(s,"float32")),l=$n(n.shape,r);return l.length>0?U(Ee(a,l),n.shape):a},b:()=>{let a=V(t,ve(n,"float32"));const l=$n(s.shape,r);l.length>0&&(a=U(Ee(a,l),s.shape));const c=Nt(s);return tn(Ne(a,ve(c,"float32")))}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rX={kernelName:mf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,tn(Nt(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oX={kernelName:xf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e,s=V(bu(n,6),Mf(n));return{x:()=>V(t,ve(s,"float32"))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iX={kernelName:gf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,ve(Mf(n),"float32"))}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aX={kernelName:bx,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>U(t,n.shape)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lX={kernelName:wx,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>W.runKernel(gC,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cX={kernelName:vx,inputsToSave:["images"],gradFunc:(t,e,n)=>{const[s]=e,r={dy:t,images:s};return{images:()=>W.runKernel(mC,r,n)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uX={kernelName:kx,gradFunc:(t,e,n)=>{const{dims:s}=n,r=je(s,t.shape);return{x:()=>bl(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dX={kernelName:yf,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hX={kernelName:bf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>tn(Ne(t,V(yl(n,1.5),2)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fX={kernelName:Cx,inputsToSave:["condition"],gradFunc:(t,e)=>{const[n]=e;return{condition:()=>ve(nt(n),"float32"),t:()=>V(t,ve(n,t.dtype)),e:()=>V(t,ve(MC(n),t.dtype))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pX={kernelName:vf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>{const s=ar(n,at(0)),r=at(Ux),o=at(Hx),i=V(t,o),a=V(V(t,r),Po(ve(n,"float32")));return cs(s,i,a)}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mX={kernelName:Sf,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,V(n,_e(at(1),n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gX={kernelName:Cf,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xX={kernelName:wf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(RC(ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yX={kernelName:kf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(pF(ve(n,"float32")),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bX={kernelName:Sx,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{begin:r,size:o}=n,i=s.shape,[a,l]=Vx(s,r,o),c=[];for(let u=0;u<t.rank;u++)c.push([a[u],i[u]-a[u]-l[u]]);return{x:()=>BC(t,c)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vX={kernelName:Ex,outputsToSave:[!0],gradFunc:(t,e,n)=>{const[s]=e,{dim:r}=n,o=!0,i=V(t,s);return{logits:()=>_e(i,V(Ee(i,[r],o),s))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wX={kernelName:$f,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,yu(n))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lT={kernelName:Ix,gradFunc:(t,e,n)=>{const{blockShape:s,paddings:r}=n;return{x:()=>NC(t,s,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cT={kernelName:Tx,gradFunc:(t,e,n)=>{const{axis:s}=n;return{x:()=>ws(t,s)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kX={kernelName:If,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,V(Yn(ve(n,"float32")),2))}}};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CX={kernelName:xC,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(t,V(ve(n,"float32"),2))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SX={kernelName:Tf,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=at(2);return{a:()=>V(t,V(r,_e(n,s))),b:()=>V(t,V(r,_e(s,n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $X={kernelName:Af,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IX={kernelName:Ef,inputsToSave:["a","b"],gradFunc:(t,e)=>{const[n,s]=e,r=Le(n.shape,s.shape);return{a:()=>{let a=t;const l=$n(n.shape,r);return l.length>0&&(a=Ee(a,l)),U(a,n.shape)},b:()=>{let a=t;const l=$n(s.shape,r);return l.length>0&&(a=Ee(a,l)),U(tn(a),s.shape)}}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TX={kernelName:$x,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,r=s.shape.slice(),{axis:o}=n;je(o,s.shape).forEach(c=>{r[c]=1});const a=U(t,r),l=V(a,ba(s.shape,"float32"));return{x:()=>l}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EX={kernelName:Nf,inputsToSave:["x"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>Ne(t,Nt(RC(n)))}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NX={kernelName:_f,outputsToSave:[!0],gradFunc:(t,e)=>{const[n]=e;return{x:()=>V(_e(at(1),Nt(n)),t)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _X={kernelName:Rf,inputsToSave:["x"],gradFunc:(t,e,n)=>{const[s]=e,{reps:r}=n;return{x:()=>{let i=nt(s);if(s.rank===1)for(let a=0;a<r[0];++a)i=ie(i,Ct(t,[a*s.shape[0]],[s.shape[0]]));else if(s.rank===2)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)i=ie(i,Ct(t,[a*s.shape[0],l*s.shape[1]],[s.shape[0],s.shape[1]]));else if(s.rank===3)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)i=ie(i,Ct(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2]],[s.shape[0],s.shape[1],s.shape[2]]));else if(s.rank===4)for(let a=0;a<r[0];++a)for(let l=0;l<r[1];++l)for(let c=0;c<r[2];++c)for(let u=0;u<r[3];++u)i=ie(i,Ct(t,[a*s.shape[0],l*s.shape[1],c*s.shape[2],u*s.shape[3]],[s.shape[0],s.shape[1],s.shape[2],s.shape[3]]));else throw new Error(`Gradient for tile operation is not implemented for rank-${s.rank} tensors yet.`);return i}}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RX={kernelName:Nc,gradFunc:(t,e,n)=>{const s=n,{perm:r}=s,o=xa(r);return{x:()=>tt(t,o)}}};/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AX={kernelName:Nx,gradFunc:(t,e,n)=>{const s=n,{axis:r}=s;return{value:()=>ci(t,r)}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DX={kernelName:_x,inputsToSave:["segmentIds"],gradFunc:(t,e)=>{const[n]=e;return{x:()=>FX(t,n)}}};function FX(t,e){const n=ya(e,nt(e)),s=FC(t,n);let r=Ol(e,at(0,"int32"));const o=s.rank-r.rank;for(let a=0;a<o;++a)r=ys(r,a+1);r=li(r,ba(s.shape,"bool"));const i=nt(s);return cs(r,s,i)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OX={kernelName:Rx,gradFunc:t=>({x:()=>nt(t)})};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PX=[TO,D8,F8,O8,P8,M8,L8,z8,B8,V8,W8,U8,j8,q8,Y8,Q8,Z8,J8,eK,tK,nK,sK,oK,rK,lK,cK,uK,dK,hK,fK,sX,pK,mK,gK,xK,yK,vK,bK,wK,kK,CK,SK,$K,IK,TK,EK,NK,_K,RK,FK,iT,iT,OK,LK,VK,WK,UK,HK,GK,jK,KK,XK,qK,YK,QK,aT,aT,ZK,JK,nX,rX,oX,iX,aX,lX,cX,uX,dX,hX,fX,pX,mX,gX,xX,yX,bX,vX,wX,lT,lT,cT,cT,kX,SX,CX,$X,IX,TX,EX,NX,_X,RX,AX,DX,OX];for(const t of PX)gU(t);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.abs=function(){return this.throwIfDisposed(),os(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.acos=function(){return this.throwIfDisposed(),y5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.acosh=function(){return this.throwIfDisposed(),v5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.add=function(t){return this.throwIfDisposed(),ie(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.all=function(t,e){return this.throwIfDisposed(),uF(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.any=function(t,e){return this.throwIfDisposed(),Fv(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.argMax=function(t){return this.throwIfDisposed(),ah(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.argMin=function(t){return this.throwIfDisposed(),$5(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.asScalar=function(){return this.throwIfDisposed(),T(this.size===1,()=>"The array must have only 1 element."),U(this,[])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.asType=function(t){return this.throwIfDisposed(),ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.as1D=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.as2D=function(t,e){return this.throwIfDisposed(),U(this,[t,e])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.as3D=function(t,e,n){return this.throwIfDisposed(),U(this,[t,e,n])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.as4D=function(t,e,n,s){return this.throwIfDisposed(),U(this,[t,e,n,s])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.as5D=function(t,e,n,s,r){return this.throwIfDisposed(),U(this,[t,e,n,s,r])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.asin=function(){return this.throwIfDisposed(),T5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.asinh=function(){return this.throwIfDisposed(),N5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.atan=function(){return this.throwIfDisposed(),R5(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.atan2=function(t){return this.throwIfDisposed(),D5(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.atanh=function(){return this.throwIfDisposed(),O5(this)};Q().prototype.avgPool=function(t,e,n,s){return this.throwIfDisposed(),EC(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.batchToSpaceND=function(t,e){return this.throwIfDisposed(),NC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.batchNorm=function(t,e,n,s,r){return this.throwIfDisposed(),Px(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.broadcastTo=function(t){return this.throwIfDisposed(),Dd(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.cast=function(t){return this.throwIfDisposed(),ve(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.ceil=function(){return this.throwIfDisposed(),lH(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.clipByValue=function(t,e){return this.throwIfDisposed(),sr(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.concat=function(t,e){return this.throwIfDisposed(),t instanceof xn&&(t=[t]),ws([this,...t],e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.conv1d=function(t,e,n,s,r,o){return this.throwIfDisposed(),dF(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.conv2dTranspose=function(t,e,n,s,r){return this.throwIfDisposed(),hF(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.conv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),xl(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.cos=function(){return this.throwIfDisposed(),RC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.cosh=function(){return this.throwIfDisposed(),pF(this)};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.cumprod=function(t,e,n){return this.throwIfDisposed(),Pv(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.cumsum=function(t,e,n){return this.throwIfDisposed(),mF(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.depthToSpace=function(t,e){return this.throwIfDisposed(),DH(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.depthwiseConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),AC(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.dilation2d=function(t,e,n,s,r){return this.throwIfDisposed(),PH(this,t,e,n,s,r)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.divNoNan=function(t){return this.throwIfDisposed(),VH(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.div=function(t){return this.throwIfDisposed(),Ne(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.dot=function(t){return this.throwIfDisposed(),UH(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.elu=function(){return this.throwIfDisposed(),Lx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.equal=function(t){return this.throwIfDisposed(),Oo(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.erf=function(){return this.throwIfDisposed(),gF(this)};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.euclideanNorm=function(t,e){return this.throwIfDisposed(),tG(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.exp=function(){return this.throwIfDisposed(),Po(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.expandDims=function(t){return this.throwIfDisposed(),ys(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.expm1=function(){return this.throwIfDisposed(),oG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.fft=function(){return this.throwIfDisposed(),OF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.flatten=function(){return this.throwIfDisposed(),U(this,[this.size])};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.floor=function(){return this.throwIfDisposed(),Bx(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.floorDiv=function(t){return this.throwIfDisposed(),cF(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.gather=function(t,e,n){return this.throwIfDisposed(),FC(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.greaterEqual=function(t){return this.throwIfDisposed(),Ol(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.greater=function(t){return this.throwIfDisposed(),ar(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.ifft=function(){return this.throwIfDisposed(),Mv(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.irfft=function(){return this.throwIfDisposed(),Y6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.isFinite=function(){return this.throwIfDisposed(),pG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.isInf=function(){return this.throwIfDisposed(),gG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.isNaN=function(){return this.throwIfDisposed(),yG(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.leakyRelu=function(t){return this.throwIfDisposed(),PC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.lessEqual=function(t){return this.throwIfDisposed(),bu(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.less=function(t){return this.throwIfDisposed(),Cg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.localResponseNormalization=function(t,e,n,s){return this.throwIfDisposed(),CG(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logSigmoid=function(){return this.throwIfDisposed(),_G(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logSoftmax=function(t){return this.throwIfDisposed(),wF(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logSumExp=function(t,e){return this.throwIfDisposed(),kF(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.log=function(){return this.throwIfDisposed(),Mo(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.log1p=function(){return this.throwIfDisposed(),vF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logicalAnd=function(t){return this.throwIfDisposed(),li(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logicalNot=function(){return this.throwIfDisposed(),MC(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logicalOr=function(t){return this.throwIfDisposed(),CF(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.logicalXor=function(t){return this.throwIfDisposed(),LG(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.matMul=function(t,e,n){return this.throwIfDisposed(),it(this,t,e,n)};Q().prototype.maxPool=function(t,e,n,s){return this.throwIfDisposed(),LC(this,t,e,n,s)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.max=function(t,e){return this.throwIfDisposed(),to(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.maximum=function(t){return this.throwIfDisposed(),ya(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.mean=function(t,e){return this.throwIfDisposed(),dn(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.min=function(t,e){return this.throwIfDisposed(),kg(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.minimum=function(t){return this.throwIfDisposed(),uh(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.mirrorPad=function(t,e){return this.throwIfDisposed(),jG(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.mod=function(t){return this.throwIfDisposed(),XG(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.mul=function(t){return this.throwIfDisposed(),V(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.neg=function(){return this.throwIfDisposed(),tn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.norm=function(t,e,n){return this.throwIfDisposed(),zx(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.notEqual=function(t){return this.throwIfDisposed(),Sg(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.oneHot=function(t,e=1,n=0){return this.throwIfDisposed(),SF(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.onesLike=function(){return this.throwIfDisposed(),Fr(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.pad=function(t,e){return this.throwIfDisposed(),BC(this,t,e)};Q().prototype.pool=function(t,e,n,s,r,o){return this.throwIfDisposed(),r6(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.pow=function(t){return this.throwIfDisposed(),yl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.prelu=function(t){return this.throwIfDisposed(),WC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.prod=function(t,e){return this.throwIfDisposed(),a6(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.reciprocal=function(){return this.throwIfDisposed(),_6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.relu=function(){return this.throwIfDisposed(),Ml(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.relu6=function(){return this.throwIfDisposed(),TF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.reshapeAs=function(t){return this.throwIfDisposed(),U(this,t.shape)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.reshape=function(t){return this.throwIfDisposed(),U(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.resizeBilinear=function(t,e,n){return this.throwIfDisposed(),BF(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.resizeNearestNeighbor=function(t,e,n){return this.throwIfDisposed(),VF(this,t,e,n)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.reverse=function(t){return this.throwIfDisposed(),bl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.rfft=function(){return this.throwIfDisposed(),J6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.round=function(){return this.throwIfDisposed(),EF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.rsqrt=function(){return this.throwIfDisposed(),NF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.selu=function(){return this.throwIfDisposed(),_F(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.separableConv2d=function(t,e,n,s,r,o){return this.throwIfDisposed(),RF(this,t,e,n,s,r,o)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sigmoid=function(){return this.throwIfDisposed(),yu(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sign=function(){return this.throwIfDisposed(),z6(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sin=function(){return this.throwIfDisposed(),AF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sinh=function(){return this.throwIfDisposed(),DF(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.slice=function(t,e){return this.throwIfDisposed(),Ct(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.softmax=function(t){return this.throwIfDisposed(),ZC(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.softplus=function(){return this.throwIfDisposed(),Ff(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.spaceToBatchND=function(t,e){return this.throwIfDisposed(),VC(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.split=function(t,e){return this.throwIfDisposed(),Js(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sqrt=function(){return this.throwIfDisposed(),Yn(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.square=function(){return this.throwIfDisposed(),Nt(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.squaredDifference=function(t){return this.throwIfDisposed(),tj(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.squeeze=function(t){return this.throwIfDisposed(),Pf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.stack=function(t,e){this.throwIfDisposed();const n=t instanceof xn?[this,t]:[this,...t];return ci(n,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.step=function(t){return this.throwIfDisposed(),Mf(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.stridedSlice=function(t,e,n,s,r,o,i,a){return this.throwIfDisposed(),ij(this,t,e,n,s,r,o,i,a)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sub=function(t){return this.throwIfDisposed(),_e(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.sum=function(t,e){return this.throwIfDisposed(),Ee(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.tan=function(){return this.throwIfDisposed(),lj(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.tanh=function(){return this.throwIfDisposed(),Ox(this)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.tile=function(t){return this.throwIfDisposed(),Qr(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.toBool=function(){return this.throwIfDisposed(),ve(this,"bool")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.toFloat=function(){return this.throwIfDisposed(),ve(this,"float32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.toInt=function(){return this.throwIfDisposed(),ve(this,"int32")};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.topk=function(t,e){return this.throwIfDisposed(),dj(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.transpose=function(t){return this.throwIfDisposed(),tt(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.unique=function(t){return this.throwIfDisposed(),pj(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.unsortedSegmentSum=function(t,e){return this.throwIfDisposed(),LF(this,t,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.unstack=function(t){return this.throwIfDisposed(),vl(this,t)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.where=function(t,e){return this.throwIfDisposed(),cs(t,this,e)};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */Q().prototype.zerosLike=function(){return this.throwIfDisposed(),nt(this)};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class yo extends Error{constructor(e){super(e),Object.setPrototypeOf(this,yo.prototype)}}class Sr extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Sr.prototype)}}class z extends Error{constructor(e){super(e),Object.setPrototypeOf(this,z.prototype)}}class Be extends Error{constructor(e){super(e),Object.setPrototypeOf(this,Be.prototype)}}class FS extends Error{constructor(e){super(e),Object.setPrototypeOf(this,FS.prototype)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NO{constructor(e){this.maxEntries=e||100,this.cache=new Map}get(e){let n;return this.cache.has(e)&&(n=this.cache.get(e),this.cache.delete(e),this.cache.set(e,n)),n}put(e,n){if(this.cache.has(e))this.cache.delete(e);else if(this.cache.size>=this.maxEntries){const s=this.cache.keys().next().value;this.cache.delete(s)}this.cache.set(e,n)}getMaxEntries(){return this.maxEntries}setMaxEntries(e){if(e<0)throw new Error(`The maxEntries of LRU caches must be at least 0, but got ${e}.`);if(this.maxEntries>e)for(let n=0;n<this.maxEntries-e;n++){const s=this.cache.keys().next().value;this.cache.delete(s)}this.maxEntries=e}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function wl(t,e){if(Array.isArray(t)){let n=[];for(let s=0;s<e;s++)n=n.concat(t);return n}else{const n=new Array(e);return n.fill(t),n}}function bo(t,e){if(!t)throw new FS(e)}function uT(t,e){let n=0;for(const s of t)s===e&&n++;return n}function bs(t){return t.length===1?t[0]:t}function ft(t){return Array.isArray(t)?t:[t]}function qo(t){const n=t.replace(/(.)([A-Z][a-z0-9]+)/g,"$1_$2").replace(/([a-z])([A-Z])/g,"$1_$2").toLowerCase();return n[0]!=="_"?n:"private"+n}function Va(t){return t.length<=1||t.indexOf("_")===-1?t:t.replace(/[_]+(\w|$)/g,(e,n)=>n.toUpperCase())}let ur={};function OS(t){if(t==null)return null;const e={};return e.className=t.getClassName(),e.config=t.getConfig(),e}function Bv(t){if(!(t==null||typeof t!="object"))if(Array.isArray(t))t.forEach(e=>Bv(e));else{const e=Object.keys(t);for(const n of e){const s=t[n];s!=null&&typeof s=="object"&&(!Array.isArray(s)&&s.type==="ndarray"&&typeof s.value=="number"?t[n]=s.value:Bv(s))}}}function Vf(t,e={},n={},s="object",r=!1){if(typeof t=="string"){const o=t;let i;if(o in n)i=n[o];else if(o in ur)i=ur[o];else if(i=e[o],i==null)throw new z(`Unknown ${s}: ${t}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);return i}else{const o=t;if(o.className==null||o.config==null)throw new z(`${s}: Improper config format: ${JSON.stringify(o)}.
'className' and 'config' must set.`);const i=o.className;let a,l;if(i in n?[a,l]=n[i]:i in ur?[a,l]=ur.className:i in e&&([a,l]=e[i]),a==null)throw new z(`Unknown ${s}: ${i}. This may be due to one of the following reasons:
1. The ${s} is defined in Python, in which case it needs to be ported to TensorFlow.js or your JavaScript code.
2. The custom ${s} is defined in JavaScript, but is not registered properly with tf.serialization.registerClass().`);if(l!=null){const c={};for(const f of Object.keys(ur))c[f]=ur[f];for(const f of Object.keys(n))c[f]=n[f];const u=o.config;u.customObjects=c;const d=Object.assign({},ur);for(const f of Object.keys(n))ur[f]=n[f];Bv(o.config);const h=l(a,o.config,n,r);return ur=Object.assign({},d),h}else{const c=Object.assign({},ur);for(const d of Object.keys(n))ur[d]=n[d];const u=new a(o.config);return ur=Object.assign({},c),u}}}function MX(t,e){return t<e?-1:t>e?1:0}function Ap(t,e){return-1*MX(t,e)}function Qi(t){if(t==null)return t;const e=[];for(const n of t)e.indexOf(n)===-1&&e.push(n);return e}function LX(t){if(t==null)throw new z(`Invalid value in obj: ${JSON.stringify(t)}`);for(const e in t)if(t.hasOwnProperty(e))return!1;return!0}function zl(t,e,n){if(n!=null&&t.indexOf(n)<0)throw new z(`${n} is not a valid ${e}.  Valid values are ${t} or null/undefined.`)}function PS(t,e,n=0,s=1/0){return bo(n>=0),bo(s>=n),Array.isArray(t)&&t.length>=n&&t.length<=s&&t.every(r=>typeof r===e)}function _n(t,e){Array.isArray(t)?(T(t.length>0,()=>`${e} is unexpectedly an empty array.`),t.forEach((n,s)=>_n(n,`element ${s+1} of ${e}`))):T(Number.isInteger(t)&&t>0,()=>`Expected ${e} to be a positive integer, but got ${_O(t)}.`)}function _O(t){return t===null?"null":Array.isArray(t)?"["+t.map(e=>_O(e)).join(",")+"]":typeof t=="string"?`"${t}"`:`${t}`}function zX(t,e,n){let s=n!=null?n():xs(),r;return(...i)=>{const a=n!=null?n():xs();return a-s<e||(s=a,r=t(...i)),r}}function RO(t){return t==="relu"?"relu":t==="linear"?"linear":t==="elu"?"elu":null}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let BX=0;function AO(){return BX++}const Dp={};function Gx(t=""){return t in Dp||(Dp[t]=0),Dp[t]+=1,t+Dp[t].toString()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const VX=["channelsFirst","channelsLast"],WX=["nearest","bilinear"],UX=["valid","same","causal"],HX=["max","avg"],GX=["sum","mul","concat","ave"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const ql=new Map;function rn(t){zl(VX,"DataFormat",t)}function jX(t){zl(WX,"InterpolationFormat",t)}function lr(t){zl(UX,"PaddingMode",t)}function DO(t){zl(HX,"PoolMode",t)}const Fd=[],dT="/";function tl(t,e){Fd.push(t);try{const n=e();return Fd.pop(),n}catch(n){throw Fd.pop(),n}}function KX(){return Fd.length===0?"":Fd.join(dT)+dT}function FO(t){if(!PO(t))throw new Error("Not a valid tensor name: '"+t+"'");return KX()+t}function OO(t){if(!PO(t))throw new Error("Not a valid tensor name: '"+t+"'");ql.has(t)||ql.set(t,0);const e=ql.get(t);if(ql.set(t,ql.get(t)+1),e>0){const n=`${t}_${e}`;return ql.set(n,1),n}else return t}const XX=new RegExp(/^[A-Za-z0-9][-A-Za-z0-9\._\/]*$/);function PO(t){return!!t.match(XX)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qX(t){return t===parseInt(t.toString(),10)}function Zi(t,e,n){e==null&&(e=0),n==null&&(n=t.length);let s=1;for(let r=e;r<n;++r)s*=t[r];return s}function Qc(t){if(t.length===0)return Number.NaN;let e=Number.POSITIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s<e&&(e=s)}return e}function ra(t){if(t.length===0)return Number.NaN;let e=Number.NEGATIVE_INFINITY;for(let n=0;n<t.length;n++){const s=t[n];s>e&&(e=s)}return e}function ro(t,e){if(e<t)throw new z(`end (${e}) < begin (${t}) is forbidden.`);const n=[];for(let s=t;s<e;++s)n.push(s);return n}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Hb;function vn(){return Hb==null&&(Hb=WU().epsilon()),Hb}function oo(){return"channelsLast"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ro(t,e){return ve(t,e)}function Wf(t,e=-1){const n=t.shape.slice();return e<0&&(e=n.length+e+1),n.splice(e,0,1),U(t,n)}function YX(t,e){return j(()=>{if(t.shape.length!==2)throw new z(`repeat() expects a rank-2 tensor, but received a rank-${t.shape.length} tensor.`);const n=Wf(t,1);return Vv(n,[1,e,1])})}function QX(t){const e=[Zi(t.shape)];return U(t,e)}function ZX(t){if(t.rank<=1)throw new z(`batchFlatten requires a minimum rank of 2. Got rank: ${t.rank}.`);const e=[t.shape[0],Zi(t.shape,1)];return U(t,e)}function nl(t,e,n){return j(()=>{switch(t.rank){case 1:return YC(t,e,n);case 2:return FF(t,[e,0],[n,t.shape[1]]);case 3:return QC(t,[e,0,0],[n,t.shape[1],t.shape[2]]);case 4:return Ig(t,[e,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3]]);case 5:return Ct(t,[e,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4]]);case 6:return Ct(t,[e,0,0,0,0,0],[n,t.shape[1],t.shape[2],t.shape[3],t.shape[4],t.shape[5]]);default:throw new z(`sliceAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Gb(t,e,n){return j(()=>{switch(t.rank){case 1:return YC(t,e,n);case 2:return FF(t,[0,e],[t.shape[0],n]);case 3:return QC(t,[0,0,e],[t.shape[0],t.shape[1],n]);case 4:return Ig(t,[0,0,0,e],[t.shape[0],t.shape[1],t.shape[2],n]);default:throw new z(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function Fp(t,e,n,s){return j(()=>{switch(t.rank){case 1:return YC(t,e,n);case 2:switch(s){case 1:return nl(t,e,n);case 2:return Gb(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}case 3:switch(s){case 1:return nl(t,e,n);case 2:return QC(t,[0,e,0],[t.shape[0],n,t.shape[2]]);case 3:return Gb(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}case 4:switch(s){case 1:return nl(t,e,n);case 2:return Ig(t,[0,e,0,0],[t.shape[0],n,t.shape[2],t.shape[3]]);case 3:return Ig(t,[0,0,e,0],[t.shape[0],t.shape[1],n,t.shape[3]]);case 4:return Gb(t,e,n);default:throw new z(`The axis is not within the rank of the tensor ${s}`)}default:throw new z(`sliceAlongLastAxis() received an unsupported tensor rank: ${t.rank}`)}})}function MS(t,e=-1){let n;return e<0&&(n=t[0].rank,n!==0?e=n:e=0),e===t[0].rank&&(e=-1),ws(t,e)}function hT(t,e){switch(t.rank){case 1:return dH([t,e]);case 2:return fH([t,e],0);case 3:return mH([t,e],0);case 4:return xH([t,e],0);default:throw new z(`concatAlongFirstAxis() received an unsupported tensor rank: ${t.rank}`)}}function Vv(t,e){if(Array.isArray(e)||(e=[e]),t.rank!==e.length)throw new z(`The length of input n (${e.length}) does not match the number of dimensions in input x (${t.rank})`);return Qr(t,e)}function jx(t,e=0,n=1,s,r){return I6(t,e,n,s,r)}function Ao(t,e,n,s){if(t.rank<2||e.rank<2)throw new Be(`dot requires both inputs to be rank >= 2 but got x shape = ${t.shape} and y shape = ${e.shape}`);if(e.rank>=3){const r=t.shape.slice(-1)[0],o=e.shape.slice(-2)[0];if(r!==o)throw new Be(`If rank y >= 3, then the second last dim of y must equal the last dim of x but got x shape = ${t.shape} and  y shape = ${e.shape}`)}if(t.rank===2&&e.rank===2)return Z2({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Wv(t.rank,s,oo()):null,activation:n});{const r=t.shape.slice(),o=r.pop();t=U(t,[-1,o]);const i=e.shape.slice(),a=i.pop(),l=i.pop(),c=[...i,a],u=Array.from({length:e.rank},(p,m)=>m===0?e.rank-2:m<=e.rank-2?m-1:m);e=U(tt(e,u),[l,-1]);const d=[...r,...c];return U(Z2({a:t,b:e,transposeA:!1,transposeB:!1,bias:s?Wv(t.rank,s,oo()):null,activation:n}),d)}}function MO(t,e,n){return j(()=>(Array.isArray(e)?e=Os(e,"int32"):e=ve(e,"int32"),FC(t,e,n)))}function Uf(t){return V(t,t)}function Wv(t,e,n){const s=e.shape;if(e.rank!==1&&e.rank!==t)throw new z(`Unexpected bias dimensions: ${e.rank}; expected it to be 1 or ${t}`);if(t===5){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1,1]):U(e,[1,s[3],s[0],s[1],s[2]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===4){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1,1]):U(e,[1,s[2],s[0],s[1]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,1,s[0]]):U(e,[1].concat(s))}else if(t===3){if(n==="channelsFirst")return s.length===1?U(e,[1,s[0],1]):U(e,[1,s[1],s[0]]);if(n==="channelsLast")return s.length===1?U(e,[1,1,s[0]]):U(e,[1].concat(s))}else if(t<3)return e;throw new z(`Unsupported input rank by biasAdd: ${e.rank}`)}function lo(t,e,n){return j(()=>(n==null&&(n=oo()),rn(n),ie(t,Wv(t.rank,e,n))))}function JX(t,e=1){if(e!==1)throw new Be(`Support for alpha values other than 1 (${e}) is not implemented yet.`);return Lx(t)}function eq(t){return j(()=>Ne(t,ie(os(t),1)))}function LO(t,e,n,s){return j(()=>wj(t,e,n,s))}function tq(t){return j(()=>{const e=ie(.5,V(.2,t));return sr(e,0,1)})}function Hf(t,e,n=!1){return n?t():e()}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const nq=["fanIn","fanOut","fanAvg"],sq=["normal","uniform","truncatedNormal"];/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function rq(t){zl(nq,"FanMode",t)}function oq(t){zl(sq,"Distribution",t)}class Mr extends wu{fromConfigUsesCustomObjects(){return!1}getConfig(){return{}}}class zO extends Mr{apply(e,n){return hn(e,n)}}zO.className="Zeros";re(zO);class LS extends Mr{apply(e,n){return ba(e,n)}}LS.className="Ones";re(LS);class BO extends Mr{constructor(e){if(super(),typeof e!="object")throw new z(`Expected argument of type ConstantConfig but got ${e}`);if(e.value===void 0)throw new z(`config must have value set but got ${e}`);this.value=e.value}apply(e,n){return j(()=>V(at(this.value),ba(e,n)))}getConfig(){return{value:this.value}}}BO.className="Constant";re(BO);class VO extends Mr{constructor(e){super(),this.DEFAULT_MINVAL=-.05,this.DEFAULT_MAXVAL=.05,this.minval=e.minval||this.DEFAULT_MINVAL,this.maxval=e.maxval||this.DEFAULT_MAXVAL,this.seed=e.seed}apply(e,n){return Of(e,this.minval,this.maxval,n,this.seed)}getConfig(){return{minval:this.minval,maxval:this.maxval,seed:this.seed}}}VO.className="RandomUniform";re(VO);class WO extends Mr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Be(`randomNormal does not support dType ${n}.`);return jx(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}WO.className="RandomNormal";re(WO);class UO extends Mr{constructor(e){super(),this.DEFAULT_MEAN=0,this.DEFAULT_STDDEV=.05,this.mean=e.mean||this.DEFAULT_MEAN,this.stddev=e.stddev||this.DEFAULT_STDDEV,this.seed=e.seed}apply(e,n){if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Be(`truncatedNormal does not support dType ${n}.`);return MF(e,this.mean,this.stddev,n,this.seed)}getConfig(){return{mean:this.mean,stddev:this.stddev,seed:this.seed}}}UO.className="TruncatedNormal";re(UO);let HO=class extends Mr{constructor(e){super(),this.gain=e.gain!=null?e.gain:1}apply(e,n){return j(()=>{if(e.length!==2||e[0]!==e[1])throw new z("Identity matrix initializer can only be used for 2D square matrices.");return V(this.gain,bF(e[0]))})}getConfig(){return{gain:this.gain}}};HO.className="Identity";re(HO);function iq(t,e="channelsLast"){let n,s;if(rn(e),t.length===2)n=t[0],s=t[1];else if([3,4,5].indexOf(t.length)!==-1){if(e==="channelsFirst"){const r=Zi(t,2);n=t[1]*r,s=t[0]*r}else if(e==="channelsLast"){const r=Zi(t,0,t.length-2);n=t[t.length-2]*r,s=t[t.length-1]*r}}else{const r=Zi(t);n=Math.sqrt(r),s=Math.sqrt(r)}return[n,s]}class Vs extends Mr{constructor(e){if(super(),e.scale<0)throw new z(`scale must be a positive float. Got: ${e.scale}`);this.scale=e.scale==null?1:e.scale,this.mode=e.mode==null?"fanIn":e.mode,rq(this.mode),this.distribution=e.distribution==null?"normal":e.distribution,oq(this.distribution),this.seed=e.seed}apply(e,n){const s=iq(e),r=s[0],o=s[1];let i=this.scale;if(this.mode==="fanIn"?i/=Math.max(1,r):this.mode==="fanOut"?i/=Math.max(1,o):i/=Math.max(1,(r+o)/2),this.distribution==="normal"){const a=Math.sqrt(i);if(n=n||"float32",n!=="float32"&&n!=="int32")throw new Be(`${this.getClassName()} does not support dType ${n}.`);return MF(e,0,a,n,this.seed)}else{const a=Math.sqrt(3*i);return Of(e,-a,a,n,this.seed)}}getConfig(){return{scale:this.scale,mode:this.mode,distribution:this.distribution,seed:this.seed}}}Vs.className="VarianceScaling";re(Vs);class zS extends Vs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Vs.className}}zS.className="GlorotUniform";re(zS);class BS extends Vs{constructor(e){super({scale:1,mode:"fanAvg",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Vs.className}}BS.className="GlorotNormal";re(BS);class VS extends Vs{constructor(e){super({scale:2,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Vs.className}}VS.className="HeNormal";re(VS);class WS extends Vs{constructor(e){super({scale:2,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Vs.className}}WS.className="HeUniform";re(WS);class US extends Vs{constructor(e){super({scale:1,mode:"fanIn",distribution:"normal",seed:e==null?null:e.seed})}getClassName(){return Vs.className}}US.className="LeCunNormal";re(US);class HS extends Vs{constructor(e){super({scale:1,mode:"fanIn",distribution:"uniform",seed:e==null?null:e.seed})}getClassName(){return Vs.className}}HS.className="LeCunUniform";re(HS);class GO extends Mr{constructor(e){super(),this.DEFAULT_GAIN=1,this.ELEMENTS_WARN_SLOW=2e3,this.gain=e.gain==null?this.DEFAULT_GAIN:e.gain,this.seed=e.seed}apply(e,n){return j(()=>{if(e.length<2)throw new Be("Shape must be at least 2D.");if(n!=="int32"&&n!=="float32"&&n!==void 0)throw new TypeError(`Unsupported data type ${n}.`);n=n;const s=Z(e.slice(0,-1)),r=e[e.length-1],o=s*r;o>this.ELEMENTS_WARN_SLOW&&console.warn(`Orthogonal initializer is being called on a matrix with more than ${this.ELEMENTS_WARN_SLOW} (${o}) elements: Slowness may result.`);const i=[Math.max(r,s),Math.min(r,s)],a=jx(i,0,1,n,this.seed),l=x8.qr(a,!1);let c=l[0];const d=l[1].flatten().stridedSlice([0],[Math.min(r,s)*Math.min(r,s)],[Math.min(r,s)+1]);return c=V(c,d.sign()),s<r&&(c=c.transpose()),V(at(this.gain),c.reshape(e))})}getConfig(){return{gain:this.gain,seed:this.seed}}}GO.className="Orthogonal";re(GO);const fT={constant:"Constant",glorotNormal:"GlorotNormal",glorotUniform:"GlorotUniform",heNormal:"HeNormal",heUniform:"HeUniform",identity:"Identity",leCunNormal:"LeCunNormal",leCunUniform:"LeCunUniform",ones:"Ones",orthogonal:"Orthogonal",randomNormal:"RandomNormal",randomUniform:"RandomUniform",truncatedNormal:"TruncatedNormal",varianceScaling:"VarianceScaling",zeros:"Zeros"};function pT(t,e={}){return Vf(t,br.getMap().classNameMap,e,"initializer")}function Vt(t){return OS(t)}function Ot(t){if(typeof t=="string"){const e=t in fT?fT[t]:t;if(e==="GlorotNormal")return new BS;if(e==="GlorotUniform")return new zS;if(e==="HeNormal")return new VS;if(e==="HeUniform")return new WS;if(e==="LeCunNormal")return new US;if(e==="LeCunUniform")return new HS;{const n={};return n.className=e,n.config={},pT(n)}}else return t instanceof Mr?t:pT(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Uv(t){return Array.isArray(t)&&Array.isArray(t[0])}function Tg(t){return t.length===0?[]:Array.isArray(t[0])?t:[t]}function De(t){let e;if(Array.isArray(t)){if(t.length!==1)throw new z(`Expected Tensor length to be 1; got ${t.length}`);e=t[0]}else e=t;return e}function rt(t){if(Array.isArray(t)&&Array.isArray(t[0])){if(t.length===1)return t=t,t[0];throw new z(`Expected exactly 1 Shape; got ${t.length}`)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Eg(t){let e=0;for(const n of t)n.shape.length===0?e+=1:e+=n.shape.reduce((s,r)=>s*r);return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const mT="Variable";class aq{constructor(e,n="float32",s=mT,r=!0,o=null){this.dtype=n??"float32",this.shape=e.shape,this.id=AO(),s=s??mT,this.originalName=FO(s),this.name=OO(this.originalName),this.trainable_=r,this.constraint=o,this.val=xj(e,this.trainable_,this.name,this.dtype)}read(){return this.assertNotDisposed(),this.val}write(e){return this.assertNotDisposed(),lq(this.val,e),this.val.id!==e.id&&(this.val.assign(e),this.constraint!=null&&this.val.assign(this.constraint.apply(this.val))),this}dispose(){this.assertNotDisposed(),this.val.dispose()}assertNotDisposed(){if(this.val.isDisposed)throw new Error(`LayersVariable ${this.name} is already disposed.`)}get trainable(){return this.trainable_}set trainable(e){this.trainable_=e,this.val.trainable=e}}function lq(t,e){if(t.shape.toString()!==e.shape.toString())throw new Error("Shape mismatch: "+JSON.stringify(t.shape)+" vs. "+JSON.stringify(e.shape))}function Hv(t){return t.map(e=>e.read())}function GS(t){t.forEach(e=>{e[0].write(e[1])})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class wn{constructor(e){this.dtype=e.dtype,this.shape=e.shape,e.shape!=null?this.ndim=e.shape.length:this.ndim=e.ndim,this.maxNDim=e.maxNDim,this.minNDim=e.minNDim,this.axes=e.axes||{}}}class Lo{constructor(e,n,s,r,o,i,a){this.dtype=e,this.shape=n,this.sourceLayer=s,this.inputs=r,this.callArgs=o,this.outputTensorIndex=a,this.id=AO(),i!=null&&(this.originalName=FO(i),this.name=OO(this.originalName)),this.rank=n.length}}let cq=0;class Kx{constructor(e,n){this.callArgs=n,this.id=cq++,this.outboundLayer=e.outboundLayer,this.inboundLayers=e.inboundLayers,this.nodeIndices=e.nodeIndices,this.tensorIndices=e.tensorIndices,this.inputTensors=e.inputTensors,this.outputTensors=e.outputTensors,this.inputMasks=e.inputMasks,this.outputMasks=e.outputMasks,this.inputShapes=e.inputShapes,this.outputShapes=e.outputShapes;for(const s of e.inboundLayers)s!=null&&s.outboundNodes.push(this);e.outboundLayer.inboundNodes.push(this)}getConfig(){const e=[];for(const n of this.inboundLayers)n!=null?e.push(n.name):e.push(null);return{outboundLayer:this.outboundLayer?this.outboundLayer.name:null,inboundLayers:e,nodeIndices:this.nodeIndices,tensorIndices:this.tensorIndices}}}let uq=0;class Ke extends wu{constructor(e={}){super(),this._callHook=null,this._addedWeightNames=[],this._stateful=!1,this.id=uq++,this.activityRegularizer=null,this.inputSpec=null,this.supportsMasking=!1,this._trainableWeights=[],this._nonTrainableWeights=[],this._losses=[],this._updates=[],this._built=!1,this.inboundNodes=[],this.outboundNodes=[];let n=e.name;if(!n){const s=this.getClassName();n=qo(s)+"_"+Gx(s)}if(this.name=n,this.trainable_=e.trainable==null?!0:e.trainable,e.inputShape!=null||e.batchInputShape!=null){let s;if(e.batchInputShape!=null)s=e.batchInputShape;else if(e.inputShape!=null){let o=null;e.batchSize!=null&&(o=e.batchSize),s=[o].concat(e.inputShape)}this.batchInputShape=s;let r=e.dtype;r==null&&(r=e.inputDType),r==null&&(r="float32"),this.dtype=r}e.weights!=null?this.initialWeights=e.weights:this.initialWeights=null,this._refCount=null,this.fastWeightInitDuringBuild=!1}static nodeKey(e,n){return e.name+"_ib-"+n.toString()}getNodeAtIndex(e,n){if(this.inboundNodes.length===0)throw new Sr(`The layer has never been called and thus has no defined ${n}.`);if(this.inboundNodes.length<=e)throw new z(`Asked to get ${n} at node ${e}, but the layer has only ${this.inboundNodes.length} inbound nodes.`);return this.inboundNodes[e]}getInputAt(e){return bs(this.getNodeAtIndex(e,"input").inputTensors)}getOutputAt(e){return bs(this.getNodeAtIndex(e,"output").outputTensors)}get input(){if(this.inboundNodes.length>1)throw new yo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer input" is ill-defined. Use \`getInputAt(nodeIndex)\` instead.`);if(this.inboundNodes.length===0)throw new yo(`Layer ${this.name} is not connected, no input to return.`);return bs(this.getNodeAtIndex(0,"input").inputTensors)}get output(){if(this.inboundNodes.length===0)throw new yo(`Layer ${this.name} has no inbound nodes.`);if(this.inboundNodes.length>1)throw new yo(`Layer ${this.name} has multiple inbound nodes, hence the notion of "layer output" is ill-defined. Use \`getOutputAt(nodeIndex)\` instead.`);return bs(this.getNodeAtIndex(0,"output").outputTensors)}get losses(){return this._losses}calculateLosses(){return this.losses.map(e=>e())}get updates(){return this._updates}get built(){return this._built}set built(e){this._built=e}get trainable(){return this.trainable_}set trainable(e){this._trainableWeights.forEach(n=>n.trainable=e),this.trainable_=e}get trainableWeights(){return this.trainable_?this._trainableWeights.filter(e=>e.trainable):[]}set trainableWeights(e){this._trainableWeights=e}get nonTrainableWeights(){return this.trainable?this._trainableWeights.filter(e=>!e.trainable).concat(this._nonTrainableWeights):this._trainableWeights.concat(this._nonTrainableWeights)}set nonTrainableWeights(e){this._nonTrainableWeights=e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}get stateful(){return this._stateful}resetStates(){if(!this.stateful)throw new Error("Cannot call the resetStates() method of a non-stateful Layer object.")}assertInputCompatibility(e){const n=ft(e);if(this.inputSpec==null||this.inputSpec.length===0)return;const s=ft(this.inputSpec);if(n.length!==s.length)throw new z(`Layer ${this.name} expects ${s.length} inputs, but it received ${n.length} input tensors. Input received: ${e}`);for(let r=0;r<n.length;r++){const o=n[r],i=s[r];if(i==null)continue;const a=o.rank;if(i.ndim!=null&&a!==i.ndim)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected ndim=${i.ndim}, found ndim=${a}`);if(i.maxNDim!=null&&a>i.maxNDim)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected max_ndim=${i.maxNDim}, found ndim=${a}`);if(i.minNDim!=null&&a<i.minNDim)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected min_ndim=${i.minNDim}, found ndim=${a}.`);if(i.dtype!=null&&o.dtype!==i.dtype)throw new z(`Input ${r} is incompatible with layer ${this.name} : expected dtype=${i.dtype}, found dtype=${o.dtype}.`);if(i.axes){const l=o.shape;for(const c in i.axes){const u=Number(c),d=i.axes[c],h=u>=0?l[u]:l[l.length+u];if(d!=null&&[d,null].indexOf(h)===-1)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected axis ${u} of input shape to have value ${d} but got shape ${l}.`)}}if(i.shape!=null)for(let l=0;l<i.shape.length;++l){const c=i.shape[l],u=o.shape[l];if(c!=null&&u!=null&&c!==u)throw new z(`Input ${r} is incompatible with layer ${this.name}: expected shape=${i.shape}, found shape=${o.shape}.`)}}}call(e,n){return e}invokeCallHook(e,n){this._callHook!=null&&this._callHook(e,n)}setCallHook(e){this._callHook=e}clearCallHook(){this._callHook=null}apply(e,n){n=n||{},this.assertNotDisposed();const s=ft(e),r=fq(e),o=pq(e);if(r===o)throw new z("Arguments to apply() must be all SymbolicTensors or all Tensors");return tl(this.name,()=>{if(!this.built){this.assertInputCompatibility(e);const i=[];for(const a of ft(e))i.push(a.shape);this.build(bs(i)),this.built=!0,this.initialWeights&&this.setWeights(this.initialWeights),this._refCount===null&&o&&(this._refCount=1)}if(this.assertInputCompatibility(e),o){let i=this.call(e,n);this.supportsMasking&&this.setMaskMetadata(e,i);const a=ft(i),l=[];for(let c of a)s.indexOf(c)!==-1&&(c=c.clone()),l.push(c);if(i=bs(l),this.activityRegularizer!=null)throw new Be("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return i}else{const i=dq(e),a=this.computeOutputShape(i);let l;const c=hq(e);if(this.warnOnIncompatibleInputShape(Array.isArray(e)?i[0]:i),a!=null&&a.length>0&&Array.isArray(a[0])?l=a.map((u,d)=>new Lo(c,u,this,ft(e),n,this.name,d)):l=new Lo(c,a,this,ft(e),n,this.name),this.addInboundNode(e,l,null,null,i,a,n),this._refCount++,this.activityRegularizer!=null)throw new Be("Layer invocation in the presence of activity regularizer(s) is not supported yet.");return l}})}warnOnIncompatibleInputShape(e){if(this.batchInputShape!=null)if(e.length!==this.batchInputShape.length)console.warn(`The rank of the input tensor provided (shape: ${JSON.stringify(e)}) does not match that of the batchInputShape (${JSON.stringify(this.batchInputShape)}) of the layer ${this.name}`);else{let n=!1;this.batchInputShape.forEach((s,r)=>{s!=null&&e[r]!=null&&e[r]!==s&&(n=!0)}),n&&console.warn(`The shape of the input tensor (${JSON.stringify(e)}) does not match the expectation of layer ${this.name}: ${JSON.stringify(this.batchInputShape)}`)}}get outputShape(){if(this.inboundNodes==null||this.inboundNodes.length===0)throw new yo(`The layer ${this.name} has never been called and thus has no defined output shape.`);const e=[];for(const n of this.inboundNodes){const s=JSON.stringify(n.outputShapes);e.indexOf(s)===-1&&e.push(s)}if(e.length===1){const n=this.inboundNodes[0].outputShapes;return Array.isArray(n)&&Array.isArray(n[0])&&n.length===1?n[0]:n}else throw new yo(`The layer ${this.name} has multiple inbound nodes with different output shapes. Hence the notion of "output shape" is ill-defined for the layer.`)}countParams(){if(!this.built)throw new Sr(`You tried to call countParams() on ${this.name}, but the layer is not built yet. Build it first by calling build(batchInputShape).`);return Eg(this.weights)}build(e){this.built=!0}getWeights(e=!1){return Hv(e?this.trainableWeights:this.weights)}setWeights(e){j(()=>{const n=this.weights;if(n.length!==e.length)throw new z(`You called setWeights(weights) on layer "${this.name}" with a weight list of length ${e.length}, but the layer was expecting ${n.length} weights. Provided weights: ${e}...`);if(n.length===0)return;const s=[],r=Hv(n);for(let o=0;o<r.length;++o){const i=r[o],a=n[o],l=e[o];if(!lt(i.shape,l.shape))throw new z(`Layer weight shape ${i.shape} not compatible with provided weight shape ${l.shape}`);s.push([a,l])}GS(s)})}addWeight(e,n,s,r,o,i,a,l){if(this._addedWeightNames.indexOf(e)!==-1)throw new z(`Duplicate weight name ${e} for layer ${this.name}`);this._addedWeightNames.push(e),s==null&&(s="float32"),this.fastWeightInitDuringBuild&&(r=l!=null?l():Ot("zeros"));const c=r.apply(n,s),u=new aq(c,s,e,i,a);return c.dispose(),o!=null&&this.addLoss(()=>o.apply(u.read())),i==null&&(i=!0),i?this._trainableWeights.push(u):this._nonTrainableWeights.push(u),u}setFastWeightInitDuringBuild(e){this.fastWeightInitDuringBuild=e}addLoss(e){e==null||Array.isArray(e)&&e.length===0||(e=ft(e),this._losses!==void 0&&this._losses!==null&&this.losses.push(...e))}computeOutputShape(e){return e}computeMask(e,n){if(!this.supportsMasking){if(n!=null)if(Array.isArray(n))n.forEach(s=>{if(s!=null)throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`)});else throw new TypeError(`Layer ${this.name} does not support masking, but was passed an inputMask.`);return null}return n}setMaskMetadata(e,n,s){if(!this.supportsMasking)return;const r=this.computeMask(e,s),o=ft(n),i=ft(r);if(o.length!==i.length)throw new Error(`${this.name} outputs ${o.length} tensors but ${o.length} masks for those tensors`);for(let a=0;a<o.length;a++)o[a].kerasMask=i[a]}addInboundNode(e,n,s,r,o,i,a=null){const l=ft(e);n=ft(n),s=ft(s),r=ft(r),o=Tg(o),i=Tg(i);const c=[],u=[],d=[];for(const h of l)c.push(h.sourceLayer),u.push(h.nodeIndex),d.push(h.tensorIndex);new Kx({outboundLayer:this,inboundLayers:c,nodeIndices:u,tensorIndices:d,inputTensors:l,outputTensors:n,inputMasks:s,outputMasks:r,inputShapes:o,outputShapes:i},a);for(let h=0;h<n.length;h++)n[h].sourceLayer=this,n[h].nodeIndex=this.inboundNodes.length-1,n[h].tensorIndex=h}getConfig(){const e={name:this.name,trainable:this.trainable};return this.batchInputShape!=null&&(e.batchInputShape=this.batchInputShape),this.dtype!=null&&(e.dtype=this.dtype),e}disposeWeights(){return this.weights.forEach(e=>e.dispose()),this.weights.length}assertNotDisposed(){if(this._refCount===0)throw new Error(`Layer '${this.name}' is already disposed.`)}dispose(){if(!this.built)throw new Error(`Cannot dispose Layer ${this.name} because it has not been built yet.`);if(this._refCount===null)throw new Error(`Cannot dispose Layer ${this.name} because it has not been used yet.`);this.assertNotDisposed();let e=0;return--this._refCount===0&&(e=this.disposeWeights()),{refCountAfterDispose:this._refCount,numDisposedVariables:e}}}function dq(t){t=ft(t);const e=[];for(const n of t)e.push(n.shape);return bs(e)}function hq(t){return"float32"}function jO(t,e,n){if((e==null||n!=null&&n>0)&&(e=t.sourceLayer,n=t.nodeIndex),e.inboundNodes.length===0)return[t];{const s=e.inboundNodes[n];if(s.inboundLayers.length===0)return s.inputTensors;{const r=[];for(let o=0;o<s.inboundLayers.length;o++){const i=s.inputTensors[o],a=s.inboundLayers[o],l=s.nodeIndices[o],c=jO(i,a,l);for(const u of c)r.indexOf(u)===-1&&r.push(u)}return r}}}function fq(t){let e=!0;for(const n of ft(t))if(!(n instanceof Lo)){e=!1;break}return e}function pq(t){let e=!0;for(const n of ft(t))if(n instanceof Lo){e=!1;break}return e}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Gf extends Ke{constructor(e){if(super({dtype:e.dtype,name:e.name!=null?e.name:Gx("input").toString()}),e.batchSize==null&&(e.batchSize=null),e.sparse==null&&(e.sparse=!1),this.trainable=!1,this.built=!0,this.sparse=e.sparse,e.inputShape!=null&&e.batchInputShape!=null)throw new z("Only provide the inputShape OR batchInputShape argument to inputLayer, not both at the same time.");let n=e.batchInputShape;if(n==null){if(e.inputShape==null)throw new z("An InputLayer should be passed either a `batchInputShape` or an `inputShape`.");n=[e.batchSize].concat(e.inputShape)}else if(e.batchSize!=null)throw new z("Cannot specify batchSize if batchInputShape is specified when creating an InputLayer.");const s=e.dtype||"float32";this.batchInputShape=n,this.dtype=s,this.inputSpec=[{shape:n}];const r=new Lo(this.dtype,this.batchInputShape,this,[],{},this.name);r.nodeIndex=0,r.tensorIndex=0,new Kx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:[r],outputTensors:[r],inputMasks:[null],outputMasks:[null],inputShapes:[n],outputShapes:[n]})}apply(e,n){throw new z(`Cannot pass any input to an InputLayer's apply() method. InputLayer name: ${this.name}`)}dispose(){return{refCountAfterDispose:this._refCount,numDisposedVariables:0}}getConfig(){return{batchInputShape:this.batchInputShape,dtype:this.dtype,sparse:this.sparse,name:this.name}}}Gf.className="InputLayer";re(Gf);function mq(t){if(t.batchShape==null&&t.shape==null)throw new Error("Please provide to Input either a `shape` or a `batchShape` argument. Note that `shape` does not include the batch dimension.");if(t.batchShape!=null&&t.shape!=null)throw new z("Please provide either a `shape` or `batchShape` argument to Input, but not both.");let e=t.batchShape;t.shape!=null&&e==null&&(e=[null].concat(t.shape));let n=t.dtype;return n==null&&(n="float32"),new Gf({batchInputShape:e,name:t.name,dtype:n,sparse:t.sparse}).inboundNodes[0].outputTensors[0]}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function gq(t,e){if(t.dtype==null||t.dtype===e.dtype)return e;try{return ve(e,t.dtype)}catch{throw new z(`The dtype of the feed (${e.dtype}) can not be cast to the dtype of the key '${t.name}' (${t.dtype}).`)}}class Oi{constructor(e){if(this.id2Value={},this.id2Mask={},this.name2Id={},e instanceof Oi)for(const n in e.id2Value)this.id2Value[n]=e.id2Value[n],n in e.id2Mask&&(this.id2Mask[n]=e.id2Mask[n]);else{if(e==null)return;for(const n of e)this.add(n.key,n.value)}}add(e,n,s){if(this.id2Value[e.id]==null)this.id2Value[e.id]=gq(e,n),this.name2Id[e.name]=e.id,s!=null&&(this.id2Mask[e.id]=s);else throw new z(`Duplicate key: name=${e.name}, id=${e.id}`);return this}addFeed(e){this.add(e.key,e.value)}hasKey(e){return this.id2Value[e.id]!=null}names(){return Object.keys(this.name2Id)}getValue(e){if(e instanceof Lo){if(this.id2Value[e.id]==null)throw new z(`Nonexistent key: ${e.name}`);return this.id2Value[e.id]}else{const n=this.name2Id[e];if(n==null)throw new z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Value[n]}}getMask(e){if(e instanceof Lo){if(this.id2Value[e.id]==null)throw new z(`Nonexistent key: ${e.name}`);return this.id2Mask[e.id]}else{const n=this.name2Id[e];if(n==null)throw new z(`Feed dict has no SymbolicTensor name: ${e}`);return this.id2Mask[n]}}disposeMasks(){this.id2Mask!=null&&Qe(this.id2Mask)}}const Ng=new NO,_g=new NO;function xq(t){Ng!=null&&Ng.setMaxEntries(t),_g!=null&&_g.setMaxEntries(t)}function dd(t,e,n,s){const r=n==null?!1:n.training,o=Array.isArray(t),i=o?t:[t],a=i.map(p=>p.name),l=[],c=e.names();for(const p of a)c.indexOf(p)!==-1?l.push(e.getValue(p)):l.push(null);s!=null&&(s.maxNumTensors=-1/0,s.minNumTensors=1/0);const u=a.join(",")+"|"+e.names().sort().join(",");let d=Ng.get(u),h;if(d==null){const p=yq(i,e);d=p.sorted,h=p.recipientCounts,Ng.put(u,d),_g.put(u,h)}h={},r||Object.assign(h,_g.get(u));const f=new Oi(e);for(let p=0;p<d.length;++p){if(s!=null){const I=_v().numTensors;I>s.maxNumTensors&&(s.maxNumTensors=I),I<s.minNumTensors&&(s.minNumTensors=I)}const m=d[p],x=m.sourceLayer;if(x instanceof Gf)continue;const g=[],y=[],b=[];let v=!1;for(const I of m.inputs){const $=f.getValue(I),E=f.getMask(I);g.push($),y.push(E),E!=null&&(v=!0),r||(h[I.name]--,h[I.name]===0&&!e.hasKey(I)&&a.indexOf(I.name)===-1&&!$.isDisposed&&I.sourceLayer.stateful!==!0&&b.push($))}v&&(n=n||{},n.mask=y[0]);const w=ft(x.apply(g,n));let k=null;x.supportsMasking&&(k=x.computeMask(g,y));const C=vq(m),S=Array.isArray(C)?C:[C];for(let I=0;I<S.length;++I){f.hasKey(S[I])||f.add(S[I],w[I],Array.isArray(k)?k[0]:k);const $=a.indexOf(S[I].name);$!==-1&&(l[$]=w[I])}r||Qe(b)}return f.disposeMasks(),o?l:l[0]}function yq(t,e){T(t!=null&&t.length>0,()=>"Expected at least one fetch, got none");let n=[],s={};if(t.length===1){const r=gT(t[0],e);n=r.sorted,s=r.recipientMap}else{const r=new Set;for(const o of t){const{sorted:i,recipientMap:a}=gT(o,e);for(const l of i)r.has(l.name)||(n.push(l),r.add(l.name));for(const l in a)s[l]==null&&(s[l]=new Set),a[l].forEach(c=>s[l].add(c))}}return{sorted:n,recipientCounts:bq(s)}}function bq(t){const e={};for(const n in t)e[n]=t[n].size;return e}function gT(t,e){const n=new Set,s=[],r={};for(const a of e.names())n.add(a);const o=[],i=[];for(o.push(t);o.length>0;){const a=o[o.length-1];if(n.has(a.name)){o.pop();continue}const l=i[i.length-1]===o.length-1;if(a.inputs.length===0||l)o.pop(),s.push(a),n.add(a.name),l&&i.pop();else{i.push(o.length-1);for(const c of a.inputs)r[c.name]==null&&(r[c.name]=new Set),r[c.name].add(a.name),!n.has(c.name)&&o.push(c)}}return{sorted:s,recipientMap:r}}function vq(t){let e;if(t.sourceLayer.inboundNodes.length===1)e=t.sourceLayer.output;else{let n=null;for(let s=0;s<t.sourceLayer.inboundNodes.length;++s)for(const r of t.sourceLayer.inboundNodes[s].outputTensors)if(r.id===t.id){n=s;break}e=t.sourceLayer.getOutputAt(n)}return e}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wq=K();wq.registerFlag("TOPOLOGICAL_SORT_CACHE_MAX_ENTRIES",()=>100,xq);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function jS(t,e){return j(()=>Yn(Ee(V(t,t),e,!0)))}class jf extends wu{getConfig(){return{}}}class KO extends jf{constructor(e){super(),this.defaultMaxValue=2,this.defaultAxis=0,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return j(()=>{const n=jS(e,this.axis),s=sr(n,0,this.maxValue);return V(e,Ne(s,ie(vn(),n)))})}getConfig(){return{maxValue:this.maxValue,axis:this.axis}}}KO.className="MaxNorm";re(KO);class XO extends jf{constructor(e){super(),this.defaultAxis=0,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return j(()=>Ne(e,ie(vn(),jS(e,this.axis))))}getConfig(){return{axis:this.axis}}}XO.className="UnitNorm";re(XO);class qO extends jf{apply(e){return Ml(e)}}qO.className="NonNeg";re(qO);class YO extends jf{constructor(e){super(),this.defaultMinValue=0,this.defaultMaxValue=1,this.defaultRate=1,this.defaultAxis=0,this.minValue=e.minValue!=null?e.minValue:this.defaultMinValue,this.maxValue=e.maxValue!=null?e.maxValue:this.defaultMaxValue,this.rate=e.rate!=null?e.rate:this.defaultRate,this.axis=e.axis!=null?e.axis:this.defaultAxis}apply(e){return j(()=>{const n=jS(e,this.axis),s=ie(V(this.rate,sr(n,this.minValue,this.maxValue)),V(1-this.rate,n));return V(e,Ne(s,ie(vn(),n)))})}getConfig(){return{minValue:this.minValue,maxValue:this.maxValue,rate:this.rate,axis:this.axis}}}YO.className="MinMaxNorm";re(YO);const xT={maxNorm:"MaxNorm",minMaxNorm:"MinMaxNorm",nonNeg:"NonNeg",unitNorm:"UnitNorm"};function kn(t){return OS(t)}function yT(t,e={}){return Vf(t,br.getMap().classNameMap,e,"constraint")}function Cn(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in xT?xT[t]:t,config:{}};return yT(n)}else return t instanceof jf?t:yT(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */async function $a(t){if(t==null)return;const e=[],n=[],s=[];for(const r in t){const o=t[r];if(typeof o!="number"){const i=o;e.push(i.data()),n.push(r),s.push(i)}}if(e.length>0){const r=await Promise.all(e);for(let o=0;o<r.length;++o)t[n[o]]=r[o][0];Qe(s)}}function QO(t){if(t!=null)for(const e in t){const n=t[e];typeof n!="number"&&n.dispose()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var bT;(function(t){t[t.SILENT=0]="SILENT",t[t.VERBOSE=1]="VERBOSE"})(bT||(bT={}));const kq=125;class hh{constructor(){this.validationData=null}setParams(e){this.params=e}async onEpochBegin(e,n){}async onEpochEnd(e,n){}async onBatchBegin(e,n){}async onBatchEnd(e,n){}async onTrainBegin(e){}async onTrainEnd(e){}setModel(e){}}class Cq{constructor(e,n=10){e==null&&(e=[]),this.callbacks=e,this.queueLength=n}append(e){this.callbacks.push(e)}setParams(e){for(const n of this.callbacks)n.setParams(e)}setModel(e){for(const n of this.callbacks)n.setModel(e)}async onEpochBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochBegin(e,n)}async onEpochEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onEpochEnd(e,n)}async onBatchBegin(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchBegin(e,n)}async onBatchEnd(e,n){n==null&&(n={});for(const s of this.callbacks)await s.onBatchEnd(e,n)}async onTrainBegin(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainBegin(e)}async onTrainEnd(e){e==null&&(e={});for(const n of this.callbacks)await n.onTrainEnd(e)}}class Sq extends hh{constructor(){super()}async onEpochBegin(e){this.seen=0,this.totals={}}async onBatchEnd(e,n){n==null&&(n={});const s=n.size==null?0:n.size;this.seen+=s;for(const r in n){const o=n[r];if(typeof o=="number")this.totals.hasOwnProperty(r)||(this.totals[r]=0),this.totals[r]=this.totals[r]+o*s;else{let i;r in this.totals?i=this.totals[r]:this.totals[r]=0;const a=j(()=>ie(this.totals[r],V(o,s)));this.totals[r]=a,i!=null&&i.dispose()}}}async onEpochEnd(e,n){if(n!=null)for(const s of this.params.metrics)this.totals[s]!=null&&(typeof this.totals[s]=="number"?n[s]=this.totals[s]/this.seen:j(()=>{const r=V(Ne(1,this.seen),this.totals[s]);n[s]=r,this.totals[s].dispose(),No(n[s])}))}}class $q extends hh{async onTrainBegin(e){this.epoch=[],this.history={}}async onEpochEnd(e,n){n==null&&(n={}),this.epoch.push(e);for(const s in n)this.history[s]==null&&(this.history[s]=[]),this.history[s].push(n[s])}async syncData(){const e=[],n=[],s=[];for(const o in this.history){const i=this.history[o];for(let a=0;a<i.length;++a)if(typeof i[a]!="number"){const l=i[a];e.push(l.data()),n.push(o),s.push(a)}}const r=await Promise.all(e);for(let o=0;o<r.length;++o)this.history[n[o]][s[o]].dispose(),this.history[n[o]][s[o]]=r[o][0]}}class Iq extends hh{constructor(e,n){if(super(),this.currentEpoch=0,this.nowFunc=e.nowFunc,this.nextFrameFunc=e.nextFrameFunc||nO,this.yieldEvery=n||"auto",this.yieldEvery==="auto"&&(this.yieldEvery=kq),this.yieldEvery==="never"&&e.onYield!=null)throw new Error("yieldEvery is `never` but you provided an `onYield` callback. Either change `yieldEvery` or remove the callback");yv(this.yieldEvery)&&(this.maybeWait=zX(this.maybeWait.bind(this),this.yieldEvery,this.nowFunc)),this.trainBegin=e.onTrainBegin,this.trainEnd=e.onTrainEnd,this.epochBegin=e.onEpochBegin,this.epochEnd=e.onEpochEnd,this.batchBegin=e.onBatchBegin,this.batchEnd=e.onBatchEnd,this.yield=e.onYield}async maybeWait(e,n,s){const r=[];this.yield!=null&&(await $a(s),r.push(this.yield(e,n,s))),r.push(this.nextFrameFunc()),await Promise.all(r)}async onEpochBegin(e,n){this.currentEpoch=e,this.epochBegin!=null&&(await $a(n),await this.epochBegin(e,n))}async onEpochEnd(e,n){const s=[];this.epochEnd!=null&&(await $a(n),s.push(this.epochEnd(e,n))),this.yieldEvery==="epoch"&&s.push(this.nextFrameFunc()),await Promise.all(s)}async onBatchBegin(e,n){this.batchBegin!=null&&(await $a(n),await this.batchBegin(e,n))}async onBatchEnd(e,n){const s=[];this.batchEnd!=null&&(await $a(n),s.push(this.batchEnd(e,n))),this.yieldEvery==="batch"?s.push(this.nextFrameFunc()):yv(this.yieldEvery)&&s.push(this.maybeWait(this.currentEpoch,e,n)),await Promise.all(s)}async onTrainBegin(e){this.trainBegin!=null&&(await $a(e),await this.trainBegin(e))}async onTrainEnd(e){this.trainEnd!=null&&(await $a(e),await this.trainEnd(e))}}function ZO(t,e){return t==null&&(t={}),t instanceof hh?[t]:Array.isArray(t)&&t[0]instanceof hh?t:ft(t).map(s=>new Iq(s,e))}class fr{constructor(){}static registerCallbackConstructor(e,n){T(e>=0&&Number.isInteger(e),()=>`Verbosity level is expected to be an integer >= 0, but got ${e}`),fr.checkForDuplicate(n),fr.constructors[e]==null&&(fr.constructors[e]=[]),fr.constructors[e].push(n)}static checkForDuplicate(e){for(const n in fr.constructors)fr.constructors[+n].forEach(r=>{if(r===e)throw new z("Duplicate callback constructor.")})}static clear(){fr.constructors={}}static createCallbacks(e){const n=[];for(const s in fr.constructors){const r=+s;e>=r&&n.push(...fr.constructors[r])}return n.map(s=>new s)}}fr.constructors={};function JO(t,e,n,s,r,o,i,a,l){const c=new $q,u=[new Sq,...fr.createCallbacks(e)];t!=null&&u.push(...t),u.push(c);const d=new Cq(u);return d.setParams({epochs:n,initialEpoch:s,samples:r,steps:o,batchSize:i,verbose:e,doValidation:a,metrics:l}),{callbackList:d,history:c}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function si(t,e={},n=!1){return Vf(t,br.getMap().classNameMap,e,"layer",n)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Rg(t,e){return j(()=>{t.dtype!=="float32"&&(t=ve(t,"float32"));const n=Ee(Uf(t),e,!0),s=Mx(n.shape,vn()),r=Yn(ya(n,s));return Ne(t,r)})}function Xx(t,e){return j(()=>dn(Uf(_e(e,t)),-1))}function KS(t,e){return j(()=>dn(os(_e(e,t)),-1))}function XS(t,e){return j(()=>{const n=_e(t,e),s=sr(os(t),vn(),Number.MAX_VALUE),r=os(Ne(n,s));return V(100,dn(r,-1))})}function Tq(t,e){return j(()=>{const n=sr(e,vn(),Number.MAX_VALUE),s=Mo(ie(1,n)),r=sr(t,vn(),Number.MAX_VALUE),o=Mo(ie(1,r));return dn(Uf(_e(s,o)),-1)})}function Eq(t,e){return j(()=>{const n=ya(0,_e(1,V(t,e)));return dn(Uf(n),-1)})}function Nq(t,e){return j(()=>{const n=ya(0,_e(1,V(t,e)));return dn(n,-1)})}function _q(t,e){return j(()=>{const n=Ee(V(t,e),-1),s=to(V(_e(1,t),e),-1);return ya(0,ie(1,_e(s,n)))})}function Rq(t,e){return j(()=>{const n=Math.log(2),s=_e(e,t),r=_e(ie(s,Ff(V(-2,s))),n);return dn(r,-1)})}function fh(t,e,n=!1){return j(()=>{if(n)e=ZC(e);else{const s=Ee(e,e.shape.length-1,!0);e=Ne(e,s)}return e=sr(e,vn(),1-vn()),tn(Ee(V(ve(t,"float32"),Mo(e)),e.shape.length-1))})}function Ag(t,e,n=!1){return j(()=>{const s=ve(Bx(QX(t)),"int32");e=sr(e,vn(),1-vn());const r=e.shape,o=U(SF(s,r[r.length-1]),r);return fh(o,e,n)})}function Aq(t,e){if(!lt(t.shape,e.shape))throw new z(`logits and labels must have the same shape, but got shapes ${JSON.stringify(t.shape)} and ${JSON.stringify(e.shape)}`);return j(()=>{const n=Ml(e),s=tn(os(e));return ie(_e(n,V(e,t)),vF(Po(s)))})}function qx(t,e){return j(()=>{let n;return n=sr(e,vn(),1-vn()),n=Mo(Ne(n,_e(1,n))),dn(Aq(t,n),-1)})}function Dq(t,e){return j(()=>{const n=sr(t,vn(),1),s=sr(e,vn(),1);return Ee(V(t,Mo(Ne(n,s))),-1)})}function Fq(t,e){return j(()=>{const n=Mo(ie(vn(),e));return dn(_e(e,V(t,n)),-1)})}function eP(t,e){return j(()=>{const n=Rg(t,-1),s=Rg(e,-1),r=V(n,s);return tn(Ee(r,-1))})}const Dg={meanSquaredError:Xx,meanAbsoluteError:KS,meanAbsolutePercentageError:XS,meanSquaredLogarithmicError:Tq,squaredHinge:Eq,hinge:Nq,categoricalHinge:_q,logcosh:Rq,categoricalCrossentropy:fh,sparseCategoricalCrossentropy:Ag,binaryCrossentropy:qx,kullbackLeiblerDivergence:Dq,poisson:Fq,cosineProximity:eP};function jb(t){if(typeof t=="string"){if(t in Dg)return Dg[t];let e=`Unknown loss ${t}`;throw t.toLowerCase().includes("softmaxcrossentropy")&&(e=`Unknown loss ${t}. Use "categoricalCrossentropy" as the string name for tf.losses.softmaxCrossEntropy`),new z(e)}else return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function tP(t,e){return j(()=>{const n=V(.5,Fr(e)),s=Ro(ar(e,n),t.dtype);return dn(Oo(t,s),-1)})}function nP(t,e){return j(()=>Ro(Oo(ah(t,-1),ah(e,-1)),"float32"))}function Oq(t,e){return j(()=>ve(Ee(li(Oo(t,1),Oo(e,1))),"float32"))}function Pq(t,e){return j(()=>ve(Ee(li(Oo(t,0),Oo(e,1))),"float32"))}function Mq(t,e){return j(()=>{const n=Oq(t,e),s=Pq(t,e),r=ie(n,s);return ve(cs(ar(r,0),Ne(n,r),0),"float32")})}function Lq(t,e){return qx(t,e)}function zq(t,e){return t.rank===e.rank&&(t=Pf(t,[t.rank-1])),e=ah(e,-1),e.dtype!==t.dtype&&(e=ve(e,t.dtype)),ve(Oo(t,e),"float32")}const Bq=Xx,Vq=Xx,Wq=KS,Uq=KS,Hq=XS,Gq=XS,sP=fh,jq=eP,rP=Ag,Fg={binaryAccuracy:tP,categoricalAccuracy:nP,precision:Mq,categoricalCrossentropy:sP,sparseCategoricalCrossentropy:rP,mse:Bq,MSE:Vq,mae:Wq,MAE:Uq,mape:Hq,MAPE:Gq,cosine:jq};function Kq(t){if(typeof t=="string"&&t in Fg)return Fg[t];if(typeof t!="string"&&t!=null)return t;throw new z(`Unknown metric ${t}`)}function Op(t){if(bo(t!==null,`Unknown LossOrMetricFn ${t}`),typeof t=="string")return t;{let e;for(const n of Object.keys(Dg))if(Dg[n]===t){e=n;break}if(e!==void 0)return e;for(const n of Object.keys(Fg))if(Fg[n]===t){e=n;break}return e!==void 0?e:t.name}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Xq(t){const e={Adagrad:()=>Xl.adagrad(.01),Adadelta:()=>Xl.adadelta(1,.95,vn()),Adam:()=>Xl.adam(.001,.9,.999,vn()),Adamax:()=>Xl.adamax(.002,.9,.999,vn(),0),RMSProp:()=>Xl.rmsprop(.001,.9,0,vn()),SGD:()=>Xl.sgd(.01)};if(e.adagrad=e.Adagrad,e.adadelta=e.Adadelta,e.adam=e.Adam,e.adamax=e.Adamax,e.rmsprop=e.RMSProp,e.sgd=e.SGD,t in e)return e[t]();throw new z(`Unknown Optimizer ${t}`)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const vT=1*1024*1024;function wT(t,e,n=!1){if(t==null||typeof t!="object"||Object.getPrototypeOf(t)!==Object.prototype||!Gv(t))throw new Error("User-defined metadata is expected to be a JSON object, but is not.");if(n){const s=JSON.stringify(t);s.length>vT&&console.warn(`User-defined metadata of model "${e}" is too large in size (length=${s.length} when serialized). It is not recommended to store such large objects in user-defined metadata. Please make sure its serialized length is <= ${vT}.`)}}function Gv(t){if(t===null)return!0;if(typeof t=="object")if(Object.getPrototypeOf(t)===Object.prototype){const e=Object.keys(t);for(const n of e)if(typeof n!="string"||!Gv(t[n]))return!1;return!0}else if(Array.isArray(t)){for(const e of t)if(!Gv(e))return!1;return!0}else return!1;else{const e=typeof t;return e==="string"||e==="number"||e==="boolean"}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function qq(t,e,n,s=console.log){const r=Qq(t),o=["Layer (type)","Input Shape","Output shape","Param #"];r?(e=e||90,n=n||[.32,.61,.89,1]):(e=e||115,n=n||[.24,.48,.7,.8,1]),n[n.length-1]<=1&&(n=n.map(u=>Math.floor(e*u)));let i;if(!r){o.push("Receives inputs"),i=[];for(const u in t.nodesByDepth)i.push(...t.nodesByDepth[u])}s("_".repeat(e)),Og(o,n,s),s("=".repeat(e));const a=t.layers;for(let u=0;u<a.length;++u)r?Zq(a[u],n,s):Jq(a[u],n,i,s),s((u===a.length-1?"=":"_").repeat(e));t.checkTrainableWeightsConsistency();const l=Yq(t),c=Eg(t.nonTrainableWeights);s(`Total params: ${l+c}`),s(`Trainable params: ${l}`),s(`Non-trainable params: ${c}`),s("_".repeat(e))}function Yq(t){let e;return t.collectedTrainableWeights!=null?e=Eg(t.collectedTrainableWeights):e=Eg(t.trainableWeights),e}function Qq(t){let e=!0;const n=[],s=[];for(const r in t.nodesByDepth)n.push(t.nodesByDepth[r]);for(const r of n){if(r.length>1||r.length===1&&r[0].inboundLayers.length>1){e=!1;break}s.push(...r)}if(e)for(const r of t.layers){let o=!1;for(const i of r.inboundNodes)if(s.indexOf(i)!==-1)if(o){e=!1;break}else o=!0;if(!e)break}return e}function Og(t,e,n=console.log){let s="";for(let r=0;r<t.length;++r)r>0&&(s=s.slice(0,s.length-1)+" "),s+=t[r],s=s.slice(0,e[r]),s+=" ".repeat(e[r]-s.length);n(s)}function Zq(t,e,n){let s,r;try{r=t.inboundNodes.map(l=>JSON.stringify(l.inputShapes)).join(",")}catch{r="multiple"}try{s=JSON.stringify(t.outputShape)}catch{s="multiple"}const o=t.name,i=t.getClassName(),a=[`${o} (${i})`,r,s,t.countParams().toString()];Og(a,e,n)}function Jq(t,e,n,s){let r,o;try{o=t.inboundNodes.map(d=>JSON.stringify(d.inputShapes)).join(",")}catch{o="multiple"}try{r=JSON.stringify(t.outputShape)}catch{r="multiple"}const i=[];for(const d of t.inboundNodes)if(!(n!=null&&n.length>0&&n.indexOf(d)===-1))for(let h=0;h<d.inboundLayers.length;++h){const f=d.inboundLayers[h].name,p=d.nodeIndices[h],m=d.tensorIndices[h];i.push(`${f}[${p}][${m}]`)}const a=t.name,l=t.getClassName(),c=i.length===0?"":i[0],u=[`${a} (${l})`,o,r,t.countParams().toString(),c];Og(u,e,s);for(let d=1;d<i.length;++d)Og(["","","","",i[d]],e,s)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function oP(t,e,n){return(t==="inboundNodes"||t==="outputLayers"||t==="inputLayers")&&e===0&&typeof n=="string"}function jv(t,e){if(t===null)return null;if(typeof t=="string")return Va(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];oP(e,r,o)?n.push(o):n.push(jv(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s];if(s==="name"&&typeof r=="string")n[s]=r;else{const o=Va(s);n[o]=jv(r,o)}}return n}}function Kv(t,e){if(t==null)return null;if(typeof t=="string")return qo(t);if(typeof t=="number"||typeof t=="boolean")return t;if(t instanceof Array){const n=[],s=t.length;for(let r=0;r<s;++r){const o=t[r];oP(e,r,o)?n.push(o):n.push(Kv(o,e))}return n}else{const n={};for(const s of Object.keys(t)){const r=t[s],o=qo(s);(s==="name"||s==="className")&&typeof r=="string"?n[o]=r:n[o]=Kv(r,s)}return n}}/** @license See the LICENSE file. */const iP="4.22.0";/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const e9=t=>{const e=Object.keys(t);if(e.length===0)return!1;const n=e[0].split("/");return!isNaN(parseInt(n[n.length-1],10))};class Ur extends Ke{constructor(e){if(super({}),this.containerNodes=new Set,this.name=e.name,this.name==null){const y=this.getClassName().toLowerCase();this.name=Gx(y)}if(this.supportsMasking=!1,this.trainable_=!0,Array.isArray(e.inputs)?this.inputs=e.inputs.slice():this.inputs=[e.inputs],Array.isArray(e.outputs)?this.outputs=e.outputs.slice():this.outputs=[e.outputs],Qi(this.inputs).length!==this.inputs.length)throw new z(`The list of inputs passed to the model is redundant. All inputs should only appear once. Found: ${this.inputs.map(y=>y.name)}`);Qi(this.outputs).length!==this.outputs.length&&console.warn(`The list of outputs passed to the model is redundant. All outputs should only appear once. Found: ${this.outputs.map(y=>y.name)}`),this.inputLayers=[],this.inputLayersNodeIndices=[],this.inputLayersTensorIndices=[],this.outputLayers=[],this.outputLayersNodeIndices=[],this.outputLayersTensorIndices=[],this.layers=[],this.internalContainerRefs=[];for(const y of this.outputs){const b=y.sourceLayer,v=y.nodeIndex,w=y.tensorIndex;this.outputLayers.push(b),this.outputLayersNodeIndices.push(v),this.outputLayersTensorIndices.push(w)}for(const y of this.inputs){const b=y.sourceLayer,v=y.nodeIndex,w=y.tensorIndex;bo(v===0,"input layer has >1 nodes"),bo(w===0,"input layer has >1 tensors"),this.inputLayers.push(b),this.inputLayersNodeIndices.push(v),this.inputLayersTensorIndices.push(w)}this.inputNames=[],this.outputNames=[],this.feedInputShapes=[],this.feedInputNames=[],this.feedOutputNames=[];for(let y=0;y<this.inputLayers.length;y++){const b=this.inputLayers[y];if(!(b instanceof Gf))throw new TypeError(`Input layers to a LayersModel must be InputLayer objects. Received inputs: ${e.inputs}. Input ${y} (0-based) originates from layer type ${b.getClassName()}.`);this.inputNames.push(b.name),this.feedInputShapes.push(b.batchInputShape),this.feedInputNames.push(b.name)}for(const y of this.outputLayers)this.outputNames.push(y.name);this.internalInputShapes=this.inputs.map(y=>y.shape),this.internalOutputShapes=this.outputs.map(y=>y.shape);const n={},s={},r={},o={},i={},a=[],l=(y,b,v,w,k,C)=>{(w==null||k==null||C==null)&&(w=y.sourceLayer,k=y.nodeIndex,C=y.tensorIndex);const S=w.inboundNodes[k];if(v.indexOf(S)!==-1)throw new Sr(`The tensor ${y.name} at layer "${w.name}" is part of a cycle.`);if(b.indexOf(S)!==-1)return;this.containerNodes.add(Ur.nodeKey(w,k)),w.id in i||(i[w.id]=Object.keys(i).length),v.indexOf(S)===-1&&v.push(S);const I=S.inboundLayers.length;for(let $=0;$<I;$++){const E=S.inputTensors[$],_=S.inboundLayers[$],D=S.nodeIndices[$],F=S.tensorIndices[$];l(E,b,v,_,D,F)}for(b.push(S);v.indexOf(S)>=0;)v.splice(v.indexOf(S),1);a.push(S)},c=[],u=[];for(const y of this.outputs)l(y,c,u);const d=a.slice().reverse();for(const y of d){s[y.id]=y,y.id in n||(n[y.id]=0);let b=n[y.id];const v=r[y.outboundLayer.id]==null?0:r[y.outboundLayer.id];b=Math.max(b,v),r[y.outboundLayer.id]=b,o[y.outboundLayer.id]=y.outboundLayer,n[y.id]=b;for(let w=0;w<y.inboundLayers.length;w++){const k=y.inboundLayers[w],C=y.nodeIndices[w],S=k.inboundNodes[C],I=n[S.id]==null?0:n[S.id];n[S.id]=Math.max(b+1,I),s[S.id]=S}}const h={};for(const y in n){const b=n[y];b in h||(h[b]=[]),h[b].push(s[y])}const f={};for(const y in r){const b=r[y];b in f||(f[b]=[]),f[b].push(o[y])}let p=Object.keys(f).map(y=>parseInt(y,10)).sort(Ap);this.layers=[];for(const y of p){const b=f[y];b.sort((v,w)=>{const k=i[v.id],C=i[w.id];return k<C?-1:k>C?1:0});for(const v of b)v instanceof Ur&&this.internalContainerRefs.push(v),this.layers.push(v)}this.layersByDepth=f,p=Object.keys(h).map(y=>parseInt(y,10)).sort(Ap);const m=this.inputs.slice(),x=[];for(const y of p)for(const b of h[y]){const v=b.outboundLayer;if(v!=null){for(const w of b.inputTensors)if(m.indexOf(w)===-1)throw new Sr(`Graph disconnected: cannot obtain value for tensor ${w} at layer "${v.name}". The following previous layers were accessed without issue: ${x}`);for(const w of b.outputTensors)m.push(w);x.push(v.name)}}this.nodesByDepth=h;const g=this.layers.map(y=>y.name);for(const y of g){const b=g.filter(v=>v===y).length;if(b!==1)throw new Sr(`The name "${y}" is used ${b} times in the model. All layer names should be unique. Layer names: `+JSON.stringify(g))}this.outboundNodes=[],this.inboundNodes=[],new Kx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:this.inputs.map(y=>null),outputMasks:this.outputs.map(y=>null),inputShapes:this.inputs.map(y=>y.shape),outputShapes:this.outputs.map(y=>y.shape)}),this.built=!0,this._refCount=1}assertNotDisposed(){if(this._refCount===0)throw new Error(`Container '${this.name}' is already disposed.`)}dispose(){this.assertNotDisposed();const e={refCountAfterDispose:null,numDisposedVariables:0};if(--this._refCount===0){for(const n of this.layers)e.numDisposedVariables+=n.dispose().numDisposedVariables;for(const n of this.internalContainerRefs)e.numDisposedVariables+=n.dispose().numDisposedVariables}return e.refCountAfterDispose=this._refCount,e}get trainable(){return this.trainable_}set trainable(e){this.layers.forEach(n=>{n._trainableWeights.forEach(s=>s.trainable=e)}),this.trainable_=e}get trainableWeights(){if(this._trainableWeights.length>0)throw new z("Container instance unexpectedly contains _trainableWeights.The trainable weights of a Container are a union of the trainable weights of its consituent Layers. Its own _trainableWeights must remain an empty Array.");if(!this.trainable)return[];let e=[];for(const n of this.layers)e=e.concat(n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.layers)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.layers)n.push(...s.trainableWeights);return n.concat(e)}return e}get weights(){return this.trainableWeights.concat(this.nonTrainableWeights)}loadWeights(e,n=!0){const s={};let r=0;const o=e9(e);o&&this.parseWeights(e);for(const a of this.layers)for(const[l,c]of a.weights.entries()){const u=o?`${c.name.split("/").slice(0,-1).join("/")+"/"}${l}`:c.originalName;if(s[u]!=null)throw new z(`Duplicate weight name: ${u}`);s[u]=c,r++}const i=[];for(const a in e){let l=a;if(s[a]==null){const c=a.split("/");l=c.slice(0,-2).concat([c[c.length-1]]).join("/")}if(s[l]!=null)i.push([s[l],e[a]]);else if(n)throw new z(`Provided weight data has no target variable: ${a}`);delete s[l]}if(n){const a=[];for(const l in s)a.push(l);if(a.length>0)throw new z(`${a.length} of ${r} weights are not set: ${a}`)}GS(i)}parseWeights(e){for(const n in Object.keys(e)){const s=n.split("/"),r=["vars","layer_checkpoint_dependencies"],o=s.map(i=>i.startsWith("_")?i.slice(1):i).filter(i=>!r.includes(i)).join("/");o!==n&&(e[o]=e[n],delete e[n])}}updatedConfig(){const e=this.getConfig(),n={};return n.className=this.getClassName(),n.config=e,n.kerasVersion=`tfjs-layers ${iP}`,n.backend="TensorFlow.js",n}toJSON(e,n=!0){const s=Kv(this.updatedConfig());return n?JSON.stringify(s):s}call(e,n){return j(()=>{e=ft(e);const s=new Oi;for(let r=0;r<this.inputs.length;++r)s.add(this.inputs[r],e[r]);return dd(this.outputs,s,n)})}computeMask(e,n){return j(()=>{e=ft(e);let s;return n==null?s=wl(null,e.length):s=ft(n),this.runInternalGraph(e,s)[1]})}computeOutputShape(e){const n=Tg(e);if(n.length!==this.inputLayers.length)throw new z(`Invalid inputShape argument ${e}: model has ${this.inputLayers.length} tensor inputs.`);const s={};for(let a=0;a<n.length;a++){const l=this.inputLayers[a],c=n[a],u=l.name+"_0_0";s[u]=c}const r=Object.keys(this.nodesByDepth).map(a=>parseInt(a,10)).sort(Ap);if(r.length>1)for(const a of r){const l=this.nodesByDepth[a];for(const c of l){const u=c.outboundLayer;if(this.inputLayers.map(m=>m.id).indexOf(u.id)!==-1)continue;const d=[];for(let m=0;m<c.inboundLayers.length;m++){const x=c.inboundLayers[m],g=c.nodeIndices[m],y=c.tensorIndices[m],b=`${x.name}_${g}_${y}`,v=s[b];d.push(v)}const h=u.computeOutputShape(bs(d)),f=Tg(h),p=u.inboundNodes.indexOf(c);for(let m=0;m<f.length;m++){const x=`${u.name}_${p}_${m}`;s[x]=f[m]}}}const o=[],i=[];for(let a=0;a<this.outputLayers.length;a++){const l=this.outputLayers[a],c=this.outputLayersNodeIndices[a],u=this.outputLayersTensorIndices[a],d=`${l.name}_${c}_${u}`;i.push(d)}for(let a=0;a<i.length;a++){const l=i[a];bo(l in s),o.push(s[l])}return bs(o)}runInternalGraph(e,n){n==null&&(n=wl(null,e.length));const s={};for(let l=0;l<this.inputs.length;++l){const c=this.inputs[l],u=e[l],d=n[l];s[c.id]=[u,d]}const r=Object.keys(this.nodesByDepth).map(l=>parseInt(l,10)).sort(Ap);for(const l of r){const c=this.nodesByDepth[l];for(const u of c){const d=u.outboundLayer,h=u.inputTensors,f=u.outputTensors,p=new Array;for(const m of h)m.id in s&&p.push(s[m.id]);if(p.length===h.length){let m={},x,g,y,b;if(u.callArgs!=null&&(m=u.callArgs),p.length===1){const[v,w]=p[0];m.mask==null&&(m.mask=w),y=ft(d.call(v,m)),b=ft(d.computeMask(v,w)),x=[v],g=[w]}else x=p.map(v=>v[0]),g=p.map(v=>v[1]),m.mask==null&&(m.mask=g),y=ft(d.call(x,m)),b=ft(d.computeMask(x,g));if(d.activityRegularizer)throw new Be("LayersModel invocation with concrete Tensor value(s) in the presence of activity regularizer(s) is not supported yet.");for(let v=0;v<f.length;++v){const w=f[v],k=y[v],C=b[v];s[w.id]=[k,C]}}}}const o=[],i=[],a=[];for(const l of this.outputs){bo(l.id in s,`Could not compute output ${l.name} : ${l.id}`);const[c,u]=s[l.id];a.push(c.shape),o.push(c),i.push(u)}return[o,i,a]}buildNodeConversionMap(e){const n={};let s;for(const r of this.layers){s=r instanceof Ur?1:0;for(let o=0;o<r.inboundNodes.length;o++){const i=Ur.nodeKey(r,o);this.containerNodes.has(i)&&(n[i]=s,s+=1)}}return n}getLayer(e,n){if(n!=null)return this.findLayer(n);if(e==null)throw new z("Provide either a layer name or layer index");if(typeof e=="number")return this.findLayer(e);for(const s of this.layers)if(s.name===e)return s;throw new z(`No such layer: ${e}`)}findLayer(e){if(this.layers.length<=e)throw new z(`Was asked to retrieve layer at index ${e}, but model only has ${this.layers.length} layer(s).`);return this.layers[e]}calculateLosses(){return j(()=>{const e=[];for(const n of this.layers)for(let s=0;s<n.inboundNodes.length;++s){const r=Ur.nodeKey(n,s);this.containerNodes.has(r)&&e.push(...n.calculateLosses())}return e})}getConfig(){const e={name:this.name},n=this.buildNodeConversionMap(this.layers),s=[];for(const i of this.layers){const a=i.getClassName(),l=i.getConfig(),c=[];for(let d=0;d<i.inboundNodes.length;d++){const h=i.inboundNodes[d],f=Ur.nodeKey(i,d);let p={};if(this.containerNodes.has(f)){if(h.callArgs)try{JSON.stringify(h.callArgs),p=h.callArgs}catch{console.warn(`Layer ${i.name} was passed non-serializable keyword arguments: ${h.callArgs}. They will not be included in the serialized model (and thus will be missing at deserialization time).`),p={}}if(h.inboundLayers.length>0){const m=[];for(let x=0;x<h.inboundLayers.length;x++){const g=h.inboundLayers[x],y=h.nodeIndices[x],b=h.tensorIndices[x],v=Ur.nodeKey(g,y);let w=n[v];w==null&&(w=0),m.push([g.name,w,b,p])}c.push(m)}}}const u={};u.name=i.name,u.className=a,u.config=l,u.inboundNodes=c,s.push(u)}e.layers=s;const r=[];for(let i=0;i<this.inputLayers.length;i++){const a=this.inputLayers[i],l=this.inputLayersNodeIndices[i],c=Ur.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.inputLayersTensorIndices[i];r.push([a.name,u,d])}e.inputLayers=r;const o=[];for(let i=0;i<this.outputLayers.length;i++){const a=this.outputLayers[i],l=this.outputLayersNodeIndices[i],c=Ur.nodeKey(a,l);if(!this.containerNodes.has(c))continue;let u=n[c];u==null&&(u=0);const d=this.outputLayersTensorIndices[i];o.push([a.name,u,d])}return e.outputLayers=o,e}static fromConfig(e,n,s={},r=!1){const o={},i={};function a(x,g){x.name in i?i[x.name].push(g):i[x.name]=[g]}function l(x,g){const y=[];let b;for(const v of g){const w=v[0],k=v[1],C=v[2];if(b=v[3]==null?{}:v[3],!(w in o)){a(x,g);return}const S=o[w];if(S.inboundNodes.length<=k){a(x,g);return}const I=S.inboundNodes[k];y.push(I.outputTensors[C])}y.length>0&&x.apply(bs(y),b)}function c(x){const g=x.name,y=si(x,n.customObjects!=null?n.customObjects:{});y.setFastWeightInitDuringBuild(r),o[g]=y,x.inboundNodes.forEach(v=>{if(!(v instanceof Array))throw new z(`Corrupted configuration, expected array for nodeData: ${v}`);a(y,v)})}const u=n.name,d=n.layers;for(const x of d)c(x);for(;!LX(i);)for(const x of d){const g=o[x.name];if(g.name in i){const y=i[g.name];delete i[g.name];for(const b of y)l(g,b)}}const h=[],f=[],p=n.inputLayers;for(const x of p){const g=x[0],y=x[1],b=x[2];bo(g in o);const w=o[g].inboundNodes[y].outputTensors;h.push(w[b])}const m=n.outputLayers;for(const x of m){const g=x[0],y=x[1],b=x[2];bo(g in o);const w=o[g].inboundNodes[y].outputTensors;f.push(w[b])}return new e({inputs:h,outputs:f,name:u})}get stateful(){if(this._stateful)throw new z("Container instance unexpectedly has _stateful = true. The statefulness of a Container is determined by the Layers it contains. Its _stateful property must remain the default false.");for(const e of this.layers)if(e.stateful)return!0;return!1}resetStates(){j(()=>{this.layers.forEach(e=>{e.stateful&&e.resetStates()})})}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function t9(t,e,n){const s=e.length;if(t==null||Array.isArray(t)&&t.length===0)return e.map(r=>null);if(s===1)return Array.isArray(t)&&t.length===1?t:typeof t=="object"&&e[0]in t?[t[e[0]]]:[t];if(Array.isArray(t)){if(t.length!==s)throw new Error(`Provided ${n} is an array of ${t.length} element(s), but the model has ${s} outputs. Make sure a set of weights is provided for each model output.`);return t}else if(typeof t=="object"&&Object.keys(t).length>0&&typeof t[Object.keys(t)[0]]=="object"){const r=[];return e.forEach(o=>{o in t?r.push(t[o]):r.push(null)}),r}else throw new Error(`The model has multiple (${s}) outputs, so ${n} must be either an array with ${s} elements or an object with ${e} keys. Provided ${n} not understood: ${JSON.stringify(t)}`)}function aP(t,e){return t9(t,e,"classWeight")}async function lP(t,e,n,s){if(e!=null||s!=null)throw new Error("Support sampleWeight is not implemented yet");if(n!=null){const r=j(()=>{if(t.shape.length===1)return el(t);if(t.shape.length===2){if(t.shape[1]>1)return ah(t,1);if(t.shape[1]===1)return U(t,[t.shape[0]]);throw new Error(`Encountered unexpected last-dimension size (${t.shape[1]}) during handling of class weights. The size is expected to be >= 1.`)}else throw new Error(`Unexpected rank of target (y) tensor (${t.rank}) during handling of class weights. The rank is expected to be 1 or 2.`)}),o=Array.from(await r.data());Qe(r);const i=[];return o.forEach(a=>{if(n[a]==null)throw new Error(`classWeight must contain all classes in the training data. The class ${a} exists in the data but not in classWeight`);i.push(n[a])}),Os(i,"float32")}else return null}function n9(t,e){return V(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const s9=32;function cP(t,e){let n,s;const r=e;n=r.xs,s=r.ys,T(n!=null&&s!=null,()=>`A Dataset iterator for fitDataset() is expected to generate objects of the form \`{xs: xVal, ys: yVal}\`, where the two values may be \`tf.Tensor\`, an array of Tensors, or a map of string to Tensor.  The provided Dataset instead generates ${e}`);const o=kT("input",t.inputNames,n),i=kT("output",t.outputNames,s),a=o[0].shape[0];T(o.length===t.inputs.length,()=>`LayersModel has ${t.inputs.length} inputs, but the dataset provides ${o.length} inputs.  (Expected input keys: ${JSON.stringify(t.inputNames)})`),T(i.length===t.outputs.length,()=>`LayersModel has ${t.outputs.length} outputs, but the dataset provides ${i.length} outputs.  (Expected output keys: ${JSON.stringify(t.outputNames)})`);for(let l=0;l<o.length;l++)T(o[l].shape[0]===a,()=>`Batch size mismatch: input ${t.inputNames[l]} has ${o[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);for(let l=0;l<i.length;l++)T(i[l].shape[0]===a,()=>`Batch size mismatch: output ${t.outputNames[l]} has ${i[l].shape[0]}; expected  ${a} based on input ${t.inputNames[0]}.`);return{xs:o,ys:i}}function kT(t,e,n){if(n instanceof xn)return[n];if(Array.isArray(n))return T(n.length===e.length,()=>`Received an array of ${n.length} Tensors, but expected ${e.length} to match the ${t} keys ${e}.`),n;{const s=[];for(const r of e){if(n[r]==null)throw new z(`The feature data generated by the dataset lacks the required ${t} key '${r}'.`);s.push(n[r])}return s}}function r9(t){if(t.length===3)throw new Be("Validation with sample weights is not implemented yet.");return{xs:t[0],ys:t[1]}}async function o9(t,e,n){const s=n.batchesPerEpoch!=null;if(T(t.optimizer!=null,()=>"You must compile a model before training/testing. Use LayersModel.compile(modelCompileConfig)."),T(n!=null,()=>"For fitDataset(), the 2nd argument (config) is required, but it is not provided in this call."),T(n.epochs!=null&&n.epochs>0&&Number.isInteger(n.epochs),()=>`For fitDataset(), config.epochs is expected to be a positive integer, but got ${n.epochs}`),T(!s||n.batchesPerEpoch>0&&Number.isInteger(n.batchesPerEpoch),()=>`For fitDataset(), config.batchesPerEpoch is expected to be a positive integer if specified, but got ${n.batchesPerEpoch}`),T(n.validationSplit==null,()=>"`validationSplit` is not supported by `fitDataset()`. Use validationData instead."),t.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");t.isTraining=!0;try{const r=n.validationData!=null;let o,i;if(r)if(CT(n.validationData))T(n.validationBatches==null||n.validationBatches>0&&Number.isInteger(n.validationBatches),()=>`For fitDataset() with dataset-based validation, config.validationBatches is expected not to be provided, or to be a positive integer, but got ${n.validationBatches}`);else{const x=r9(n.validationData);o=x.xs,i=x.ys}const a=t.makeTrainFunction(),l=t.getDedupedMetricsNames();let c;r?c=l.slice().concat(l.map(x=>"val_"+x)):c=l.slice();const u=ZO(n.callbacks,n.yieldEvery),d=n.verbose==null?1:n.verbose,{callbackList:h,history:f}=JO(u,d,n.epochs,null,null,i9(e,n),null,r,c);h.setModel(t),t.history=f,await h.onTrainBegin(),t.stopTraining_=!1;let p=n.initialEpoch==null?0:n.initialEpoch,m=await e.iterator();for(;p<n.epochs;){const x={};await h.onEpochBegin(p);let g=0,y=0;for(s||(m=await e.iterator());!s||g<n.batchesPerEpoch;){const b=await m.next();if(s&&b.done){console.warn(`You provided \`batchesPerEpoch\` as ${n.batchesPerEpoch}, but your dataset iterator ran out of data after ${g} batches; interrupting training. Make sure that your dataset can generate at least \`batchesPerEpoch * epochs\` batches (in this case, ${n.batchesPerEpoch*n.epochs} batches). You may need to use the repeat() function when building your dataset.`);break}if(b.value!=null){const{xs:v,ys:w}=cP(t,b.value),k={};k.batch=y,k.size=v[0].shape[0],await h.onBatchBegin(y,k);const C=[];if(n.classWeight!=null){const $=aP(n.classWeight,t.outputNames);for(let E=0;E<$.length;++E)C.push(await lP(w[E],null,$[E]))}const S=v.concat(w).concat(C),I=a(S);Qe(S);for(let $=0;$<l.length;++$){const E=l[$],_=I[$];k[E]=_,No(_)}await h.onBatchEnd(y,k),QO(k),y++,g++}if(s?g>=n.batchesPerEpoch:b.done){if(r){let v;CT(n.validationData)?v=ft(await t.evaluateDataset(n.validationData,{batches:n.validationBatches})):v=ft(t.evaluate(o,i,{batchSize:n.validationBatchSize==null?s9:n.validationBatchSize,verbose:0}));for(let w=0;w<t.metricsNames.length;++w)x[`val_${t.metricsNames[w]}`]=v[w]}break}if(t.stopTraining_)break}if(await h.onEpochEnd(p,x),p++,t.stopTraining_)break}return await h.onTrainEnd(),await t.history.syncData(),t.history}finally{t.isTraining=!1}}function i9(t,e){let n=null;return e.batchesPerEpoch!=null?n=e.batchesPerEpoch:Number.isFinite(t.size)&&(n=t.size),n}function CT(t){return typeof t.iterator=="function"}function a9(t){return typeof t.next=="function"}async function l9(t,e,n){n=n||{};const s=n.batches!=null,r=t.testFunction;let o=[];if(n.verbose>0)throw new Be("Verbose mode is not implemented yet.");T(!s||n.batches>0&&Number.isInteger(n.batches),()=>`Test loop expects \`batches\` to be a positive integer, but received ${JSON.stringify(n.batches)}`);const i=a9(e)?e:await e.iterator();let a=0,l=0;for(;!s||l<n.batches;){const c=await i.next();if(o=j(()=>{if(c.value){const{xs:u,ys:d}=cP(t,c.value),h=u.concat(d),f=j(()=>r(h));if(Qe(h),l===0)for(let m=0;m<f.length;++m)o.push(at(0));const p=h[0].shape[0];for(let m=0;m<f.length;++m){const x=f[m],g=o[m];o[m]=j(()=>ie(o[m],V(p,x))),l>0&&Qe(g)}Qe(f),a+=p,++l}return o}),c.done){s&&console.warn(`Your dataset iterator ran out of data during evaluateDataset(). Interrupting evalution. Make sure that your dataset can generate at least \`batches\` batches (in this case, ${n.batches} batches). You may need to use the repeat() function when building your dataset.`);break}}for(let c=0;c<o.length;++c){const u=o[c];o[c]=Ne(o[c],a),Qe(u)}return bs(o)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Kb(t){T(t>0&&Number.isInteger(t),()=>`batchSize is required to be a positive integer, but got ${t}`)}function ju(t,e,n){return t==null?[null]:Array.isArray(t)?t.map(s=>nl(s,e,n-e)):nl(t,e,n-e)}function Xv(t,e){return j(()=>t==null?null:Array.isArray(t)?t.map(n=>Xv(n,e)):MO(t,e.dtype==="int32"?e:ve(e,"int32")))}function Xb(t,e){const n=[];let s=0,r=null;for(;s<t;)r=s+e,r>=t&&(r=t),n.push([s,r]),s=r;return n}function uP(t){const e=[];t instanceof xn&&(t=[t]);for(let n=0;n<t.length;++n){const s=t[n];if(s.rank===1)e.push(Wf(s,1));else{if(s.rank===0)throw new Error("Expected tensor to be at least 1D, but received a 0D tensor (scalar).");e.push(s)}}return e}function Wr(t,e){if(t==null)return;const n=[];if(e instanceof xn)n.push(e.id);else if(Array.isArray(e))e.forEach(r=>n.push(r.id));else if(e!=null)for(const r in e){const o=e[r];n.push(o.id)}const s=[];if(t instanceof xn)n.indexOf(t.id)===-1&&s.push(t);else if(Array.isArray(t))t.forEach(r=>{n.indexOf(r.id)===-1&&s.push(r)});else if(t!=null)for(const r in t){const o=t[r];n.indexOf(o.id)===-1&&s.push(o)}s.forEach(r=>{r.isDisposed||r.dispose()})}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function c9(t){return t instanceof xn}function qv(t){return Array.isArray(t)}function ST(t){return!c9(t)&&!qv(t)}function $T(t,e,n,s=!0,r=""){if(e==null||e.length===0){if(t!=null){let i=!1;if(qv(t)&&t.length>0)i=!0;else if(ST(t)){for(const a in t)if(t.hasOwnProperty(a)){i=!0;break}}else i=!0;if(i)throw new z(`Error when checking model ${r} expected no data, but got ${t}`)}return[]}if(t==null)return e.map(i=>null);let o;if(ST(t)){t=t,o=[];for(const i of e){if(t[i]==null)throw new z(`No data provided for "${i}". Need data for each key in: ${e}`);o.push(t[i])}}else if(qv(t)){if(t=t,t.length!==e.length)throw new z(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the model expected. Expected to see ${e.length} Tensor(s), but instead got the following list of Tensor(s): ${t}`);o=t}else{if(t=t,e.length>1)throw new z(`The model ${r} expects ${e.length} Tensor(s), but only received one Tensor. Found: Tensor with shape ${t.shape}`);o=[t]}if(o=uP(o),n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new z(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s). but got array with shape ${a.shape}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u>=0&&c!==u)throw new z(`${r} expected a batch of elements where each example has shape [${n[i].slice(1,n[i].length)}] (i.e.,tensor shape [*,${n[i].slice(1,n[i].length)}]) but the ${r} received an input with ${a.shape[0]} examples, each with shape [${a.shape.slice(1,a.shape.length)}] (tensor shape [${a.shape}])`)}}return o}function u9(t,e,n){const s=Qi(t.map(o=>o.shape[0]));s.sort();const r=Qi(e.map(o=>o.shape[0]));if(r.sort(),s.length>1)throw new z(`All input Tensors (x) should have the same number of samples. Got array shapes: ${JSON.stringify(t.map(o=>o.shape))}`);if(r.length>1)throw new z(`All target Tensors (y) should have the same number of samples. Got array shapes: ${JSON.stringify(e.map(o=>o.shape))}`);if(s.length>0&&r.length>0&&!lt(s,r))throw new z(`Input Tensors should have the same number of samples as target Tensors. Found ${s[0]} input sample(s) and ${r[0]} target sample(s).`)}function d9(t,e,n){const s=[Xx,qx,fh];for(let r=0;r<t.length;++r){const o=t[r],i=e[r],a=n[r];if(i!=null){if(i===fh&&o.shape[o.shape.length-1]===1)throw new z(`You are passing a target array of shape ${o.shape} while using a loss 'categorical_crossentropy'. 'categorical_crossentropy'expects targets to be binary matrices (1s and 0s) of shape [samples, classes].`);if(s.indexOf(i)!==-1){const l=o.shape.slice(1),c=a.slice(1);for(let u=0;u<l.length;++u){const d=l[u],h=c[u];if(h!=null&&d!==h)throw new z(`A target Tensor with shape ${o.shape} was passed for an output of shape ${a}, while using a loss function that expects targets to have the same shape as the output.`)}}}}}function IT(t,e,n,s=!0,r=""){let o;if(Array.isArray(t)){if(t.length!==e.length)throw new z(`Error when checking model ${r}: the Array of Tensors that you are passing to your model is not the size the the model expected. Expected to see ${e.length} Tensor(s), but instead got ${t.length} Tensors(s).`);o=t}else{if(e.length>1)throw new z(`The model expects ${e.length} ${r} Tensors, but only received one Tensor. Found: array with shape ${JSON.stringify(t.shape)}.`);o=[t]}if(n!=null)for(let i=0;i<e.length;++i){if(n[i]==null)continue;const a=o[i];if(a.shape.length!==n[i].length)throw new z(`Error when checking ${r}: expected ${e[i]} to have ${n[i].length} dimension(s), but got array with shape ${JSON.stringify(a.shape)}`);for(let l=0;l<n[i].length;++l){if(l===0&&!s)continue;const c=a.shape[l],u=n[i][l];if(u!=null&&u!==c)throw new z(`Error when checking ${r}: expected ${e[i]} to have shape ${JSON.stringify(n[i])} but got array with shape ${JSON.stringify(a.shape)}.`)}}}function h9(t,e){if(t==null||Array.isArray(t)&&t.length===0)return e.map(s=>[]);let n;if(typeof t=="string"||typeof t=="function")n=[t];else if(Array.isArray(t)||typeof t=="object")n=t;else throw new TypeError(`Type of metrics argument not understood. Expected an string,function, Array, or Object, found: ${t}`);if(Array.isArray(n))return e.map(s=>n);{const s=[];for(const r of e){let o=n.hasOwnProperty(r)?n[r]:[];Array.isArray(o)||(o=[o]),s.push(o)}return s}}const f9="layers-model";class sl extends Ur{constructor(e){super(e),this.isTraining=!1}summary(e,n,s=console.log){if(!this.built)throw new z("This model has never been called, thus its weights have not been created yet. So no summary can be displayed. Build the model first (e.g., by calling it on some test data).");qq(this,e,n,s)}compile(e){if(e.loss==null&&(e.loss=[]),this.loss=e.loss,typeof e.optimizer=="string")this.optimizer_=Xq(e.optimizer),this.isOptimizerOwned=!0;else{if(!(e.optimizer instanceof va))throw new z("User-defined optimizer must be an instance of tf.Optimizer.");this.optimizer_=e.optimizer,this.isOptimizerOwned=!1}let n=[];if(!Array.isArray(e.loss)&&typeof e.loss!="string"&&typeof e.loss!="function"){e.loss=e.loss;for(const i in e.loss)if(this.outputNames.indexOf(i)===-1)throw new z(`Unknown entry in loss dictionary: "${i}". Only expected the following keys: ${this.outputNames}`);for(const i of this.outputNames)e.loss[i]==null&&console.warn(`Output "${i}" is missing from loss dictionary. We assume this was done on purpose, and we will not be expecting data to be passed to ${i} during training`),n.push(jb(e.loss[i]))}else if(Array.isArray(e.loss)){if(e.loss.length!==this.outputs.length)throw new z(`When passing an Array as loss, it should have one entry per model output. The model has ${this.outputs.length} output(s), but you passed loss=${e.loss}.`);n=e.loss.map(a=>jb(a))}else{const i=jb(e.loss);this.outputs.forEach(a=>{n.push(i)})}this.lossFunctions=n,this.feedOutputNames=[],this.feedOutputShapes=[],this.feedLossFns=[];for(let i=0;i<this.outputs.length;++i){const a=this.internalOutputShapes[i],l=this.outputNames[i];this.feedOutputNames.push(l),this.feedOutputShapes.push(a),this.feedLossFns.push(this.lossFunctions[i])}const s=[];this.metrics=e.metrics,this.metricsNames=["loss"],this.metricsTensors=[],tl("loss",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=this.lossFunctions[i];this.outputs.length>1&&(this.metricsTensors.push([a,i]),this.metricsNames.push(this.outputNames[i]+"_loss"))}});const r=h9(e.metrics,this.outputNames),o=(i,a,l)=>{this.outputNames.length>1&&(a=this.outputNames[i]+"_"+a),this.metricsNames.push(a),this.metricsTensors.push([l,i])};tl("metric",()=>{for(let i=0;i<this.outputs.length;++i){if(s.indexOf(i)!==-1)continue;const a=r[i];(c=>{const u="";let d,h,f;for(const p of c){if(typeof p=="string"&&["accuracy","acc","crossentropy","ce"].indexOf(p)!==-1){const x=this.internalOutputShapes[i];x[x.length-1]===1||this.lossFunctions[i]===qx?["accuracy","acc"].indexOf(p)!==-1?h=tP:["crossentropy","ce"].indexOf(p)!==-1&&(h=Lq):this.lossFunctions[i]===Ag?["accuracy","acc"].indexOf(p)!==-1?h=zq:["crossentropy","ce"].indexOf(p)!==-1&&(h=rP):["accuracy","acc"].indexOf(p)!==-1?h=nP:["crossentropy","ce"].indexOf(p)!==-1&&(h=sP);let g;["accuracy","acc"].indexOf(p)!==-1?g="acc":["crossentropy","ce"].indexOf(p)!==-1&&(g="ce"),f=h,d=u+g}else f=Kq(p),d=u+Op(p);let m;tl(d,()=>{m=f}),o(i,d,m)}})(a)}}),this.collectedTrainableWeights=this.trainableWeights}checkTrainableWeightsConsistency(){this.collectedTrainableWeights!=null&&this.trainableWeights.length!==this.collectedTrainableWeights.length&&console.warn("Discrepancy between trainableweights and collected trainable weights. Did you set `model.trainable` without calling `model.compile()` afterwards?")}evaluate(e,n,s={}){const r=s.batchSize==null?32:s.batchSize;Kb(r);const o=!0,i=this.standardizeUserDataXY(e,n,o,r);try{const a=i[0].concat(i[1]);this.makeTestFunction();const l=this.testFunction,c=this.testLoop(l,a,r,s.verbose,s.steps);return bs(c)}finally{Wr(i[0],e),Wr(i[1],n)}}async evaluateDataset(e,n){return this.makeTestFunction(),l9(this,e,n)}checkNumSamples(e,n,s,r="steps"){let o;if(s!=null){if(o=null,n!=null)throw new z(`If ${r} is set, batchSize must be null or undefined.Got batchSize = ${n}`)}else if(e!=null)Array.isArray(e)?o=e[0].shape[0]:o=e.shape[0];else throw new z(`Either the input data should have a defined shape, or ${r} shoud be specified.`);return o}execute(e,n){if(Array.isArray(n)&&n.length===0)throw new z("`outputs` is an empty Array, which is not allowed.");const s=Array.isArray(n),r=s?n:[n],o=this.retrieveSymbolicTensors(r),i=new Oi;if(e instanceof xn&&(e=[e]),Array.isArray(e)){if(e.length!==this.inputs.length)throw new z(`The number of inputs provided (${e.length}) does not match the number of inputs of this model (${this.inputs.length}).`);for(let l=0;l<this.inputs.length;++l)i.add(this.inputs[l],e[l])}else for(const l of this.inputs){const c=e[l.name];if(c==null)throw new z(`No value is provided for the model's input ${l.name}`);i.add(l,c)}const a=dd(o,i);return s?a:a[0]}retrieveSymbolicTensors(e){const n=wl(null,e.length);let s=e.length;for(const r of this.layers){const o=Array.isArray(r.output)?r.output:[r.output],i=o.map(a=>a.name);for(let a=0;a<e.length;++a){const l=i.indexOf(e[a]);if(l!==-1&&(n[a]=o[l],s--),s===0)break}if(s===0)break}if(s>0){const r=[];throw n.forEach((o,i)=>{o==null&&r.push(e[i])}),new z(`Cannot find SymbolicTensors for output name(s): ${JSON.stringify(r)}`)}return n}predictLoop(e,n=32,s=!1){return j(()=>{const r=this.checkNumSamples(e);if(s)throw new Be("Verbose predictLoop() is not implemented yet.");const o=Xb(r,n),i=this.outputs.map(a=>[]);for(let a=0;a<o.length;++a)j(()=>{const c=o[a][0],u=o[a][1],d=ju(e,c,u),h=[];if(Array.isArray(d))for(let p=0;p<d.length;++p)h.push({key:this.inputs[p],value:d[p]});else h.push({key:this.inputs[0],value:d});const f=new Oi(h);return dd(this.outputs,f)}).forEach((c,u)=>i[u].push(c));return bs(i.map(a=>ws(a,0)))})}predict(e,n={}){const s=uP(e);IT(s,this.inputNames,this.feedInputShapes,!1);try{const r=n.batchSize==null?32:n.batchSize;return Kb(r),this.predictLoop(s,r)}finally{Wr(s,e)}}predictOnBatch(e){IT(e,this.inputNames,this.feedInputShapes,!0);const n=(Array.isArray(e)?e[0]:e).shape[0];return this.predictLoop(e,n)}standardizeUserDataXY(e,n,s=!0,r){if(this.optimizer_==null)throw new Sr("You must compile a model before training/testing. Use LayersModel.compile(modelCompileArgs).");const o=[];for(let i=0;i<this.feedOutputShapes.length;++i){const a=this.feedOutputShapes[i];this.feedLossFns[i]===Ag?o.push(a.slice(0,a.length-1).concat([1])):o.push(a)}if(e=$T(e,this.feedInputNames,this.feedInputShapes,!1,"input"),n=$T(n,this.feedOutputNames,o,!1,"target"),u9(e,n),d9(n,this.feedLossFns,this.feedOutputShapes),this.stateful&&r!=null&&r>0&&e[0].shape[0]%r!==0)throw new z(`In a stateful network, you should only pass inputs with a number of samples that is divisible by the batch size ${r}. Found: ${e[0].shape[0]} sample(s).`);return[e,n]}async standardizeUserData(e,n,s,r,o=!0,i){const[a,l]=this.standardizeUserDataXY(e,n,o,i);if(s!=null)throw new Error("sample weight is not supported yet.");let c=null;if(r!=null){const u=aP(r,this.outputNames);c=[];for(let d=0;d<u.length;++d)c.push(await lP(l[d],null,u[d]))}return[a,l,c]}testLoop(e,n,s,r=0,o){return j(()=>{const i=this.checkNumSamples(n,s,o,"steps"),a=[];if(r>0)throw new Be("Verbose mode is not implemented yet.");if(o!=null)throw new Be("steps mode in testLoop() is not implemented yet");{const l=Xb(i,s),c=Os(ro(0,i));for(let u=0;u<l.length;++u){const d=l[u][0],h=l[u][1],f=nl(c,d,h-d),p=Xv(n,f),m=e(p);if(u===0)for(let x=0;x<m.length;++x)a.push(at(0));for(let x=0;x<m.length;++x){const g=m[x];a[x]=ie(a[x],V(h-d,g))}}for(let u=0;u<a.length;++u)a[u]=Ne(a[u],i)}return a})}getDedupedMetricsNames(){const e=this.metricsNames,n=[];for(let s=0;s<e.length;++s){const r=e[s];let o=r;if(uT(e,r)>1){const i=uT(e.slice(0,s),r);o+=`_${i}`}n.push(o)}return n}makeTrainFunction(){return e=>{const n=[],s=e.slice(0,this.inputs.length),r=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),o=e.slice(this.inputs.length+this.outputs.length,this.inputs.length+this.outputs.length*2),i=[],a=()=>{const d=[];for(let m=0;m<this.inputs.length;++m)d.push({key:this.inputs[m],value:s[m]});const h=new Oi(d),f=dd(this.outputs,h,{training:!0});let p;for(let m=0;m<this.lossFunctions.length;++m){const x=this.lossFunctions[m];let g=x(r[m],f[m]);o[m]!=null&&(g=n9(g,o[m]));const y=dn(g);n.push(y),m===0?p=g:p=ie(p,g)}for(let m=0;m<this.metricsTensors.length;++m){let x;if(this.outputs.length>1&&m<this.outputs.length)x=n[m];else{const g=this.metricsTensors[m][0],y=this.metricsTensors[m][1];x=dn(g(r[y],f[y]))}No(x),i.push(x)}return p=dn(p),this.calculateLosses().forEach(m=>{p=ie(p,m)}),p},l=this.collectedTrainableWeights.map(d=>d.read()),c=!0;return[this.optimizer_.minimize(a,c,l)].concat(i)}}makeTestFunction(){this.testFunction=e=>j(()=>{const n=[];let s;const r=e.slice(0,this.inputs.length),o=e.slice(this.inputs.length,this.inputs.length+this.outputs.length),i=[];for(let c=0;c<this.inputs.length;++c)i.push({key:this.inputs[c],value:r[c]});const a=new Oi(i),l=dd(this.outputs,a);for(let c=0;c<this.lossFunctions.length;++c){const u=this.lossFunctions[c],d=dn(u(o[c],l[c]));c===0?s=d:s=ie(s,d),n.push(s)}for(let c=0;c<this.metricsTensors.length;++c){const u=this.metricsTensors[c][0],d=this.metricsTensors[c][1],h=dn(u(o[d],l[d]));n.push(h)}return n})}async fit(e,n,s={}){if(this.isTraining)throw new Error("Cannot start training because another fit() call is ongoing.");this.isTraining=!0;let r,o,i,a,l,c,u,d,h;try{const f=s.batchSize==null?32:s.batchSize;Kb(f);const p=!1,m=await this.standardizeUserData(e,n,s.sampleWeight,s.classWeight,p,f);r=m[0],o=m[1],h=m[2];let x=!1,g;if(s.validationData!=null&&s.validationData.length>0){if(x=!0,s.validationData.length===2)l=s.validationData[0],c=s.validationData[1];else throw s.validationData.length===3?new Be("validationData including sample weights is not supported yet."):new z(`When passing validation data, it must contain 2 (valX, valY) or 3 (valX, valY, valSampleWeight) items; ${s.validationData} is invalid.`);const I=!0,$=await this.standardizeUserData(l,c,null,null,I,f);u=$[0],d=$[1],g=u.concat(d)}else if(s.validationSplit!=null&&s.validationSplit>0&&s.validationSplit<1){x=!0;const I=Math.floor(r[0].shape[0]*(1-s.validationSplit)),$=r[0].shape[0];u=ju(r,I,$),i=r,r=ju(r,0,I),d=ju(o,I,$),a=o,o=ju(o,0,I),g=u.concat(d)}else s.validationSteps!=null&&(x=!0);const y=r.concat(o).concat(h);this.checkTrainableWeightsConsistency();const b=this.makeTrainFunction(),v=this.getDedupedMetricsNames();let w,k;x?(this.makeTestFunction(),w=this.testFunction,k=v.slice().concat(v.map(I=>"val_"+I))):(w=null,g=[],k=v.slice());const C=ZO(s.callbacks,s.yieldEvery);return await this.fitLoop(b,y,v,f,s.epochs,s.verbose,C,w,g,s.shuffle,k,s.initialEpoch,null,null)}finally{this.isTraining=!1,Wr(r,e),Wr(o,n),Wr(i,e),Wr(a,n),Wr(u,l),Wr(d,c),h!=null&&Qe(h)}}async fitLoop(e,n,s,r,o,i,a,l,c,u,d,h,f,p){r==null&&(r=32),o==null&&(o=1),u==null&&(u=!0),h==null&&(h=0);let m=!1;if(l!=null&&c!=null&&(m=!0),p!=null&&(m=!0,f==null))throw new z("Can only use `validationSteps` when doing step-wise training, i.e., `stepsPerEpoch` must be set.");const x=this.checkNumSamples(n,r,f,"steps_per_epoch");let g;x!=null&&(g=ro(0,x)),i==null&&(i=1);const{callbackList:y,history:b}=JO(a,i,o,h,x,f,r,m,d);y.setModel(this),this.history=b,await y.onTrainBegin(),this.stopTraining_=!1;for(let v=h;v<o;++v){await y.onEpochBegin(v);const w={};if(f!=null)throw new Be("stepsPerEpoch mode is not implemented yet.");{if(u==="batch")throw new Be("batch shuffling is not implemneted yet");u&&ZW(g);const k=Os(g),C=Xb(x,r);for(let S=0;S<C.length;++S){const I={};if(await y.onBatchBegin(S,I),j(()=>{const $=C[S][0],E=C[S][1],_=nl(k,$,E-$);I.batch=S,I.size=E-$;const D=Xv(n,_),F=e(D);for(let R=0;R<s.length;++R){const P=s[R],M=F[R];I[P]=M,No(M)}if(S===C.length-1&&m){const R=this.testLoop(l,c,r);for(let P=0;P<s.length;++P){const M=s[P],N=R[P];No(N),w["val_"+M]=N}}}),await y.onBatchEnd(S,I),QO(I),this.stopTraining_)break}k.dispose()}if(await y.onEpochEnd(v,w),this.stopTraining_)break}return await y.onTrainEnd(),await this.history.syncData(),this.history}async fitDataset(e,n){return o9(this,e,n)}async trainOnBatch(e,n){const s=await this.standardizeUserData(e,n),r=s[0],o=s[1],a=this.makeTrainFunction()(r.concat(o)),l=[];for(const c of a){const u=await c.data();l.push(u[0])}return Qe(a),Wr(s[0],e),Wr(s[1],n),bs(l)}getNamedWeights(e){const n=[],s=e!=null&&e.trainableOnly,r=s?this.trainableWeights:this.weights,o=this.getWeights(s);for(let i=0;i<r.length;++i)s&&!r[i].trainable||n.push({name:r[i].originalName,tensor:o[i]});return n}set stopTraining(e){this.stopTraining_=e}get stopTraining(){return this.stopTraining_}get optimizer(){return this.optimizer_}set optimizer(e){this.optimizer_!==e&&(this.optimizer_=e,this.isOptimizerOwned=!1)}dispose(){const e=super.dispose();if(e.refCountAfterDispose===0&&this.optimizer!=null&&this.isOptimizerOwned){const n=_v().numTensors;this.optimizer_.dispose(),e.numDisposedVariables+=n-_v().numTensors}return e}getLossIdentifiers(){let e;if(typeof this.loss=="string")e=qo(this.loss);else if(Array.isArray(this.loss)){for(const n of this.loss)if(typeof n!="string")throw new Error("Serialization of non-string loss is not supported.");e=this.loss.map(n=>qo(n))}else{const n=Object.keys(this.loss);e={};const s=this.loss;for(const r of n)if(typeof s[r]=="string")e[r]=qo(s[r]);else throw new Error("Serialization of non-string loss is not supported.")}return e}getMetricIdentifiers(){if(typeof this.metrics=="string"||typeof this.metrics=="function")return[qo(Op(this.metrics))];if(Array.isArray(this.metrics))return this.metrics.map(e=>qo(Op(e)));{const e={};for(const n in this.metrics)e[n]=qo(Op(this.metrics[n]));return e}}getTrainingConfig(){return{loss:this.getLossIdentifiers(),metrics:this.getMetricIdentifiers(),optimizer_config:{class_name:this.optimizer.getClassName(),config:this.optimizer.getConfig()}}}loadTrainingConfig(e){if(e.weighted_metrics!=null)throw new Error("Loading weight_metrics is not supported yet.");if(e.loss_weights!=null)throw new Error("Loading loss_weights is not supported yet.");if(e.sample_weight_mode!=null)throw new Error("Loading sample_weight_mode is not supported yet.");const n=jv(e.optimizer_config),s=si(n);let r;if(typeof e.loss=="string")r=Va(e.loss);else if(Array.isArray(e.loss))r=e.loss.map(i=>Va(i));else if(e.loss!=null){r={};for(const i in e.loss)r[i]=Va(e.loss[i])}let o;if(Array.isArray(e.metrics))o=e.metrics.map(i=>Va(i));else if(e.metrics!=null){o={};for(const i in e.metrics)o[i]=Va(e.metrics[i])}this.compile({loss:r,metrics:o,optimizer:s})}async save(e,n){if(typeof e=="string"){const c=KU(e);if(c.length===0)throw new z(`Cannot find any save handlers for URL '${e}'`);if(c.length>1)throw new z(`Found more than one (${c.length}) save handlers for URL '${e}'`);e=c[0]}if(e.save==null)throw new z("LayersModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");const s=await X2(this.getNamedWeights(n)),r=!1,o=null,a={modelTopology:this.toJSON(o,r),format:f9,generatedBy:`TensorFlow.js tfjs-layers v${iP}`,convertedBy:null};if((n==null?!1:n.includeOptimizer)&&this.optimizer!=null){a.trainingConfig=this.getTrainingConfig();const c="optimizer",{data:u,specs:d}=await X2(await this.optimizer.getWeights(),c);s.specs.push(...d),s.data=jU([s.data,u])}return this.userDefinedMetadata!=null&&(wT(this.userDefinedMetadata,this.name,!0),a.userDefinedMetadata=this.userDefinedMetadata),a.weightData=s.data,a.weightSpecs=s.specs,e.save(a)}setUserDefinedMetadata(e){wT(e,this.name),this.userDefinedMetadata=e}getUserDefinedMetadata(){return this.userDefinedMetadata}}sl.className="Model";re(sl);class dP extends sl{}dP.className="Functional";re(dP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Zc extends sl{constructor(e){if(super({inputs:[],outputs:[]}),e=e||{},this.trainable=!0,this.built=!1,this.name=e.name!=null?e.name:Gx("sequential_"),e.layers!=null)for(const n of e.layers)this.add(n)}checkShape(e){if(e.inboundNodes[0].outputTensors[0].shape.some(s=>s<0))throw new z(`Negative dimension size caused by adding layer ${e.name} with input shape [${e.inboundNodes[0].inputTensors[0].shape}]`)}add(e){const n=e instanceof Zc||e instanceof sl;let s;if(n){if(s=e,s.outputs.length!==1)throw new z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");if(s.inputs.length!==1)throw new z("All layers in a Sequential model should have a single input tensor. For multi-input layers, use the functional API.")}if(this.outputs.length===0){if(e.inboundNodes.length===0){if(e.batchInputShape==null)throw new z("The first layer in a Sequential model must get an `inputShape` or `batchInputShape` argument.");const r=mq({batchShape:e.batchInputShape,dtype:e.dtype,name:e.name+"_input"});e.apply(r)}if(n)this.outputs=s.outputs,this.inputs=s.inputs;else{if(e.inboundNodes.length!==1)throw new z(`A layer added to a Sequential model must not already be connected somewhere else. LayersModel received layer ${e.name} which has ${e.inboundNodes.length} pre-existing inbound connections.`);if(e.inboundNodes[0].outputTensors.length!==1)throw new z("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[e.inboundNodes[0].outputTensors[0]],this.inputs=jO(this.outputs[0])}this.inboundNodes=[],new Kx({outboundLayer:this,inboundLayers:[],nodeIndices:[],tensorIndices:[],inputTensors:this.inputs,outputTensors:this.outputs,inputMasks:wl(null,this.inputs.length),outputMasks:[null],inputShapes:this.inputs.map(r=>r.shape),outputShapes:this.outputs[0].shape})}else{const r=e.apply(this.outputs[0]);if(Array.isArray(r))throw new TypeError("All layers in a Sequential model should have a single output tensor. For multi-output layers, use the functional API.");this.checkShape(e),this.outputs=[r],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}this.layers.push(e),this.built=!1}pop(){if(this.layers.length===0)throw new TypeError("There are no layers in the model.");if(this.layers.pop(),this.layers.length===0)this.outputs=[],this.inboundNodes=[],this.outboundNodes=[];else{const e=this.layers.length-1;this.layers[e].outboundNodes=[],this.outputs=[this.layers[e].output],this.inboundNodes[0].outputTensors=this.outputs,this.inboundNodes[0].outputShapes=[this.outputs[0].shape]}}call(e,n){return this.model==null&&this.build(),this.model.call(e,n)}build(e){if(rt(e),this.inputs.length===0||this.outputs.length===0)throw new TypeError("Sequential model cannot be built: model is empty. Add some layers first.");this.model=new sl({inputs:this.inputs,outputs:this.outputs[0],name:this.name+"_model"}),this.model.trainable=this.trainable,this.supportsMasking=this.model.supportsMasking,this.inputLayers=this.model.inputLayers,this.inputLayersNodeIndices=this.model.inputLayersNodeIndices,this.inputLayersTensorIndices=this.model.inputLayersTensorIndices,this.outputLayers=this.model.outputLayers,this.outputLayersNodeIndices=this.model.outputLayersNodeIndices,this.outputLayersTensorIndices=this.model.outputLayersTensorIndices,this.nodesByDepth=this.model.nodesByDepth,this.containerNodes=this.model.containerNodes,this.outputNames=this.model.outputNames,this.inputNames=this.model.inputNames,this.built=!0}countParams(){return this.built||this.build(),super.countParams()}summary(e,n,s=console.log){this.built||this.build(),super.summary(e,n,s)}setWeights(e){this.model==null&&this.build(),this.model.setWeights(e)}evaluate(e,n,s={}){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.evaluate(e,n,s)}async evaluateDataset(e,n){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.evaluateDataset(e,n)}predict(e,n={}){return this.model==null&&this.build(),this.model.predict(e,n)}predictOnBatch(e){return this.model==null&&this.build(),this.model.predictOnBatch(e)}compile(e){this.build(),this.model.compile(e),this.optimizer_=this.model.optimizer,this.isOptimizerOwned=this.model.isOptimizerOwned,this.loss=this.model.loss,this.metrics=this.model.metrics,this.metricsTensors=this.model.metricsTensors,this.metricsNames=this.model.metricsNames}get optimizer(){return this.model==null?void 0:this.model.optimizer}set optimizer(e){this.model.optimizer=e}async fit(e,n,s={}){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.fit(e,n,s)}async fitDataset(e,n){if(!this.built)throw new Sr("The model needs to be compiled before being used.");return this.model.fitDataset(e,n)}async trainOnBatch(e,n){return this.model.trainOnBatch(e,n)}static fromConfig(e,n,s={},r=!1){let o,i={};if(n instanceof Array){if(n[0].className==null||n[0].className==="Merge")throw new z("Legacy serialization format not supported yet.");o=n}else T(n.layers!=null,()=>"When the config data for a Sequential model is not an Array, it must be an Object that contains the 'layers' field."),o=n.layers,delete n.layers,i=n;const a=new e(i);if(!(a instanceof Zc))throw new Be(`Sequential.fromConfig called on non-Sequential input: ${a}`);for(const l of o){const u=si(l,void 0,r);r&&u.setFastWeightInitDuringBuild(!0),a.add(u)}return a}set stopTraining(e){if(this.model==null)throw new z("Cannot set the stopTraining property of a sequential model before it is compiled.");this.model.stopTraining=e}get stopTraining(){if(this.model==null)throw new z("Cannot get the stopTraining property of a sequential model before it is compiled.");return this.model.stopTraining}getConfig(){const e=[];for(const n of this.layers){const s={};s.className=n.getClassName(),s.config=n.getConfig(),e.push(s)}return{name:this.name,layers:e}}}Zc.className="Sequential";re(Zc);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function p9(t){return new sl(t)}function m9(t){return new Zc(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */let Zn=class extends wu{getConfig(){return{}}};class hP extends Zn{apply(e,n=1){return JX(e,n)}}hP.className="elu";re(hP);class fP extends Zn{apply(e){return _F(e)}}fP.className="selu";re(fP);class pP extends Zn{apply(e){return Ml(e)}}pP.className="relu";re(pP);class mP extends Zn{apply(e){return j(()=>uh(6,Ml(e)))}}mP.className="relu6";re(mP);class gP extends Zn{apply(e){return e}}gP.className="linear";re(gP);class xP extends Zn{apply(e){return yu(e)}}xP.className="sigmoid";re(xP);class yP extends Zn{apply(e){return tq(e)}}yP.className="hardSigmoid";re(yP);class bP extends Zn{apply(e){return Ff(e)}}bP.className="softplus";re(bP);class vP extends Zn{apply(e){return eq(e)}}vP.className="softsign";re(vP);class wP extends Zn{apply(e){return Ox(e)}}wP.className="tanh";re(wP);let qS=class extends Zn{apply(e,n=-1){return ZC(e,n)}};qS.className="softmax";re(qS);class kP extends Zn{apply(e,n=-1){return wF(e,n)}}kP.className="logSoftmax";re(kP);class CP extends Zn{apply(e){return j(()=>j(()=>{const n=Math.sqrt(2),s=V(.5,ie(1,gF(Ne(e,n))));return V(e,s)}))}}CP.className="gelu";re(CP);class SP extends Zn{apply(e){return j(()=>V(.5,V(e,ie(1,Ox(V(Yn(Ne(2,Math.PI)),ie(e,V(.044715,yl(e,3)))))))))}}SP.className="gelu_new";re(SP);class $P extends Zn{apply(e){return j(()=>V(e,Ox(Ff(e))))}}$P.className="mish";re($P);class IP extends Zn{apply(e,n=1){return j(()=>V(yu(V(e,n)),e))}}IP.className="swish";re(IP);function oa(t){return t.getClassName()}function qb(t,e={}){return Vf(t,br.getMap().classNameMap,e,"activation")}function ia(t){if(t==null){const e={};return e.className="linear",e.config={},qb(e)}if(typeof t=="string"){const e={};return e.className=t,e.config={},qb(e)}else return t instanceof Zn?t:qb(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function g9(t){if(t!=null&&typeof t!="object")throw new Error(`Argument to L1L2 regularizer's constructor is expected to be an object, but received: ${t}`)}class TP extends wu{}class EP extends TP{constructor(e){super(),g9(e),this.l1=e==null||e.l1==null?.01:e.l1,this.l2=e==null||e.l2==null?.01:e.l2,this.hasL1=this.l1!==0,this.hasL2=this.l2!==0}apply(e){return j(()=>{let n=hn([1]);return this.hasL1&&(n=ie(n,Ee(V(this.l1,os(e))))),this.hasL2&&(n=ie(n,Ee(V(this.l2,Uf(e))))),U(n,[])})}getConfig(){return{l1:this.l1,l2:this.l2}}static fromConfig(e,n){return new e({l1:n.l1,l2:n.l2})}}EP.className="L1L2";re(EP);const TT={l1l2:"L1L2"};function vt(t){return OS(t)}function ET(t,e={}){return Vf(t,br.getMap().classNameMap,e,"regularizer")}function Pt(t){if(t==null)return null;if(typeof t=="string"){const n={className:t in TT?TT[t]:t,config:{}};return ET(n)}else return t instanceof TP?t:ET(t)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class NP extends Ke{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null&&(this.maxValue=e.maxValue)}call(e,n){e=De(e);let s=Ml(e);return this.maxValue!=null&&(s=sr(s,0,this.maxValue)),s}computeOutputShape(e){return e}getConfig(){const e={maxValue:this.maxValue},n=super.getConfig();return Object.assign(e,n),e}}NP.className="ReLU";re(NP);class _P extends Ke{constructor(e){super(e??{}),this.DEFAULT_ALPHA=.3,e==null&&(e={}),this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=De(e);return PC(s,this.alpha)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}}_P.className="LeakyReLU";re(_P);class RP extends Ke{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA_INITIALIZER="zeros",e==null&&(e={}),this.supportsMasking=!0,this.alphaInitializer=Ot(e.alphaInitializer||this.DEFAULT_ALPHA_INITIALIZER),this.alphaRegularizer=Pt(e.alphaRegularizer),this.alphaConstraint=Cn(e.alphaConstraint),e.sharedAxes==null)this.sharedAxes=null;else if(Array.isArray(e.sharedAxes))this.sharedAxes=e.sharedAxes;else if(typeof e.sharedAxes=="number")this.sharedAxes=[e.sharedAxes];else throw new z(`Expected sharedAxes to be a number or an array of numbers, but got ${e.sharedAxes}`)}build(e){e=rt(e);const n=e.slice(1);if(this.sharedAxes!=null)for(const r of this.sharedAxes)n[r-1]=1;this.alpha=this.addWeight("alpha",n,"float32",this.alphaInitializer,this.alphaRegularizer,!0,this.alphaConstraint);const s={};if(this.sharedAxes!=null)for(let r=1;r<e.length;++r)s[r]=e[r];this.inputSpec=[new wn({ndim:e.length,axes:s})],this.built=!0}call(e,n){return e=De(e),WC(e,this.alpha.read())}getConfig(){const e={alphaInitializer:Vt(this.alphaInitializer),alphaRegularizer:vt(this.alphaRegularizer),alphaConstraint:kn(this.alphaConstraint),sharedAxes:this.sharedAxes},n=super.getConfig();return Object.assign(e,n),e}}RP.className="PReLU";re(RP);let AP=class extends Ke{constructor(e){if(super(e??{}),this.DEFAULT_ALPHA=1,e==null&&(e={}),e.alpha!=null&&e.alpha!==this.DEFAULT_ALPHA)throw new Be(`Non-default alpha value (${e.alpha}) is not supported by the ELU layer yet.`);this.alpha=e.alpha==null?this.DEFAULT_ALPHA:e.alpha}call(e,n){const s=De(e);return Lx(s)}computeOutputShape(e){return e}getConfig(){const e={alpha:this.alpha},n=super.getConfig();return Object.assign(e,n),e}};AP.className="ELU";re(AP);class DP extends Ke{constructor(e){super(e??{}),this.DEFAULT_THETA=1,e==null&&(e={}),this.theta=e.theta==null?this.DEFAULT_THETA:e.theta}call(e,n){const s=De(e);return V(s,ve(ar(s,this.theta),"float32"))}computeOutputShape(e){return e}getConfig(){const e={theta:this.theta},n=super.getConfig();return Object.assign(e,n),e}}DP.className="ThresholdedReLU";re(DP);class FP extends Ke{constructor(e){super(e??{}),this.DEFAULT_AXIS=1,e==null&&(e={}),this.softmax=new qS().apply,this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis}call(e,n){return j(()=>{let s=De(e);const r=n.mask;if(r!=null){const o=V(_e(ba(s.shape),ve(r,s.dtype)),at(-1e9));s=ie(s,o)}return this.axis instanceof Array?this.axis.length>1?Po(_e(s,kF(s,this.axis,!0))):this.softmax(s,this.axis[0]):this.softmax(s,this.axis)})}computeOutputShape(e){return e}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}FP.className="Softmax";re(FP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function Ac(t,e,n){if(typeof t=="number")return wl(t,e);if(t.length!==e)throw new z(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${t.length} elements.`);for(let s=0;s<e;++s){const r=t[s];if(!qX(r))throw new z(`The ${n} argument must be an integer or tuple of ${e} integers. Received: ${JSON.stringify(t)} including a non-integer number ${r}`)}return t}function no(t,e,n,s,r=1){if(t==null)return t;const o=e+(e-1)*(r-1);let i;return n==="same"?i=t:i=t-o+1,Math.floor((i+s-1)/s)}function vo(t,e,n,s){if(t==null)return null;if(s==="valid")t=t*e+ra([n-e,0]);else if(s==="same")t=t*e;else throw new z(`Unsupport padding mode: ${s}.`);return t}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function YS(t,e){return j(()=>(rn(e),e==="channelsFirst"?tt(t,[0,2,3,1]):t))}function OP(t,e){return j(()=>(rn(e),e==="channelsFirst"?tt(t,[0,2,3,4,1]):t))}function x9(t,e,n,s=1,r="valid",o,i=1){return j(()=>{if(o==null&&(o=oo()),rn(o),t.shape.length!==3)throw new z(`The input of a conv1dWithBias operation should be 3, but is ${t.shape.length} instead.`);if(e.shape.length!==3)throw new z(`The kernel for a conv1dWithBias operation should be 3, but is ${e.shape.length} instead`);if(n!=null&&n.shape.length!==1)throw new z(`The bias for a conv1dWithBias operation should be 1, but is ${n.shape.length} instead`);if(o==="channelsFirst"&&(t=tt(t,[0,2,1])),r==="causal")throw new Be("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");let a=dF(t,e,s,r==="same"?"same":"valid","NWC",i);return n!=null&&(a=lo(a,n)),a})}function NT(t,e,n,s=[1,1],r="valid",o,i,a=null){return j(()=>{if(o==null&&(o=oo()),rn(o),t.rank!==3&&t.rank!==4)throw new z(`conv2dWithBiasActivation expects input to be of rank 3 or 4, but received ${t.rank}.`);if(e.rank!==3&&e.rank!==4)throw new z(`conv2dWithBiasActivation expects kernel to be of rank 3 or 4, but received ${t.rank}.`);let l=YS(t,o);if(r==="causal")throw new Be("The support for CAUSAL padding mode in conv1dWithBias is not implemented yet.");return l=Sj({x:l,filter:e,strides:s,pad:r==="same"?"same":"valid",dilations:i,dataFormat:"NHWC",bias:n,activation:a}),o==="channelsFirst"&&(l=tt(l,[0,3,1,2])),l})}function y9(t,e,n,s=[1,1,1],r="valid",o,i){return j(()=>{if(o==null&&(o=oo()),rn(o),t.rank!==4&&t.rank!==5)throw new z(`conv3dWithBias expects input to be of rank 4 or 5, but received ${t.rank}.`);if(e.rank!==4&&e.rank!==5)throw new z(`conv3dWithBias expects kernel to be of rank 4 or 5, but received ${t.rank}.`);let a=OP(t,o);if(r==="causal")throw new Be("The support for CAUSAL padding mode in conv3dWithBias is not implemented yet.");return a=CH(a,e,s,r==="same"?"same":"valid","NDHWC",i),n!=null&&(a=lo(a,n)),o==="channelsFirst"&&(a=tt(a,[0,4,1,2,3])),a})}class Yx extends Ke{constructor(e,n){if(super(n),this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",Yx.verifyArgs(n),this.rank=e,_n(this.rank,"rank"),this.rank!==1&&this.rank!==2&&this.rank!==3)throw new Be(`Convolution layer for rank other than 1, 2, or 3 (${this.rank}) is not implemented yet.`);if(this.kernelSize=Ac(n.kernelSize,e,"kernelSize"),this.strides=Ac(n.strides==null?1:n.strides,e,"strides"),this.padding=n.padding==null?"valid":n.padding,lr(this.padding),this.dataFormat=n.dataFormat==null?"channelsLast":n.dataFormat,rn(this.dataFormat),this.activation=ia(n.activation),this.useBias=n.useBias==null?!0:n.useBias,this.biasInitializer=Ot(n.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.biasConstraint=Cn(n.biasConstraint),this.biasRegularizer=Pt(n.biasRegularizer),this.activityRegularizer=Pt(n.activityRegularizer),this.dilationRate=Ac(n.dilationRate==null?1:n.dilationRate,e,"dilationRate"),this.rank===1&&Array.isArray(this.dilationRate)&&this.dilationRate.length!==1)throw new z(`dilationRate must be a number or an array of a single number for 1D convolution, but received ${JSON.stringify(this.dilationRate)}`);if(this.rank===2){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==2)throw new z(`dilationRate must be a number or array of two numbers for 2D convolution, but received ${JSON.stringify(this.dilationRate)}`)}else if(this.rank===3){if(typeof this.dilationRate=="number")this.dilationRate=[this.dilationRate,this.dilationRate,this.dilationRate];else if(this.dilationRate.length!==3)throw new z(`dilationRate must be a number or array of three numbers for 3D convolution, but received ${JSON.stringify(this.dilationRate)}`)}}static verifyArgs(e){if(bo("kernelSize"in e,"required key 'kernelSize' not in config"),typeof e.kernelSize!="number"&&!PS(e.kernelSize,"number",1,3))throw new z(`BaseConv expects config.kernelSize to be number or number[] with length 1, 2, or 3, but received ${JSON.stringify(e.kernelSize)}.`)}getConfig(){const e={kernelSize:this.kernelSize,strides:this.strides,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,activation:oa(this.activation),useBias:this.useBias,biasInitializer:Vt(this.biasInitializer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),biasConstraint:kn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}class ku extends Yx{constructor(e,n){super(e,n),this.kernel=null,ku.verifyArgs(n),this.filters=n.filters,_n(this.filters,"filters"),this.kernelInitializer=Ot(n.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.kernelConstraint=Cn(n.kernelConstraint),this.kernelRegularizer=Pt(n.kernelRegularizer)}build(e){e=rt(e);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z(`The channel dimension of the input should be defined. Found ${e[n]}`);const s=e[n],r=this.kernelSize.concat([s,this.filters]);this.kernel=this.addWeight("kernel",r,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[{ndim:this.rank+2,axes:{[n]:s}}],this.built=!0}call(e,n){return j(()=>{e=De(e);let s;const r=this.bias==null?null:this.bias.read(),o=RO(this.activation.getClassName());if(o!=null&&this.rank===2)s=NT(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate,o);else{if(this.rank===1)s=x9(e,this.kernel.read(),r,this.strides[0],this.padding,this.dataFormat,this.dilationRate[0]);else if(this.rank===2)s=NT(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else if(this.rank===3)s=y9(e,this.kernel.read(),r,this.strides,this.padding,this.dataFormat,this.dilationRate);else throw new Be("convolutions greater than 3D are not implemented yet.");this.activation!=null&&(s=this.activation.apply(s))}return s})}computeOutputShape(e){e=rt(e);const n=[],s=this.dataFormat==="channelsLast"?e.slice(1,e.length-1):e.slice(2);for(let o=0;o<s.length;++o){const i=no(s[o],this.kernelSize[o],this.padding,this.strides[o],typeof this.dilationRate=="number"?this.dilationRate:this.dilationRate[o]);n.push(i)}let r=[e[0]];return this.dataFormat==="channelsLast"?(r=r.concat(n),r.push(this.filters)):(r.push(this.filters),r=r.concat(n)),r}getConfig(){const e={filters:this.filters,kernelInitializer:Vt(this.kernelInitializer),kernelRegularizer:vt(this.kernelRegularizer),kernelConstraint:kn(this.kernelConstraint)},n=super.getConfig();return Object.assign(e,n),e}static verifyArgs(e){if(!("filters"in e)||typeof e.filters!="number"||e.filters<1)throw new z(`Convolution layer expected config.filters to be a 'number' > 0 but got ${JSON.stringify(e.filters)}`)}}class Kf extends ku{constructor(e){super(2,e),Kf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!PS(e.kernelSize,"number",1,2))throw new z(`Conv2D expects config.kernelSize to be number or number[] with length 1 or 2, but received ${JSON.stringify(e.kernelSize)}.`)}}Kf.className="Conv2D";re(Kf);class Xf extends ku{constructor(e){super(3,e),Xf.verifyArgs(e)}getConfig(){const e=super.getConfig();return delete e.rank,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!(Array.isArray(e.kernelSize)&&(e.kernelSize.length===1||e.kernelSize.length===3)))throw new z(`Conv3D expects config.kernelSize to be number or [number, number, number], but received ${JSON.stringify(e.kernelSize)}.`)}}Xf.className="Conv3D";re(Xf);class PP extends Kf{constructor(e){if(super(e),this.inputSpec=[new wn({ndim:4})],this.padding!=="same"&&this.padding!=="valid")throw new z(`Conv2DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=rt(e),e.length!==4)throw new z("Input should have rank 4; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new wn({ndim:4,axes:{[n]:s}})],this.built=!0}call(e,n){return j(()=>{let s=De(e);if(s.shape.length!==4)throw new z(`Conv2DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a;this.dataFormat==="channelsFirst"?(i=2,a=3):(i=1,a=2);const l=r[i],c=r[a],u=this.kernelSize[0],d=this.kernelSize[1],h=this.strides[0],f=this.strides[1],p=vo(l,h,u,this.padding),m=vo(c,f,d,this.padding),x=[o,p,m,this.filters];this.dataFormat!=="channelsLast"&&(s=tt(s,[0,2,3,1]));let g=hF(s,this.kernel.read(),x,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(g=tt(g,[0,3,1,2])),this.bias!=null&&(g=lo(g,this.bias.read(),this.dataFormat)),this.activation!=null&&(g=this.activation.apply(g)),g})}computeOutputShape(e){e=rt(e);const n=e.slice();let s,r,o;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3):(s=3,r=1,o=2);const i=this.kernelSize[0],a=this.kernelSize[1],l=this.strides[0],c=this.strides[1];return n[s]=this.filters,n[r]=vo(n[r],l,i,this.padding),n[o]=vo(n[o],c,a,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}PP.className="Conv2DTranspose";re(PP);class MP extends Xf{constructor(e){if(super(e),this.inputSpec=[new wn({ndim:5})],this.padding!=="same"&&this.padding!=="valid")throw new z(`Conv3DTranspose currently supports only padding modes 'same' and 'valid', but received padding mode ${this.padding}`)}build(e){if(e=rt(e),e.length!==5)throw new z("Input should have rank 5; Received input shape: "+JSON.stringify(e));const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null)throw new z("The channel dimension of the inputs should be defined. Found `None`.");const s=e[n],r=this.kernelSize.concat([this.filters,s]);this.kernel=this.addWeight("kernel",r,"float32",this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint)),this.inputSpec=[new wn({ndim:5,axes:{[n]:s}})],this.built=!0}call(e,n){return j(()=>{let s=De(e);if(s.shape.length!==5)throw new z(`Conv3DTranspose.call() expects input tensor to be rank-4, but received a tensor of rank-${s.shape.length}`);const r=s.shape,o=r[0];let i,a,l;this.dataFormat==="channelsFirst"?(l=2,i=3,a=4):(l=1,i=2,a=3);const c=r[l],u=r[i],d=r[a],h=this.kernelSize[0],f=this.kernelSize[1],p=this.kernelSize[2],m=this.strides[0],x=this.strides[1],g=this.strides[2],y=vo(c,m,h,this.padding),b=vo(u,x,f,this.padding),v=vo(d,g,p,this.padding),w=[o,y,b,v,this.filters];this.dataFormat!=="channelsLast"&&(s=tt(s,[0,2,3,4,1]));let k=IH(s,this.kernel.read(),w,this.strides,this.padding);return this.dataFormat!=="channelsLast"&&(k=tt(k,[0,4,1,2,3])),this.bias!==null&&(k=lo(k,this.bias.read(),this.dataFormat)),this.activation!==null&&(k=this.activation.apply(k)),k})}computeOutputShape(e){e=rt(e);const n=e.slice();let s,r,o,i;this.dataFormat==="channelsFirst"?(s=1,r=2,o=3,i=4):(s=4,r=1,o=2,i=3);const a=this.kernelSize[0],l=this.kernelSize[1],c=this.kernelSize[2],u=this.strides[0],d=this.strides[1],h=this.strides[2];return n[s]=this.filters,n[r]=vo(n[r],u,a,this.padding),n[o]=vo(n[o],d,l,this.padding),n[i]=vo(n[i],h,c,this.padding),n}getConfig(){const e=super.getConfig();return delete e.dilationRate,e}}MP.className="Conv3DTranspose";re(MP);class LP extends ku{constructor(e,n){if(super(e,n),this.DEFAULT_DEPTHWISE_INITIALIZER="glorotUniform",this.DEFAULT_POINTWISE_INITIALIZER="glorotUniform",this.depthwiseKernel=null,this.pointwiseKernel=null,n.filters==null)throw new z("The `filters` configuration field is required by SeparableConv, but is unspecified.");if(n.kernelInitializer!=null||n.kernelRegularizer!=null||n.kernelConstraint!=null)throw new z("Fields kernelInitializer, kernelRegularizer and kernelConstraint are invalid for SeparableConv2D. Use depthwiseInitializer, depthwiseRegularizer, depthwiseConstraint, pointwiseInitializer, pointwiseRegularizer and pointwiseConstraint instead.");if(n.padding!=null&&n.padding!=="same"&&n.padding!=="valid")throw new z(`SeparableConv${this.rank}D supports only padding modes: 'same' and 'valid', but received ${JSON.stringify(n.padding)}`);this.depthMultiplier=n.depthMultiplier==null?1:n.depthMultiplier,this.depthwiseInitializer=Ot(n.depthwiseInitializer||this.DEFAULT_DEPTHWISE_INITIALIZER),this.depthwiseRegularizer=Pt(n.depthwiseRegularizer),this.depthwiseConstraint=Cn(n.depthwiseConstraint),this.pointwiseInitializer=Ot(n.depthwiseInitializer||this.DEFAULT_POINTWISE_INITIALIZER),this.pointwiseRegularizer=Pt(n.pointwiseRegularizer),this.pointwiseConstraint=Cn(n.pointwiseConstraint)}build(e){if(e=rt(e),e.length<this.rank+2)throw new z(`Inputs to SeparableConv${this.rank}D should have rank ${this.rank+2}, but received input shape: ${JSON.stringify(e)}`);const n=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[n]==null||e[n]<0)throw new z(`The channel dimension of the inputs should be defined, but found ${JSON.stringify(e[n])}`);const s=e[n],r=this.kernelSize.concat([s,this.depthMultiplier]),o=[];for(let a=0;a<this.rank;++a)o.push(1);o.push(s*this.depthMultiplier,this.filters);const i=!0;this.depthwiseKernel=this.addWeight("depthwise_kernel",r,"float32",this.depthwiseInitializer,this.depthwiseRegularizer,i,this.depthwiseConstraint),this.pointwiseKernel=this.addWeight("pointwise_kernel",o,"float32",this.pointwiseInitializer,this.pointwiseRegularizer,i,this.pointwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[this.filters],"float32",this.biasInitializer,this.biasRegularizer,i,this.biasConstraint):this.bias=null,this.inputSpec=[new wn({ndim:this.rank+2,axes:{[n]:s}})],this.built=!0}call(e,n){return j(()=>{e=De(e);let s;if(this.rank===1)throw new Be("1D separable convolution is not implemented yet.");return this.rank===2&&(this.dataFormat==="channelsFirst"&&(e=tt(e,[0,2,3,1])),s=RF(e,this.depthwiseKernel.read(),this.pointwiseKernel.read(),this.strides,this.padding,this.dilationRate,"NHWC")),this.useBias&&(s=lo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),this.dataFormat==="channelsFirst"&&(s=tt(s,[0,3,1,2])),s})}getConfig(){const e=super.getConfig();return delete e.rank,delete e.kernelInitializer,delete e.kernelRegularizer,delete e.kernelConstraint,e.depthwiseInitializer=Vt(this.depthwiseInitializer),e.pointwiseInitializer=Vt(this.pointwiseInitializer),e.depthwiseRegularizer=vt(this.depthwiseRegularizer),e.pointwiseRegularizer=vt(this.pointwiseRegularizer),e.depthwiseConstraint=kn(this.depthwiseConstraint),e.pointwiseConstraint=kn(this.pointwiseConstraint),e}}LP.className="SeparableConv";class zP extends LP{constructor(e){super(2,e)}}zP.className="SeparableConv2D";re(zP);class Qx extends ku{constructor(e){super(1,e),Qx.verifyArgs(e),this.inputSpec=[{ndim:3}]}getConfig(){const e=super.getConfig();return delete e.rank,delete e.dataFormat,e}static verifyArgs(e){if(typeof e.kernelSize!="number"&&!PS(e.kernelSize,"number",1,1))throw new z(`Conv1D expects config.kernelSize to be number or number[] with length 1, but received ${JSON.stringify(e.kernelSize)}.`)}}Qx.className="Conv1D";re(Qx);class BP extends Ke{constructor(e){super(e),typeof e.cropping=="number"?this.cropping=[[e.cropping,e.cropping],[e.cropping,e.cropping]]:typeof e.cropping[0]=="number"?this.cropping=[[e.cropping[0],e.cropping[0]],[e.cropping[1],e.cropping[1]]]:this.cropping=e.cropping,this.dataFormat=e.dataFormat===void 0?"channelsLast":e.dataFormat,this.inputSpec=[{ndim:4}]}computeOutputShape(e){return this.dataFormat==="channelsFirst"?[e[0],e[1],e[2]-this.cropping[0][0]-this.cropping[0][1],e[3]-this.cropping[1][0]-this.cropping[1][1]]:[e[0],e[1]-this.cropping[0][0]-this.cropping[0][1],e[2]-this.cropping[1][0]-this.cropping[1][1],e[3]]}call(e,n){return j(()=>{if(e=De(e),this.dataFormat==="channelsLast"){const s=Fp(e,this.cropping[0][0],e.shape[1]-this.cropping[0][0]-this.cropping[0][1],2);return Fp(s,this.cropping[1][0],e.shape[2]-this.cropping[1][1]-this.cropping[1][0],3)}else{const s=Fp(e,this.cropping[0][0],e.shape[2]-this.cropping[0][0]-this.cropping[0][1],3);return Fp(s,this.cropping[1][0],e.shape[3]-this.cropping[1][1]-this.cropping[1][0],4)}})}getConfig(){const e={cropping:this.cropping,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}BP.className="Cropping2D";re(BP);class VP extends Ke{constructor(e){super(e),this.DEFAULT_SIZE=[2,2],this.inputSpec=[{ndim:4}],this.size=e.size==null?this.DEFAULT_SIZE:e.size,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,rn(this.dataFormat),this.interpolation=e.interpolation==null?"nearest":e.interpolation,jX(this.interpolation)}computeOutputShape(e){if(this.dataFormat==="channelsFirst"){const n=e[2]==null?null:this.size[0]*e[2],s=e[3]==null?null:this.size[1]*e[3];return[e[0],e[1],n,s]}else{const n=e[1]==null?null:this.size[0]*e[1],s=e[2]==null?null:this.size[1]*e[2];return[e[0],n,s,e[3]]}}call(e,n){return j(()=>{let s=De(e);const r=s.shape;if(this.dataFormat==="channelsFirst"){s=tt(s,[0,2,3,1]);const o=this.size[0]*r[2],i=this.size[1]*r[3],a=this.interpolation==="nearest"?ei.resizeNearestNeighbor(s,[o,i]):ei.resizeBilinear(s,[o,i]);return tt(a,[0,3,1,2])}else{const o=this.size[0]*r[1],i=this.size[1]*r[2];return this.interpolation==="nearest"?ei.resizeNearestNeighbor(s,[o,i]):ei.resizeBilinear(s,[o,i])}})}getConfig(){const e={size:this.size,dataFormat:this.dataFormat,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}}VP.className="UpSampling2D";re(VP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function b9(t,e,n=[1,1],s="valid",r,o){return j(()=>{r==null&&(r=oo()),rn(r);let i=YS(t,r);if(t.rank!==4)throw new z(`Input for depthwiseConv2d is required to be 4-D, but is instead ${t.rank}-D`);if(e.rank!==4)throw new z(`depthwiseKernel is required to be 4-D, but is instead ${e.rank}-D`);return i=AC(i,e,n,s==="same"?"same":"valid","NHWC",o),r==="channelsFirst"&&(i=tt(i,[0,3,1,2])),i})}class WP extends Yx{constructor(e){super(2,e),this.depthwiseKernel=null,this.depthMultiplier=e.depthMultiplier==null?1:e.depthMultiplier,this.depthwiseInitializer=Ot(e.depthwiseInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.depthwiseConstraint=Cn(e.depthwiseConstraint),this.depthwiseRegularizer=Pt(e.depthwiseRegularizer)}build(e){if(e=rt(e),e.length<4)throw new z(`Inputs to DepthwiseConv2D should have rank 4. Received input shape: ${JSON.stringify(e)}.`);const n=this.dataFormat==="channelsFirst"?1:3;if(e[n]==null||e[n]<0)throw new z(`The channel dimension of the inputs to DepthwiseConv2D should be defined, but is not (${e[n]}).`);const s=e[n],r=[this.kernelSize[0],this.kernelSize[1],s,this.depthMultiplier];this.depthwiseKernel=this.addWeight("depthwise_kernel",r,null,this.depthwiseInitializer,this.depthwiseRegularizer,!0,this.depthwiseConstraint),this.useBias?this.bias=this.addWeight("bias",[s*this.depthMultiplier],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return j(()=>{e=De(e);let s=b9(e,this.depthwiseKernel.read(),this.strides,this.padding,this.dataFormat,null);return this.useBias&&(s=lo(s,this.bias.read(),this.dataFormat)),this.activation!=null&&(s=this.activation.apply(s)),s})}computeOutputShape(e){e=rt(e);const n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[1]*this.depthMultiplier:e[3]*this.depthMultiplier,o=no(n,this.kernelSize[0],this.padding,this.strides[0]),i=no(s,this.kernelSize[1],this.padding,this.strides[1]);return this.dataFormat==="channelsFirst"?[e[0],r,o,i]:[e[0],o,i,r]}getConfig(){const e=super.getConfig();return e.depthMultiplier=this.depthMultiplier,e.depthwiseInitializer=Vt(this.depthwiseInitializer),e.depthwiseRegularizer=vt(this.depthwiseRegularizer),e.depthwiseConstraint=kn(this.depthwiseRegularizer),e}}WP.className="DepthwiseConv2D";re(WP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function UP(t,e,n,s){if(Array.isArray(t)){if(e!=null||n!=null)throw new z("When inputs is an array, neither initialState or constants should be provided");s!=null&&(n=t.slice(t.length-s,t.length),t=t.slice(0,t.length-s)),t.length>1&&(e=t.slice(1,t.length)),t=t[0]}function r(o){return o==null||Array.isArray(o)?o:[o]}return e=r(e),n=r(n),{inputs:t,initialState:e,constants:n}}function HP(t,e,n,s=!1,r,o,i=!1,a=!1){return j(()=>{const l=e.shape.length;if(l<3)throw new z(`Input should be at least 3D, but is ${l}D.`);const c=[1,0].concat(ro(2,l));if(e=tt(e,c),o!=null)throw new Be("The rnn() functoin of the deeplearn.js backend does not support constants yet.");i&&console.warn("Backend rnn(): the unroll = true option is not applicable to the imperative deeplearn.js backend."),r!=null&&(r=ve(ve(r,"bool"),"float32"),r.rank===l-1&&(r=ys(r,-1)),r=tt(r,c)),s&&(e=bl(e,0),r!=null&&(r=bl(r,0)));const u=[];let d,h=n;const f=e.shape[0],p=vl(e);let m;r!=null&&(m=vl(r));for(let g=0;g<f;++g){const y=p[g],b=j(()=>t(y,h));if(r==null)d=b[0],h=b[1];else{const v=j(()=>{const w=m[g],k=_e(Fr(w),w),C=ie(V(b[0],w),V(h[0],k)),S=h.map((I,$)=>ie(V(b[1][$],w),V(I,k)));return{output:C,newStates:S}});d=v.output,h=v.newStates}a&&u.push(d)}let x;return a&&(x=ci(u,1)),[d,x,h]})}class wa extends Ke{constructor(e){super(e);let n;if(e.cell==null)throw new z("cell property is missing for the constructor of RNN.");if(Array.isArray(e.cell)?n=new JS({cells:e.cell}):n=e.cell,n.stateSize==null)throw new z("The RNN cell should have an attribute `stateSize` (tuple of integers, one integer per RNN state).");this.cell=n,this.returnSequences=e.returnSequences==null?!1:e.returnSequences,this.returnState=e.returnState==null?!1:e.returnState,this.goBackwards=e.goBackwards==null?!1:e.goBackwards,this._stateful=e.stateful==null?!1:e.stateful,this.unroll=e.unroll==null?!1:e.unroll,this.supportsMasking=!0,this.inputSpec=[new wn({ndim:3})],this.stateSpec=null,this.states_=null,this.numConstants=null,this.keptStates=[]}getStates(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;return ro(0,e).map(n=>null)}else return this.states_}setStates(e){this.states_=e}computeOutputShape(e){Uv(e)&&(e=e[0]),e=e;let n=this.cell.stateSize;Array.isArray(n)||(n=[n]);const s=n[0];let r;if(this.returnSequences?r=[e[0],e[1],s]:r=[e[0],s],this.returnState){const o=[];for(const i of n)o.push([e[0],i]);return[r].concat(o)}else return r}computeMask(e,n){return j(()=>{Array.isArray(n)&&(n=n[0]);const s=this.returnSequences?n:null;if(this.returnState){const r=this.states.map(o=>null);return[s].concat(r)}else return s})}get states(){if(this.states_==null){const e=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1,n=[];for(let s=0;s<e;++s)n.push(null);return n}else return this.states_}set states(e){this.states_=e}build(e){if(this.numConstants!=null)throw new Be("Constants support is not implemented in RNN yet.");Uv(e)&&(e=e[0]),e=e;const n=this.stateful?e[0]:null,s=e.slice(2);this.inputSpec[0]=new wn({shape:[n,null,...s]});const r=[e[0]].concat(e.slice(2));this.cell.build(r);let o;if(Array.isArray(this.cell.stateSize)?o=this.cell.stateSize:o=[this.cell.stateSize],this.stateSpec!=null){if(!lt(this.stateSpec.map(i=>i.shape[i.shape.length-1]),o))throw new z(`An initialState was passed that is not compatible with cell.stateSize. Received stateSpec=${this.stateSpec}; However cell.stateSize is ${this.cell.stateSize}`)}else this.stateSpec=o.map(i=>new wn({shape:[null,i]}));this.stateful&&this.resetStates()}resetStates(e,n=!1){j(()=>{if(!this.stateful)throw new yo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape[0];if(s==null)throw new z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.states_==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>hn([s,r])):this.states_=[hn([s,this.cell.stateSize])];else if(e==null)Qe(this.states_),this.keptStates!=null&&(Qe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(r=>hn([s,r])):this.states_[0]=hn([s,this.cell.stateSize]);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n===!0?this.keptStates.push(this.states_.slice()):Qe(this.states_);for(let r=0;r<this.states_.length;++r){const o=e[r],i=Array.isArray(this.cell.stateSize)?this.cell.stateSize[r]:this.cell.stateSize,a=[s,i];if(!lt(o.shape,a))throw new z(`State ${r} is incompatible with layer ${this.name}: expected shape=${a}, received shape=${o.shape}`);this.states_[r]=o}}this.states_=this.states_.map(r=>No(r.clone()))})}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=UP(e,s,r,this.numConstants);e=o.inputs,s=o.initialState,r=o.constants;let i=[],a=[];if(s!=null){n.initialState=s,i=i.concat(s),this.stateSpec=[];for(const c of s)this.stateSpec.push(new wn({shape:c.shape}));a=a.concat(this.stateSpec)}if(r!=null&&(n.constants=r,i=i.concat(r),this.numConstants=r.length),i[0]instanceof Lo){const c=[e].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return j(()=>{const s=n==null?null:n.mask,r=n==null?null:n.training;let o=n==null?null:n.initialState;e=De(e),o==null&&(this.stateful?o=this.states_:o=this.getInitialState(e));const i=Array.isArray(this.cell.stateSize)?this.cell.stateSize.length:1;if(o.length!==i)throw new z(`RNN Layer has ${i} state(s) but was passed ${o.length} initial state(s).`);this.unroll&&console.warn("Ignoring unroll = true for RNN layer, due to imperative backend.");const a={training:r},c=HP((p,m)=>{const x=this.cell.call([p].concat(m),a);return[x[0],x.slice(1)]},e,o,this.goBackwards,s,null,this.unroll,this.returnSequences),u=c[0],d=c[1],h=c[2];this.stateful&&this.resetStates(h,r);const f=this.returnSequences?d:u;return this.returnState?[f].concat(h):f})}getInitialState(e){return j(()=>{let n=hn(e.shape);return n=Ee(n,[1,2]),n=Wf(n),Array.isArray(this.cell.stateSize)?this.cell.stateSize.map(s=>s>1?Vv(n,[1,s]):n):this.cell.stateSize>1?[Vv(n,[1,this.cell.stateSize])]:[n]})}get trainableWeights(){return this.trainable?this.cell.trainableWeights:[]}get nonTrainableWeights(){return this.trainable?this.cell.nonTrainableWeights:this.cell.weights}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.cell!=null&&this.cell.setFastWeightInitDuringBuild(e)}getConfig(){const e=super.getConfig(),n={returnSequences:this.returnSequences,returnState:this.returnState,goBackwards:this.goBackwards,stateful:this.stateful,unroll:this.unroll};this.numConstants!=null&&(n.numConstants=this.numConstants);const s=this.cell.getConfig();return this.getClassName()===wa.className&&(n.cell={className:this.cell.getClassName(),config:s}),Object.assign(Object.assign(Object.assign({},s),e),n)}static fromConfig(e,n,s={}){const r=n.cell,o=si(r,s);return new e(Object.assign(n,{cell:o}))}}wa.className="RNN";re(wa);class Zx extends Ke{}class QS extends Zx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,_n(this.units,"units"),this.activation=ia(e.activation==null?this.DEFAULT_ACTIVATION:e.activation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ot(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ot(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ot(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Pt(e.kernelRegularizer),this.recurrentRegularizer=Pt(e.recurrentRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.kernelConstraint=Cn(e.kernelConstraint),this.recurrentConstraint=Cn(e.recurrentConstraint),this.biasConstraint=Cn(e.biasConstraint),this.dropout=Qc([1,ra([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Qc([1,ra([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=rt(e),this.kernel=this.addWeight("kernel",[e[e.length-1],this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return j(()=>{if(e=e,e.length!==2)throw new z(`SimpleRNNCell expects 2 input Tensors, got ${e.length}.`);let s=e[1];e=e[0];const r=n.training==null?!1:n.training;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=aa({ones:()=>Fr(e),rate:this.dropout,training:r,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=aa({ones:()=>Fr(s),rate:this.recurrentDropout,training:r,dropoutFunc:this.dropoutFunc}));let o;const i=this.dropoutMask,a=this.recurrentDropoutMask;i!=null?o=Ao(V(e,i),this.kernel.read()):o=Ao(e,this.kernel.read()),this.bias!=null&&(o=lo(o,this.bias.read())),a!=null&&(s=V(s,a));let l=ie(o,Ao(s,this.recurrentKernel.read()));return this.activation!=null&&(l=this.activation.apply(l)),[l,l]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),useBias:this.useBias,kernelInitializer:Vt(this.kernelInitializer),recurrentInitializer:Vt(this.recurrentInitializer),biasInitializer:Vt(this.biasInitializer),kernelRegularizer:vt(this.kernelRegularizer),recurrentRegularizer:vt(this.recurrentRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:kn(this.kernelConstraint),recurrentConstraint:kn(this.recurrentConstraint),biasConstraint:kn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout};return Object.assign(Object.assign({},e),n)}}QS.className="SimpleRNNCell";re(QS);class GP extends wa{constructor(e){e.cell=new QS(e),super(e)}call(e,n){return j(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return new e(n)}}GP.className="SimpleRNN";re(GP);class ZS extends Zx{constructor(e){if(super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.resetAfter)throw new z("GRUCell does not support reset_after parameter set to true.");this.units=e.units,_n(this.units,"units"),this.activation=ia(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ia(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ot(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ot(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ot(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelRegularizer=Pt(e.kernelRegularizer),this.recurrentRegularizer=Pt(e.recurrentRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.kernelConstraint=Cn(e.kernelConstraint),this.recurrentConstraint=Cn(e.recurrentConstraint),this.biasConstraint=Cn(e.biasConstraint),this.dropout=Qc([1,ra([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Qc([1,ra([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=this.units,this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){e=rt(e);const n=e[e.length-1];this.kernel=this.addWeight("kernel",[n,this.units*3],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*3],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias?this.bias=this.addWeight("bias",[this.units*3],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint):this.bias=null,this.built=!0}call(e,n){return j(()=>{if(e=e,e.length!==2)throw new z(`GRUCell expects 2 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training==null?!1:n.training;let r=e[1];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=aa({ones:()=>Fr(e),rate:this.dropout,training:s,count:3,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=aa({ones:()=>Fr(r),rate:this.recurrentDropout,training:s,count:3,dropoutFunc:this.dropoutFunc}));const o=this.dropoutMask,i=this.recurrentDropoutMask;let a,l,c;0<this.dropout&&this.dropout<1&&(e=V(e,o[0]));let u=Ao(e,this.kernel.read());this.useBias&&(u=lo(u,this.bias.read())),0<this.recurrentDropout&&this.recurrentDropout<1&&(r=V(r,i[0]));const d=this.recurrentKernel.read(),[h,f]=Js(d,[2*this.units,this.units],d.rank-1),p=Ao(r,h),[m,x,g]=Js(u,3,u.rank-1),[y,b]=Js(p,2,p.rank-1);a=this.recurrentActivation.apply(ie(m,y)),l=this.recurrentActivation.apply(ie(x,b));const v=Ao(V(l,r),f);c=this.activation.apply(ie(g,v));const w=ie(V(a,r),V(ie(1,tn(a)),c));return[w,w]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),recurrentActivation:oa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Vt(this.kernelInitializer),recurrentInitializer:Vt(this.recurrentInitializer),biasInitializer:Vt(this.biasInitializer),kernelRegularizer:vt(this.kernelRegularizer),recurrentRegularizer:vt(this.recurrentRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:kn(this.kernelConstraint),recurrentConstraint:kn(this.recurrentConstraint),biasConstraint:kn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation,resetAfter:!1};return Object.assign(Object.assign({},e),n)}}ZS.className="GRUCell";re(ZS);class jP extends wa{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new ZS(e),super(e)}call(e,n){return j(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}jP.className="GRU";re(jP);class Jx extends Zx{constructor(e){super(e),this.DEFAULT_ACTIVATION="tanh",this.DEFAULT_RECURRENT_ACTIVATION="hardSigmoid",this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_RECURRENT_INITIALIZER="orthogonal",this.DEFAULT_BIAS_INITIALIZER="zeros",this.units=e.units,_n(this.units,"units"),this.activation=ia(e.activation===void 0?this.DEFAULT_ACTIVATION:e.activation),this.recurrentActivation=ia(e.recurrentActivation===void 0?this.DEFAULT_RECURRENT_ACTIVATION:e.recurrentActivation),this.useBias=e.useBias==null?!0:e.useBias,this.kernelInitializer=Ot(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.recurrentInitializer=Ot(e.recurrentInitializer||this.DEFAULT_RECURRENT_INITIALIZER),this.biasInitializer=Ot(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.unitForgetBias=e.unitForgetBias,this.kernelRegularizer=Pt(e.kernelRegularizer),this.recurrentRegularizer=Pt(e.recurrentRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.kernelConstraint=Cn(e.kernelConstraint),this.recurrentConstraint=Cn(e.recurrentConstraint),this.biasConstraint=Cn(e.biasConstraint),this.dropout=Qc([1,ra([0,e.dropout==null?0:e.dropout])]),this.recurrentDropout=Qc([1,ra([0,e.recurrentDropout==null?0:e.recurrentDropout])]),this.dropoutFunc=e.dropoutFunc,this.implementation=e.implementation,this.stateSize=[this.units,this.units],this.dropoutMask=null,this.recurrentDropoutMask=null}build(e){var n;e=rt(e);const s=e[e.length-1];this.kernel=this.addWeight("kernel",[s,this.units*4],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.recurrentKernel=this.addWeight("recurrent_kernel",[this.units,this.units*4],null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint);let r;if(this.useBias){if(this.unitForgetBias){const o=this.biasInitializer,i=this.units;r=new(n=class extends Mr{apply(l,c){const u=o.apply([i]),d=new LS().apply([i]),h=o.apply([i*2]);return hT(hT(u,d),h)}},n.className="CustomInit",n)}else r=this.biasInitializer;this.bias=this.addWeight("bias",[this.units*4],null,r,this.biasRegularizer,!0,this.biasConstraint)}else this.bias=null;this.built=!0}call(e,n){return j(()=>{const s=n.training==null?!1:n.training;if(e=e,e.length!==3)throw new z(`LSTMCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);let r=e[1];const o=e[2];e=e[0],0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=aa({ones:()=>Fr(e),rate:this.dropout,training:s,count:4,dropoutFunc:this.dropoutFunc})),0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=aa({ones:()=>Fr(r),rate:this.recurrentDropout,training:s,count:4,dropoutFunc:this.dropoutFunc}));const i=this.dropoutMask,a=this.recurrentDropoutMask;let l,c,u,d;0<this.dropout&&this.dropout<1&&(e=V(e,i[0]));let h=Ao(e,this.kernel.read());0<this.recurrentDropout&&this.recurrentDropout<1&&(r=V(r,a[0])),h=ie(h,Ao(r,this.recurrentKernel.read())),this.useBias&&(h=lo(h,this.bias.read()));const[f,p,m,x]=Js(h,4,h.rank-1);l=this.recurrentActivation.apply(f),c=this.recurrentActivation.apply(p),u=ie(V(c,o),V(l,this.activation.apply(m))),d=this.recurrentActivation.apply(x);const g=V(d,this.activation.apply(u));return[g,g,u]})}getConfig(){const e=super.getConfig(),n={units:this.units,activation:oa(this.activation),recurrentActivation:oa(this.recurrentActivation),useBias:this.useBias,kernelInitializer:Vt(this.kernelInitializer),recurrentInitializer:Vt(this.recurrentInitializer),biasInitializer:Vt(this.biasInitializer),unitForgetBias:this.unitForgetBias,kernelRegularizer:vt(this.kernelRegularizer),recurrentRegularizer:vt(this.recurrentRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:kn(this.kernelConstraint),recurrentConstraint:kn(this.recurrentConstraint),biasConstraint:kn(this.biasConstraint),dropout:this.dropout,recurrentDropout:this.recurrentDropout,implementation:this.implementation};return Object.assign(Object.assign({},e),n)}}Jx.className="LSTMCell";re(Jx);class KP extends wa{constructor(e){e.implementation===0&&console.warn("`implementation=0` has been deprecated, and now defaults to `implementation=1`. Please update your layer call."),e.cell=new Jx(e),super(e)}call(e,n){return j(()=>{this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null);const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}static fromConfig(e,n){return n.implmentation===0&&(n.implementation=1),new e(n)}}KP.className="LSTM";re(KP);class JS extends Zx{constructor(e){super(e),this.cells=e.cells}get stateSize(){const e=[];for(const n of this.cells.slice().reverse())Array.isArray(n.stateSize)?e.push(...n.stateSize):e.push(n.stateSize);return e}call(e,n){return j(()=>{e=e;let s=e.slice(1);const r=[];for(const a of this.cells.slice().reverse())Array.isArray(a.stateSize)?r.push(s.splice(0,a.stateSize.length)):r.push(s.splice(0,1));r.reverse();const o=[];let i;for(let a=0;a<this.cells.length;++a){const l=this.cells[a];s=r[a],a===0?i=[e[0]].concat(s):i=[i[0]].concat(s),i=l.call(i,n),o.push(i.slice(1))}s=[];for(const a of o.slice().reverse())s.push(...a);return[i[0]].concat(s)})}build(e){Uv(e)&&(e=e[0]),e=e;let n;this.cells.forEach((s,r)=>{tl(`RNNCell_${r}`,()=>{s.build(e),Array.isArray(s.stateSize)?n=s.stateSize[0]:n=s.stateSize,e=[e[0],n]})}),this.built=!0}getConfig(){const e=super.getConfig(),n=o=>({className:o.getClassName(),config:o.getConfig()}),r={cells:this.cells.map(n)};return Object.assign(Object.assign({},e),r)}static fromConfig(e,n,s={}){const r=[];for(const o of n.cells)r.push(si(o,s));return new e({cells:r})}get trainableWeights(){if(!this.trainable)return[];const e=[];for(const n of this.cells)e.push(...n.trainableWeights);return e}get nonTrainableWeights(){const e=[];for(const n of this.cells)e.push(...n.nonTrainableWeights);if(!this.trainable){const n=[];for(const s of this.cells)n.push(...s.trainableWeights);return n.concat(e)}return e}getWeights(){const e=[];for(const n of this.cells)e.push(...n.weights);return Hv(e)}setWeights(e){const n=[];for(const s of this.cells){const r=s.weights.length,o=e.splice(r);for(let i=0;i<s.weights.length;++i)n.push([s.weights[i],o[i]])}GS(n)}}JS.className="StackedRNNCells";re(JS);function aa(t){const{ones:e,rate:n,training:s=!1,count:r=1,dropoutFunc:o}=t,i=()=>o!=null?o(e(),n):LO(e(),n),a=()=>Hf(i,e,s);return!r||r<=1?No(a().clone()):Array(r).fill(void 0).map(a).map(c=>No(c.clone()))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */var v9=globalThis&&globalThis.__rest||function(t,e){var n={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(n[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(t);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(t,s[r])&&(n[s[r]]=t[s[r]]);return n};class XP extends wa{constructor(e){if(e.unroll)throw new Be("Unrolling is not possible with convolutional RNNs.");if(Array.isArray(e.cell))throw new Be("It is not possible at the moment to stack convolutional cells.");super(e),this.inputSpec=[new wn({ndim:5})]}call(e,n){return j(()=>{if(this.cell.dropoutMask!=null&&(Qe(this.cell.dropoutMask),this.cell.dropoutMask=null),this.cell.recurrentDropoutMask!=null&&(Qe(this.cell.recurrentDropoutMask),this.cell.recurrentDropoutMask=null),n&&n.constants)throw new z("ConvRNN2D cell does not support constants");const s=n==null?null:n.mask,r=n==null?null:n.training,o=n==null?null:n.initialState;return super.call(e,{mask:s,training:r,initialState:o})})}computeOutputShape(e){let n=this.computeSingleOutputShape(e);return this.returnSequences||(n=[n[0],...n.slice(2)]),this.returnState&&(n=[n,...Array(2).fill([e[0],...n.slice(-3)])]),n}getInitialState(e){return j(()=>{const{stateSize:n}=this.cell,s=e.shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)],i=hn(o);return Array.isArray(n)?Array(n.length).fill(i):[i]})}resetStates(e,n=!1){j(()=>{if(!this.stateful)throw new yo("Cannot call resetStates() on an RNN Layer that is not stateful.");const s=this.inputSpec[0].shape,r=this.computeSingleOutputShape(s),o=[r[0],...r.slice(2)];if(s[0]==null)throw new z("If an RNN is stateful, it needs to know its batch size. Specify the batch size of your input tensors: \n- If using a Sequential model, specify the batch size by passing a `batchInputShape` option to your first layer.\n- If using the functional API, specify the batch size by passing a `batchShape` option to your Input layer.");if(this.getStates()==null)Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>hn(o)):this.states_=[hn(o)];else if(e==null)Qe(this.states_),this.keptStates!=null&&(Qe(this.keptStates),this.keptStates=[]),Array.isArray(this.cell.stateSize)?this.states_=this.cell.stateSize.map(()=>hn(o)):this.states_[0]=hn(o);else{if(Array.isArray(e)||(e=[e]),e.length!==this.states_.length)throw new z(`Layer ${this.name} expects ${this.states_.length} state(s), but it received ${e.length} state value(s). Input received: ${e}`);n?this.keptStates.push(this.states_.slice()):Qe(this.states_);for(let a=0;a<this.states_.length;++a){const l=e[a],c=o;if(!lt(l.shape,c))throw new z(`State ${a} is incompatible with layer ${this.name}: expected shape=${c}, received shape=${l.shape}`);this.states_[a]=l}}this.states_=this.states_.map(a=>No(a.clone()))})}computeSingleOutputShape(e){const{dataFormat:n,filters:s,kernelSize:r,padding:o,strides:i,dilationRate:a}=this.cell,l=n==="channelsFirst",c=e[l?3:2],u=e[l?4:3],d=no(c,r[0],o,i[0],a[0]),h=no(u,r[1],o,i[1],a[1]);return[...e.slice(0,2),...l?[s,d,h]:[d,h,s]]}}XP.className="ConvRNN2D";class e$ extends Jx{constructor(e){const{filters:n,kernelSize:s,strides:r,padding:o,dataFormat:i,dilationRate:a}=e;super(Object.assign(Object.assign({},e),{units:n})),this.filters=n,_n(this.filters,"filters"),this.kernelSize=Ac(s,2,"kernelSize"),this.kernelSize.forEach(l=>_n(l,"kernelSize")),this.strides=Ac(r||1,2,"strides"),this.strides.forEach(l=>_n(l,"strides")),this.padding=o||"valid",lr(this.padding),this.dataFormat=i||"channelsLast",rn(this.dataFormat),this.dilationRate=Ac(a||1,2,"dilationRate"),this.dilationRate.forEach(l=>_n(l,"dilationRate"))}build(e){var n;e=rt(e);const s=this.dataFormat==="channelsFirst"?1:e.length-1;if(e[s]==null)throw new z(`The channel dimension of the input should be defined. Found ${e[s]}`);const r=e[s],o=4,i=this.kernelSize.concat([r,this.filters*o]);this.kernel=this.addWeight("kernel",i,null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint);const a=this.kernelSize.concat([this.filters,this.filters*o]);if(this.recurrentKernel=this.addWeight("recurrent_kernel",a,null,this.recurrentInitializer,this.recurrentRegularizer,!0,this.recurrentConstraint),this.useBias){let l;if(this.unitForgetBias){const c=this.biasInitializer,u=this.filters;l=new(n=class extends Mr{apply(h,f){const p=c.apply([u]),m=ba([u]),x=c.apply([u*2]);return MS([p,m,x])}},n.className="CustomInit",n)}else l=this.biasInitializer;this.bias=this.addWeight("bias",[this.filters*o],null,l,this.biasRegularizer,!0,this.biasConstraint)}this.built=!0}call(e,n){return j(()=>{if(e.length!==3)throw new z(`ConvLSTM2DCell expects 3 input Tensors (inputs, h, c), got ${e.length}.`);const s=n.training||!1,r=e[0],o=e[1],i=e[2],a=4;0<this.dropout&&this.dropout<1&&this.dropoutMask==null&&(this.dropoutMask=aa({ones:()=>Fr(r),rate:this.dropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const l=this.dropoutMask,c=(G,X,Y)=>!X||!X[Y]?G:V(X[Y],G);let u=c(r,l,0),d=c(r,l,1),h=c(r,l,2),f=c(r,l,3);0<this.recurrentDropout&&this.recurrentDropout<1&&this.recurrentDropoutMask==null&&(this.recurrentDropoutMask=aa({ones:()=>Fr(o),rate:this.recurrentDropout,training:s,count:a,dropoutFunc:this.dropoutFunc}));const p=this.recurrentDropoutMask;let m=c(o,p,0),x=c(o,p,1),g=c(o,p,2),y=c(o,p,3);const b=3,[v,w,k,C]=Js(this.kernel.read(),a,b),[S,I,$,E]=this.useBias?Js(this.bias.read(),a):[null,null,null,null];u=this.inputConv(u,v,S,this.padding),d=this.inputConv(d,w,I,this.padding),h=this.inputConv(h,k,$,this.padding),f=this.inputConv(f,C,E,this.padding);const[_,D,F,R]=Js(this.recurrentKernel.read(),a,b);m=this.recurrentConv(m,_),x=this.recurrentConv(x,D),g=this.recurrentConv(g,F),y=this.recurrentConv(y,R);const P=this.recurrentActivation.apply(ie(u,m)),M=this.recurrentActivation.apply(ie(d,x)),N=ie(V(M,i),V(P,this.activation.apply(ie(h,g)))),B=V(this.recurrentActivation.apply(ie(f,y)),this.activation.apply(N));return[B,B,N]})}getConfig(){const e=super.getConfig(),n=v9(e,["units"]),s={filters:this.filters,kernelSize:this.kernelSize,padding:this.padding,dataFormat:this.dataFormat,dilationRate:this.dilationRate,strides:this.strides};return Object.assign(Object.assign({},n),s)}inputConv(e,n,s,r){const o=xl(e,n,this.strides,r||"valid",this.dataFormat==="channelsFirst"?"NCHW":"NHWC",this.dilationRate);return s?lo(o,s,this.dataFormat):o}recurrentConv(e,n){return xl(e,n,1,"same",this.dataFormat==="channelsFirst"?"NCHW":"NHWC")}}e$.className="ConvLSTM2DCell";re(e$);class qP extends XP{constructor(e){const n=new e$(e);super(Object.assign(Object.assign({},e),{cell:n}))}static fromConfig(e,n){return new e(n)}}qP.className="ConvLSTM2D";re(qP);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class t$ extends Ke{constructor(e){super(e),this.rate=Math.max(Math.min(e.rate,1),0),this.noiseShape=e.noiseShape,this.seed=e.seed,this.supportsMasking=!0}getNoiseShape(e){if(this.noiseShape==null)return this.noiseShape;const n=e.shape,s=[];for(let r=0;r<this.noiseShape.length;++r)s.push(this.noiseShape[r]==null?n[r]:this.noiseShape[r]);return s}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e);if(0<this.rate&&this.rate<1){const r=n.training==null?!1:n.training,o=this.getNoiseShape(s);return Hf(()=>LO(s,this.rate,o,this.seed),()=>s,r)}return e})}getConfig(){const e={rate:this.rate,noiseShape:this.noiseShape,seed:this.seed},n=super.getConfig();return Object.assign(e,n),e}dispose(){return super.dispose()}}t$.className="Dropout";re(t$);class YP extends t${constructor(e){super(e),this.inputSpec=[{ndim:3}]}getNoiseShape(e){const n=e.shape;return[n[0],1,n[2]]}}YP.className="SpatialDropout1D";re(YP);class n$ extends Ke{constructor(e){if(super(e),this.activation=null,this.useBias=!0,this.kernel=null,this.bias=null,this.DEFAULT_KERNEL_INITIALIZER="glorotNormal",this.DEFAULT_BIAS_INITIALIZER="zeros",e.batchInputShape==null&&e.inputShape==null&&e.inputDim!=null){let n=null;e.batchSize!=null&&(n=e.batchSize),this.batchInputShape=[n,e.inputDim]}this.units=e.units,_n(this.units,"units"),this.activation=ia(e.activation),e.useBias!=null&&(this.useBias=e.useBias),this.kernelInitializer=Ot(e.kernelInitializer||this.DEFAULT_KERNEL_INITIALIZER),this.biasInitializer=Ot(e.biasInitializer||this.DEFAULT_BIAS_INITIALIZER),this.kernelConstraint=Cn(e.kernelConstraint),this.biasConstraint=Cn(e.biasConstraint),this.kernelRegularizer=Pt(e.kernelRegularizer),this.biasRegularizer=Pt(e.biasRegularizer),this.activityRegularizer=Pt(e.activityRegularizer),this.supportsMasking=!0,this.inputSpec=[{minNDim:2}]}build(e){e=rt(e);const n=e[e.length-1];this.kernel==null&&(this.kernel=this.addWeight("kernel",[n,this.units],null,this.kernelInitializer,this.kernelRegularizer,!0,this.kernelConstraint),this.useBias&&(this.bias=this.addWeight("bias",[this.units],null,this.biasInitializer,this.biasRegularizer,!0,this.biasConstraint))),this.inputSpec=[{minNDim:2,axes:{[-1]:n}}],this.built=!0}computeOutputShape(e){e=rt(e);const n=e.slice();return n[n.length-1]=this.units,n}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e),r=RO(this.activation.getClassName());let o;return r!=null?o=Ao(s,this.kernel.read(),r,this.bias?this.bias.read():null):(o=Ao(s,this.kernel.read()),this.bias!=null&&(o=lo(o,this.bias.read())),this.activation!=null&&(o=this.activation.apply(o))),o})}getConfig(){const e={units:this.units,activation:oa(this.activation),useBias:this.useBias,kernelInitializer:Vt(this.kernelInitializer),biasInitializer:Vt(this.biasInitializer),kernelRegularizer:vt(this.kernelRegularizer),biasRegularizer:vt(this.biasRegularizer),activityRegularizer:vt(this.activityRegularizer),kernelConstraint:kn(this.kernelConstraint),biasConstraint:kn(this.biasConstraint)},n=super.getConfig();return Object.assign(e,n),e}}n$.className="Dense";re(n$);class QP extends Ke{constructor(e){e=e||{},super(e),this.inputSpec=[{minNDim:3}],this.dataFormat=e.dataFormat}computeOutputShape(e){e=rt(e);for(const n of e.slice(1))if(n==null)throw new z(`The shape of the input to "Flatten" is not fully defined (got ${e.slice(1)}). Make sure to pass a complete "input_shape" or "batch_input_shape" argument to the first layer in your model.`);return[e[0],Zi(e,1)]}call(e,n){return j(()=>{this.invokeCallHook(e,n);let s=De(e);if(this.dataFormat==="channelsFirst"&&s.rank>1){const r=[0];for(let o=2;o<s.rank;++o)r.push(o);r.push(1),s=tt(s,r)}return ZX(s)})}getConfig(){const e={};this.dataFormat!=null&&(e.dataFormat=this.dataFormat);const n=super.getConfig();return Object.assign(e,n),e}}QP.className="Flatten";re(QP);class ZP extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.activation=ia(e.activation)}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e);return this.activation.apply(s)})}getConfig(){const e={activation:oa(this.activation)},n=super.getConfig();return Object.assign(e,n),e}}ZP.className="Activation";re(ZP);class JP extends Ke{constructor(e){super(e),this.n=e.n,this.inputSpec=[{ndim:2}]}computeOutputShape(e){return[e[0],this.n,e[1]]}call(e,n){return j(()=>(e=De(e),YX(e,this.n)))}getConfig(){const e={n:this.n},n=super.getConfig();return Object.assign(e,n),e}}JP.className="RepeatVector";re(JP);class eM extends Ke{constructor(e){super(e),this.targetShape=e.targetShape;for(let n=0;n<this.targetShape.length;++n)this.isUnknown(this.targetShape[n])&&(this.targetShape[n]=null)}isUnknown(e){return e<0||e==null}fixUnknownDimension(e,n){const s="Total size of new array must be unchanged.",r=n.slice();let o=1,i=null;for(let l=0;l<r.length;++l){const c=r[l];if(this.isUnknown(c))if(i===null)i=l;else throw new z("Can only specifiy one unknown dimension.");else o*=c}const a=Zi(e);if(i!==null){if(o===0||a%o!==0)throw new z(s);r[i]=a/o}else if(a!==o)throw new z(s);return r}computeOutputShape(e){let n=!1;for(let s=0;s<e.length;++s)if(this.isUnknown(e[s])){n=!0;break}return n?e.slice(0,1).concat(this.targetShape):e.slice(0,1).concat(this.fixUnknownDimension(e.slice(1),this.targetShape))}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e),r=s.shape,o=r.slice(0,1).concat(this.fixUnknownDimension(r.slice(1),this.targetShape));return U(s,o)})}getConfig(){const e={targetShape:this.targetShape},n=super.getConfig();return Object.assign(e,n),e}}eM.className="Reshape";re(eM);class tM extends Ke{constructor(e){if(super(e),e.dims==null)throw new Error("Required configuration field `dims` is missing during Permute constructor call.");if(!Array.isArray(e.dims))throw new Error(`Permute constructor requires \`dims\` to be an Array, but received ${e.dims} instead.`);const n=ro(1,e.dims.length+1);if(!lt(e.dims.slice().sort(),n))throw new Error("Invalid permutation `dims`: "+JSON.stringify(e.dims)+" `dims` must contain consecutive integers starting from 1.");this.dims=e.dims,this.dimsIncludingBatch=[0].concat(this.dims),this.inputSpec=[new wn({ndim:this.dims.length+1})]}computeOutputShape(e){e=rt(e);const n=e.slice();return this.dims.forEach((s,r)=>{n[r+1]=e[s]}),n}call(e,n){return tt(De(e),this.dimsIncludingBatch)}getConfig(){const e={dims:this.dims},n=super.getConfig();return Object.assign(e,n),e}}tM.className="Permute";re(tM);class nM extends Ke{constructor(e){super(e??{}),this.supportsMasking=!0,e!=null?this.maskValue=e.maskValue==null?0:e.maskValue:this.maskValue=0}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={maskValue:this.maskValue};return Object.assign(n,e),n}computeMask(e,n){const s=De(e),r=-1;return Fv(Sg(s,this.maskValue),r)}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e),r=-1,o=!0,i=Fv(Sg(s,this.maskValue),r,o);return V(s,ve(i,s.dtype))})}}nM.className="Masking";re(nM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class sM extends Ke{constructor(e){if(super(e),this.embeddings=null,this.DEFAULT_EMBEDDINGS_INITIALIZER="randomUniform",e.batchInputShape==null&&e.inputShape==null){let n=null;e.batchSize!=null&&(n=e.batchSize),e.inputLength==null?this.batchInputShape=[n,null]:this.batchInputShape=[n].concat(ft(e.inputLength))}this.inputDim=e.inputDim,_n(this.inputDim,"inputDim"),this.outputDim=e.outputDim,_n(this.outputDim,"outputDim"),this.embeddingsInitializer=Ot(e.embeddingsInitializer||this.DEFAULT_EMBEDDINGS_INITIALIZER),this.embeddingsRegularizer=Pt(e.embeddingsRegularizer),this.activityRegularizer=Pt(e.activityRegularizer),this.embeddingsConstraint=Cn(e.embeddingsConstraint),this.maskZero=e.maskZero,this.supportsMasking=e.maskZero,this.inputLength=e.inputLength}build(e){this.embeddings=this.addWeight("embeddings",[this.inputDim,this.outputDim],this.dtype,this.embeddingsInitializer,this.embeddingsRegularizer,!0,this.embeddingsConstraint),this.built=!0}warnOnIncompatibleInputShape(e){}computeMask(e,n){return j(()=>this.maskZero?(e=De(e),Sg(e,nt(e))):null)}computeOutputShape(e){if(e=rt(e),this.inputLength==null)return[...e,this.outputDim];const n=ft(this.inputLength);if(n.length!==e.length-1)throw new z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);{let s=0;for(let r=0;r<n.length;++r){const o=n[r],i=e[r+1];if(o!=null&&i!=null&&o!==i)throw new z(`"inputLength" is ${this.inputLength}, but received input shape has shape ${e}`);o==null&&(n[s]=i),s++}}return[e[0],...n,this.outputDim]}call(e,n){return j(()=>{this.invokeCallHook(e,n);let s=De(e);s.dtype!=="int32"&&(s=Ro(s,"int32"));const r=MO(this.embeddings.read(),U(s,[s.size]));return U(r,rt(this.computeOutputShape(s.shape)))})}getConfig(){const e={inputDim:this.inputDim,outputDim:this.outputDim,embeddingsInitializer:Vt(this.embeddingsInitializer),embeddingsRegularizer:vt(this.embeddingsRegularizer),activityRegularizer:vt(this.activityRegularizer),embeddingsConstraint:kn(this.embeddingsConstraint),maskZero:this.maskZero,inputLength:this.inputLength},n=super.getConfig();return Object.assign(e,n),e}}sM.className="Embedding";re(sM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class Bl extends Ke{constructor(e){super(e||{}),this.supportsMasking=!0}mergeFunction(e){throw new Be}computeElementwiseOpOutputShape(e,n){if(e==null||n==null)return null;if(e.length<n.length)return this.computeElementwiseOpOutputShape(n,e);if(n.length===0)return e;const s=e.slice(0,e.length-n.length);for(let r=0;r<n.length;++r){const o=e[e.length-n.length+r],i=n[r];if(o==null||i==null||o<0||i<0)s.push(null);else if(o===1)s.push(i);else if(i===1)s.push(o);else{if(o!==i)throw new z("Operands could not be broadcast together with shapes "+JSON.stringify(e)+" "+JSON.stringify(n));s.push(o)}}return s}build(e){if(Array.isArray(e)&&!Array.isArray(e[0])&&(e=[rt(e)]),e=e,e.length<2)throw new z(`A merge layer should be called on an Array of at least 2 inputs. Got ${e.length} input(s).`);let n=[];for(const o of e)o!=null&&o[0]!==null&&n.push(o[0]);if(n=Qi(n),n.length>1)throw new z(`Can not merge tensors with different batch sizes. Got tensors with shapes: ${JSON.stringify(e)}.`);let s=e[0]==null?null:e[0].slice(1);for(let o=1;o<e.length;++o){const i=e[o]==null?null:e[o].slice(1);s=this.computeElementwiseOpOutputShape(s,i)}const r=e.map(o=>o.length);e.indexOf(null)===-1&&Qi(r).length===1?this.reshapeRequired=!1:this.reshapeRequired=!0}call(e,n){return j(()=>{if(e=e,this.reshapeRequired){const s=[],r=e.map(o=>o.rank);if(r.indexOf(null)===-1){const o=ra(r);for(let i of e){const a=i.rank;for(let l=0;l<o-a;++l)i=Wf(i,1);s.push(i)}return this.mergeFunction(s)}else{let o=!1;for(const l of e){const c=l.rank;if(c==null){const u=l.shape,d=u[0],h=u.slice(1).concat([d]);let f=U(l,[d].concat(Zi(u.slice(1))));f=tt(f,[1,0]),f=U(f,h),s.push(f),o=!0}else if(c>1){const u=ro(1,c).concat([0]);s.push(tt(l,u)),o=!0}else s.push(l)}let i=this.mergeFunction(s);const a=i.rank;if(o){if(a==null){const l=i.shape,c=l.length,u=l[c-1],d=[u].concat(l.slice(0,l.length-1));i=U(tt(U(i,[-1,u]),[1,0]),d)}else if(a>1){const l=[a-1].concat(ro(0,a-1));i=tt(i,l)}}return i}}else return this.mergeFunction(e)})}computeOutputShape(e){e=e;let n;e[0]==null?n=null:n=e[0].slice(1);for(let r=1;r<e.length;++r){const o=e[r]==null?null:e[r].slice(1);n=this.computeElementwiseOpOutputShape(n,o)}let s=[];for(const r of e)r!=null&&r[0]!==null&&s.push(r[0]);return s=Qi(s),s.length===1?n=s.concat(n):n=[null].concat(n),n}computeMask(e,n){return j(()=>{if(n==null)return null;if(!Array.isArray(n))throw new z("`mask` should be an Array");if(!Array.isArray(e))throw new z("`inputs` should be an Array");if(n.length!==e.length)throw new z(`The Array 'inputs' and 'mask' are expected to have the same length, but have different lengths (${e.length} vs ${n.length})`);if(n.every(r=>r==null))return null;n=n.map(r=>r==null?r:ys(r,0));let s=n[0];for(let r=1;r<n.length-1;++r)s=li(s,n[r]);return s})}}class rM extends Bl{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ie(n,e[s]);return n})}}rM.className="Add";re(rM);class oM extends Bl{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=V(n,e[s]);return n})}}oM.className="Multiply";re(oM);class iM extends Bl{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0].clone();for(let s=1;s<e.length;++s)n=ie(n,e[s]);return V(1/e.length,n)})}}iM.className="Average";re(iM);class aM extends Bl{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=ya(n,e[s]);return n})}}aM.className="Maximum";re(aM);class lM extends Bl{constructor(e){super(e)}mergeFunction(e){return j(()=>{let n=e[0];for(let s=1;s<e.length;++s)n=uh(n,e[s]);return n})}}lM.className="Minimum";re(lM);class cM extends Bl{constructor(e){super(e),this.DEFAULT_AXIS=-1,e==null&&(e={}),this.axis=e.axis==null?this.DEFAULT_AXIS:e.axis,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){if(!(Array.isArray(e)&&Array.isArray(e[0]))||e.length===1)throw new z("A `Concatenate` layer should be called on a list of at least 2 inputs");e=e;let n=!0;for(const r of e)if(r!=null){n=!1;break}if(n)return;const s=[];for(let r=0;r<e.length;++r){const o=e[r].slice();o.splice(this.axis,1);let i=!1;for(const a of s)if(lt(a,o)){i=!0;break}i||s.push(o)}if(s.length>1)throw new z("A `Concatenate` layer requires inputs with matching shapes except for the concat axis. Got input shapes: "+JSON.stringify(e))}mergeFunction(e){return j(()=>MS(e,this.axis))}computeOutputShape(e){if(!(Array.isArray(e)&&Array.isArray(e[0])))throw new z("A `Concatenate` layer should be called on a list of inputs.");const n=e,s=n[0].slice(),r=this.axis<0?s.length+this.axis:this.axis;for(const o of n.slice(1)){if(s[r]==null||o[r]==null){s[r]=null;break}s[r]+=o[r]}return s}computeMask(e,n){if(n==null)return null;if(!Array.isArray(n))throw new z("`mask` should be an array for Concatenate");if(!Array.isArray(e))throw new z("`inputs` should be an array for Concatenate");if(n.length!==e.length)throw new z(`Mismatch in the length of mask (${n.length}) and the legnth of inputs (${e.length})`);return j(()=>{let s=!0;if(n.forEach(i=>{if(i!=null){s=!1;return}}),s)return null;const r=[];for(let i=0;i<e.length;++i)n[i]==null?r.push(ve(Fr(e[i]),"bool")):n[i].rank<e[i].rank?r.push(ys(n[i],-1)):r.push(n[i]);const o=ws(r,this.axis);return uF(o,-1,!1)})}getConfig(){const e={axis:this.axis},n=super.getConfig();return Object.assign(e,n),e}}cM.className="Concatenate";re(cM);function Ku(t,e){for(;t<0;)t+=e;return t}function w9(t,e,n){if(t.shape.length>3||e.shape.length>3)throw new Be("batchDot is not implemented for tensors of 4D or higher rank yet");if(T(t.shape.length>=2,()=>`batchDot requires the rank of x to be >= 2, but got ${t.shape.length}`),T(t.shape.length>=2,()=>`batchDot requires the rank of y to be >= 2, but got ${e.shape.length}`),typeof n=="number"&&(n=[n,n]),t.dtype==="complex64"||e.dtype==="complex64")throw new Be("batchDot is not implemented for complex64-type Tensors yet.");const s=t.shape.length,r=e.shape.length;n==null&&(n=[s-1,r-2]);const o=n;return j(()=>{let i;if(s>r){i=s-r;const l=[];for(let c=0;c<i;++c)l.push(1);e=U(e,e.shape.concat(l))}else if(r>s){i=r-s;const l=[];for(let c=0;c<i;++c)l.push(1);t=U(t,t.shape.concat(l))}else i=0;let a;if(t.shape.length===2&&e.shape.length===2)o[0]===o[1]?a=Ee(V(t,e),o[0]):a=Ee(V(tt(t,[1,0]),e),o[1]);else{const l=o[0]!==t.shape.length-1,c=o[1]===e.shape.length-1;a=it(t,e,l,c)}if(i>0){let l;s>r?l=s+r-3:l=s-1;const c=[];for(let u=l;u<l+i;++u)c.push(u);a=Pf(a,c)}return a.shape.length===1&&(a=ys(a,1)),a})}class uM extends Bl{constructor(e){super(e),this.axes=e.axes,this.normalize=e.normalize==null?!1:e.normalize,this.supportsMasking=!0,this.reshapeRequired=!1}build(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0],s=e[1];if(n.length>3||s.length>3)throw new Be("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);if(n[r[0]]!==s[r[1]])throw new z(`Dimension incompatibility: ${n[r[0]]} !== ${s[r[1]]}`)}mergeFunction(e){if(e.length!==2)throw new z(`A \`Dot\` layer must be called on exactly 2 inputs, but received ${e.length} input(s).`);let n=e[0],s=e[1],r;return Array.isArray(this.axes)?r=this.axes.map((o,i)=>Ku(o,e[i].shape.length)):r=[Ku(this.axes,n.shape.length),Ku(this.axes,s.shape.length)],this.normalize&&(n=Rg(n,r[0]),s=Rg(s,r[1])),w9(n,s,r)}interpretAxes(e,n){let s;return Array.isArray(this.axes)?s=this.axes:s=[Ku(this.axes,e.length),Ku(this.axes,n.length)],s}computeOutputShape(e){T(Array.isArray(e)&&e.length===2&&Array.isArray(e[0])&&Array.isArray(e[1]),()=>"A `Dot` layer should be called on a list of exactly 2 inputs.");const n=e[0].slice(),s=e[1].slice();if(n.length>3||s.length>3)throw new Be("Dot layer does not support tensors of 4D or higher rank yet.");const r=this.interpretAxes(n,s);n.splice(r[0],1),s.splice(r[1],1),s.splice(0,1);const o=n.concat(s);return o.length===1&&o.push(1),o}computeMask(e,n){return null}getConfig(){const e={axes:this.axes,normalize:this.normalize},n=super.getConfig();return Object.assign(e,n),e}}uM.className="Dot";re(uM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class dM extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.stddev=e.stddev}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={stddev:this.stddev};return Object.assign(n,e),n}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e);return Hf(()=>ie(jx(s.shape,0,this.stddev),s),()=>s,n.training||!1)})}}dM.className="GaussianNoise";re(dM);class hM extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return j(()=>{this.invokeCallHook(e,n);const s=De(e);return this.rate>0&&this.rate<1?Hf(()=>{const o=Math.sqrt(this.rate/(1-this.rate));return V(s,jx(s.shape,1,o))},()=>s,n.training||!1):s})}}hM.className="GaussianDropout";re(hM);class fM extends Ke{constructor(e){super(e),this.supportsMasking=!0,this.rate=e.rate,this.noiseShape=e.noiseShape}_getNoiseShape(e){return this.noiseShape||De(e).shape}computeOutputShape(e){return e}getConfig(){const e=super.getConfig(),n={rate:this.rate};return Object.assign(n,e),n}call(e,n){return j(()=>{if(this.rate<1&&this.rate>0){const s=this._getNoiseShape(e);return Hf(()=>{const o=De(e),i=1.6732632423543772,a=1.0507009873554805,l=-i*a;let c=Ol(Of(s),this.rate);c=Ro(c,"float32");const u=((1-this.rate)*(1+this.rate*l**2))**-.5,d=-u*l*this.rate,h=ie(V(o,c),V(ie(c,-1),l));return ie(V(h,u),d)},()=>De(e),n.training||!1)}return e})}}fM.className="AlphaDropout";re(fM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ph(t,e,n,s,r,o=.001){let i;if(t.rank===2)i=J5(t,e,n,s,r,o);else if(t.rank===3)i=tH(t,e,n,s,r,o);else if(t.rank===4)i=sH(t,e,n,s,r,o);else throw new Be(`batchNormalization is not implemented for array of rank ${t.rank} yet`);return i}function k9(t,e,n,s,r=.001){return j(()=>{const o=zC(t,s),i=o.mean,a=o.variance;return[ph(t,i,a,n,e,r),i,a]})}function C9(t,e,n,s,r=.001){return j(()=>{const o=zC(t,s),i=o.mean,a=o.variance,l=[];for(const p of ro(0,t.rank))s.indexOf(p)!==-1?l.push(1):l.push(t.shape[p]);const c=U(i,l),u=U(a,l),d=e==null?null:U(e,l),h=n==null?null:U(n,l);return[ph(t,c,u,h,d,r),i,a]})}function S9(t,e,n,s,r=.001){return lt(s.slice().sort(),ro(0,t.rank-1))?k9(t,e,n,s,r):C9(t,e,n,s,r)}class pM extends Ke{constructor(e){e==null&&(e={}),super(e),this.supportsMasking=!0,this.axis=e.axis==null?-1:e.axis,this.momentum=e.momentum==null?.99:e.momentum,this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Ot(e.betaInitializer||"zeros"),this.gammaInitializer=Ot(e.gammaInitializer||"ones"),this.movingMeanInitializer=Ot(e.movingMeanInitializer||"zeros"),this.movingVarianceInitializer=Ot(e.movingVarianceInitializer||"ones"),this.betaConstraint=Cn(e.betaConstraint),this.gammaConstraint=Cn(e.gammaConstraint),this.betaRegularizer=Pt(e.betaRegularizer),this.gammaRegularizer=Pt(e.gammaRegularizer)}build(e){e=rt(e);const n=this.axis>=0?this.axis:this.axis+e.length,s=e[n];if(s==null)throw new z(`Axis ${n} of input tensor should have a defined dimension but the layer received an input with shape ${JSON.stringify(e)}.`);this.inputSpec=[new wn({ndim:e.length,axes:{[n]:s}})];const r=[s];this.scale&&(this.gamma=this.addWeight("gamma",r,null,this.gammaInitializer,this.gammaRegularizer,!0,this.gammaConstraint)),this.center&&(this.beta=this.addWeight("beta",r,null,this.betaInitializer,this.betaRegularizer,!0,this.betaConstraint)),this.movingMean=this.addWeight("moving_mean",r,null,this.movingMeanInitializer,null,!1),this.movingVariance=this.addWeight("moving_variance",r,null,this.movingVarianceInitializer,null,!1),this.built=!0}call(e,n){return j(()=>{const s=n.training==null?!1:n.training,r=De(e),o=r.shape,i=o.length,a=ro(0,i),l=this.axis>=0?this.axis:this.axis+i;a.splice(l,1);const c=wl(1,i);c[l]=o[l];const u=a.slice();u.sort();const d=!lt(u,ro(0,i).slice(0,i-1)),h=()=>{if(d){const y=U(this.movingMean.read(),c),b=U(this.movingVariance.read(),c),v=this.center?U(this.beta.read(),c):null,w=this.scale?U(this.gamma.read(),c):null;return ph(r,y,b,v,w,this.epsilon)}else return ph(r,this.movingMean.read(),this.movingVariance.read(),this.beta==null?null:this.beta.read(),this.gamma==null?null:this.gamma.read(),this.epsilon)};if(!s)return h();const[f,p,m]=S9(r,this.gamma.read(),this.beta.read(),a,this.epsilon),x=(y,b,v)=>{j(()=>{const w=1-v,k=y.read(),C=V(_e(k,b),w);y.write(_e(k,C))})};return(()=>{x(this.movingMean,p,this.momentum),x(this.movingVariance,m,this.momentum)})(),f})}getConfig(){const e={axis:this.axis,momentum:this.momentum,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Vt(this.betaInitializer),gammaInitializer:Vt(this.gammaInitializer),movingMeanInitializer:Vt(this.movingMeanInitializer),movingVarianceInitializer:Vt(this.movingVarianceInitializer),betaRegularizer:vt(this.betaRegularizer),gammaRegularizer:vt(this.gammaRegularizer),betaConstraint:kn(this.betaConstraint),gammaConstraint:kn(this.gammaConstraint)},n=super.getConfig();return Object.assign(e,n),e}}pM.className="BatchNormalization";re(pM);class mM extends Ke{constructor(e){if(e==null&&(e={}),super(e),this.axis=e.axis==null?-1:e.axis,typeof this.axis=="number"){if(!Number.isInteger(this.axis))throw new Error(`Expected axis to be an integer, but received ${this.axis}`)}else if(Array.isArray(this.axis)){for(const n of this.axis)if(!Number.isInteger(n))throw new Error(`Expected axis to be an array of integers, but received ${JSON.stringify(this.axis)}`)}else throw new Error(`Expected axis to be an integer or an array of integers, but received ${JSON.stringify(this.axis)}`);this.epsilon=e.epsilon==null?.001:e.epsilon,this.center=e.center==null?!0:e.center,this.scale=e.scale==null?!0:e.scale,this.betaInitializer=Ot(e.betaInitializer||"zeros"),this.gammaInitializer=Ot(e.gammaInitializer||"ones"),this.betaRegularizer=Pt(e.betaRegularizer),this.gammaRegularizer=Pt(e.gammaRegularizer),this.supportsMasking=!0}build(e){e=rt(e);const n=e.length;typeof this.axis=="number"&&(this.axis=[this.axis]);for(let o=0;o<this.axis.length;++o)this.axis[o]<0&&(this.axis[o]+=n);for(const o of this.axis)if(o<0||o>=n)throw new Error(`Invalid axis: ${o}`);if(this.axis.length!==Qi(this.axis).length)throw new Error(`Found duplicate axes in: ${this.axis}`);const s=this.axis.map(o=>e[o]),r=!0;this.scale?this.gamma=this.addWeight("gamma",s,"float32",this.gammaInitializer,this.gammaRegularizer,r):this.gamma=null,this.center?this.beta=this.addWeight("beta",s,"float32",this.betaInitializer,this.betaRegularizer,r):this.beta=null,this.built=!0}call(e,n){const s=De(e),r=s.shape,o=r.length;return j(()=>{let{mean:a,variance:l}=zC(s,this.axis,!0);const c=wl(1,o);for(const m of this.axis)c[m]=r[m];const u=m=>m!=null&&m.shape.length!==o?U(m,c):m;let d=this.scale?u(this.gamma.read()):null,h=this.center?u(this.beta.read()):null;const f=[],p=[];for(let m=0;m<o;++m)this.axis.indexOf(m)!==-1?(f.push(r[m]),p.push(1)):(f.push(1),p.push(r[m]));return a=Qr(a,f),l=Qr(l,f),d!=null&&(d=Qr(d,p)),h!=null&&(h=Qr(h,p)),ph(s,a,l,h,d,this.epsilon)})}getConfig(){const e={axis:this.axis,epsilon:this.epsilon,center:this.center,scale:this.scale,betaInitializer:Vt(this.betaInitializer),gammaInitializer:Vt(this.gammaInitializer),betaRegularizer:vt(this.betaRegularizer),gammaRegularizer:vt(this.gammaRegularizer)},n=super.getConfig();return Object.assign(e,n),e}}mM.className="LayerNormalization";re(mM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function $9(t,e,n){return j(()=>{if(t.rank!==4)throw new z(`temporalPadding expects input tensor to be 4-D, but received a ${t.rank}-D tensor.`);if(e==null&&(e=[[1,1],[1,1]]),e.length!==2||e[0].length!==2||e[1].length!==2)throw new z("spatial2dPadding expects `padding` to be an Array of two Arrays, each of which is an Array of two integers.");if(n==null&&(n=oo()),n!=="channelsLast"&&n!=="channelsFirst")throw new z(`Unknown data format: ${n}. Supported data formats are 'channelsLast' and 'channelsFirst.`);let s;return n==="channelsFirst"?s=[[0,0],[0,0],e[0],e[1]]:s=[[0,0],e[0],e[1],[0,0]],BC(t,s)})}class gM extends Ke{constructor(e){if(e==null&&(e={}),super(e),this.dataFormat=e.dataFormat==null?oo():e.dataFormat,e.padding==null)this.padding=[[1,1],[1,1]];else if(typeof e.padding=="number")this.padding=[[e.padding,e.padding],[e.padding,e.padding]];else{if(e.padding=e.padding,e.padding.length!==2)throw new z(`ZeroPadding2D expects padding to be a length-2 array, but received a length-${e.padding.length} array.`);let n,s;if(typeof e.padding[0]=="number")n=[e.padding[0],e.padding[0]],s=[e.padding[1],e.padding[1]];else{if(e.padding=e.padding,e.padding[0].length!==2)throw new z(`ZeroPadding2D expects height padding to be a length-2 array, but received a length-${e.padding[0].length} array.`);if(n=e.padding[0],e.padding[1].length!==2)throw new z(`ZeroPadding2D expects width padding to be a length-2 array, but received a length-${e.padding[1].length} array.`);s=e.padding[1]}this.padding=[n,s]}this.inputSpec=[new wn({ndim:4})]}computeOutputShape(e){e=rt(e);let n,s;return this.dataFormat==="channelsFirst"?(e[2]!=null&&e[2]>=0?n=e[2]+this.padding[0][0]+this.padding[0][1]:n=null,e[3]!=null&&e[3]>=0?s=e[3]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],e[1],n,s]):(e[1]!=null&&e[1]>=0?n=e[1]+this.padding[0][0]+this.padding[0][1]:n=null,e[2]!=null&&e[2]>=0?s=e[2]+this.padding[1][0]+this.padding[1][1]:s=null,[e[0],n,s,e[3]])}call(e,n){return j(()=>$9(De(e),this.padding,this.dataFormat))}getConfig(){const e={padding:this.padding,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}gM.className="ZeroPadding2D";re(gM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function ey(t,e,n,s,r,o){return j(()=>{rn(r),DO(o),lr(s),n==null&&(n=[1,1]),s==null&&(s="valid"),r==null&&(r=oo()),o==null&&(o="max"),t=YS(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=LC(t,e,n,a):i=EC(t,e,n,a),r==="channelsFirst"&&(i=tt(i,[0,3,1,2])),i})}function xM(t,e,n,s,r,o){return j(()=>{rn(r),DO(o),lr(s),n==null&&(n=[1,1,1]),s==null&&(s="valid"),r==null&&(r=oo()),o==null&&(o="max"),t=OP(t,r);let i;const a=s==="same"?"same":"valid";return o==="max"?i=VG(t,e,n,a):i=U5(t,e,n,a),r==="channelsFirst"&&(i=tt(i,[0,4,1,2,3])),i})}class yM extends Ke{constructor(e){if(e.poolSize==null&&(e.poolSize=2),super(e),typeof e.poolSize=="number")this.poolSize=[e.poolSize];else if(Array.isArray(e.poolSize)&&e.poolSize.length===1&&typeof e.poolSize[0]=="number")this.poolSize=e.poolSize;else throw new z(`poolSize for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.poolSize)}`);if(_n(this.poolSize,"poolSize"),e.strides==null)this.strides=this.poolSize;else if(typeof e.strides=="number")this.strides=[e.strides];else if(Array.isArray(e.strides)&&e.strides.length===1&&typeof e.strides[0]=="number")this.strides=e.strides;else throw new z(`strides for 1D convolutional layer must be a number or an Array of a single number, but received ${JSON.stringify(e.strides)}`);_n(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,lr(this.padding),this.inputSpec=[new wn({ndim:3})]}computeOutputShape(e){e=rt(e);const n=no(e[1],this.poolSize[0],this.padding,this.strides[0]);return[e[0],n,e[2]]}call(e,n){return j(()=>{this.invokeCallHook(e,n),e=Wf(De(e),2);const s=this.poolingFunction(De(e),[this.poolSize[0],1],[this.strides[0],1],this.padding,"channelsLast");return Pf(s,[2])})}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides},n=super.getConfig();return Object.assign(e,n),e}}class bM extends yM{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return rn(o),lr(r),ey(e,n,s,r,o,"max")}}bM.className="MaxPooling1D";re(bM);class vM extends yM{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return rn(o),lr(r),ey(e,n,s,r,o,"avg")}}vM.className="AveragePooling1D";re(vM);class wM extends Ke{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==2)throw new z(`If the strides property of a 2D pooling layer is an Array, it is expected to have a length of 2, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides];_n(this.poolSize,"poolSize"),_n(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,rn(this.dataFormat),lr(this.padding),this.inputSpec=[new wn({ndim:4})]}computeOutputShape(e){e=rt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2];return n=no(n,this.poolSize[0],this.padding,this.strides[0]),s=no(s,this.poolSize[1],this.padding,this.strides[1]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s]:[e[0],n,s,e[3]]}call(e,n){return j(()=>(this.invokeCallHook(e,n),this.poolingFunction(De(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class kM extends wM{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return rn(o),lr(r),ey(e,n,s,r,o,"max")}}kM.className="MaxPooling2D";re(kM);class CM extends wM{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return rn(o),lr(r),ey(e,n,s,r,o,"avg")}}CM.className="AveragePooling2D";re(CM);class SM extends Ke{constructor(e){if(e.poolSize==null&&(e.poolSize=[2,2,2]),super(e),this.poolSize=Array.isArray(e.poolSize)?e.poolSize:[e.poolSize,e.poolSize,e.poolSize],e.strides==null)this.strides=this.poolSize;else if(Array.isArray(e.strides)){if(e.strides.length!==3)throw new z(`If the strides property of a 3D pooling layer is an Array, it is expected to have a length of 3, but received length ${e.strides.length}.`);this.strides=e.strides}else this.strides=[e.strides,e.strides,e.strides];_n(this.poolSize,"poolSize"),_n(this.strides,"strides"),this.padding=e.padding==null?"valid":e.padding,this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,rn(this.dataFormat),lr(this.padding),this.inputSpec=[new wn({ndim:5})]}computeOutputShape(e){e=rt(e);let n=this.dataFormat==="channelsFirst"?e[2]:e[1],s=this.dataFormat==="channelsFirst"?e[3]:e[2],r=this.dataFormat==="channelsFirst"?e[4]:e[3];return n=no(n,this.poolSize[0],this.padding,this.strides[0]),s=no(s,this.poolSize[1],this.padding,this.strides[1]),r=no(r,this.poolSize[2],this.padding,this.strides[2]),this.dataFormat==="channelsFirst"?[e[0],e[1],n,s,r]:[e[0],n,s,r,e[4]]}call(e,n){return j(()=>(this.invokeCallHook(e,n),this.poolingFunction(De(e),this.poolSize,this.strides,this.padding,this.dataFormat)))}getConfig(){const e={poolSize:this.poolSize,padding:this.padding,strides:this.strides,dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class $M extends SM{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return rn(o),lr(r),xM(e,n,s,r,o,"max")}}$M.className="MaxPooling3D";re($M);class IM extends SM{constructor(e){super(e)}poolingFunction(e,n,s,r,o){return rn(o),lr(r),xM(e,n,s,r,o,"avg")}}IM.className="AveragePooling3D";re(IM);class TM extends Ke{constructor(e){super(e),this.inputSpec=[new wn({ndim:3})]}computeOutputShape(e){return[e[0],e[2]]}call(e,n){throw new Be}}class EM extends TM{constructor(e){super(e||{})}call(e,n){return j(()=>{const s=De(e);return dn(s,1)})}}EM.className="GlobalAveragePooling1D";re(EM);class NM extends TM{constructor(e){super(e||{})}call(e,n){return j(()=>{const s=De(e);return to(s,1)})}}NM.className="GlobalMaxPooling1D";re(NM);class _M extends Ke{constructor(e){super(e),this.dataFormat=e.dataFormat==null?"channelsLast":e.dataFormat,rn(this.dataFormat),this.inputSpec=[new wn({ndim:4})]}computeOutputShape(e){return e=e,this.dataFormat==="channelsLast"?[e[0],e[3]]:[e[0],e[1]]}call(e,n){throw new Be}getConfig(){const e={dataFormat:this.dataFormat},n=super.getConfig();return Object.assign(e,n),e}}class RM extends _M{call(e,n){return j(()=>{const s=De(e);return this.dataFormat==="channelsLast"?dn(s,[1,2]):dn(s,[2,3])})}}RM.className="GlobalAveragePooling2D";re(RM);class AM extends _M{call(e,n){return j(()=>{const s=De(e);return this.dataFormat==="channelsLast"?to(s,[1,2]):to(s,[2,3])})}}AM.className="GlobalMaxPooling2D";re(AM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class DM extends Ke{constructor(e){super(e),this.layer=e.layer}build(e){this.built=!0}get trainable(){return this.layer!=null?this.layer.trainable:!1}set trainable(e){this.layer!=null&&(this.layer.trainable=e)}get trainableWeights(){return this.layer.trainableWeights}get nonTrainableWeights(){return this.layer.nonTrainableWeights}get updates(){return this.layer._updates}get losses(){return this.layer.losses}getWeights(){return this.layer.getWeights()}setWeights(e){this.layer.setWeights(e)}getConfig(){const e={layer:{className:this.layer.getClassName(),config:this.layer.getConfig()}},n=super.getConfig();return Object.assign(e,n),e}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.layer!=null&&this.layer.setFastWeightInitDuringBuild(e)}static fromConfig(e,n,s={}){const r=n.layer,o=si(r,s);delete n.layer;const i={layer:o};return Object.assign(i,n),new e(i)}}class FM extends DM{constructor(e){super(e),this.supportsMasking=!0}build(e){if(e=rt(e),e.length<3)throw new z(`TimeDistributed layer expects an input shape >= 3D, but received input shape ${JSON.stringify(e)}`);this.inputSpec=[{shape:e}];const n=[e[0]].concat(e.slice(2));this.layer.built||(this.layer.build(n),this.layer.built=!0),super.build(e)}computeOutputShape(e){e=rt(e);const n=[e[0]].concat(e.slice(2)),s=this.layer.computeOutputShape(n),r=e[1];return[s[0],r].concat(s.slice(1))}call(e,n){return j(()=>(e=De(e),HP((i,a)=>[De(this.layer.call(i,n)),[]],e,[],!1,null,null,!1,!0)[1]))}}FM.className="TimeDistributed";re(FM);function I9(t){zl(GX,"BidirectionalMergeMode",t)}const T9="concat";class OM extends DM{constructor(e){super(e);const n=e.layer.getConfig(),s={};s.className=e.layer.getClassName(),s.config=n,this.forwardLayer=si(s),n.goBackwards=n.goBackwards!==!0;const r={};if(r.className=e.layer.getClassName(),r.config=n,this.backwardLayer=si(r),this.forwardLayer.name="forward_"+this.forwardLayer.name,this.backwardLayer.name="backward_"+this.backwardLayer.name,this.mergeMode=e.mergeMode===void 0?T9:e.mergeMode,I9(this.mergeMode),e.weights)throw new Be("weights support is not implemented for Bidirectional layer yet.");this._stateful=e.layer.stateful,this.returnSequences=e.layer.returnSequences,this.returnState=e.layer.returnState,this.supportsMasking=!0,this._trainable=!0,this.inputSpec=e.layer.inputSpec,this.numConstants=null}get trainable(){return this._trainable}set trainable(e){this._trainable=e,this.forwardLayer!=null&&(this.forwardLayer.trainable=e),this.backwardLayer!=null&&(this.backwardLayer.trainable=e)}getWeights(){return this.forwardLayer.getWeights().concat(this.backwardLayer.getWeights())}setWeights(e){const n=e.length,s=Math.floor(n/2);this.forwardLayer.setWeights(e.slice(0,s)),this.backwardLayer.setWeights(e.slice(s))}computeOutputShape(e){let n=this.forwardLayer.computeOutputShape(e);Array.isArray(n)&&Array.isArray(n[0])||(n=[n]),n=n;let s,r,o;return this.returnState&&(o=n.slice(1)),s=n[0],s=s,this.mergeMode==="concat"?(s[s.length-1]*=2,r=[s]):this.mergeMode==null?r=[s,s.slice()]:r=[s],this.returnState?this.mergeMode==null?r.concat(o).concat(o.slice()):[s].concat(o).concat(o.slice()):bs(r)}apply(e,n){let s=n==null?null:n.initialState,r=n==null?null:n.constants;n==null&&(n={});const o=UP(e,s,r,this.numConstants);if(e=o.inputs,s=o.initialState,r=o.constants,Array.isArray(e)&&(s=e.slice(1),e=e[0]),(s==null||s.length===0)&&r==null)return super.apply(e,n);const i=[],a=[];if(s!=null){const c=s.length;if(c%2>0)throw new z("When passing `initialState` to a Bidrectional RNN, the state should be an Array containing the states of the underlying RNNs.");n.initialState=s,i.push(...s);const u=s.map(d=>new wn({shape:d.shape}));this.forwardLayer.stateSpec=u.slice(0,c/2),this.backwardLayer.stateSpec=u.slice(c/2),a.push(...u)}if(r!=null)throw new Be("Support for constants in Bidirectional layers is not implemented yet.");const l=i[0]instanceof Lo;for(const c of i)if(c instanceof Lo!==l)throw new z("The initial state of a Bidirectional layer cannot be specified as a mix of symbolic and non-symbolic tensors");if(l){const c=[e].concat(i),u=this.inputSpec.concat(a),d=this.inputSpec;this.inputSpec=u;const h=super.apply(c,n);return this.inputSpec=d,h}else return super.apply(e,n)}call(e,n){return j(()=>{const s=n.initialState;let r,o;if(s==null)r=this.forwardLayer.call(e,n),o=this.backwardLayer.call(e,n);else{const l=s.slice(0,s.length/2),c=s.slice(s.length/2);r=this.forwardLayer.call(e,Object.assign(n,{initialState:l})),o=this.backwardLayer.call(e,Object.assign(n,{initialState:c}))}let i;this.returnState&&(Array.isArray(r)&&(i=r.slice(1).concat(o.slice(1))),r=r[0],o=o[0]),this.returnSequences&&(o=bl(o,1));let a;return this.mergeMode==="concat"?a=MS([r,o]):this.mergeMode==="sum"?a=ie(r,o):this.mergeMode==="ave"?a=V(.5,ie(r,o)):this.mergeMode==="mul"?a=V(r,o):this.mergeMode==null&&(a=[r,o]),this.returnState?this.mergeMode==null?a.concat(i):[a].concat(i):a})}resetStates(e){this.forwardLayer.resetStates(),this.backwardLayer.resetStates()}build(e){tl(this.forwardLayer.name,()=>{this.forwardLayer.build(e)}),tl(this.backwardLayer.name,()=>{this.backwardLayer.build(e)}),this.built=!0}computeMask(e,n){Array.isArray(n)&&(n=n[0]);let s;if(this.returnSequences?this.mergeMode==null?s=[n,n]:s=n:this.mergeMode==null?s=[null,null]:s=null,this.returnState){const o=this.forwardLayer.states.map(i=>null);return Array.isArray(s)?s.concat(o).concat(o):[s].concat(o).concat(o)}else return s}get trainableWeights(){return this.forwardLayer.trainableWeights.concat(this.backwardLayer.trainableWeights)}get nonTrainableWeights(){return this.forwardLayer.nonTrainableWeights.concat(this.backwardLayer.nonTrainableWeights)}setFastWeightInitDuringBuild(e){super.setFastWeightInitDuringBuild(e),this.forwardLayer!=null&&this.forwardLayer.setFastWeightInitDuringBuild(e),this.backwardLayer!=null&&this.backwardLayer.setFastWeightInitDuringBuild(e)}getConfig(){const e={mergeMode:this.mergeMode},n=super.getConfig();return Object.assign(e,n),e}static fromConfig(e,n){const s=si(n.layer);if(delete n.layer,n.numConstants!=null)throw new Be("Deserialization of a Bidirectional layer with numConstants present is not supported yet.");const r=n;return r.layer=s,new e(r)}}OM.className="Bidirectional";re(OM);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class PM extends Ke{constructor(e){super(e),this.scale=e.scale,e.offset?this.offset=e.offset:this.offset=0}getConfig(){const e={scale:this.scale,offset:this.offset},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return j(()=>(e=De(e),e.dtype!=="float32"&&(e=Ro(e,"float32")),ie(V(e,this.scale),this.offset)))}}PM.className="Rescaling";re(PM);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const{resizeBilinear:E9,cropAndResize:N9}=ei;class MM extends Ke{constructor(e){super(e),this.height=e.height,this.width=e.width}centerCrop(e,n,s,r,o,i,a,l){return j(()=>{let c,u=!1;const d=n/i,h=s/a,f=(r+n)/i,p=(o+s)/a,m=[d,h,f,p],x=[];e.rank===3?(u=!0,c=ci([e])):c=e;for(let w=0;w<c.shape[0];w++)x.push(m);const g=eF(x,[x.length,4]),y=dh(0,x.length,1,"int32"),v=N9(c,g,y,[r,o],"nearest");return Ro(u?De(vl(v)):v,l)})}upsize(e,n,s,r){return j(()=>{const o=E9(e,[n,s]);return Ro(o,r)})}call(e,n){return j(()=>{const s=De(e),r=s.dtype,o=s.shape,i=o[o.length-3],a=o[o.length-2];let l=0;i!==this.height&&(l=Math.floor((i-this.height)/2));let c=0;return a!==this.width&&(c=Math.floor((a-this.width)/2),c===0&&(c=1)),l>=0&&c>=0?this.centerCrop(s,l,c,this.height,this.width,i,a,r):this.upsize(e,this.height,this.width,r)})}getConfig(){const e={height:this.height,width:this.width},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=rt(e);const n=e.length-3,s=e.length-2;return e[n]=this.height,e[s]=this.width,e}}MM.className="CenterCrop";re(MM);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function _9(t,e,n,s){let r=De(t);if(r.dtype!=="int32"&&(r=Ro(r,"int32")),e==="int")return r;const o=r.shape;if(r.rank===0&&(r=ys(r,-1)),e==="oneHot"&&r.shape[r.shape.length-1]!==1&&(r=ys(r,-1)),r.rank>2)throw new z(`When outputMode is not int, maximum output rank is 2 Received outputMode ${e} and input shape ${o} which would result in output rank ${r.rank}.`);const i=["multiHot","oneHot"].includes(e),a=r;let l;if(typeof s<"u"&&e==="count"?l=Q2(a,s,n,i):l=Q2(a,[],n,i),e!=="tfIdf")return l;if(s)return V(l,s);throw new z("When outputMode is 'tfIdf', weights must be provided.")}/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class LM extends Ke{constructor(e){super(e),this.numTokens=e.numTokens,e.outputMode?this.outputMode=e.outputMode:this.outputMode="multiHot"}getConfig(){const e={numTokens:this.numTokens,outputMode:this.outputMode},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){return e=rt(e),e==null?[this.numTokens]:this.outputMode==="oneHot"&&e[e.length-1]!==1?(e.push(this.numTokens),e):(e[e.length-1]=this.numTokens,e)}call(e,n){return j(()=>{e=De(e),e.dtype!=="int32"&&(e=Ro(e,"int32"));let s;if(typeof n.countWeights<"u"){if(this.outputMode!=="count")throw new z(`countWeights is not used when outputMode !== count.
              Received countWeights=${n.countWeights}`);s=De(n.countWeights)}const r=to(e),o=kg(e),i=ar(this.numTokens,r).bufferSync().get(0),a=Ol(o,0).bufferSync().get(0);if(!(i&&a))throw new z(`Input values must be between 0 < values <= numTokens with numTokens=${this.numTokens}`);return _9(e,this.outputMode,this.numTokens,s)})}}LM.className="CategoryEncoding";re(LM);/**
 * @license
 * Copyright 2022 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const R9=["bilinear","nearest"],_T=new Set(R9);class zM extends Ke{constructor(e){if(super(e),this.height=e.height,this.width=e.width,e.interpolation)if(_T.has(e.interpolation))this.interpolation=e.interpolation;else throw new z(`Invalid interpolation parameter: ${e.interpolation} is not implemented`);else this.interpolation="bilinear";this.cropToAspectRatio=!!e.cropToAspectRatio}computeOutputShape(e){e=rt(e);const n=e[2];return[this.height,this.width,n]}getConfig(){const e={height:this.height,width:this.width,interpolation:this.interpolation,cropToAspectRatio:this.cropToAspectRatio},n=super.getConfig();return Object.assign(e,n),e}call(e,n){return j(()=>{const s=[this.height,this.width];if(this.interpolation==="bilinear")return ei.resizeBilinear(e,s,!this.cropToAspectRatio);if(this.interpolation==="nearest")return ei.resizeNearestNeighbor(e,s,!this.cropToAspectRatio);throw new Error(`Interpolation is ${this.interpolation} but only ${[..._T]} are supported`)})}}zM.className="Resizing";re(zM);/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class BM{constructor(e){this.seed=e}next(){if(this.seed!==void 0)return this.seed++}}BM.className="RandomSeed";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */class VM extends Ke{constructor(e){super(e),this.randomGenerator=new BM(e.seed)}getConfig(){const e={seed:this.randomGenerator.seed},n=super.getConfig();return Object.assign(e,n),e}}VM.className="BaseRandomLayer";/**
 * @license
 * Copyright 2023 CodeSmith LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */const A9=["bilinear","nearest"],RT=new Set(A9);class WM extends VM{constructor(e){super(e);const{factor:n,interpolation:s="bilinear"}=e;if(this.factor=n,Array.isArray(this.factor)&&this.factor.length===2)this.widthLower=this.factor[0],this.widthUpper=this.factor[1];else if(!Array.isArray(this.factor)&&this.factor>0)this.widthLower=-this.factor,this.widthUpper=this.factor;else throw new z(`Invalid factor: ${this.factor}. Must be positive number or tuple of 2 numbers`);if(this.widthLower<-1||this.widthUpper<-1)throw new z(`factor must have values larger than -1. Got: ${this.factor}`);if(this.widthUpper<this.widthLower)throw new z(`factor cannot have upper bound less than lower bound.
        Got upper bound: ${this.widthUpper}.
        Got lower bound: ${this.widthLower}
      `);if(s)if(RT.has(s))this.interpolation=s;else throw new z(`Invalid interpolation parameter: ${s} is not implemented`)}getConfig(){const e={factor:this.factor,interpolation:this.interpolation},n=super.getConfig();return Object.assign(e,n),e}computeOutputShape(e){e=rt(e);const n=e[2];return[this.imgHeight,-1,n]}call(e,n){return j(()=>{const s=De(e);this.imgHeight=s.shape[s.shape.length-3];const r=s.shape[s.shape.length-2];this.widthFactor=Of([1],1+this.widthLower,1+this.widthUpper,"float32",this.randomGenerator.next());let o=this.widthFactor.dataSync()[0]*r;o=Math.round(o);const i=[this.imgHeight,o];switch(this.interpolation){case"bilinear":return ei.resizeBilinear(e,i);case"nearest":return ei.resizeNearestNeighbor(e,i);default:throw new Error(`Interpolation is ${this.interpolation}
          but only ${[...RT]} are supported`)}})}}WM.className="RandomWidth";re(WM);/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Use of this source code is governed by an MIT-style
 * license that can be found in the LICENSE file or at
 * https://opensource.org/licenses/MIT.
 * =============================================================================
 */function AT(t){return new n$(t)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const D9=K();D9.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,t=>{t&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var DT;(function(t){t[t.DT_INVALID=0]="DT_INVALID",t[t.DT_FLOAT=1]="DT_FLOAT",t[t.DT_DOUBLE=2]="DT_DOUBLE",t[t.DT_INT32=3]="DT_INT32",t[t.DT_UINT8=4]="DT_UINT8",t[t.DT_INT16=5]="DT_INT16",t[t.DT_INT8=6]="DT_INT8",t[t.DT_STRING=7]="DT_STRING",t[t.DT_COMPLEX64=8]="DT_COMPLEX64",t[t.DT_INT64=9]="DT_INT64",t[t.DT_BOOL=10]="DT_BOOL",t[t.DT_QINT8=11]="DT_QINT8",t[t.DT_QUINT8=12]="DT_QUINT8",t[t.DT_QINT32=13]="DT_QINT32",t[t.DT_BFLOAT16=14]="DT_BFLOAT16",t[t.DT_QINT16=15]="DT_QINT16",t[t.DT_QUINT16=16]="DT_QUINT16",t[t.DT_UINT16=17]="DT_UINT16",t[t.DT_COMPLEX128=18]="DT_COMPLEX128",t[t.DT_HALF=19]="DT_HALF",t[t.DT_RESOURCE=20]="DT_RESOURCE",t[t.DT_VARIANT=21]="DT_VARIANT",t[t.DT_UINT32=22]="DT_UINT32",t[t.DT_UINT64=23]="DT_UINT64",t[t.DT_FLOAT_REF=101]="DT_FLOAT_REF",t[t.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",t[t.DT_INT32_REF=103]="DT_INT32_REF",t[t.DT_UINT8_REF=104]="DT_UINT8_REF",t[t.DT_INT16_REF=105]="DT_INT16_REF",t[t.DT_INT8_REF=106]="DT_INT8_REF",t[t.DT_STRING_REF=107]="DT_STRING_REF",t[t.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",t[t.DT_INT64_REF=109]="DT_INT64_REF",t[t.DT_BOOL_REF=110]="DT_BOOL_REF",t[t.DT_QINT8_REF=111]="DT_QINT8_REF",t[t.DT_QUINT8_REF=112]="DT_QUINT8_REF",t[t.DT_QINT32_REF=113]="DT_QINT32_REF",t[t.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",t[t.DT_QINT16_REF=115]="DT_QINT16_REF",t[t.DT_QUINT16_REF=116]="DT_QUINT16_REF",t[t.DT_UINT16_REF=117]="DT_UINT16_REF",t[t.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",t[t.DT_HALF_REF=119]="DT_HALF_REF",t[t.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",t[t.DT_VARIANT_REF=121]="DT_VARIANT_REF",t[t.DT_UINT32_REF=122]="DT_UINT32_REF",t[t.DT_UINT64_REF=123]="DT_UINT64_REF"})(DT||(DT={}));var FT;(function(t){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(t.CheckpointFormatVersion||(t.CheckpointFormatVersion={}))})(FT||(FT={}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var OT;(function(t){t[t.FAIL=0]="FAIL",t[t.SHORTEST=1]="SHORTEST",t[t.LONGEST=2]="LONGEST"})(OT||(OT={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ce(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the CPU backend.`)})}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F9=zF;class ty extends Rk{nextDataId(){return ty.nextDataId++}constructor(){super(),this.blockSize=48,this.firstUse=!0,this.data=new rD(this,mo())}write(e,n,s){this.firstUse&&(this.firstUse=!1,K().get("IS_NODE")&&Ks(`
============================
Hi, looks like you are running TensorFlow.js in Node.js. To speed things up dramatically, install our node backend, visit https://github.com/tensorflow/tfjs-node for more details. 
============================`));const r={id:this.nextDataId()};return this.data.set(r,{values:e,dtype:s,refCount:1}),r}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Ph(s[0])){const o=s.map(i=>Yi(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return{dataId:r,shape:e,dtype:n}}refCount(e){return this.data.has(e)?this.data.get(e).refCount:0}incRef(e){const n=this.data.get(e);n.refCount++}decRef(e){if(this.data.has(e)){const n=this.data.get(e);n.refCount--}}move(e,n,s,r,o){this.data.set(e,{values:n,dtype:r,refCount:o})}numDataIds(){return this.data.numDataIds()}async read(e){return this.readSync(e)}readSync(e){const{dtype:n,complexTensorInfos:s}=this.data.get(e);if(n==="complex64"){const r=this.readSync(s.real.dataId),o=this.readSync(s.imag.dataId);return ui(r,o)}return rU(this.data.get(e).values,n)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>sa(r));return Ge(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ge(e.shape,e.dtype,n)}makeOutput(e,n,s){return mo().makeTensorFromTensorInfo(this.makeTensorInfo(n,s,e),this)}disposeData(e,n=!1){if(this.data.has(e)){if(this.data.get(e).refCount--,!n&&this.data.get(e).refCount>0)return!1;const{complexTensorInfos:s}=this.data.get(e);s!=null&&(this.disposeData(s.real.dataId,!0),this.disposeData(s.imag.dataId,!0)),this.data.delete(e)}return!0}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}async time(e){const n=xs();return e(),{kernelMs:xs()-n}}memory(){return{unreliable:!0,reasons:["The reported memory is an upper bound. Due to automatic garbage collection, the true allocated memory may be less."]}}where(e){Ce([e],"where");const n=this.readSync(e.dataId);return F9(e.shape,n)}dispose(){}floatPrecision(){return 32}epsilon(){return super.epsilon()}}ty.nextDataId=0;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UM(t){const e=new Float32Array(t.length);for(let n=0;n<t.length;++n)e[n]=Math.abs(t[n]);return e}const O9=t=>{const{x:e}=t.inputs,n=t.backend;Ce(e,"abs");let s=new Float32Array(Z(e.shape));const r=n.data.get(e.dataId).values;return s=UM(r),n.makeOutput(s,e.shape,e.dtype)},P9={kernelName:A0,backendName:"cpu",kernelFunc:O9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function on(t){return(e,n,s,r,o)=>{const i=Le(e,n),a=i.length,l=Te(i),c=Z(i),u=Xn(o,c),d=e.length,h=n.length,f=Te(e),p=Te(n),m=qc(e,i),x=qc(n,i);if(m.length+x.length===0)for(let g=0;g<u.length;++g)u[g]=t(s[g%s.length],r[g%r.length]);else for(let g=0;g<u.length;++g){const y=mu(g,a,l),b=y.slice(-d);m.forEach(C=>b[C]=0);const v=Eo(b,d,f),w=y.slice(-h);x.forEach(C=>w[C]=0);const k=Eo(w,h,p);u[g]=t(s[v],r[k])}return[u,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rs(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=n.makeTensorInfo(s.shape,"complex64"),l=n.data.get(a.dataId);return l.complexTensorInfos={real:n.makeTensorInfo(s.shape,"float32",o),imag:n.makeTensorInfo(r.shape,"float32",i)},a}const M9={kernelName:Hk,backendName:"cpu",kernelFunc:Rs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pg(t,e,n="float32"){if(n==="complex64"){const r=Pg(t,e,"float32"),o=Pg(t,e,"float32");return Rs({inputs:{real:r,imag:o},backend:t})}const s=qn(Z(e),n);return t.makeTensorInfo(e,n,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zo(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const L9={kernelName:sf,backendName:"cpu",kernelFunc:zo};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kl(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.real,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const z9={kernelName:pC,backendName:"cpu",kernelFunc:kl};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HM(t,e,n,s){if(s==="int32"){const r=Int32Array.from(t);return[e,"int32",r]}if(s==="bool"){const r=Fl([0],n),[o,i]=on((a,l)=>a!==l?1:0)(e,[],t,r,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${n} to ${s}`)}function la(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return zo({inputs:{x:r},backend:n});const u=Pg(n,r.shape,r.dtype),d=la({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),h=Rs({inputs:{real:d,imag:u},backend:n});return n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),h}if(r.dtype==="complex64"){const u=kl({inputs:{input:r},backend:n}),d=la({inputs:{x:u},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(u),d}if(!aD(r.dtype,o)){const u=zo({inputs:{x:r},backend:n});return{dataId:u.dataId,shape:u.shape,dtype:o}}const i=n.data.get(r.dataId).values,[a,l,c]=HM(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,c)}const B9={kernelName:Hh,backendName:"cpu",kernelFunc:la};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function In(t,e,n,s){return n==null?({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;Ce([i,a],t);const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=i.dtype==="string"?di(c):c,h=i.dtype==="string"?di(u):u,f=s||i.dtype,[p,m]=e(i.shape,a.shape,d,h,f);return l.makeTensorInfo(m,f,p)}:({inputs:r,backend:o})=>{const{a:i,b:a}=r,l=o;if(i.dtype==="complex64"||a.dtype==="complex64"){const c=la({inputs:{x:i},backend:l,attrs:{dtype:"complex64"}}),u=l.data.get(c.dataId),d=u.complexTensorInfos.real,h=u.complexTensorInfos.imag,f=l.data.get(d.dataId).values,p=l.data.get(h.dataId).values,m=la({inputs:{x:a},backend:l,attrs:{dtype:"complex64"}}),x=l.data.get(m.dataId),g=x.complexTensorInfos.real,y=x.complexTensorInfos.imag,b=l.data.get(g.dataId).values,v=l.data.get(y.dataId).values,[w,k,C]=n(i.shape,a.shape,f,p,b,v),S=l.makeTensorInfo(C,"float32",w),I=l.makeTensorInfo(C,"float32",k),$=Rs({inputs:{real:S,imag:I},backend:l});return l.disposeIntermediateTensorInfo(c),l.disposeIntermediateTensorInfo(m),l.disposeIntermediateTensorInfo(S),l.disposeIntermediateTensorInfo(I),$}else{const c=l.data.get(i.dataId).values,u=l.data.get(a.dataId).values,d=s||i.dtype,[h,f]=e(i.shape,a.shape,c,u,d);return l.makeTensorInfo(f,d,h)}}}function s$(t){return(e,n,s,r,o,i)=>{const a=Le(e,n),l=Z(a),c=a.length,u=Te(a),d=Xn("float32",l),h=Xn("float32",l),f=qc(e,a),p=qc(n,a),m=ui(s,r),x=ui(o,i),g=e.length,y=Te(e),b=n.length,v=Te(n);if(f.length+p.length===0)for(let w=0;w<d.length;w++){const k=w%m.length,C=w%x.length,S=t(m[k*2],m[k*2+1],x[C*2],x[C*2+1]);d[w]=S.real,h[w]=S.imag}else for(let w=0;w<d.length;w++){const k=mu(w,c,u),C=k.slice(-g);f.forEach(_=>C[_]=0);const S=Eo(C,g,y),I=k.slice(-b);p.forEach(_=>I[_]=0);const $=Eo(I,b,v),E=t(m[S*2],m[S*2+1],x[$*2],x[$*2+1]);d[w]=E.real,h[w]=E.imag}return[d,h,a]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GM=on((t,e)=>t+e),V9=s$((t,e,n,s)=>({real:t+n,imag:e+s})),Jc=In(gu,GM,V9),W9={kernelName:gu,backendName:"cpu",kernelFunc:Jc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r$(t,e,n,s,r){const o=Z(s),i=qn(r,n);for(let a=0;a<t.length;a++){const l=t[a];if(l<0)throw new Error("Input x must be non-negative!");l>=r||(o>0?i[l]+=e[a]:i[l]+=1)}return i}function jM(t,e,n,s=!1){const r=t.shape[0],o=t.shape[1],i=Ge([r,n],e.dtype);for(let a=0;a<r;a++)for(let l=0;l<o;l++){const c=t.get(a,l);if(c<0)throw new Error("Input x must be non-negative!");c>=n||(s?i.set(1,a,c):e.size>0?i.set(i.get(a,c)+e.get(a,l),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KM=on((t,e)=>t&e),U9=In(Uk,KM),H9={kernelName:Uk,backendName:"cpu",kernelFunc:U9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bo(t){return(e,n,s)=>{const r=Jt(n,e.length);for(let o=0;o<e.length;++o)r[o]=t(e[o],s);return r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pt(t,e,n){const s=Bo(e);return ka(t,s,n)}function ka(t,e,n){return({inputs:s,attrs:r,backend:o})=>{const{x:i}=s;Ce(i,t);const a=o,l=a.data.get(i.dataId).values;let c;if(i.dtype==="string"){if(!Array.isArray(l))throw new Error("String tensor's value was not an instance of Array");c=di(l)}else c=l;const u=n||i.dtype,d=e(c,u,r);return a.makeTensorInfo(i.shape,u,d)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XM=Bo(t=>Math.ceil(t)),G9=ka(Gh,XM),j9={kernelName:Gh,backendName:"cpu",kernelFunc:G9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qM(t,e,n,s){const r=Jt(n,Z(e));if(s&&n!=="string"){let o=0;t.forEach(i=>{const a=Z(i.shape);r.set(i.vals,o),o+=a})}else{let o=0;t.forEach(i=>{const a=n==="string"?di(i.vals):i.vals;let l=0;for(let c=0;c<i.shape[0];++c){const u=c*e[1]+o;for(let d=0;d<i.shape[1];++d)r[u+d]=a[l++]}o+=i.shape[1]})}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YM=on((t,e)=>t===e?1:0),QM=In(K0,YM,null,"bool"),K9={kernelName:K0,backendName:"cpu",kernelFunc:QM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZM=Bo(t=>Math.exp(t)),JM=ka(Zh,ZM,"float32"),X9={kernelName:Zh,backendName:"cpu",kernelFunc:JM};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eL=Bo(t=>Math.expm1(t)),q9=ka(Jh,eL),Y9={kernelName:Jh,backendName:"cpu",kernelFunc:q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tL=Bo(t=>Math.floor(t)),Q9=ka(ef,tL),Z9={kernelName:ef,backendName:"cpu",kernelFunc:Q9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nL=on((t,e)=>Math.floor(t/e)),J9=In(tf,nL,null,"int32"),e7={kernelName:tf,backendName:"cpu",kernelFunc:J9};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sL(t,e,n,s,r,o,i,a,l){const c=Ge([s,o],n);for(let u=0;u<s;u++){const d=[];let h=0;for(let f=0;f<r;f++){const p=t[u*r+f];h+=p*i[f],d.push(p)}if(h<0||h>=l/o)throw new Error(`Invalid indices: ${d} does not index into ${a}`);for(let f=0;f<o;f++)c.values[u*o+f]=e.get(...e.indexToLoc(h*o+f))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rL(t,e,n){const s=Ge(n,t.dtype);for(let r=0;r<s.size;++r){const i=s.indexToLoc(r).slice(),a=i[0],l=i[2],c=e.locToIndex([a,l]);i[2]=e.values[c];const u=t.locToIndex(i);0<=u&&u<t.values.length&&(s.values[r]=t.values[u])}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oL=on((t,e)=>t>e?1:0),t7=In(Q0,oL,null,"bool"),n7={kernelName:Q0,backendName:"cpu",kernelFunc:t7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iL=on((t,e)=>t>=e?1:0),s7=In(nf,iL,null,"bool"),r7={kernelName:nf,backendName:"cpu",kernelFunc:s7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aL=on((t,e)=>t<e?1:0),o7=In(J0,aL,null,"bool"),i7={kernelName:J0,backendName:"cpu",kernelFunc:o7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lL=on((t,e)=>t<=e?1:0),a7=In(ex,lL,null,"bool"),l7={kernelName:ex,backendName:"cpu",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cL(t,e,n){const s=(e-t)/(n-1),r=qn(n,"float32");r[0]=t;for(let o=1;o<r.length;o++)r[o]=r[o-1]+s;return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uL=Bo(t=>Math.log(t)),c7=ka(lf,uL),u7={kernelName:lf,backendName:"cpu",kernelFunc:c7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dL(t,e,n,s){const r=Xn(s,Z(n));for(let o=0;o<r.length;++o){const i=o*e;let a=t[i];for(let l=0;l<e;++l){const c=t[i+l];(Number.isNaN(c)||c>a)&&(a=c)}r[o]=a}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hL=on((t,e)=>Math.max(t,e)),d7=In(uf,hL),h7={kernelName:uf,backendName:"cpu",kernelFunc:d7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fL=on((t,e)=>Math.min(t,e)),f7=In(df,fL),p7={kernelName:df,backendName:"cpu",kernelFunc:f7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$=on((t,e)=>t*e),m7=s$((t,e,n,s)=>({real:t*n-e*s,imag:t*s+e*n})),ny=In(ff,o$,m7),g7={kernelName:ff,backendName:"cpu",kernelFunc:ny};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pL(t,e,n){const s=ma(-1,n);return o$([],e,s,t,n)}function x7(t){const{inputs:e,backend:n}=t,{x:s}=e;Ce(s,"neg");const r=n.data.get(s.dataId).values,[o,i]=pL(r,s.shape,s.dtype);return n.makeTensorInfo(i,s.dtype,o)}const y7={kernelName:dx,backendName:"cpu",kernelFunc:x7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mL=on((t,e)=>t!==e?1:0),b7=In(hx,mL,null,"bool"),v7={kernelName:hx,backendName:"cpu",kernelFunc:b7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i$(t,e,n,s,r){const o=e.length,i=Z(e),a=Te(e),l=Te(r),c=Xn(n,Z(r));for(let u=0;u<i;++u){const d=mu(u,o,a),h=new Array(d.length);for(let p=0;p<h.length;p++)h[p]=d[s[p]];const f=Eo(h,o,l);c[f]=t[u]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cs(t){const{inputs:e,attrs:n,backend:s}=t,{x:r}=e,{perm:o}=n;Ce(r,"transpose");const i=r.shape.length,a=new Array(i);for(let d=0;d<a.length;d++)a[d]=r.shape[o[d]];const l=s.data.get(r.dataId).values,c=i$(l,r.shape,r.dtype,o,a);return{dataId:s.write(c,a,r.dtype),shape:a,dtype:r.dtype}}const w7={kernelName:Nc,backendName:"cpu",kernelFunc:Cs};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gL(t,e,n,s){const[r,o]=An(t,s),i=Bs(e,"int32"),a=qn(Z(r),i),l=Z(o);for(let c=0;c<a.length;++c){const u=c*l;let d=1;for(let h=0;h<l;++h)d*=n[u+h];a[c]=d}return{outVals:a,outShape:r,outDtype:i}}function k7(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Ce(r,"prod");const a=r.shape.length,l=je(o,r.shape),c=Wt(l,a);let u=l,d=r;const h=[];c!=null&&(d=Cs({inputs:{x:r},backend:n,attrs:{perm:c}}),h.push(d),u=sn(u.length,a));const f=n.data.get(d.dataId).values,{outVals:p,outShape:m,outDtype:x}=gL(d.shape,d.dtype,f,u);let g=m;return i&&(g=fn(m,l)),h.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.makeTensorInfo(g,x,p)}const C7={kernelName:yx,backendName:"cpu",kernelFunc:k7};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S7(t,e,n){t.forEach((s,r)=>{if(s<0||s>=n){const o=mu(r,e.length,Te(e)).join(",");throw new Error(`indices[${o}] = ${s} is not in [0, ${n})`)}})}function $7(t,e){for(let n=0;n<t.length;++n){const s=t[n],r=n===t.length-1?e:t[n+1].length;if(s.length===0)throw new Error("Ragged splits may not be empty");if(s[0]<0)throw new Error("Ragged splits must be non-negative");if(s[s.length-1]>r)throw new Error("Ragged splits must not point past values");for(let o=1;o<s.length;++o)if(s[o-1]>s[o])throw new Error("Ragged splits must be sorted in ascending order")}}function I7(t,e,n,s){const r=[];let o=0;const i=e.length-1+n.length,a=new Array(i).fill(null).map(()=>[0]);$7(n,s);let l=1;for(let c=0;c<e.length-1;++c){l*=e[c];const u=e[c+1];for(let d=1;d<l+1;++d)a[c].push(d*u)}for(let c=0;c<t.length;++c){let u=t[c],d=t[c]+1;for(let h=0;h<n.length;++h){const f=n[h],p=h+e.length-1;if(p>=0){const m=a[p],x=m[m.length-1]-f[u];for(let g=u;g<d;++g)a[p].push(f[g+1]+x)}u=f[u],d=f[d]}d!==u&&(r.push([u,d]),o+=d-u)}return{outSplits:a,valueSlices:r,numValues:o}}function T7(t){const e=[];for(let n=0;n<t.length;++n){const s=t[n].length,r=Jt("int32",s);e.push(r),t[n].forEach((o,i)=>r[i]=o)}return e}function PT(t,e){const n=t.slice(0,e);for(;n.length<e;)n.push(1);for(let s=e;s<t.length;s++)n[e-1]*=t[s];return n}function E7(t,e,n,s,r,o){const i=PT(e,2)[1],a=PT(o,2)[1];let l=0;for(const c of n)for(let u=c[0];u<c[1];++u){for(let d=0;d<s;++d)r[l*a+d]=t[u*i+d];++l}}function N7(t,e,n,s,r){const o=e.slice();o[0]=r;const i=Jt(n,Z(o)),a=t.length,l=a===0?0:a/e[0];return E7(t,e,s,l,i,o),[i,o]}function xL(t,e,n,s,r,o,i,a){if(t.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const l=e[0][0]-1;if(S7(o,i,l),s.length===0)throw new Error("params.rank must be nonzero");const c=s[0],{outSplits:u,valueSlices:d,numValues:h}=I7(o,i,t,c),f=T7(u),p=N7(n,s,r,d,h);return[f,p[0],p[1]]}/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MT=2147483647;function yL(t,e,n,s,r,o,i){if(e.length>1)throw new Error("starts must be a scalar or vector");if(r.length>1)throw new Error("limits must be a scalar or vector");if(i.length>1)throw new Error("deltas must be a scalar or vector");const a=e.length===0,l=r.length===0,c=i.length===0,u=[];a||u.push(e[0]),l||u.push(r[0]),c||u.push(i[0]);for(let x=1;x<u.length;++x)if(u[x]!==u[x-1])throw new Error("starts, limits, and deltas must have the same shape");const d=u.length===0?1:u[0],h=Jt("int32",d+1);h[0]=0;for(let x=0;x<d;++x){const g=a?t[0]:t[x],y=l?s[0]:s[x],b=c?o[0]:o[x];if(b===0)throw new Error("Requires delta != 0");let v;if(b>0&&y<g||b<0&&y>g)v=0;else if(v=Math.ceil(Math.abs((y-g)/b)),v>MT)throw new Error(`Requires ((limit - start) / delta) <= ${MT}`);h[x+1]=h[x]+v}const f=h[d],p=Jt(n,f);let m=0;for(let x=0;x<d;++x){const g=h[x+1]-h[x];let y=a?t[0]:t[x];const b=c?o[0]:o[x];for(let v=0;v<g;++v)p[m++]=y,y+=b}return[h,p]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var dr=qr;class Mg{constructor(e,n,s,r,o,i,a,l,c,u){this.shape=e,this.shapeShape=n,this.values=s,this.valuesShape=r,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=l,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=rO(u),this.raggedRank=oO(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===dr.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===dr.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const n=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case dr.VALUE_ROWIDS:return Mg.getMaxWidthValueRowID(n);case dr.ROW_SPLITS:return Mg.getMaxWidthRowSplit(n);default:throw new Error(`Cannot handle partition type ${dr[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const n=e.length;if(n===0||n===1)return 0;let s=0;for(let r=0;r<n-1;++r){const o=e[r+1]-e[r];o>s&&(s=o)}return s}static getMaxWidthValueRowID(e){const n=e.length;if(n===0)return 0;let s=0,r=e[0],o=0;for(let i=1;i<n;++i){const a=e[i];a!==r&&(r=a,o=Math.max(i-s,o),s=i)}return Math.max(n-s,o)}tensorShapeFromTensor(e,n,s=!0){if(n.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return zT(e,s)}calculateOutputSize(e){const n=this.valuesShape,s=this.defaultValueShape;iO(s,n);const r=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=sO(this.raggedRank,r,n);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,n,s){const r=Math.min(e,s),o=[];let i=0;for(let a=0;a<r;++a,i+=n)o.push(i);for(let a=r;a<e;++a)o.push(-1);return T(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,n,s,r){const o=e.length,i=[];for(let a=0;a<o-1;++a){const l=e[a+1]-e[a];let c=Math.min(r,l),u=n[a];u===-1&&(c=0);for(let d=0;d<c;++d)i.push(u),u+=s;for(let d=0;d<l-c;++d)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,n,s,r){const o=e.length,i=[];if(o===0)return[];let a=0,l=e[0];if(l>=n.length)throw new Error(`Got currentValueRowId=${l}, which is not less than ${n.length}`);let c=n[l];i.push(c);for(let u=1;u<o;++u){const d=e[u];if(d===l)c>=0&&(++a,a<r?c+=s:c=-1);else{if(a=0,l=d,d>=n.length)throw new Error(`Got nextValueRowId=${d} which is not less than ${n.length}`);c=n[d]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,n,s,r){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case dr.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,n,s,r);case dr.ROW_SPLITS:if(o.length-1>n.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${n.length}`);return this.calculateOutputIndexRowSplit(o,n,s,r);default:throw new Error(`Unsupported partition type: ${dr[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const n=this.rowPartitionTypes[0];switch(n){case dr.FIRST_DIM_SIZE:return e[0];case dr.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case dr.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${dr[n]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const n=this.getFirstDimensionSize(),s=this.calculateOutputSize(n),r=new Array(this.raggedRank+1);r[r.length-1]=1;for(let l=r.length-2;l>=0;--l)r[l]=r[l+1]*s[l+1];const o=zT(s,!1),i=Jt(this.valuesDType,Z(o));if(r[0]*s[0]>0){let l=this.calculateFirstParentOutputIndex(n,r[0],s[0]);for(let c=1;c<=this.raggedRank;++c)l=this.calculateOutputIndex(c-1,l,r[c],s[c]);this.setOutput(this.raggedRank,l,i,o)}return[o,i]}setOutput(e,n,s,r){if(s.length===0)return;const o=this.values,i=s;let a=r.slice();a=a.slice(e+1);const l=Z(a),c=n.length;let u=this.defaultValue;if(u.length!==l&&u.length!==1){const p=this.defaultValueShape;j(()=>{const m=U(u,p);u=Dd(m,a).dataSync()})}let d=0,h=0,f=0;for(let p=0;p<=c;++p){let m=p<c?n[p]:-1;if(m===f){++f;continue}if(h<f){const x=o.subarray(d*l),g=i.subarray(h*l),y=(f-h)*l;LT(g,x,y)}if(p>=c){const x=s.length;m=Math.floor(x/l)}if(m>f)if(this.defaultValue.length===1)i.subarray(f*l,m*l).fill(this.defaultValue[0]),f=m;else for(;m>f;){const x=i.slice(f*l);LT(x,u,l),++f}m<0?(d=p+1,h=f):(d=p,h=f,f=h+1)}}}function LT(t,e,n){for(let s=0;s<n;s++)t[s]=e[s]}function zT(t,e){const n=[];for(let s of t){if(s<0){if(!e)throw new Error(`Dimension ${s} must be >= 0`);if(s<-1)throw new Error(`Dimension ${s} must be >= -1`);s=-1}n.push(s)}return n}function bL(t,e,n,s,r,o,i,a,l,c){return new Mg(t,e,n,s,r,o,i,a,l,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vL(t,e,n,s){const r=t===e,o=t<e&&n<0,i=e<t&&n>1;if(r||o||i)return qn(0,s);const a=Math.abs(Math.ceil((e-t)/n)),l=qn(a,s);e<t&&n===1&&(n=-1),l[0]=t;for(let c=1;c<l.length;c++)l[c]=l[c-1]+n;return l}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wL=Bo(t=>1/Math.sqrt(t)),_7=ka(bf,wL),R7={kernelName:bf,backendName:"cpu",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(t,e,n,s,r,o,i,a,l,c){const u=[s/r,r],d=t.values,h=e.values;if(s===0)return Ge(n,e.dtype);const f=l instanceof Mn?l:Ge(u,e.dtype);typeof l=="string"||typeof l=="number"?f.values.fill(l):typeof l=="boolean"&&f.values.fill(+l);for(let p=0;p<o;p++){const m=[];let x=0;for(let g=0;g<i;g++){const y=d[p*i+g];m.push(y),x+=y*a[g]}if(x<0||x>=s/r)throw new Error(`Invalid indices: ${m} does not index into ${n}`);for(let g=0;g<r;g++)c?f.values[x*r+g]+=h[p*r+g]:f.values[x*r+g]=e.rank===0?h[0]:h[p*r+g]}return f}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A7=Bo(t=>1/(1+Math.exp(-t))),kL=pt(Sf,t=>1/(1+Math.exp(-t))),D7={kernelName:Sf,backendName:"cpu",kernelFunc:kL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CL(t,e,n,s,r){const o=hS(s,e,n),i=Z(n),a=Te(s);if(o){const d=fS(e,a);return r==="string"?t.slice(d,d+i):t.subarray(d,d+i)}const l=r==="string"?di(t):t,c=Ge(s,r,l),u=Ge(n,r);for(let d=0;d<u.size;++d){const h=u.indexToLoc(d),f=h.map((p,m)=>p+e[m]);u.set(c.get(...f),...h)}return r==="string"?IO(u.values):u.values}function Cl(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s;Ce(r,"slice");const[a,l]=Vx(r,o,i);uS(r,a,l);const c=n.data.get(r.dataId).values,u=CL(c,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,u)}const F7={kernelName:Sx,backendName:"cpu",kernelFunc:Cl};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SL(t,e,n,s,r,o,i){const a=e[0],l=o[0],c=new Array(l),u=new Array(a),d=e[1];if(l===0){if(a!==0)throw new Error(fO(a));const x=Jt(n,0),g=Jt(r,0);return[x,[0,d],g,c,u]}let h=!0,f=0;const p=new Array(l).fill(0);for(let x=0;x<a;++x){const g=t[x*d];if(g<0)throw new Error(pO(x,g));if(g>=l)throw new Error(mO(x,g,l));++p[g],h=h&&g>=f,f=g}let m=!0;for(let x=0;x<l;++x){const g=p[x]===0;c[x]=g,m=m&&!g,p[x]=Math.max(p[x],1),x>0&&(p[x]+=p[x-1])}if(m&&h){const x=t,g=s;for(let y=0;y<a;++y)u[y]=y;return[x,[a,d],g,c,u]}else{const x=p[l-1],g=Jt(n,x*d),y=Jt(r,x),b=new Array(l).fill(0);for(let v=0;v<a;++v){const w=t[v*d],k=b[w],C=(w===0?0:p[w-1])+k;b[w]++;for(let S=0;S<d;++S)g[C*d+S]=t[v*d+S];y[C]=s[v],u[v]=C}for(let v=0;v<l;++v)if(b[v]===0){const k=v===0?0:p[v-1];g[k*d+0]=v;for(let C=1;C<d;++C)g[k*d+C]=0;y[k]=i}return[g,[x,d],y,c,u]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $L(t,e,n,s,r){const o=Z(s),i=e[0],a=r.length,l=[];let c=1,u=-1;for(let x=0;x<a;++x){const g=r[x];if(g===-1){if(u!==-1)throw new Error(gO(u,x));u=x,l.push(1)}else{if(g<0)throw new Error(xO(x,g));c*=g,l.push(g)}}if(u!==-1){if(c<=0)throw new Error(yO());const x=Math.trunc(o/c);if(c*x!==o)throw new Error(bO(s,l));l[u]=x}if(Z(l)!==o)throw new Error(vO(s,l));const h=s.length,f=[];if(h>0){f[h-1]=1;for(let x=h-2;x>=0;--x)f[x]=f[x+1]*s[x+1]}const p=[];if(a>0){p[a-1]=1;for(let x=a-2;x>=0;--x)p[x]=p[x+1]*l[x+1]}const m=Jt(n,i*a);for(let x=0;x<i;++x){let g=0;for(let y=0;y<h;++y)g+=t[x*h+y]*f[y];for(let y=0;y<a;++y)m[x*a+y]=Math.trunc(g/p[y]),g%=p[y]}return[m,[i,a],l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$(t,e,n,s,r,o=!1,i=0){const a=s.length,l=[e[0],t.length/e[0]],c=l[1],d=a>0?r[a-1]+1:0;if(d<0)throw new Error(zv());const h=e.slice();h[0]=d;const f=h.reduce((b,v)=>b*v,1),p=Jt(n,f);if(a===0)return d>0&&p.fill(i),[p,h];if(d<=0)throw new Error(zv());let m=0,x=1,g=0,y=r[m];for(;;){let b=0;if(x<a){if(b=r[x],y===b){++x;continue}if(y>=b)throw new Error(wO())}if(y<0||y>=d)throw new Error(kO(y,d));y>g&&p.fill(i,g*c,y*c);for(let v=m;v<x;++v){const w=s[v];if(w<0||w>=l[0])throw new Error(CO(v,s[v],l[0]));for(let k=0;k<c;k++)p[y*c+k]+=t[w*c+k]}if(o)for(let v=0;v<c;v++)p[y*c+v]/=x-m;if(m=x,++x,g=y+1,y=b,x>a)break}return g<d&&p.fill(i,g*c,d*c),[p,h]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O7=Bo(t=>Math.sqrt(t)),P7=pt(If,t=>Math.sqrt(t)),M7={kernelName:If,backendName:"cpu",kernelFunc:P7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IL=on((t,e)=>{const n=t-e;return n*n}),L7=In(Tf,IL),z7={kernelName:Tf,backendName:"cpu",kernelFunc:L7};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TL=Bo((t,e)=>{const{pattern:n,replaceGlobal:s,rewrite:r}=e;return t.replace(new RegExp(n,s?"g":""),r)}),B7=ka(yC,TL),V7={kernelName:yC,backendName:"cpu",kernelFunc:B7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EL(t,e,n,s){const r=Ge(t,e.dtype);for(let o=0;o<r.size;o++){const i=r.indexToLoc(o),a=new Array(i.length);for(let l=0;l<a.length;l++)a[l]=i[l]*n[l]+s[l];r.set(e.get(...a),...i)}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W7{constructor(e,n,s,r,o,i){this.separator=Yi(e),this.nGramWidths=n,this.leftPad=Yi(s),this.rightPad=Yi(r),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,n){const s=this.getPadWidth(n);return Math.max(0,e+2*s-n+1)}createNGrams(e,n,s,r,o,i){for(let a=0;a<o;++a){const l=this.getPadWidth(i),c=Math.max(0,l-a),u=Math.max(0,l-(o-(a+1))),d=i-(c+u),h=n+(c>0?0:a-l);let f=0;f+=c*this.leftPad.length;for(let y=0;y<d;++y)f+=e[h+y].length;f+=u*this.rightPad.length;const p=c+u+d-1;f+=p*this.separator.length,s[r+a]=new Uint8Array(f);const m=s[r+a];let x=0;const g=y=>y.forEach(b=>m[x++]=b);for(let y=0;y<c;++y)g(this.leftPad),g(this.separator);for(let y=0;y<d-1;++y)g(e[h+y]),g(this.separator);if(d>0){g(e[h+d-1]);for(let y=0;y<u;++y)g(this.separator),g(this.rightPad)}else{for(let y=0;y<u-1;++y)g(this.rightPad),g(this.separator);g(this.rightPad)}}}compute(e,n){const s=e.length,r=n.length;if(r>0){let l=n[0];if(l!==0)throw new Error(`First split value must be 0, got ${l}`);for(let c=1;c<r;++c){let u=n[c]>=l;if(u=u&&n[c]<=s,!u)throw new Error(`Invalid split value ${n[c]}, must be in [${l}, ${s}]`);l=n[c]}if(l!==s)throw new Error(`Last split value must be data size. Expected ${s}, got ${l}`)}const o=r-1,i=Jt("int32",r);if(s===0||r===0){const l=new Array(s);for(let c=0;c<=o;++c)i[c]=0;return[l,i]}i[0]=0;for(let l=1;l<=o;++l){const c=n[l]-n[l-1];let u=0;this.nGramWidths.forEach(d=>{u+=this.getNumNGrams(c,d)}),this.preserveShort&&c>0&&u===0&&(u=1),i[l]=i[l-1]+u}const a=new Array(i[o]);for(let l=0;l<o;++l){const c=n[l];let u=i[l];if(this.nGramWidths.forEach(d=>{const h=n[l+1]-n[l],f=this.getNumNGrams(h,d);this.createNGrams(e,c,a,u,f,d),u+=f}),this.preserveShort&&u===i[l]){const d=n[l+1]-n[l];if(d===0)continue;const h=d+2*this.padWidth,f=1;this.createNGrams(e,c,a,u,f,h)}}return[a,i]}}function NL(t,e,n,s,r,o,i,a){return new W7(n,s,r,o,i,a).compute(t,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U7(t,e,n,s){if(!t.length)return;if(e.length===0){for(let o=0;o<t.length;++o)s.push(t.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=t.indexOf(o);for(;i!==-1;){const a=t.subarray(0,i);(!n||a.length!==0)&&s.push(a),t=t.subarray(i+1),i=t.indexOf(o)}(!n||t.length!==0)&&s.push(t);return}let r=0;for(let o=0;o<t.length+1;o++)if(o===t.length||e.indexOf(t[o])!==-1){const i=t.subarray(r,o);(!n||i.length!==0)&&s.push(i),r=o+1}}function _L(t,e,n){const s=t.length,r=[];let o=0,i=0;const a=new Array(s);for(let h=0;h<s;++h){const f=r.length;U7(t[h],e,n,r);const p=r.length-f;a[h]=p,o+=p,i=Math.max(i,p)}const l=Jt("int32",o*2),c=new Array(o),u=[s,i];let d=0;for(let h=0;h<s;++h)for(let f=0;f<a[h];++f)l[d*2]=h,l[d*2+1]=f,c[d]=r[d],++d;return[l,c,u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RL(t,e){const n=Jt("int32",t.length);for(let s=0;s<t.length;++s)n[s]=CU(t[s]).modulo(e).getLowBitsUnsigned();return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AL=on((t,e)=>t-e),H7=s$((t,e,n,s)=>({real:t-n,imag:e-s})),l$=In(Ef,AL,H7),G7={kernelName:Ef,backendName:"cpu",kernelFunc:l$};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DL(t,e){const n=new Array(t.rank);for(let r=0;r<n.length;r++)n[r]=t.shape[r]*e[r];const s=Ge(n,t.dtype);for(let r=0;r<s.values.length;++r){const o=s.indexToLoc(r),i=new Array(t.rank);for(let l=0;l<i.length;l++)i[l]=o[l]%t.shape[l];const a=t.locToIndex(i);s.values[r]=t.values[a]}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hd=(t,e)=>{const n=e.value-t.value;return n===0?t.index-e.index:n};function FL(t,e,n=0,s=t.length-1){for(;s>n;){if(s-n>600){const a=s-n+1,l=e-n+1,c=Math.log(a),u=.5*Math.exp(2*c/3),d=.5*Math.sqrt(c*u*(a-u)/a)*Math.sign(l-a/2),h=Math.max(n,Math.floor(e-l*u/a+d)),f=Math.min(s,Math.floor(e+(a-l)*u/a+d));FL(t,e,h,f)}const r=t[e];let o=n,i=s;for(rc(t,n,e),hd(t[s],r)>0&&rc(t,n,s);o<i;){for(rc(t,o,i),o++,i--;hd(t[o],r)<0;)o=o+1;for(;hd(t[i],r)>0;)i=i-1}hd(t[n],r)===0?rc(t,n,i):(i=i+1,rc(t,i,s)),i<=e&&(n=i+1),e<=i&&(s=i-1)}}function OL(t,e,n,s,r){const o=e[e.length-1],[i,a]=[t.length/o,o],l=Xn(n,i*s),c=Xn("int32",i*s);for(let d=0;d<i;d++){const h=d*a,f=t.subarray(h,h+a);let p=new Array(f.length);f.forEach((y,b)=>p[b]={value:y,index:b}),s<p.length&&(FL(p,s),p=p.slice(0,s)),r&&p.sort(hd);const m=d*s,x=l.subarray(m,m+s),g=c.subarray(m,m+s);for(let y=0;y<s;y++)x[y]=p[y].value,g[y]=p[y].index}const u=e.slice();return u[u.length-1]=s,[Ge(u,n,l),Ge(u,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PL(t,e,n,s){const r=je(e,n)[0],o=[1,n[0],1];for(let p=0;p<r;p++)o[0]*=n[p];o[1]=n[r];for(let p=r+1;p<n.length;p++)o[2]*=n[p];const i=new Map,a=new Int32Array(n[r]),l=new Mn(o,s,t),c=[],u=o[0]===1&&o[2]===1;for(let p=0;p<n[r];p++){let m;if(u)m=t[p].toString();else{const g=[];for(let y=0;y<o[0];y++)for(let b=0;b<o[2];b++)g.push(l.get(y,p,b));m=g.join(",")}const x=i.get(m);if(x!=null)a[p]=x;else{const g=i.size;i.set(m,g),a[p]=g,c.push(p)}}const d=o.slice();d[1]=i.size;const h=new Mn(d,s);c.forEach((p,m)=>{for(let x=0;x<o[0];x++)for(let g=0;g<o[2];g++)h.set(l.get(x,p,g),x,m,g)});const f=n.slice();return f[r]=d[1],{outputValues:h.values,outputShape:f,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const j7=Object.freeze(Object.defineProperty({__proto__:null,addImpl:GM,bincountImpl:r$,bincountReduceImpl:jM,bitwiseAndImpl:KM,castImpl:HM,ceilImpl:XM,concatImpl:qM,equalImpl:YM,expImpl:ZM,expm1Impl:eL,floorDivImpl:nL,floorImpl:tL,gatherNdImpl:sL,gatherV2Impl:rL,greaterEqualImpl:iL,greaterImpl:oL,lessEqualImpl:lL,lessImpl:aL,linSpaceImpl:cL,logImpl:uL,maxImpl:dL,maximumImpl:hL,minimumImpl:fL,multiplyImpl:o$,negImpl:pL,notEqualImpl:mL,prodImpl:gL,raggedGatherImpl:xL,raggedRangeImpl:yL,raggedTensorToTensorImpl:bL,rangeImpl:vL,rsqrtImpl:wL,scatterImpl:Xa,sigmoidImpl:A7,simpleAbsImpl:UM,sliceImpl:CL,sparseFillEmptyRowsImpl:SL,sparseReshapeImpl:$L,sparseSegmentReductionImpl:a$,sqrtImpl:O7,squaredDifferenceImpl:IL,staticRegexReplaceImpl:TL,stridedSliceImpl:EL,stringNGramsImpl:NL,stringSplitImpl:_L,stringToHashBucketFastImpl:RL,subImpl:AL,tileImpl:DL,topKImpl:OL,transposeImpl:i$,uniqueImpl:PL},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */tF("cpu",()=>new ty,1);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ML=pt(Yh,t=>t>=0?t:Math.exp(t)-1),K7={kernelName:Yh,backendName:"cpu",kernelFunc:ML};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s;Ce([r],"leakyRelu");const i=Z(r.shape),a=n.data.get(r.dataId).values,l=Xn("float32",i);for(let c=0;c<a.length;c++)l[c]=a[c]<0?o*a[c]:a[c];return n.makeTensorInfo(r.shape,"float32",l)}const X7={kernelName:Z0,backendName:"cpu",kernelFunc:LL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7=on((t,e)=>t<0?e*t:t);function zL(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e;Ce([s,r],"prelu");const o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,[a,l]=q7(s.shape,r.shape,o,i,"float32");return n.makeTensorInfo(l,"float32",a)}const Y7={kernelName:xx,backendName:"cpu",kernelFunc:zL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BL=pt(gf,t=>Math.max(0,t)),Q7={kernelName:gf,backendName:"cpu",kernelFunc:BL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VL=pt(xf,t=>Math.min(Math.max(0,t),6)),Z7={kernelName:xf,backendName:"cpu",kernelFunc:VL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lg(t,e,n,s,r){if(n==="linear")return zo({inputs:{x:e},backend:t});if(n==="relu")return BL({inputs:{x:e},backend:t});if(n==="elu")return ML({inputs:{x:e},backend:t});if(n==="relu6")return VL({inputs:{x:e},backend:t});if(n==="prelu")return zL({inputs:{x:e,alpha:s},backend:t});if(n==="leakyrelu")return LL({inputs:{x:e},backend:t,attrs:{alpha:r}});if(n==="sigmoid")return kL({inputs:{x:e},backend:t});throw new Error(`Activation ${n} has not been implemented for the CPU backend.`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function St(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=Z(r.shape),a=iD(o,i),l=Z(a);T(i===l,()=>`The new shape (${a}) has ${l} elements and the old shape (${r.shape}) has ${i} elements. The new shape and old shape must have the same number of elements.`),n.incRef(r.dataId);const c=n.data.get(r.dataId);if(c.complexTensorInfos!=null){const u=c.complexTensorInfos.real,d=c.complexTensorInfos.imag;u.shape=a,d.shape=a}return{dataId:r.dataId,shape:a,dtype:r.dtype}}const J7={kernelName:bx,backendName:"cpu",kernelFunc:St};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WL(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;Ce([r,o],"matMul");const l=r.shape.length,c=o.shape.length,u=i?r.shape[l-2]:r.shape[l-1],d=a?o.shape[c-1]:o.shape[c-2],h=i?r.shape[l-1]:r.shape[l-2],f=a?o.shape[c-2]:o.shape[c-1],p=r.shape.slice(0,-2),m=o.shape.slice(0,-2),x=Z(p),g=Z(m),b=Le(r.shape.slice(0,-2),o.shape.slice(0,-2)).concat([h,f]);T(u===d,()=>`Error in matMul: inner shapes (${u}) and (${d}) of Tensors with shapes ${r.shape} and ${o.shape} and transposeA=${i} and transposeB=${a} must match.`);const v=i?[x,u,h]:[x,h,u],w=a?[g,f,d]:[g,d,f],k=St({inputs:{x:r},backend:n,attrs:{shape:v}}),C=St({inputs:{x:o},backend:n,attrs:{shape:w}}),S=i?k.shape[1]:k.shape[2],I=i?k.shape[2]:k.shape[1],$=a?C.shape[1]:C.shape[2],E=Math.max(x,g),_=n.data.get(k.dataId).values,D=n.data.get(C.dataId).values,F=Te(k.shape),R=Te(C.shape),[P,M,N]=i?[F[0],1,F[1]]:[F[0],F[1],1],[B,G,X]=a?[1,R[1],R[0]]:[R[1],1,R[0]],Y=I*$,J=Ge([E,I,$],k.dtype),q=J.values,ee=n.blockSize;for(let ne=0;ne<E;ne++){const ce=ne%x,ge=ne%g;for(let de=0;de<I;de+=ee){const $e=Math.min(de+ee,I);for(let fe=0;fe<$;fe+=ee){const Ie=Math.min(fe+ee,$);for(let xe=0;xe<S;xe+=ee){const ye=Math.min(xe+ee,S);for(let pe=de;pe<$e;pe++)for(let Re=fe;Re<Ie;Re++){let Pe=0;for(let Ae=xe;Ae<ye;Ae++){const At=_[ce*P+pe*M+Ae*N],Oe=D[Ae*B+Re*G+ge*X];Pe+=At*Oe}q[ne*Y+(pe*$+Re)]+=Pe}}}}}return n.disposeIntermediateTensorInfo(k),n.disposeIntermediateTensorInfo(C),n.makeTensorInfo(b,J.dtype,J.values)}const eY={kernelName:M0,backendName:"cpu",kernelFunc:WL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tY(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;let h,f,p;const m=[];h=WL({inputs:{a:r,b:o},attrs:{transposeA:l,transposeB:c},backend:n}),i&&(f=Jc({inputs:{a:h,b:i},backend:n}),m.push(h),h=f),u&&(p=Lg(n,h,u,a,d),m.push(h),h=p);for(const g of m)n.disposeIntermediateTensorInfo(g);return h}const nY={kernelName:xg,backendName:"cpu",kernelFunc:tY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sY=pt(Mh,t=>Math.acos(t)),rY={kernelName:Mh,backendName:"cpu",kernelFunc:sY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oY=pt(Lh,t=>Math.acosh(t)),iY={kernelName:Lh,backendName:"cpu",kernelFunc:oY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aY(t){const{inputs:e,backend:n}=t,s=e;Ce(e,"addN");const r=s.map(a=>n.data.get(a.dataId).values),o=Ge(s[0].shape,s[0].dtype),i=o.values;for(let a=0;a<s.length;a++){const l=r[a];for(let c=0;c<i.length;c++)i[c]+=l[c]}return n.makeTensorInfo(o.shape,o.dtype,o.values)}const lY={kernelName:Mk,backendName:"cpu",kernelFunc:aY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Ce(r,"all");const a=je(o,r.shape);let l=a;const c=Wt(l,r.shape.length);let u=r;c!=null&&(u=Cs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=sn(l.length,r.shape.length)),zn("all",l,u.shape.length);const[d,h]=An(u.shape,l),f=Z(h),p=qn(Z(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const y=g*f;let b=m[y];for(let v=0;v<f;++v){const w=m[y+v];b=b&&w}p[g]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const x=n.makeTensorInfo(d,u.dtype,p);if(i){const g=fn(d,a),y=St({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),y}return x}const uY={kernelName:Lk,backendName:"cpu",kernelFunc:cY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Ce(r,"any");const a=je(o,r.shape);let l=a;const c=Wt(l,r.shape.length);let u=r;c!=null&&(u=Cs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=sn(l.length,r.shape.length)),zn("any",l,u.shape.length);const[d,h]=An(u.shape,l),f=Z(h),p=qn(Z(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const y=g*f;let b=m[y];for(let v=0;v<f;++v){const w=m[y+v];b=b||w}p[g]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const x=n.makeTensorInfo(d,u.dtype,p);if(i){const g=fn(d,a),y=St({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),y}return x}const hY={kernelName:zk,backendName:"cpu",kernelFunc:dY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;Ce(r,"argMax");let i=je(o,r.shape);const a=Wt(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Cs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=sn(i.length,l.shape.length)),i=[i[0]],zn("argMax",i,l.shape.length);const[u,d]=An(l.shape,i),h=Z(u),f=qn(h,"int32"),p=Z(d),m=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const g=x*p;let y=m[g],b=0;for(let v=0;v<p;++v){const w=m[g+v];w>y&&(y=w,b=v)}f[x]=b}return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(u,"int32",f)}const pY={kernelName:D0,backendName:"cpu",kernelFunc:fY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;Ce(r,"argMin");let i=je(o,r.shape);const a=Wt(i,r.shape.length);let l=r;const c=[];a!=null&&(l=Cs({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=sn(i.length,l.shape.length)),i=[i[0]],zn("argMin",i,l.shape.length);const[u,d]=An(l.shape,i),h=Z(u),f=qn(h,"int32"),p=Z(d),m=n.data.get(l.dataId).values;for(let x=0;x<f.length;++x){const g=x*p;let y=m[g],b=0;for(let v=0;v<p;++v){const w=m[g+v];w<y&&(y=w,b=v)}f[x]=b}return c.forEach(x=>n.disposeIntermediateTensorInfo(x)),n.makeTensorInfo(u,"int32",f)}const gY={kernelName:F0,backendName:"cpu",kernelFunc:mY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xY=pt(zh,t=>Math.asin(t)),yY={kernelName:zh,backendName:"cpu",kernelFunc:xY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bY=pt(Bh,t=>Math.asinh(t)),vY={kernelName:Bh,backendName:"cpu",kernelFunc:bY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wY=pt(Vh,t=>Math.atan(t)),kY={kernelName:Vh,backendName:"cpu",kernelFunc:wY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CY=on((t,e)=>Math.atan2(t,e)),SY=In(Uh,CY),$Y={kernelName:Uh,backendName:"cpu",kernelFunc:SY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IY=pt(Wh,t=>Math.atanh(t)),TY={kernelName:Wh,backendName:"cpu",kernelFunc:IY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$(t,e,n,s,r,o){const i=r.strideHeight,a=r.strideWidth,l=r.dilationHeight,c=r.dilationWidth,u=r.effectiveFilterHeight,d=r.effectiveFilterWidth,h=r.padInfo.top,f=r.padInfo.left,p=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,m=Ge(r.outShape,n),x=m.values,g=r.outShape[1]*r.outShape[2]*r.outShape[3],y=r.outShape[2]*r.outShape[3],b=r.outShape[3];for(let v=0;v<r.batchSize;++v){const w=v*g,k=v*s[0];for(let C=0;C<r.inChannels;++C)for(let S=0;S<r.outHeight;++S){const I=S*i-h,$=Math.max(0,I),E=Math.min(r.inHeight,u+I),_=w+S*y;for(let D=0;D<r.outWidth;++D){const F=D*a-f,R=Math.max(0,F),P=Math.min(r.inWidth,d+F);let M=p,N=0,B=0;for(let X=$;X<E;X+=l){const Y=k+X*s[1];for(let J=R;J<P;J+=c){const q=Y+J*s[2],ee=t[q+C];o==="max"&&ee>M?M=ee:o==="avg"&&(N+=ee,B++)}if(isNaN(M))break}const G=_+D*b+C;x[G]=o==="avg"?N/B:M}}}return m}function UL(t,e,n,s,r=!1,o=!1){const i=Ge(s.outShape,"int32"),a=s.strideHeight,l=s.strideWidth,c=s.dilationHeight,u=s.dilationWidth,d=s.effectiveFilterHeight,h=s.effectiveFilterWidth,f=s.padInfo.top,p=s.padInfo.left,m=Ge(e,n,t);for(let x=0;x<s.batchSize;++x)for(let g=0;g<s.inChannels;++g)for(let y=0;y<s.outHeight;++y){const b=y*a-f;let v=b;for(;v<0;)v+=c;const w=Math.min(s.inHeight,d+b);for(let k=0;k<s.outWidth;++k){const C=k*l-p;let S=C;for(;S<0;)S+=u;const I=Math.min(s.inWidth,h+C);let $=Number.NEGATIVE_INFINITY,E=-1;for(let _=v;_<w;_+=c){const D=_-b;for(let F=S;F<I;F+=u){const R=F-C,P=m.get(x,_,F,g);P>$&&($=P,r?E=o?((x*s.inHeight+_)*s.inWidth+F)*s.inChannels+g:(_*s.inWidth+F)*s.inChannels+g:E=D*h+R)}}i.set(E,x,y,k,g)}}return i}function HL(t,e,n,s,r,o){const i=r.strideDepth,a=r.strideHeight,l=r.strideWidth,c=r.dilationDepth,u=r.dilationHeight,d=r.dilationWidth,h=r.effectiveFilterDepth,f=r.effectiveFilterHeight,p=r.effectiveFilterWidth,m=r.padInfo.front,x=r.padInfo.top,g=r.padInfo.left,y=o==="max"?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY,b=Ge(r.outShape,n),v=b.values,w=r.outShape[1]*r.outShape[2]*r.outShape[3]*r.outShape[4],k=r.outShape[2]*r.outShape[3]*r.outShape[4],C=r.outShape[3]*r.outShape[4],S=r.outShape[4];for(let I=0;I<r.batchSize;++I){const $=I*w,E=I*s[0];for(let _=0;_<r.inChannels;++_)for(let D=0;D<r.outDepth;++D){const F=D*i-m;let R=F;for(;R<0;)R+=c;const P=Math.min(r.inDepth,h+F),M=$+D*k;for(let N=0;N<r.outHeight;++N){const B=N*a-x;let G=B;for(;G<0;)G+=u;const X=Math.min(r.inHeight,f+B),Y=M+N*C;for(let J=0;J<r.outWidth;++J){const q=J*l-g;let ee=q;for(;ee<0;)ee+=d;const ne=Math.min(r.inWidth,p+q),ce=Y+J*S;let ge=y,de=0,$e=0;for(let Ie=R;Ie<P;Ie+=c){const xe=E+Ie*s[1];for(let ye=G;ye<X;ye+=u){const pe=xe+ye*s[2];for(let Re=ee;Re<ne;Re+=d){const Pe=pe+Re*s[3],Ae=t[Pe+_];if(o==="max"&&Ae>ge?ge=Ae:o==="avg"&&(de+=Ae,$e++),isNaN(ge))break}if(isNaN(ge))break}if(isNaN(ge))break}const fe=ce+_;v[fe]=o==="avg"?de/Math.max($e,1):ge}}}}return b}function EY(t,e){const n=Ge(e.outShape,"int32"),s=e.strideDepth,r=e.strideHeight,o=e.strideWidth,i=e.dilationDepth,a=e.dilationHeight,l=e.dilationWidth,c=e.effectiveFilterDepth,u=e.effectiveFilterHeight,d=e.effectiveFilterWidth,h=e.padInfo.front,f=e.padInfo.top,p=e.padInfo.left;for(let m=0;m<e.batchSize;++m)for(let x=0;x<e.inChannels;++x)for(let g=0;g<e.outDepth;++g){const y=g*s-h;let b=y;for(;b<0;)b+=i;const v=Math.min(e.inDepth,c+y);for(let w=0;w<e.outHeight;++w){const k=w*r-f;let C=k;for(;C<0;)C+=a;const S=Math.min(e.inHeight,u+k);for(let I=0;I<e.outWidth;++I){const $=I*o-p;let E=$;for(;E<0;)E+=l;const _=Math.min(e.inWidth,d+$);let D=Number.NEGATIVE_INFINITY,F=-1;for(let R=b;R<v;R+=i){const P=R-y;for(let M=C;M<S;M+=a){const N=M-k;for(let B=E;B<_;B+=l){const G=B-$,X=t.get(m,R,M,B,x);X>=D&&(D=X,F=P*u*d+N*u+G)}}}n.set(F,m,g,w,I,x)}}}return n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function NY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ce(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Qn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Pr(r.shape,o,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&lt(u.inShape,u.outShape))d=zo({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Te(r.shape),p=c$(h,r.shape,r.dtype,f,u,"avg");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const _Y={kernelName:O0,backendName:"cpu",kernelFunc:NY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ce(r,"avgPool3d");const u=yi(r.shape,o,i,1,a,l,c),d=n.data.get(r.dataId).values,h=HL(d,r.shape,r.dtype,Te(r.shape),u,"avg");return n.makeTensorInfo(h.shape,"float32",h.values)}const AY={kernelName:P0,backendName:"cpu",kernelFunc:RY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DY(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;Ce([r,o],"avgPool3DGrad");const u=yi(o.shape,i,a,1,l,c),d=u.strideDepth,h=u.strideHeight,f=u.strideWidth,p=u.filterDepth,m=u.filterHeight,x=u.filterWidth,g=u.dilationDepth,y=u.dilationHeight,b=u.dilationWidth,v=u.effectiveFilterDepth,w=u.effectiveFilterHeight,k=u.effectiveFilterWidth,C=v-1-u.padInfo.front,S=k-1-u.padInfo.left,I=w-1-u.padInfo.top,$=Ge(o.shape,"float32"),E=1/(p*m*x),_=n.bufferSync(r);for(let D=0;D<u.batchSize;++D)for(let F=0;F<u.inChannels;++F)for(let R=0;R<u.inDepth;++R)for(let P=0;P<u.inHeight;++P)for(let M=0;M<u.inWidth;++M){const N=R-C,B=P-I,G=M-S;let X=0;for(let Y=0;Y<v;Y+=g){const J=(N+Y)/d;if(!(J<0||J>=u.outDepth||Math.floor(J)!==J))for(let q=0;q<w;q+=y){const ee=(B+q)/h;if(!(ee<0||ee>=u.outHeight||Math.floor(ee)!==ee))for(let ne=0;ne<k;ne+=b){const ce=(G+ne)/f;if(ce<0||ce>=u.outWidth||Math.floor(ce)!==ce)continue;const ge=_.get(D,J,ee,ce,F);X+=ge}}}$.set(X*E,D,R,P,M,F)}return n.makeTensorInfo($.shape,$.dtype,$.values)}const FY={kernelName:Vk,backendName:"cpu",kernelFunc:DY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OY(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;Ce([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Pr(i.shape,a,l,1,c),d=u.strideHeight,h=u.strideWidth,f=u.filterHeight,p=u.filterWidth,m=u.dilationHeight,x=u.dilationWidth,g=u.effectiveFilterHeight,y=u.effectiveFilterWidth,b=y-1-u.padInfo.left,v=g-1-u.padInfo.top,w=Ge(i.shape,"float32"),k=1/(f*p),C=n.data.get(r.dataId).values,S=Ge(r.shape,"float32",C);for(let I=0;I<u.batchSize;++I)for(let $=0;$<u.inChannels;++$)for(let E=0;E<u.inHeight;++E)for(let _=0;_<u.inWidth;++_){const D=E-v,F=_-b;let R=0;for(let P=0;P<g;P+=m){const M=(D+P)/d;if(!(M<0||M>=u.outHeight||Math.floor(M)!==M))for(let N=0;N<y;N+=x){const B=(F+N)/h;if(B<0||B>=u.outWidth||Math.floor(B)!==B)continue;const G=S.get(I,M,B,$);R+=G}}w.set(R*k,I,E,_,$)}return n.makeTensorInfo(w.shape,w.dtype,w.values)}const PY={kernelName:Bk,backendName:"cpu",kernelFunc:OY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,scale:o,offset:i,mean:a,variance:l}=e;T(a.shape.length===l.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||a.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(o==null||a.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks."),Ce([r,a,l,o,i],"batchNorm");let{varianceEpsilon:c}=s;c==null&&(c=.001);const u=n.data.get(r.dataId).values,d=n.data.get(a.dataId).values,h=n.data.get(l.dataId).values,f=o?n.data.get(o.dataId).values:new Float32Array([1]),p=i?n.data.get(i.dataId).values:new Float32Array([0]),m=new Float32Array(u.length),x=p.length,g=f.length,y=h.length,b=d.length;let v=0,w=0,k=0,C=0;for(let S=0;S<u.length;++S)m[S]=p[v++]+(u[S]-d[w++])*f[k++]/Math.sqrt(h[C++]+c),v>=x&&(v=0),w>=b&&(w=0),k>=g&&(k=0),C>=y&&(C=0);return n.makeTensorInfo(r.shape,r.dtype,m)}const LY={kernelName:q0,backendName:"cpu",kernelFunc:MY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;Ce([r],"batchToSpaceND");const a=o.reduce((g,y)=>g*y),l=Lf(r.shape,o,a),c=zf(l.length,o.length),u=Bf(r.shape,o,a),d=yS(i,o.length),h=bS(u,i,o.length),f=St({inputs:{x:r},backend:n,attrs:{shape:l}}),p=Cs({inputs:{x:f},backend:n,attrs:{perm:c}}),m=St({inputs:{x:p},backend:n,attrs:{shape:u}}),x=Cl({inputs:{x:m},backend:n,attrs:{begin:d,size:h}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),x}const BY={kernelName:L0,backendName:"cpu",kernelFunc:zY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function VY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=r$(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const WY={kernelName:Wk,backendName:"cpu",kernelFunc:VY};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function UY(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.data.get(s.dataId).values,i=n.data.get(r.dataId).values,a=Le(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const HY={kernelName:hD,backendName:"cpu",kernelFunc:UY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GY=pt(jh,(t,e)=>{const n=e;return t>n.clipValueMax?n.clipValueMax:t<n.clipValueMin?n.clipValueMin:t}),jY={kernelName:jh,backendName:"cpu",kernelFunc:GY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KY=t=>{const{x:e}=t.inputs,n=t.backend,s=new Float32Array(Z(e.shape)),r=n.data.get(e.dataId),o=r.complexTensorInfos.real,i=r.complexTensorInfos.imag,a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values;for(let c=0;c<a.length;c++){const u=a[c],d=l[c];s[c]=Math.hypot(u,d)}return n.makeOutput(s,e.shape,"float32")},XY={kernelName:z0,backendName:"cpu",kernelFunc:KY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eu(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.data.get(s.dataId).complexTensorInfos.imag,o=n.data.get(r.dataId).values;return n.makeTensorInfo(r.shape,r.dtype,o)}const qY={kernelName:iC,backendName:"cpu",kernelFunc:eu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tu(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=je(r,e[0].shape)[0],i=e.map(m=>m.shape);mS(i,o);let a=_o(e.map(m=>m.shape),o);if(Z(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(m=>Z(m.shape)>0);if(l.length===1)return zo({inputs:{x:l[0]},backend:n});if(l[0].dtype==="complex64"){const m=l.map(v=>kl({inputs:{input:v},backend:n})),x=l.map(v=>eu({inputs:{input:v},backend:n})),g=tu({inputs:m,backend:n,attrs:{axis:o}}),y=tu({inputs:x,backend:n,attrs:{axis:o}}),b=Rs({inputs:{real:g,imag:y},backend:n});return m.forEach(v=>n.disposeIntermediateTensorInfo(v)),x.forEach(v=>n.disposeIntermediateTensorInfo(v)),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),b}const c=l.map(m=>{const g=[-1,Z(m.shape.slice(o))];return St({inputs:{x:m},backend:n,attrs:{shape:g}})}),u=c.map(m=>({vals:n.data.get(m.dataId).values,shape:m.shape}));a=_o(c.map(m=>m.shape),1);const d=c[0].shape[0]===1,h=qM(u,a,e[0].dtype,d),f=_o(l.map(m=>m.shape),o),p=n.makeTensorInfo(f,e[0].dtype,h);return c.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const YY={kernelName:B0,backendName:"cpu",kernelFunc:tu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s;Ce([r,o],"conv2d");const d=bi(l),h=Ln(r.shape,o.shape,i,c,a,u,!1,d),f=h.filterHeight,p=h.filterWidth,m=h.dilationHeight,x=h.dilationWidth,g=h.padInfo.left,y=h.padInfo.top,b=h.dataFormat==="channelsLast",v=new Mn(h.outShape,r.dtype),w=Te(r.shape),k=Te(o.shape),C=w[0],S=b?w[1]:w[2],I=b?w[2]:1,$=b?1:w[1],E=v.strides[0],_=b?v.strides[1]:v.strides[2],D=b?v.strides[2]:1,F=b?1:v.strides[1],R=n.data.get(r.dataId).values,P=n.data.get(o.dataId).values,M=v.values;for(let N=0;N<h.batchSize;++N){const B=N*C,G=N*E;for(let X=0;X<h.outHeight;++X){const Y=G+X*_,J=X*h.strideHeight-y;for(let q=0;q<f;++q){const ee=J+q*m;if(ee<0||ee>=h.inHeight)continue;const ne=q*k[0],ce=B+ee*S;for(let ge=0;ge<h.outWidth;++ge){const de=Y+ge*D,$e=ge*h.strideWidth-g;for(let fe=0;fe<p;++fe){const Ie=$e+fe*x;if(Ie<0||Ie>=h.inWidth)continue;const xe=ne+fe*k[1],ye=ce+Ie*I;let pe=xe;for(let Re=0;Re<h.inChannels;++Re){const Pe=R[ye+Re*$];for(let Ae=0;Ae<h.outChannels;++Ae)M[de+Ae*F]+=Pe*P[pe+Ae];pe+=h.outChannels}}}}}}return n.makeTensorInfo(v.shape,v.dtype,M)}const QY={kernelName:V0,backendName:"cpu",kernelFunc:GL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZY(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s;Ce([r,o],"conv2dBackpropFilter");const d=bi(l),h=Ln(r.shape,u,i,1,a,c,!1,d),{strideHeight:f,strideWidth:p,filterHeight:m,filterWidth:x}=h,g=h.dataFormat==="channelsLast",y=new Mn(h.filterShape,"float32"),b=h.padInfo.left,v=h.padInfo.top,w=n.data.get(r.dataId).values,k=n.data.get(o.dataId).values,C=new Mn(r.shape,r.dtype,w),S=new Mn(o.shape,o.dtype,k);for(let I=0;I<m;++I){const $=Math.max(0,Math.ceil((v-I)/f)),E=Math.min(h.outHeight,(h.inHeight+v-I)/f);for(let _=0;_<x;++_){const D=Math.max(0,Math.ceil((b-_)/p)),F=Math.min(h.outWidth,(h.inWidth+b-_)/p);for(let R=0;R<h.inChannels;++R)for(let P=0;P<h.outChannels;++P){let M=0;for(let N=0;N<h.batchSize;++N)for(let B=$;B<E;++B){const G=I+B*f-v;for(let X=D;X<F;++X){const Y=_+X*p-b;g?M+=C.get(N,G,Y,R)*S.get(N,B,X,P):M+=C.get(N,R,G,Y)*S.get(N,P,B,X)}}y.set(M,I,_,R,P)}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const JY={kernelName:Gk,backendName:"cpu",kernelFunc:ZY};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eQ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s;Ce([r,o],"conv2dBackpropInput");const d=Te(o.shape),h=Te(r.shape);let f=bi(c);const p=Ln(i,o.shape,a,1,l,u,!1,f),m=new Mn(p.inShape,"float32"),x=m.values,g=n.data.get(r.dataId).values,y=n.data.get(o.dataId).values,[b,v,w]=d,{batchSize:k,filterHeight:C,filterWidth:S,inChannels:I,inHeight:$,inWidth:E,outChannels:_,outHeight:D,outWidth:F,strideHeight:R,strideWidth:P}=p;f=p.dataFormat;const M=C-1-p.padInfo.top,N=S-1-p.padInfo.left,B=f==="channelsLast",G=m.strides[0],X=B?m.strides[1]:m.strides[2],Y=B?m.strides[2]:1,J=B?1:m.strides[1],q=h[0],ee=B?h[1]:h[2],ne=B?h[2]:1,ce=B?1:h[1];for(let ge=0;ge<k;++ge)for(let de=0;de<I;++de)for(let $e=0;$e<$;++$e){const fe=$e-M,Ie=Math.max(0,Math.ceil(fe/R)),xe=Math.min(D,(C+fe)/R);for(let ye=0;ye<E;++ye){const pe=ye-N,Re=Math.max(0,Math.ceil(pe/P)),Pe=Math.min(F,(S+pe)/P);let Ae=0;for(let Oe=Ie;Oe<xe;++Oe){const Xe=Oe*R-fe;for(let wt=Re;wt<Pe;++wt){const It=wt*P-pe,He=q*ge+ee*Oe+ne*wt,Ht=b*(C-1-Xe)+v*(S-1-It)+w*de;for(let cn=0;cn<_;++cn){const Mt=g[He+ce*cn],se=y[Ht+cn];Ae+=Mt*se}}}const At=G*ge+X*$e+Y*ye+J*de;x[At]=Ae}}return n.makeTensorInfo(m.shape,m.dtype,m.values)}const tQ={kernelName:W0,backendName:"cpu",kernelFunc:eQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s;Ce([r,o],"conv3d");const c=ga(r.shape,o.shape,i,l,a),{filterDepth:u,filterHeight:d,filterWidth:h,dilationDepth:f,dilationHeight:p,dilationWidth:m,padInfo:x}=c,g=x.front,y=x.left,b=x.top,v=new Mn(c.outShape,r.dtype),w=n.data.get(r.dataId).values,k=n.data.get(o.dataId).values,C=v.values,S=Te(r.shape),I=Te(o.shape);for(let $=0;$<c.batchSize;++$){const E=$*S[0],_=$*v.strides[0];for(let D=0;D<c.outDepth;++D){const F=_+D*v.strides[1],R=D*c.strideDepth-g;for(let P=0;P<u;++P){const M=R+P*f;if(M<0||M>=c.inDepth)continue;const N=P*I[0],B=E+M*S[1];for(let G=0;G<c.outHeight;++G){const X=F+G*v.strides[2],Y=G*c.strideHeight-b;for(let J=0;J<d;++J){const q=Y+J*p;if(q<0||q>=c.inHeight)continue;const ee=N+J*I[1],ne=B+q*S[2];for(let ce=0;ce<c.outWidth;++ce){const ge=X+ce*c.outChannels,de=ce*c.strideWidth-y;for(let $e=0;$e<h;++$e){const fe=de+$e*m;if(fe<0||fe>=c.inWidth)continue;const Ie=ee+$e*I[2],xe=ne+fe*c.inChannels;let ye=Ie;for(let pe=0;pe<c.inChannels;++pe){const Re=w[xe+pe];for(let Pe=0;Pe<c.outChannels;++Pe)C[ge+Pe]+=Re*k[ye+Pe];ye+=c.outChannels}}}}}}}}return n.makeTensorInfo(v.shape,v.dtype,v.values)}const sQ={kernelName:U0,backendName:"cpu",kernelFunc:nQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s;Ce([r,o],"conv3dBackpropFilterV2");const c=Te(r.shape),u=Te(o.shape),d=ga(r.shape,l,i,1,a),h=d.strideDepth,f=d.strideHeight,p=d.strideWidth,m=d.filterDepth,x=d.filterHeight,g=d.filterWidth,y=new Mn(d.filterShape,"float32"),b=y.values,[v,w,k,C]=y.strides,S=n.data.get(o.dataId).values,[I,$,E,_]=u,D=n.data.get(r.dataId).values,[F,R,P,M]=c,N=d.padInfo.front,B=d.padInfo.left,G=d.padInfo.top;for(let X=0;X<m;++X){const Y=Math.max(0,Math.ceil((N-X)/h)),J=Math.min(d.outDepth,(d.inDepth+N-X)/h),q=X*v;for(let ee=0;ee<x;++ee){const ne=Math.max(0,Math.ceil((G-ee)/f)),ce=Math.min(d.outHeight,(d.inHeight+G-ee)/f),ge=ee*w+q;for(let de=0;de<g;++de){const $e=Math.max(0,Math.ceil((B-de)/p)),fe=Math.min(d.outWidth,(d.inWidth+B-de)/p),Ie=de*k+ge;for(let xe=0;xe<d.inChannels;++xe){const ye=xe*C+Ie;for(let pe=0;pe<d.outChannels;++pe){let Re=0;for(let Pe=0;Pe<d.batchSize;++Pe){const Ae=Pe*F,At=Pe*I;for(let Oe=Y;Oe<J;++Oe){const wt=(X+Oe*h-N)*R+Ae,It=Oe*$+At;for(let He=ne;He<ce;++He){const cn=(ee+He*f-G)*P+wt,Mt=He*E+It;for(let se=$e;se<fe;++se){const we=(de+se*p-B)*M+cn,Ve=se*_+Mt;Re+=D[we+xe]*S[Ve+pe]}}}}b[ye+pe]=Re}}}}}return n.makeTensorInfo(y.shape,y.dtype,y.values)}const oQ={kernelName:jk,backendName:"cpu",kernelFunc:rQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iQ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s;Ce([r],"conv3dBackpropInputV2");const c=Te(r.shape),u=Te(o.shape),d=ga(l,o.shape,a,1,i),h=new Mn(d.inShape,"float32"),f=h.values,[p,m,x,g]=h.strides,y=n.data.get(r.dataId).values,[b,v,w,k]=c,C=n.data.get(o.dataId).values,[S,I,$,E]=u,{batchSize:_,filterDepth:D,filterHeight:F,filterWidth:R,inChannels:P,inDepth:M,inHeight:N,inWidth:B,outChannels:G,outDepth:X,outHeight:Y,outWidth:J,strideDepth:q,strideHeight:ee,strideWidth:ne}=d,ce=D-1-d.padInfo.front,ge=F-1-d.padInfo.top,de=R-1-d.padInfo.left;for(let $e=0;$e<_;++$e)for(let fe=0;fe<P;++fe)for(let Ie=0;Ie<M;++Ie){const xe=Ie-ce,ye=Math.max(0,Math.ceil(xe/q)),pe=Math.min(X,(D+xe)/q);for(let Re=0;Re<N;++Re){const Pe=Re-ge,Ae=Math.max(0,Math.ceil(Pe/ee)),At=Math.min(Y,(F+Pe)/ee);for(let Oe=0;Oe<B;++Oe){const Xe=Oe-de,wt=Math.max(0,Math.ceil(Xe/ne)),It=Math.min(J,(R+Xe)/ne);let He=0;for(let Ht=ye;Ht<pe;++Ht){const cn=Ht*q-xe;for(let Mt=Ae;Mt<At;++Mt){const se=Mt*ee-Pe;for(let te=wt;te<It;++te){const we=te*ne-Xe,Ve=b*$e+v*Ht+w*Mt+k*te,qe=S*(D-1-cn)+I*(F-1-se)+$*(R-1-we)+E*fe;for(let le=0;le<G;++le){const Ye=y[Ve+le],ht=C[qe+le];He+=Ye*ht}}}}f[p*$e+m*Ie+x*Re+g*Oe+fe]=He}}}return n.makeTensorInfo(h.shape,h.dtype,h.values)}const aQ={kernelName:Kk,backendName:"cpu",kernelFunc:iQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lQ=pt(Kh,t=>Math.cos(t)),cQ={kernelName:Kh,backendName:"cpu",kernelFunc:lQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uQ=pt(Xh,t=>Math.cosh(t)),dQ={kernelName:Xh,backendName:"cpu",kernelFunc:uQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hQ(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=s,[u,d,h,f]=r.shape,p=o.shape[0],[m,x]=a,g=Ge([p,m,x,f],"float32"),y=n.data.get(o.dataId).values,b=n.data.get(i.dataId).values,v=n.data.get(r.dataId).values,w=Te(r.shape),k=Te(g.shape);for(let C=0;C<p;C++){const S=C*4,I=y[S],$=y[S+1],E=y[S+2],_=y[S+3],D=b[C];if(D>=u)continue;const F=m>1?(E-I)*(d-1)/(m-1):0,R=x>1?(_-$)*(h-1)/(x-1):0;for(let P=0;P<m;P++){const M=m>1?I*(d-1)+P*F:.5*(I+E)*(d-1);if(M<0||M>d-1){for(let N=0;N<x;N++)for(let B=0;B<f;B++){const G=B+N*k[2]+P*k[1]+C*k[0];g.values[G]=c}continue}if(l==="bilinear"){const N=Math.floor(M),B=Math.ceil(M),G=M-N;for(let X=0;X<x;X++){const Y=x>1?$*(h-1)+X*R:.5*($+_)*(h-1);if(Y<0||Y>h-1){for(let ne=0;ne<f;ne++){const ce=ne+X*k[2]+P*k[1]+C*k[0];g.values[ce]=c}continue}const J=Math.floor(Y),q=Math.ceil(Y),ee=Y-J;for(let ne=0;ne<f;ne++){let ce=ne+J*w[2]+N*w[1]+D*w[0];const ge=v[ce];ce=ne+q*w[2]+N*w[1]+D*w[0];const de=v[ce];ce=ne+J*w[2]+B*w[1]+D*w[0];const $e=v[ce];ce=ne+q*w[2]+B*w[1]+D*w[0];const fe=v[ce],Ie=ge+(de-ge)*ee,xe=$e+(fe-$e)*ee;ce=ne+X*k[2]+P*k[1]+C*k[0],g.values[ce]=Ie+(xe-Ie)*G}}}else for(let N=0;N<x;++N){const B=x>1?$*(h-1)+N*R:.5*($+_)*(h-1);if(B<0||B>h-1){for(let Y=0;Y<f;Y++){const J=Y+N*k[2]+P*k[1]+C*k[0];g.values[J]=c}continue}const G=Math.round(B),X=Math.round(M);for(let Y=0;Y<f;Y++){const J=Y+G*w[2]+X*w[1]+D*w[0],q=Y+N*k[2]+P*k[1]+C*k[0];g.values[q]=v[J]}}}}return n.makeTensorInfo(g.shape,g.dtype,g.values)}const fQ={kernelName:qk,backendName:"cpu",kernelFunc:hQ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;Ce(r,"cumprod");const l=Wt([o],r.shape.length);let c=r;l!=null&&(c=Cs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=sn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumprod in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Bs(c.dtype,"int32"),h=Fk(Z(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,y)=>g+p-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=p)for(let y=0;y<p;y++){const b=m(g,y);if(y===0)h[b]=i?1:f[b];else{const v=m(g,y-1);h[b]=i?f[v]*h[v]:f[b]*h[v]}}const x=n.makeTensorInfo(c.shape,d,h);if(l!=null){const g=xa(l),y=Cs({inputs:{x},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),y}return x}const mQ={kernelName:Xk,backendName:"cpu",kernelFunc:pQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;Ce(r,"cumsum");const l=Wt([o],r.shape.length);let c=r;l!=null&&(c=Cs({inputs:{x:r},backend:n,attrs:{perm:l}}));const u=sn(1,r.shape.length)[0];if(u!==c.shape.length-1)throw new Error(`backend.cumsum in CPU expects an inner-most axis=${c.shape.length-1} but got axis=${u}`);const d=Bs(c.dtype,"int32"),h=qn(Z(c.shape),d),f=n.data.get(c.dataId).values,p=c.shape[c.shape.length-1],m=a?(g,y)=>g+p-y-1:(g,y)=>g+y;for(let g=0;g<f.length;g+=p)for(let y=0;y<p;y++){const b=m(g,y);if(y===0)h[b]=i?0:f[b];else{const v=m(g,y-1);h[b]=i?f[v]+h[v]:f[b]+h[v]}}const x=n.makeTensorInfo(c.shape,d,h);if(l!=null){const g=xa(l),y=Cs({inputs:{x},backend:n,attrs:{perm:g}});return n.disposeIntermediateTensorInfo(x),n.disposeIntermediateTensorInfo(c),y}return x}const xQ={kernelName:H0,backendName:"cpu",kernelFunc:gQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=r$(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(o),u=jM(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const bQ={kernelName:Yk,backendName:"cpu",kernelFunc:yQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s;T(i==="NHWC",()=>`Only NHWC dataFormat supported on CPU for depthToSpace. Got ${i}`);const a=r.shape[0],l=r.shape[1],c=r.shape[2],u=r.shape[3],d=l*o,h=c*o,f=u/(o*o),p=n.data.get(r.dataId).values,m=new Float32Array(a*d*h*f);let x=0;for(let g=0;g<a;++g)for(let y=0;y<d;++y){const b=Math.floor(y/o),v=y%o;for(let w=0;w<h;++w){const k=Math.floor(w/o),C=w%o,S=(v*o+C)*f;for(let I=0;I<f;++I){const E=I+S+u*(k+c*(b+l*g));m[x++]=p[E]}}}return n.makeTensorInfo([a,d,h,f],r.dtype,m)}const wQ={kernelName:Qk,backendName:"cpu",kernelFunc:vQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;Ce([r,o],"depthwiseConv2DNative");const u=Te(r.shape),d=Te(o.shape);let h=l;h==null&&(h=[1,1]),T(Qn(i,h),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${h}'`);const f=Ln(r.shape,o.shape,i,h,a,c,!0),{filterHeight:p,filterWidth:m,dilationHeight:x,dilationWidth:g,padInfo:y}=f,b=y.left,v=y.top,w=f.outChannels/f.inChannels,k=new Mn(f.outShape,r.dtype),C=n.data.get(r.dataId).values,S=n.data.get(o.dataId).values,I=k.values;for(let $=0;$<f.batchSize;++$){const E=$*u[0],_=$*k.strides[0];for(let D=0;D<f.outHeight;++D){const F=_+D*k.strides[1],R=D*f.strideHeight-v;for(let P=0;P<p;++P){const M=R+P*x;if(M<0||M>=f.inHeight)continue;const N=P*d[0],B=E+M*u[1];for(let G=0;G<f.outWidth;++G){const X=F+G*k.strides[2],Y=G*f.strideWidth-b;for(let J=0;J<m;++J){const q=Y+J*g;if(q<0||q>=f.inWidth)continue;const ee=N+J*d[1],ne=B+q*f.inChannels;let ce=X,ge=ee;for(let de=0;de<f.inChannels;++de){const $e=C[ne+de];for(let fe=0;fe<w;++fe)I[ce+fe]+=$e*S[ge+fe];ce+=w,ge+=w}}}}}}return n.makeTensorInfo(k.shape,k.dtype,k.values)}const kQ={kernelName:G0,backendName:"cpu",kernelFunc:jL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function CQ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s;Ce([r,o],"depthwiseConv2dNativeBackpropFilter");const d=Ln(r.shape,u,i,a,l,c,!0),{strideHeight:h,strideWidth:f,filterHeight:p,filterWidth:m}=d,x=new Mn(d.filterShape,"float32"),g=d.padInfo.left,y=d.padInfo.top,b=d.outChannels/d.inChannels,v=n.data.get(r.dataId).values,w=new Mn(r.shape,r.dtype,v),k=n.data.get(o.dataId).values,C=new Mn(o.shape,o.dtype,k);for(let S=0;S<p;++S){const I=Math.max(0,Math.ceil((y-S)/h)),$=Math.min(d.outHeight,(d.inHeight+y-S)/h);for(let E=0;E<m;++E){const _=Math.max(0,Math.ceil((g-E)/f)),D=Math.min(d.outWidth,(d.inWidth+g-E)/f);for(let F=0;F<d.outChannels;++F){const R=Math.trunc(F/b),P=F%b;let M=0;for(let N=0;N<d.batchSize;++N)for(let B=I;B<$;++B){const G=S+B*h-y;for(let X=_;X<D;++X){const Y=E+X*f-g;M+=w.get(N,G,Y,R)*C.get(N,B,X,F)}}x.set(M,S,E,R,P)}}}return n.makeTensorInfo(x.shape,x.dtype,x.values)}const SQ={kernelName:Zk,backendName:"cpu",kernelFunc:CQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $Q(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s;Ce([r,o],"depthwiseConv2DNativeBackpropInput");const d=Te(r.shape),h=Te(o.shape),f=Ln(u,o.shape,i,a,l,c,!0),p=new Mn(f.inShape,"float32"),m=p.values,[x,g,y]=p.strides,b=n.data.get(r.dataId).values,[v,w,k]=d,C=n.data.get(o.dataId).values,[S,I,$]=h,{batchSize:E,filterHeight:_,filterWidth:D,inChannels:F,inHeight:R,inWidth:P,outChannels:M,outHeight:N,outWidth:B,strideHeight:G,strideWidth:X}=f,Y=_-1-f.padInfo.top,J=D-1-f.padInfo.left,q=M/F;for(let ee=0;ee<E;++ee)for(let ne=0;ne<F;++ne)for(let ce=0;ce<R;++ce){const ge=ce-Y,de=Math.max(0,Math.ceil(ge/G)),$e=Math.min(N,(_+ge)/G);for(let fe=0;fe<P;++fe){const Ie=fe-J,xe=Math.max(0,Math.ceil(Ie/X)),ye=Math.min(B,(D+Ie)/X);let pe=0;for(let Re=de;Re<$e;++Re){const Pe=Re*G-ge;for(let Ae=xe;Ae<ye;++Ae){const At=Ae*X-Ie,Oe=v*ee+w*Re+k*Ae,Xe=S*(_-1-Pe)+I*(D-1-At)+$*ne;for(let wt=0;wt<q;++wt){const It=ne*q+wt,He=b[Oe+It],Ht=C[Xe+wt];pe+=He*Ht}}}m[x*ee+g*ce+y*fe+ne]=pe}}return n.makeTensorInfo(p.shape,p.dtype,p.values)}const IQ={kernelName:Jk,backendName:"cpu",kernelFunc:$Q};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function TQ(t){const{inputs:e,backend:n}=t,{x:s}=e,r=Z(s.shape),o=n.data.get(s.dataId).values,i=Ge([r,r],s.dtype),a=i.values;for(let c=0;c<o.length;c++)a[c*r+c]=o[c];const l=[...s.shape,...s.shape];return n.makeTensorInfo(l,i.dtype,i.values)}const EQ={kernelName:fD,backendName:"cpu",kernelFunc:TQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NQ={kernelName:j0,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r}=t,{strides:o,pad:i,dilations:a}=n,l=e,c=l.data.get(s.dataId).values,u=s.shape.length,d=l.data.get(r.dataId).values,h=r.shape.length,{batchSize:f,inHeight:p,inWidth:m,inChannels:x,outHeight:g,outWidth:y,padInfo:b,strideHeight:v,strideWidth:w,filterHeight:k,filterWidth:C,dilationHeight:S,dilationWidth:I,outShape:$}=Df(s.shape,r.shape,o,i,"NHWC",a),E=Z($),_=$.length,D=Jt(s.dtype,E);for(let R=0;R<f;++R)for(let P=0;P<g;++P){const M=P*v-b.top;for(let N=0;N<y;++N){const B=N*w-b.left;for(let G=0;G<x;++G){let X=Number.MIN_SAFE_INTEGER;for(let J=0;J<k;++J){const q=M+J*S;if(q>=0&&q<p)for(let ee=0;ee<C;++ee){const ne=B+ee*I;if(ne>=0&&ne<m){const ce=Eo([R,q,ne,G],u,Te(s.shape)),ge=Eo([J,ee,G],h,Te(r.shape)),de=c[ce]+d[ge];de>X&&(X=de)}}}const Y=Eo([R,P,N,G],_,Te($));D[Y]=X}}}return{dataId:l.write(Fl(D,s.dtype),$,s.dtype),shape:$,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _Q={kernelName:kv,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=eo(s.shape,c.data.get(s.dataId).values),d=eo(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:k,dilationHeight:C,dilationWidth:S,outShape:I}=Df(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===I.length,()=>`Error in ${kv}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const $=eo(I,c.data.get(o.dataId).values),E=cD(r.shape,r.dtype);for(let D=0;D<h;++D)for(let F=0;F<x;++F){const R=F*b-y.top;for(let P=0;P<g;++P){const M=P*v-y.left;for(let N=0;N<m;++N){let B=Number.MIN_SAFE_INTEGER,G=0,X=0;for(let Y=0;Y<w;++Y){const J=R+Y*C;if(J>=0&&J<f)for(let q=0;q<k;++q){const ee=M+q*S;if(ee>=0&&ee<p){const ne=u[D][J][ee][N]+d[Y][q][N];ne>B&&(B=ne,G=Y,X=q)}}}E[G][X][N]+=$[D][F][P][N]}}}return{dataId:c.write(Fl(E,s.dtype),r.shape,r.dtype),shape:r.shape,dtype:r.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RQ={kernelName:wv,backendName:"cpu",kernelFunc:({inputs:t,backend:e,attrs:n})=>{const{x:s,filter:r,dy:o}=t,{strides:i,pad:a,dilations:l}=n,c=e,u=eo(s.shape,c.data.get(s.dataId).values),d=eo(r.shape,c.data.get(r.dataId).values),{batchSize:h,inHeight:f,inWidth:p,inChannels:m,outHeight:x,outWidth:g,padInfo:y,strideHeight:b,strideWidth:v,filterHeight:w,filterWidth:k,dilationHeight:C,dilationWidth:S,outShape:I}=Df(s.shape,r.shape,i,a,"NHWC",l);T(o.rank===I.length,()=>`Error in ${wv}, dy must have the same rank as output ${I.length}, but got ${o.rank}`);const $=eo(I,c.data.get(o.dataId).values),E=cD(s.shape,s.dtype);for(let D=0;D<h;++D)for(let F=0;F<x;++F){const R=F*b-y.top;for(let P=0;P<g;++P){const M=P*v-y.left;for(let N=0;N<m;++N){let B=Number.MIN_SAFE_INTEGER,G=R<0?0:R,X=M<0?0:M;for(let Y=0;Y<w;++Y){const J=R+Y*C;if(J>=0&&J<f)for(let q=0;q<k;++q){const ee=M+q*S;if(ee>=0&&ee<p){const ne=u[D][J][ee][N]+d[Y][q][N];ne>B&&(B=ne,G=J,X=ee)}}}E[D][G][X][N]+=$[D][F][P][N]}}}return{dataId:c.write(Fl(E,s.dtype),s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AQ(t){const{inputs:e,backend:n,attrs:s}=t,{image:r}=e,{canvas:o,options:i}=s,{contextOptions:a,imageOptions:l}=i||{},c=(l==null?void 0:l.alpha)||1,u=(a==null?void 0:a.contextType)||"2d";if(u!=="2d")throw new Error(`Context type ${a.contextType} is not supported by the CPU backend.`);const d=o.getContext(u,(a==null?void 0:a.contextAttributes)||{});if(d==null)throw new Error(`Could not get the context with ${u} type.`);const[h,f]=r.shape.slice(0,2),p=r.shape.length===2?1:r.shape[2],m=n.data.get(r.dataId).values,x=r.dtype==="float32"?255:1,g=new Uint8ClampedArray(f*h*4);for(let b=0;b<h*f;++b){const v=[0,0,0,255*c];for(let k=0;k<p;k++){const C=m[b*p+k];if(r.dtype==="float32"){if(C<0||C>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${C}.`)}else if(r.dtype==="int32"&&(C<0||C>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${C}.`);p===1?(v[0]=C*x,v[1]=C*x,v[2]=C*x):v[k]=C*x}const w=b*4;g[w+0]=Math.round(v[0]),g[w+1]=Math.round(v[1]),g[w+2]=Math.round(v[2]),g[w+3]=Math.round(v[3])}o.width=f,o.height=h;const y=new ImageData(g,f,h);return d.putImageData(y,0,0),r}const DQ={kernelName:hU,backendName:"cpu",kernelFunc:AQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qf(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Ce(r,"sum");let a;r.dtype==="bool"?a=la({inputs:{x:r},backend:n,attrs:{dtype:"int32"}}):a=zo({inputs:{x:r},backend:n});const l=a.shape.length,c=je(o,a.shape),u=Wt(c,l);let d=c,h=a;u!=null&&(h=Cs({inputs:{x:a},backend:n,attrs:{perm:u}}),d=sn(d.length,l)),zn("sum",d,h.shape.length);const[f,p]=An(h.shape,d),m=Bs(h.dtype,"int32");let x=Pg(n,f,m);const g=Z(p),y=n.data.get(x.dataId).values,b=n.data.get(h.dataId).values;for(let v=0;v<y.length;++v){const w=v*g;let k=0;for(let C=0;C<g;++C)k+=b[w+C];y[v]=k}if(i){const v=fn(x.shape,c),w=x;x=St({inputs:{x},backend:n,attrs:{shape:v}}),n.disposeIntermediateTensorInfo(w)}return n.disposeIntermediateTensorInfo(a),u!=null&&n.disposeIntermediateTensorInfo(h),x}const FQ={kernelName:$x,backendName:"cpu",kernelFunc:qf};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function OQ(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=TS(r,o.length);NS(i.length,l,o);const{path:c,steps:u}=_S(a,l),d=u.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const x of u[m]){const{permutationIndices:g,expandDims:y}=ES(f,l[x]);let b;RS(g)?b=o[x]:(b=Cs({inputs:{x:o[x]},backend:n,attrs:{perm:g}}),p.push(b));const v=b.shape.slice();for(let w=0;w<y.length;++w)v.splice(y[w],0,1);lt(b.shape,v)||(b=St({inputs:{x:b},backend:n,attrs:{shape:v}}),p.push(b)),h===null?h=b:(h=ny({inputs:{a:b,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=qf({inputs:{x:h},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const PQ={kernelName:eC,backendName:"cpu",kernelFunc:OQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MQ(t){const{inputs:e,backend:n}=t,{dy:s,y:r}=e;Ce([s,r],"eluGrad");const o=new Float32Array(Z(r.shape)),i=n.data.get(r.dataId).values,a=n.data.get(s.dataId).values;for(let l=0;l<i.length;++l){const c=i[l];c>=0?o[l]=a[l]:o[l]=a[l]*(c+1)}return n.makeTensorInfo(r.shape,"float32",o)}const LQ={kernelName:tC,backendName:"cpu",kernelFunc:MQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zQ=vS,BQ=wS,VQ=kS,WQ=CS,UQ=SS,HQ=$S,GQ=pt(Qh,t=>{const e=Math.sign(t),n=Math.abs(t),s=1/(1+zQ*n);return e*(1-((((HQ*s+UQ)*s+WQ)*s+VQ)*s+BQ)*s*Math.exp(-n*n))}),jQ={kernelName:Qh,backendName:"cpu",kernelFunc:GQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zg(t){const{inputs:e,backend:n,attrs:s}=t,{input:r}=e,{dim:o}=s,i=r.shape.length,a=r.shape.slice();let l=o;return o<0&&(T(-(i+1)<=o,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+o+1),a.splice(l,0,1),St({inputs:{x:r},backend:n,attrs:{shape:a}})}const KQ={kernelName:X0,backendName:"cpu",kernelFunc:zg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XQ=on((t,e)=>t/e),u$=In(qh,XQ),Yv={kernelName:qh,backendName:"cpu",kernelFunc:u$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KL(t,e,n){const s=t.shape,r=s[0],o=s[1],i=n.data.get(t.dataId),a=i.complexTensorInfos.real,l=i.complexTensorInfos.imag,c=[r,o],u=Z(c),d=Xn("float32",u),h=Xn("float32",u);for(let x=0;x<r;x++){const g=Cl({inputs:{x:a},backend:n,attrs:{begin:[x,0],size:[1,o]}}),y=Cl({inputs:{x:l},backend:n,attrs:{begin:[x,0],size:[1,o]}}),b=Rs({inputs:{real:g,imag:y},backend:n}),{real:v,imag:w}=qQ(b,e,n),k=ui(v,w);for(let C=0;C<o;C++){const S=IS(k,C);d[x*o+C]=S.real,h[x*o+C]=S.imag}n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(y),n.disposeIntermediateTensorInfo(b)}const f=n.makeTensorInfo(c,"float32",d),p=n.makeTensorInfo(c,"float32",h),m=Rs({inputs:{real:f,imag:p},backend:n});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),m}function qQ(t,e,n){const s=Z(t.shape),r=n.data.get(t.dataId),o=n.data.get(r.complexTensorInfos.real.dataId).values,i=n.data.get(r.complexTensorInfos.imag.dataId).values;if(YQ(s)){const a=Qv(o,i,s,e,n),l=[t.shape[0],t.shape[1]];if(e){const c=n.makeTensorInfo(l,"float32",a.real),u=n.makeTensorInfo(l,"float32",a.imag),d=n.makeTensorInfo([],"float32",ma(s,"float32")),h=zo({inputs:{x:d},backend:n}),f=Yv.kernelFunc({inputs:{a:c,b:d},backend:n}),p=Yv.kernelFunc({inputs:{a:u,b:h},backend:n}),m=n.data.get(f.dataId).values,x=n.data.get(p.dataId).values;return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),{real:m,imag:x}}return a}else{const a=ui(o,i),l=QQ(a,s,e);return aO(l)}}function YQ(t){return(t&t-1)===0}function Qv(t,e,n,s,r){if(n===1)return{real:t,imag:e};const o=ui(t,e),i=n/2,a=lO(o),l=a.real,c=a.imag,u=[l.length],d=r.makeTensorInfo(u,"float32",l),h=r.makeTensorInfo(u,"float32",c),f=Rs({inputs:{real:d,imag:h},backend:r}),p=cO(o),m=p.real,x=p.imag,g=[m.length],y=r.makeTensorInfo(g,"float32",m),b=r.makeTensorInfo(g,"float32",x),v=Rs({inputs:{real:y,imag:b},backend:r}),w=Qv(l,c,i,s,r),k=w.real,C=w.imag,S=[k.length],I=r.makeTensorInfo(S,"float32",k),$=r.makeTensorInfo(S,"float32",C),E=Rs({inputs:{real:I,imag:$},backend:r}),_=Qv(m,x,i,s,r),D=_.real,F=_.imag,R=[D.length],P=r.makeTensorInfo(R,"float32",D),M=r.makeTensorInfo(R,"float32",F),N=Rs({inputs:{real:P,imag:M},backend:r}),B=dO(n,s),G=[B.real.length],X=r.makeTensorInfo(G,"float32",B.real),Y=r.makeTensorInfo(G,"float32",B.imag),J=Rs({inputs:{real:X,imag:Y},backend:r}),q=ny({inputs:{a:J,b:N},backend:r}),ee=Jc({inputs:{a:E,b:q},backend:r}),ne=l$({inputs:{a:E,b:q},backend:r}),ce=kl({inputs:{input:ee},backend:r}),ge=kl({inputs:{input:ne},backend:r}),de=eu({inputs:{input:ee},backend:r}),$e=eu({inputs:{input:ne},backend:r}),fe=tu({inputs:[ce,ge],backend:r,attrs:{axis:0}}),Ie=tu({inputs:[de,$e],backend:r,attrs:{axis:0}}),xe=r.data.get(fe.dataId).values,ye=r.data.get(Ie.dataId).values;return r.disposeIntermediateTensorInfo(d),r.disposeIntermediateTensorInfo(h),r.disposeIntermediateTensorInfo(f),r.disposeIntermediateTensorInfo(y),r.disposeIntermediateTensorInfo(b),r.disposeIntermediateTensorInfo(v),r.disposeIntermediateTensorInfo(I),r.disposeIntermediateTensorInfo($),r.disposeIntermediateTensorInfo(E),r.disposeIntermediateTensorInfo(P),r.disposeIntermediateTensorInfo(M),r.disposeIntermediateTensorInfo(N),r.disposeIntermediateTensorInfo(X),r.disposeIntermediateTensorInfo(Y),r.disposeIntermediateTensorInfo(J),r.disposeIntermediateTensorInfo(q),r.disposeIntermediateTensorInfo(ee),r.disposeIntermediateTensorInfo(ne),r.disposeIntermediateTensorInfo(ce),r.disposeIntermediateTensorInfo(de),r.disposeIntermediateTensorInfo(ge),r.disposeIntermediateTensorInfo($e),r.disposeIntermediateTensorInfo(fe),r.disposeIntermediateTensorInfo(Ie),{real:xe,imag:ye}}function QQ(t,e,n){const s=new Float32Array(e*2);for(let r=0;r<e;r++){let o=0,i=0;for(let a=0;a<e;a++){const l=hO(r*a,e,n),c=IS(t,a);o+=c.real*l.real-c.imag*l.imag,i+=c.real*l.imag+c.imag*l.real}n&&(o/=e,i/=e),uO(s,o,i,r)}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZQ(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Z(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=St({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=KL(a,!1,n),c=St({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const JQ={kernelName:nC,backendName:"cpu",kernelFunc:ZQ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d$(t){const{backend:e,attrs:n}=t,{shape:s,value:r,dtype:o}=n,i=o||pu(r),a=Jt(i,Z(s));return tZ(a,r,i),e.makeTensorInfo(s,i,a)}const eZ={kernelName:sC,backendName:"cpu",kernelFunc:d$};function tZ(t,e,n){t.fill(e)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nZ={kernelName:rC,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,r=n,o=Xn(s.dtype,Z(s.shape)),[i,a,l,c]=s.shape,u=r.data.get(s.dataId).values;for(let h=0;h<i;h++){const f=h*l*a*c;for(let p=0;p<a;p++){const m=p*(l*c);for(let x=0;x<l;x++){const g=x*c;for(let y=0;y<c;y++){const b=Math.round(l-x-1),v=f+m+g+y;let w=u[v];if(b>=0&&b<l){const k=b*c,C=f+m+k+y;w=u[C]}o[v]=w}}}}return{dataId:r.write(o,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=GL({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const x=m;if(u==="NCHW"&&i.shape.length===1&&i.shape[0]!==1){const g=St({inputs:{x:i},backend:n,attrs:{shape:[i.shape[0],1,1]}});m=Jc({inputs:{a:m,b:g},backend:n}),n.disposeIntermediateTensorInfo(g)}else m=Jc({inputs:{a:m,b:i},backend:n});n.disposeIntermediateTensorInfo(x)}if(f){const x=m;if(u==="NCHW"&&f==="prelu"&&a.shape.length===1&&a.shape[0]!==1){const g=St({inputs:{x:a},backend:n,attrs:{shape:[a.shape[0],1,1]}});m=Lg(n,m,f,g,p),n.disposeIntermediateTensorInfo(g)}else m=Lg(n,m,f,a,p);n.disposeIntermediateTensorInfo(x)}return m}const rZ={kernelName:yg,backendName:"cpu",kernelFunc:sZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s;let m=jL({inputs:{x:r,filter:o},backend:n,attrs:{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h}});if(i){const x=m;m=Jc({inputs:{a:m,b:i},backend:n}),n.disposeIntermediateTensorInfo(x)}if(f){const x=m;m=Lg(n,m,f,a,p),n.disposeIntermediateTensorInfo(x)}return m}const iZ={kernelName:AD,backendName:"cpu",kernelFunc:oZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aZ(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=Z(s.shape),i=r.shape,a=i[i.length-1],[l,c,u,d]=cS(s,r);if(c===0)return n.makeTensorInfo(l,s.dtype,[]);const h=n.data.get(r.dataId).values,f=n.bufferSync(s),p=sL(h,f,s.dtype,c,a,u,d,s.shape,o);return n.makeTensorInfo(l,s.dtype,p.values)}const lZ={kernelName:pD,backendName:"cpu",kernelFunc:aZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s;Ce([r,o],"gatherV2");const l=je(i,r.shape)[0],c=n.data.get(o.dataId).values,u=r.shape[l];for(let v=0;v<c.length;++v){const w=c[v];T(w<=u-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${u-1}]`)}let d=a;a==null&&(d=0);const h=Z(o.shape),f=DS(r,o,l,d),p=St({inputs:{x:r},backend:n,attrs:{shape:[f.batchSize,f.outerSize,f.dimSize,f.sliceSize]}}),m=St({inputs:{x:o},backend:n,attrs:{shape:[f.batchSize,h/f.batchSize]}}),x=[f.batchSize,f.outerSize,h/f.batchSize,f.sliceSize],g=n.bufferSync(m),y=n.bufferSync(p),b=rL(y,g,x);return n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.makeTensorInfo(f.outputShape,b.dtype,b.values)}const uZ={kernelName:Y0,backendName:"cpu",kernelFunc:cZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dZ(t){const{inputs:e,backend:n}=t,{input:s}=e,r=Z(s.shape),o=s.shape[s.shape.length-1],i=r/o,a=St({inputs:{x:s},backend:n,attrs:{shape:[i,o]}}),l=KL(a,!0,n),c=St({inputs:{x:l},backend:n,attrs:{shape:s.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(l),c}const hZ={kernelName:oC,backendName:"cpu",kernelFunc:dZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fZ=pt(rf,t=>Number.isFinite(t)?1:0,"bool"),pZ={kernelName:rf,backendName:"cpu",kernelFunc:fZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mZ=pt(of,t=>Math.abs(t)===1/0?1:0,"bool"),gZ={kernelName:of,backendName:"cpu",kernelFunc:mZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xZ=pt(af,t=>Number.isNaN(t)?1:0,"bool"),yZ={kernelName:af,backendName:"cpu",kernelFunc:xZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bZ(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=cL(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const vZ={kernelName:mD,backendName:"cpu",kernelFunc:bZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wZ=pt(cf,t=>Math.log1p(t)),kZ={kernelName:cf,backendName:"cpu",kernelFunc:wZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CZ=on((t,e)=>t&&e),SZ=In(tx,CZ,null,"bool"),$Z={kernelName:tx,backendName:"cpu",kernelFunc:SZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IZ=pt(nx,t=>t?0:1,"bool"),TZ={kernelName:nx,backendName:"cpu",kernelFunc:IZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EZ=on((t,e)=>t||e),NZ=In(sx,EZ,null,"bool"),_Z={kernelName:sx,backendName:"cpu",kernelFunc:NZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s;Ce(r,"LRN");const c=r.shape[3],u=c-1,d=n.data.get(r.dataId).values,h=Z(r.shape),f=new Float32Array(h);function p(m){const x=m%c;let g=m-x+Math.max(0,x-o);const y=m-x+Math.min(x+o,u);let b=0;for(;g<=y;g++){const v=d[g];b+=v*v}return b}for(let m=0;m<h;m++){const x=p(m),g=d[m]*Math.pow(i+a*x,-l);f[m]=g}return n.makeTensorInfo(r.shape,r.dtype,f)}const AZ={kernelName:rx,backendName:"cpu",kernelFunc:RZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function DZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s;Ce(i,"LRNGrad");const d=Z(i.shape),h=i.shape[3],f=n.data.get(i.dataId).values,p=n.data.get(r.dataId).values,m=n.data.get(o.dataId).values,x=new Float32Array(d),g=d;for(let y=0;y<g;y++){const b=y%h,v=y-b+Math.max(0,b-a),w=y-b+Math.min(h,b+a+1);let k=0;for(let C=v;C<w;C++)k+=Math.pow(p[C],2);k=c*k+l;for(let C=v;C<w;C++){let S=-2*c*u*p[C]*m[y]/k;y===C&&(S+=Math.pow(k,-u)),S*=f[y],x[C]+=S}}return n.makeTensorInfo(i.shape,r.dtype,x)}const FZ={kernelName:aC,backendName:"cpu",kernelFunc:DZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XL(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=n;let l=r.shape;const c=l.length,u=je(o,l);let d=u;const h=Wt(d,c);let f=a.data.get(r.dataId).values;if(h!=null){const v=new Array(c);for(let w=0;w<v.length;w++)v[w]=l[h[w]];f=i$(f,l,r.dtype,h,v),d=sn(d.length,c),l=v}Ce(r,"max"),zn("max",d,c);const[p,m]=An(l,d),x=Z(m),g=dL(f,x,p,r.dtype),y=a.write(g,p,r.dtype);let b=p;return i&&(b=fn(p,u)),{dataId:y,shape:b,dtype:r.dtype}}const OZ={kernelName:ox,backendName:"cpu",kernelFunc:XL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Ce(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Qn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Pr(r.shape,o,i,c,a,l);let d;if(u.filterWidth===1&&u.filterHeight===1&&lt(u.inShape,u.outShape))d=zo({inputs:{x:r},backend:n});else{const h=n.data.get(r.dataId).values,f=Te(r.shape),p=c$(h,r.shape,r.dtype,f,u,"max");d=n.makeTensorInfo(u.outShape,r.dtype,p.values)}return d}const MZ={kernelName:ix,backendName:"cpu",kernelFunc:PZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s;Ce(r,"maxPool3d");const u=yi(r.shape,o,i,1,a,l,c),d=n.data.get(r.dataId).values,h=HL(d,r.shape,r.dtype,Te(r.shape),u,"max");return n.makeTensorInfo(h.shape,"float32",h.values)}const zZ={kernelName:ax,backendName:"cpu",kernelFunc:LZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BZ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,{filterSize:i,strides:a,pad:l,dimRoundingMode:c}=s;Ce([r,o],"maxPool3DGrad");const u=yi(o.shape,i,a,1,l,c),d=n.bufferSync(o),h=EY(d,u),f=u.strideDepth,p=u.strideHeight,m=u.strideWidth,x=u.dilationDepth,g=u.dilationHeight,y=u.dilationWidth,b=u.effectiveFilterDepth,v=u.effectiveFilterHeight,w=u.effectiveFilterWidth,k=b-1-u.padInfo.front,C=w-1-u.padInfo.left,S=v-1-u.padInfo.top,I=Ge(o.shape,"float32"),$=n.bufferSync(r);for(let E=0;E<u.batchSize;++E)for(let _=0;_<u.inChannels;++_)for(let D=0;D<u.inDepth;++D)for(let F=0;F<u.inHeight;++F)for(let R=0;R<u.inWidth;++R){const P=D-k,M=F-S,N=R-C;let B=0;for(let G=0;G<b;G+=x){const X=(P+G)/f;if(!(X<0||X>=u.outDepth||Math.floor(X)!==X))for(let Y=0;Y<v;Y+=g){const J=(M+Y)/p;if(!(J<0||J>=u.outHeight||Math.floor(J)!==J))for(let q=0;q<w;q+=y){const ee=(N+q)/m;if(ee<0||ee>=u.outWidth||Math.floor(ee)!==ee)continue;const ne=b*v*w-1-h.get(E,X,J,ee,_),ce=G*v*w+Y*w+q,ge=ne===ce?1:0;if(ge===0)continue;const de=$.get(E,X,J,ee,_);B+=de*ge}}}I.set(B,E,D,F,R,_)}return n.makeTensorInfo(I.shape,I.dtype,I.values)}const VZ={kernelName:cC,backendName:"cpu",kernelFunc:BZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WZ(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;Ce([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=Pr(a.shape,l,c,1,u,d),f=n.data.get(a.dataId).values,p=Ge(h.outShape,a.dtype,UL(f,a.shape,a.dtype,h).values),m=h.strideHeight,x=h.strideWidth,g=h.dilationHeight,y=h.dilationWidth,b=h.effectiveFilterHeight,v=h.effectiveFilterWidth,w=v-1-h.padInfo.left,k=b-1-h.padInfo.top,C=Ge(a.shape,"float32"),S=n.data.get(r.dataId).values,I=Ge(r.shape,"float32",S);for(let $=0;$<h.batchSize;++$)for(let E=0;E<h.inChannels;++E)for(let _=0;_<h.inHeight;++_)for(let D=0;D<h.inWidth;++D){const F=_-k,R=D-w;let P=0;for(let M=0;M<b;M+=g){const N=(F+M)/m;if(!(N<0||N>=h.outHeight||Math.floor(N)!==N))for(let B=0;B<v;B+=y){const G=(R+B)/x;if(G<0||G>=h.outWidth||Math.floor(G)!==G)continue;const X=b*v-1-p.get($,N,G,E),Y=M*v+B,J=X===Y?1:0;if(J===0)continue;const q=I.get($,N,G,E);P+=q*J}}C.set(P,$,_,D,E)}return n.makeTensorInfo(C.shape,C.dtype,C.values)}const UZ={kernelName:lC,backendName:"cpu",kernelFunc:WZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function HZ(t,e,n,s,r){const o=Te(e),i=c$(t,e,n,o,r,"max"),a=UL(t,e,n,r,!0,s);return[i.values,a.values]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GZ={kernelName:gD,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;Ce(s,"MaxPoolWithArgmax");const c=l.data.get(s.dataId).values,u=Pr(s.shape,r,o,[1,1],i),[d,h]=HZ(c,s.shape,s.dtype,a,u),f=l.write(d,u.outShape,s.dtype),p=l.write(h,u.outShape,s.dtype);return[{dataId:f,shape:u.outShape,dtype:s.dtype},{dataId:p,shape:u.outShape,dtype:"int32"}]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=je(o,r.shape),c=An(r.shape,a)[1],u=Z(c),d=[],h=n.makeTensorInfo([],"float32",new Float32Array([u]));d.push(h);const f=la({inputs:{x:r},backend:n,attrs:{dtype:"float32"}});d.push(f);const p=u$({inputs:{a:f,b:h},backend:n});d.push(p);const m=qf({inputs:{x:p},backend:n,attrs:{axis:o,keepDims:i}});return d.forEach(x=>n.disposeIntermediateTensorInfo(x)),m}const KZ={kernelName:lx,backendName:"cpu",kernelFunc:jZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function XZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;Ce(r,"min");const a=je(o,r.shape);let l=a;const c=Wt(l,r.shape.length);let u=r;c!=null&&(u=Cs({inputs:{x:r},backend:n,attrs:{perm:c}}),l=sn(l.length,r.shape.length)),zn("min",l,u.shape.length);const[d,h]=An(u.shape,l),f=Z(h),p=qn(Z(d),u.dtype),m=n.data.get(u.dataId).values;for(let g=0;g<p.length;++g){const y=g*f;let b=m[y];for(let v=0;v<f;++v){const w=m[y+v];(Number.isNaN(w)||w<b)&&(b=w)}p[g]=b}c!=null&&n.disposeIntermediateTensorInfo(u);const x=n.makeTensorInfo(d,u.dtype,p);if(i){const g=fn(d,a),y=St({inputs:{x},backend:n,attrs:{shape:g}});return n.disposeIntermediateTensorInfo(x),y}return x}const qZ={kernelName:cx,backendName:"cpu",kernelFunc:XZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YZ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,mode:i}=s;Ce(r,"mirrorPad");const a=o.map((b,v)=>b[0]+r.shape[v]+b[1]),l=o.map(b=>b[0]),c=o.map((b,v)=>b[0]+r.shape[v]),u=i==="reflect"?0:1,d=n.data.get(r.dataId).values,h=r.shape.length,f=Te(r.shape),p=Z(a),m=a.length,x=Te(a),g=Xn(r.dtype,p);for(let b=0;b<p;b++){let v=mu(b,m,x);for(let k=0;k<m;k++)v[k]<l[k]?v[k]=l[k]*2-v[k]-u:v[k]>=c[k]&&(v[k]=(c[k]-1)*2-v[k]+u);v=v.map((k,C)=>k-l[C]);const w=Eo(v,h,f);g[b]=d[w]}return{dataId:n.write(g,a,r.dtype),shape:a,dtype:r.dtype}}const QZ={kernelName:ux,backendName:"cpu",kernelFunc:YZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZZ=on((t,e)=>{const n=t%e;return t<0&&e<0||t>=0&&e>=0?n:(n+e)%e}),JZ=In(hf,ZZ),eJ={kernelName:hf,backendName:"cpu",kernelFunc:JZ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qL(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=r.shape.length;let a=o;if(a===-1&&(a=i-1),a!==i-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${i} and dim was ${a}`);const l=je([a],r.shape),c=XL({inputs:{x:r},backend:n,attrs:{reductionIndices:l,keepDims:!1}}),u=fn(c.shape,l),d=St({inputs:{x:c},backend:n,attrs:{shape:u}}),h=l$({inputs:{a:r,b:d},backend:n}),f=JM({inputs:{x:h},backend:n}),p=qf({inputs:{x:f},backend:n,attrs:{axis:l,keepDims:!1}}),m=St({inputs:{x:p},backend:n,attrs:{shape:u}}),x=u$({inputs:{a:f,b:m},backend:n});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),x}const tJ={kernelName:Ex,backendName:"cpu",kernelFunc:qL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nJ(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s;Ce(r,"multinomial");const l=a?r:qL({inputs:{logits:r},backend:n,attrs:{dim:-1}}),c=l.shape[0],u=l.shape[1],d=n.data.get(l.dataId).values,h=[c,o],f=qn(Z(h),"int32");for(let p=0;p<c;++p){const m=p*u,x=new Float32Array(u-1);x[0]=d[m];for(let b=1;b<x.length;++b)x[b]=x[b-1]+d[m+b];const g=qC.alea(i.toString()),y=p*o;for(let b=0;b<o;++b){const v=g();f[y+b]=x.length;for(let w=0;w<x.length;w++)if(v<x[w]){f[y+b]=w;break}}}return a||n.disposeIntermediateTensorInfo(l),n.makeTensorInfo(h,"int32",f)}const sJ={kernelName:xD,backendName:"cpu",kernelFunc:nJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rJ=rS;function oJ(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s;Ce(r,"NonMaxSuppression");const c=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,{selectedIndices:d}=rJ(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const iJ={kernelName:uC,backendName:"cpu",kernelFunc:oJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aJ=oS;function lJ(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s;Ce(r,"NonMaxSuppressionPadded");const u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,{selectedIndices:h,validOutputs:f}=aJ(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const cJ={kernelName:dC,backendName:"cpu",kernelFunc:lJ};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uJ=iS;function dJ(t){const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s;Ce(r,"NonMaxSuppressionWithScore");const u=n.data.get(r.dataId).values,d=n.data.get(o.dataId).values,h=i,f=a,p=l,m=c,{selectedIndices:x,selectedScores:g}=uJ(u,d,h,f,p,m);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const hJ={kernelName:hC,backendName:"cpu",kernelFunc:dJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fJ(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s;Ce(r,"oneHot");const c=Z(r.shape),u=new Float32Array(c*i);u.fill(l);const d=n.data.get(r.dataId).values;for(let h=0;h<c;++h)d[h]>=0&&d[h]<i&&(u[h*i+d[h]]=a);return n.makeTensorInfo([...r.shape,i],o,u)}const pJ={kernelName:px,backendName:"cpu",kernelFunc:fJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bg(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("zerosLike is not supported for string tensors");if(s.dtype==="complex64"){const r=kl({inputs:{input:s},backend:n}),o=Bg({inputs:{x:r},backend:n}),i=eu({inputs:{input:s},backend:n}),a=Bg({inputs:{x:i},backend:n}),l=Rs({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return d$({backend:n,attrs:{shape:s.shape,value:0,dtype:s.dtype}})}const mJ={kernelName:Rx,backendName:"cpu",kernelFunc:Bg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YL(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported for string tensors");if(s.dtype==="complex64"){const r=kl({inputs:{input:s},backend:n}),o=YL({inputs:{x:r},backend:n}),i=eu({inputs:{input:s},backend:n}),a=Bg({inputs:{x:i},backend:n}),l=Rs({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return d$({backend:n,attrs:{shape:s.shape,value:1,dtype:s.dtype}})}const gJ={kernelName:fx,backendName:"cpu",kernelFunc:YL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function QL(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return zg({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(u=>{Dk(o,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=zg({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=tu({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const xJ={kernelName:mx,backendName:"cpu",kernelFunc:QL};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;Ce(r,"pad");const a=o.map((y,b)=>y[0]+r.shape[b]+y[1]),l=o.map(y=>y[0]),c=n.data.get(r.dataId).values,u=Z(r.shape),d=r.shape.length,h=Te(r.shape),f=Z(a),p=a.length,m=Te(a),x=Xn(r.dtype,f);i!==0&&x.fill(i);for(let y=0;y<u;y++){const v=mu(y,d,h).map((k,C)=>k+l[C]),w=Eo(v,p,m);x[w]=c[y]}return{dataId:n.write(x,a,r.dtype),shape:a,dtype:r.dtype}}const ZL={kernelName:gx,backendName:"cpu",kernelFunc:yJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const bJ=on((t,e)=>Math.pow(t,e)),vJ=In(pf,bJ),wJ={kernelName:pf,backendName:"cpu",kernelFunc:vJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kJ(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,a=r.map(x=>n.data.get(x.dataId).values),l=r.map(x=>x.shape),c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values,[d,h,f]=xL(a,l,c,o.shape,o.dtype,u,i.shape),p=d.map(x=>n.makeTensorInfo([x.length],"int32",x)),m=n.makeTensorInfo(f,o.dtype,h);return p.concat([m])}const CJ={kernelName:yD,backendName:"cpu",kernelFunc:kJ};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function SJ(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=yL(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const $J={kernelName:bD,backendName:"cpu",kernelFunc:SJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function IJ(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.data.get(r.dataId).values,u=n.data.get(o.dataId).values,d=n.data.get(i.dataId).values,h=a.map(x=>n.data.get(x.dataId).values),f=a.map(x=>x.shape),[p,m]=bL(c,r.shape,u,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,o.dtype,m)}const TJ={kernelName:vD,backendName:"cpu",kernelFunc:IJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function EJ(t){const{backend:e,attrs:n}=t,{start:s,stop:r,dtype:o,step:i}=n,a=vL(s,r,i,o);return e.makeTensorInfo([a.length],o,a)}const NJ={kernelName:fC,backendName:"cpu",kernelFunc:EJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _J=pt(mf,t=>1/t),RJ={kernelName:mf,backendName:"cpu",kernelFunc:_J};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function AJ(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;Ce(r,"resizeBilinear");const l=Te(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,x=new Float32Array(Z([d,c,u,p])),g=[o&&c>1?h-1:h,o&&u>1?f-1:f],y=[o&&c>1?c-1:c,o&&u>1?u-1:u];let b=0;const v=g[0]/y[0],w=g[1]/y[1];for(let k=0;k<d;k++)for(let C=0;C<c;C++){let S;i?S=v*(C+.5)-.5:S=v*C;const I=Math.max(0,Math.floor(S)),$=S-I,E=Math.min(h-1,Math.ceil(S)),_=k*l[0]+I*l[1],D=k*l[0]+E*l[1];for(let F=0;F<u;F++){let R;i?R=w*(F+.5)-.5:R=w*F;const P=Math.max(0,Math.floor(R)),M=R-P,N=Math.min(f-1,Math.ceil(R)),B=_+P*l[2],G=D+P*l[2],X=_+N*l[2],Y=D+N*l[2];for(let J=0;J<p;J++){const q=m[B+J],ee=m[G+J],ne=m[X+J],ce=m[Y+J],ge=q+(ne-q)*M,de=ee+(ce-ee)*M,$e=ge+(de-ge)*$;x[b++]=$e}}}return n.makeTensorInfo([d,c,u,p],"float32",x)}const DJ={kernelName:wx,backendName:"cpu",kernelFunc:AJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FJ(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;Ce([o,r],"resizeBilinearGrad");const a=Te(r.shape),[l,c,u,d]=r.shape,[,h,f]=o.shape,p=new Float32Array(l*c*u*d),m=[i&&h>1?c-1:c,i&&f>1?u-1:u],x=[i&&h>1?h-1:h,i&&f>1?f-1:f],g=m[0]/x[0],y=m[1]/x[1],b=n.data.get(o.dataId).values;let v=0;for(let w=0;w<l;w++){const k=w*a[0];for(let C=0;C<h;C++){const S=C*g,I=Math.floor(S),$=Math.min(Math.ceil(S),c-1),E=k+I*a[1],_=k+$*a[1],D=S-I,F=1-D;for(let R=0;R<f;R++){const P=R*y,M=Math.floor(P),N=Math.min(Math.ceil(P),u-1),B=P-M,G=1-B,X=E+M*a[2],Y=E+N*a[2],J=_+M*a[2],q=_+N*a[2],ee=F*G,ne=F*B,ce=D*G,ge=D*B;for(let de=0;de<d;de++){const $e=b[v++];p[X+de]+=$e*ee,p[Y+de]+=$e*ne,p[J+de]+=$e*ce,p[q+de]+=$e*ge}}}}return n.makeTensorInfo([l,u,c,d],"float32",p)}const OJ={kernelName:gC,backendName:"cpu",kernelFunc:FJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function PJ(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s;Ce(r,"resizeNearestNeighbor");const l=Te(r.shape),[c,u]=a,[d,h,f,p]=r.shape,m=n.data.get(r.dataId).values,x=new Float32Array(d*c*u*p),g=[o&&c>1?h-1:h,o&&u>1?f-1:f],y=[o&&c>1?c-1:c,o&&u>1?u-1:u],b=g[0]/y[0],v=g[1]/y[1];let w=0;for(let k=0;k<d;k++){const C=k*l[0];for(let S=0;S<c;S++){const I=i?b*(S+.5):b*S;let $=Math.min(h-1,o?Math.round(I):Math.floor(I));i&&($=Math.max(0,$));const E=C+$*l[1];for(let _=0;_<u;_++){const D=i?v*(_+.5):v*_;let F=Math.min(f-1,o?Math.round(D):Math.floor(D));i&&(F=Math.max(0,F));const R=E+F*l[2];for(let P=0;P<p;P++){const M=m[R+P];x[w++]=M}}}}return n.makeTensorInfo([d,c,u,p],r.dtype,x)}const MJ={kernelName:vx,backendName:"cpu",kernelFunc:PJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LJ(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s;Ce([o,r],"resizeNearestNeighborGrad");const a=Te(r.shape),l=Te(o.shape),[c,u,d,h]=r.shape,[,f,p]=o.shape,m=new Float32Array(c*u*d*h),x=n.data.get(o.dataId).values,g=[i&&f>1?u-1:u,i&&p>1?d-1:d],y=[i&&f>1?f-1:f,i&&p>1?p-1:p],b=g[0]/y[0],v=g[1]/y[1],w=1/b,k=1/v,C=Math.ceil(w)*2+2,S=Math.ceil(k)*2+2;for(let I=0;I<c;I++){const $=I*a[0];for(let E=0;E<u;E++){const _=$+E*a[1],D=Math.floor(E*w),F=Math.floor(D-C/2);for(let R=0;R<d;R++){const P=_+R*a[2],M=Math.floor(R*k),N=Math.floor(M-S/2);for(let B=0;B<h;B++){let G=0;for(let X=0;X<C;X++){const Y=X+F;if(Y<0||Y>=f)continue;const J=$+Y*l[1],q=Y*b,ee=Math.min(u-1,i?Math.round(q):Math.floor(q));if(E===ee)for(let ne=0;ne<S;ne++){const ce=ne+N;if(ce<0||ce>=p)continue;const ge=J+ce*l[2],de=ce*v,$e=Math.min(d-1,i?Math.round(de):Math.floor(de));R===$e&&(G+=x[ge+B])}}m[P+B]=G}}}}return n.makeTensorInfo(r.shape,r.dtype,m)}const zJ={kernelName:mC,backendName:"cpu",kernelFunc:LJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BJ(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s;Ce(r,"reverse");const i=r.shape.length,a=je(o,r.shape);if(i===0)return zo({inputs:{x:r},backend:n});const l=new Mn(r.shape,r.dtype),c=n.bufferSync(r);for(let u=0;u<l.size;u++){const d=l.indexToLoc(u),h=d.slice();a.forEach(f=>h[f]=r.shape[f]-1-h[f]),l.set(c.get(...h),...d)}return n.makeTensorInfo(l.shape,l.dtype,l.values)}const VJ={kernelName:kx,backendName:"cpu",kernelFunc:BJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WJ={kernelName:CC,backendName:"cpu",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=Xn(s.dtype,Z(s.shape)),[c,u,d,h]=s.shape,[f,p]=xS(i,u,d),m=255,x=Math.sin(r),g=Math.cos(r),y=a.data.get(s.dataId).values;for(let v=0;v<c;v++){const w=v*d*u*h;for(let k=0;k<u;k++){const C=k*(d*h);for(let S=0;S<d;S++){const I=S*h;for(let $=0;$<h;$++){const E=[c,k,S,$],_=E[2],D=E[1];let F=(_-f)*g-(D-p)*x,R=(_-f)*x+(D-p)*g;F=Math.round(F+f),R=Math.round(R+p);let P=o;if(typeof o!="number"&&($===3?P=m:P=o[$]),F>=0&&F<d&&R>=0&&R<u){const N=R*(d*h),B=F*h,G=w+N+B+$;P=y[G]}const M=w+C+I+$;l[M]=P}}}}return{dataId:a.write(l,s.shape,s.dtype),shape:s.shape,dtype:s.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const UJ=pt(yf,t=>{const e=Math.floor(t);return t-e<.5?Math.floor(t):t-e>.5?Math.ceil(t):e%2===0?e:e+1}),HJ={kernelName:yf,backendName:"cpu",kernelFunc:UJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GJ(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Ll(o,r,i),h=!0,f=n.bufferSync(r),p=n.bufferSync(o),m=Xa(f,p,i,d,c,l,a,u,0,h);return n.makeTensorInfo(i,m.dtype,m.values)}const jJ={kernelName:wD,backendName:"cpu",kernelFunc:GJ};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function KJ(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<e?n=r+1:s=r;return s}function XJ(t,e){let n=0,s=t.length,r=0;for(;n<s;)r=Math.floor((n+s)/2),t[r]<=e?n=r+1:s=r;return s}function qJ(t,e,n,s,r,o){const i=Jt("int32",n*r);for(let a=0;a<n;++a){const l=t.slice(a*s,(a+1)*s),c=a*r;for(let u=0;u<r;++u)i[c+u]=o==="left"?KJ(l,e[u+c]):XJ(l,e[u+c])}return i}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YJ(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,c=qJ(a,l,r.shape[0],r.shape[1],o.shape[1],i);return n.makeTensorInfo(o.shape,"int32",c)}const QJ={kernelName:CD,backendName:"cpu",kernelFunc:YJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZJ(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e;Ce([s,r,o],"select");const i=s.shape.length,a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=Bs(r.dtype,o.dtype),d=qn(Z(r.shape),u);let h=0;const f=i===0||i>1||r.shape.length===1?1:Z(r.shape.slice(1));for(let p=0;p<a.length;p++)for(let m=0;m<f;m++)a[p]===1?d[h++]=l[p]:d[h++]=c[p];return n.makeTensorInfo(r.shape,u,d)}const JJ={kernelName:Cx,backendName:"cpu",kernelFunc:ZJ};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eee=Ux,tee=Hx,nee=pt(vf,t=>t>=0?tee*t:eee*(Math.exp(t)-1)),see={kernelName:vf,backendName:"cpu",kernelFunc:nee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ree=pt(Cf,t=>t<0?-1:t>0?1:0),oee={kernelName:Cf,backendName:"cpu",kernelFunc:ree};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iee=pt(wf,t=>Math.sin(t)),aee={kernelName:wf,backendName:"cpu",kernelFunc:iee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lee=pt(kf,t=>Math.sinh(t)),cee={kernelName:kf,backendName:"cpu",kernelFunc:lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uee=11920928955078125e-23,BT=Math.log(uee)+2,dee=pt($f,t=>{const e=t>-BT,n=t<BT,s=Math.exp(t);let r;return n?r=s:e?r=t:r=Math.log(1+s),r}),hee={kernelName:$f,backendName:"cpu",kernelFunc:dee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;Ce([r],"spaceToBatchND");const a=Z(o),l=[[0,0]];l.push(...i);for(let k=1+o.length;k<r.shape.length;++k)l.push([0,0]);const c=ZL.kernelFunc({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),u=Lf(c.shape,o,a,!1),d=zf(u.length,o.length,!1),h=Bf(c.shape,o,a,!1),m=St({inputs:{x:c},backend:n,attrs:{shape:u}}),y=Cs({inputs:{x:m},backend:n,attrs:{perm:d}}),w=St({inputs:{x:y},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(y),w}const pee={kernelName:Ix,backendName:"cpu",kernelFunc:fee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mee(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
        ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
        ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.data.get(s.dataId).values,l=n.data.get(r.dataId).values,c=n.data.get(o.dataId).values,u=n.data.get(i.dataId).values[0],[d,h,f,p,m]=SL(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(x=>Number(x)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const gee={kernelName:SD,backendName:"cpu",kernelFunc:mee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xee(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape
        ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape
        ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.data.get(r.dataId).values),a=n.data.get(s.dataId).values,l=Array.from(n.data.get(o.dataId).values),[c,u,d]=$L(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const yee={kernelName:$D,backendName:"cpu",kernelFunc:xee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bee(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
          ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
          ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=a$(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const vee={kernelName:ID,backendName:"cpu",kernelFunc:bee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wee(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
         ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
         ${o.shape}`);if(r.shape[0]!==o.shape[0])throw new Error("segmentIds and indices should have same size.");const i=n.data.get(s.dataId).values,a=n.data.get(r.dataId).values,l=n.data.get(o.dataId).values,[c,u]=a$(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const kee={kernelName:TD,backendName:"cpu",kernelFunc:wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cee(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Ll(o,r,a),f=!1,p=n.bufferSync(r);let m;switch(o.dtype){case"bool":{const x=n.bufferSync(o),g=!!n.data.get(i.dataId).values[0];m=Xa(p,x,a,h,u,c,l,d,g,f);break}case"float32":{const x=n.bufferSync(o),g=n.data.get(i.dataId).values[0];m=Xa(p,x,a,h,u,c,l,d,g,f);break}case"int32":{const x=n.bufferSync(o),g=n.data.get(i.dataId).values[0];m=Xa(p,x,a,h,u,c,l,d,g,f);break}case"string":{const x=n.bufferSync(o),g=sa(n.data.get(i.dataId).values[0]);m=Xa(p,x,a,h,u,c,l,d,g,f);break}default:throw new Error(`Unsupported type ${o.dtype}`)}return n.makeTensorInfo(a,m.dtype,m.values)}const See={kernelName:ED,backendName:"cpu",kernelFunc:Cee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=je(i,r.shape)[0],l=AS(r,o,a),c=new Array(r.shape.length).fill(0),u=r.shape.slice();return l.map(d=>{const h=[...u];h[a]=d;const f=Cl({inputs:{x:r},backend:n,attrs:{begin:c,size:h}});return c[a]+=d,f})}const Iee={kernelName:Tx,backendName:"cpu",kernelFunc:$ee};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tee={kernelName:xC,backendName:"cpu",kernelFunc:({inputs:t,backend:e})=>{const{x:n}=t,s=e;Ce(n,"square");const r=s.data.get(n.dataId).values,o=new Float32Array(r.length);for(let a=0;a<r.length;++a){const l=r[a];o[a]=l*l}return{dataId:s.write(o,n.shape,n.dtype),shape:n.shape,dtype:n.dtype}}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Eee=pt(Af,(t,e)=>{const n=e;return isNaN(t)?NaN:t>0?1:n.alpha}),Nee={kernelName:Af,backendName:"cpu",kernelFunc:Eee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s;Ce(r,"stridedSlice");const{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:x,isSimpleSlice:g,begin:y,end:b,strides:v}=pS(r.shape,o,i,a,l,c,u,d,h);let w;if(m)w=St({inputs:{x:r},backend:n,attrs:{shape:p}});else if(x||g){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const k=dS(y,b,v),C=Cl({inputs:{x:r},backend:n,attrs:{begin:y,size:k}});w=St({inputs:{x:C},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(C)}else{const k=n.bufferSync(r),C=EL(f,k,v,y);w=n.makeTensorInfo(p,C.dtype,C.values)}return w}const Ree={kernelName:bC,backendName:"cpu",kernelFunc:_ee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aee(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.data.get(u.dataId).values,f=n.data.get(d.dataId).values,[p,m]=NL(h,f,r,o,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const Dee={kernelName:ND,backendName:"cpu",kernelFunc:Aee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fee(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.data.get(o.dataId).values,l=n.data.get(i.dataId).values[0],[c,u,d]=_L(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Oee={kernelName:_D,backendName:"cpu",kernelFunc:Fee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pee(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.data.get(o.dataId).values,a=RL(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const Mee={kernelName:RD,backendName:"cpu",kernelFunc:Pee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lee=pt(Nf,t=>Math.tan(t)),zee={kernelName:Nf,backendName:"cpu",kernelFunc:Lee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bee=pt(_f,t=>Math.tanh(t)),Vee={kernelName:_f,backendName:"cpu",kernelFunc:Bee};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wee(t){const{inputs:e,backend:n}=t,{tensor:s,indices:r,updates:o}=e,{sliceRank:i,numUpdates:a,sliceSize:l,strides:c,outputSize:u}=Ll(o,r,s.shape),d=!1,h=n.bufferSync(r),f=n.bufferSync(o),p=n.bufferSync(s),m=Xa(h,f,s.shape,u,l,a,i,c,p,d);return n.makeTensorInfo(s.shape,m.dtype,m.values)}const Uee={kernelName:kD,backendName:"cpu",kernelFunc:Wee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;Ce(r,"tile");const i=DL(n.bufferSync(r),o);return n.makeTensorInfo(i.shape,i.dtype,i.values)}const Gee={kernelName:Rf,backendName:"cpu",kernelFunc:Hee};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jee(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s;Ce(r,"topk");const a=n.data.get(r.dataId).values,[l,c]=OL(a,r.shape,r.dtype,o,i);return[n.makeTensorInfo(l.shape,l.dtype,l.values),n.makeTensorInfo(c.shape,c.dtype,c.values)]}const Kee={kernelName:vC,backendName:"cpu",kernelFunc:jee};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xee(t){const{inputs:e,attrs:n,backend:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=n,[u,d,h,f]=r.shape,[p,m]=c??[d,h],x=[u,p,m,f],g=Te(r.shape),y=g[0],b=g[1],v=g[2],w=Te(x),k=w[0],C=w[1],S=w[2],I=Xn(r.dtype,Z(x));I.fill(l);const $=s.data.get(r.dataId).values,E=s.data.get(o.dataId).values;for(let D=0;D<u;++D){const F=o.shape[0]===1?E:E.subarray(D*8,D*8+8);for(let R=0;R<p;++R)for(let P=0;P<m;++P)for(let M=0;M<f;++M){let N;const B=F[6]*P+F[7]*R+1;if(B===0)continue;const G=(F[0]*P+F[1]*R+F[2])/B,X=(F[3]*P+F[4]*R+F[5])/B,Y=VT(G,h,a),J=VT(X,d,a);switch(i){case"nearest":N=ete($,d,h,y,b,v,D,J,Y,M,l);break;case"bilinear":N=tte($,d,h,y,b,v,D,J,Y,M,l);break;default:throw new Error(`Error in Transform: Expect 'nearest' or 'bilinear', but got ${i}`)}const q=D*k+R*C+P*S+M;I[q]=N}return s.makeTensorInfo(x,r.dtype,I)}return{dataId:s.write(I,x,r.dtype),shape:r.shape,dtype:r.dtype}}const qee={kernelName:wC,backendName:"cpu",kernelFunc:Xee};function VT(t,e,n){switch(n){case"reflect":return Yee(t,e);case"wrap":return Qee(t,e);case"nearest":return Jee(t,e);case"constant":default:return Zee(t)}}function Yee(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=2*e;n<s&&(n=s*Math.trunc(-n/s)+n),n=n<-e?n+s:-n-1}else if(n>e-1)if(e<=1)n=0;else{const s=2*e;n-=s*Math.trunc(n/s),n>=e&&(n=s-n-1)}return dl(0,n,e-1)}function Qee(t,e){let n=t;if(n<0)if(e<=1)n=0;else{const s=e-1;n+=e*(Math.trunc(-n/s)+1)}else if(n>e-1)if(e<=1)n=0;else{const s=e-1;n-=e*Math.trunc(n/s)}return dl(0,n,e-1)}function Zee(t,e){return t}function Jee(t,e){return dl(0,t,e-1)}function fd(t,e,n,s,r,o,i,a,l,c,u){const d=i*s+a*r+l*o+c;return 0<=a&&a<e&&0<=l&&l<n?t[d]:u}function ete(t,e,n,s,r,o,i,a,l,c,u){const d=Math.round(a),h=Math.round(l);return fd(t,e,n,s,r,o,i,d,h,c,u)}function tte(t,e,n,s,r,o,i,a,l,c,u){const d=Math.floor(a),h=Math.floor(l),f=d+1,p=h+1,m=(p-l)*fd(t,e,n,s,r,o,i,d,h,c,u)+(l-h)*fd(t,e,n,s,r,o,i,d,p,c,u),x=(p-l)*fd(t,e,n,s,r,o,i,f,h,c,u)+(l-h)*fd(t,e,n,s,r,o,i,f,p,c,u);return(f-a)*m+(a-d)*x}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nte(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;Ce(o,"unique");const i=s.data.get(o.dataId).values,{outputValues:a,outputShape:l,indices:c}=PL(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const ste={kernelName:kC,backendName:"cpu",kernelFunc:nte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rte(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r.shape.length,a=r.shape[o],l=new Array(i-1);let c=0;for(let f=0;f<i;f++)f!==o&&(l[c++]=r.shape[f]);const u=new Array(i).fill(0),d=r.shape.slice();d[o]=1;const h=new Array(a);for(let f=0;f<h.length;f++){u[o]=f;const p=Cl({inputs:{x:r},backend:n,attrs:{begin:u,size:d}});h[f]=St({inputs:{x:p},backend:n,attrs:{shape:l}}),n.disposeIntermediateTensorInfo(p)}return h}const ote={kernelName:Nx,backendName:"cpu",kernelFunc:rte};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ite(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s;Ce(r,"unsortedSegmentSum");const a=r.shape.length,l=o.shape.length,c=[],u=[],d=a-l;let h=o;for(let p=0;p<d;++p){const m=zg({inputs:{input:h},backend:n,attrs:{dim:p+1}});h=m,u.push(m)}for(let p=0;p<i;++p){const m=ma(p,"int32"),x=n.makeTensorInfo([],"int32",m),g=QM({inputs:{a:x,b:h},backend:n}),y=la({inputs:{x:g},backend:n,attrs:{dtype:"float32"}}),b=ny({inputs:{a:y,b:r},backend:n}),v=qf({inputs:{x:b},backend:n,attrs:{axis:0,keepDims:!1}});c.push(v),u.push(x),u.push(g),u.push(y),u.push(b),u.push(v)}const f=QL({inputs:c,backend:n,attrs:{axis:0}});return u.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const ate={kernelName:_x,backendName:"cpu",kernelFunc:ite};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lte=[nY,P9,rY,iY,W9,lY,uY,hY,pY,gY,yY,vY,kY,$Y,TY,_Y,AY,FY,PY,eY,LY,BY,WY,H9,HY,B9,j9,jY,M9,XY,YY,QY,JY,tQ,sQ,oQ,aQ,cQ,dQ,fQ,mQ,xQ,bQ,wQ,kQ,SQ,IQ,EQ,NQ,_Q,RQ,DQ,PQ,K7,LQ,K9,jQ,X9,KQ,Y9,JQ,eZ,nZ,Z9,e7,rZ,iZ,lZ,uZ,n7,r7,L9,hZ,qY,pZ,gZ,yZ,X7,i7,l7,vZ,u7,kZ,$Z,TZ,_Z,AZ,FZ,OZ,h7,MZ,zZ,VZ,UZ,GZ,KZ,qZ,p7,QZ,eJ,sJ,g7,y7,iJ,cJ,hJ,v7,pJ,gJ,xJ,ZL,wJ,Y7,C7,CJ,$J,TJ,NJ,z9,Yv,RJ,Q7,Z7,J7,DJ,OJ,MJ,zJ,VJ,WJ,HJ,R7,jJ,QJ,JJ,see,D7,oee,aee,cee,F7,tJ,hee,pee,gee,yee,vee,kee,See,Iee,M7,Tee,z7,V7,Nee,Ree,Dee,Oee,Mee,G7,FQ,zee,Vee,Uee,Gee,Kee,qee,w7,ste,ote,ate,mJ];for(const t of lte)DD(t);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wa={},Pp={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function cte(t,e){Wa[t]=e}function io(t,e){if(!(t in Wa)||e!=null){const s=dte(t,e);if(s!==null)Wa[t]=s;else return console.log("Could not get context for WebGL version",t),null}const n=Wa[t];return n==null||n.isContextLost()?(delete Wa[t],io(t)):(n.disable(n.DEPTH_TEST),n.disable(n.STENCIL_TEST),n.disable(n.BLEND),n.disable(n.DITHER),n.disable(n.POLYGON_OFFSET_FILL),n.disable(n.SAMPLE_COVERAGE),n.enable(n.SCISSOR_TEST),n.enable(n.CULL_FACE),n.cullFace(n.BACK),Wa[t])}function ute(t){if(!K().getBool("IS_SAFARI")&&typeof OffscreenCanvas<"u"&&t===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function dte(t,e){if(t!==1&&t!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const n=e??ute(t);return n.addEventListener("webglcontextlost",s=>{s.preventDefault(),delete Wa[t]},!1),K().getBool("SOFTWARE_WEBGL_ENABLED")&&(Pp.failIfMajorPerformanceCaveat=!1),t===1?n.getContext("webgl",Pp)||n.getContext("experimental-webgl",Pp):n.getContext("webgl2",Pp)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var mh;(function(t){t[t.DENSE=0]="DENSE",t[t.SHARED_BATCH=1]="SHARED_BATCH"})(mh||(mh={}));var Ys;(function(t){t[t.RENDER=0]="RENDER",t[t.UPLOAD=1]="UPLOAD",t[t.PIXELS=2]="PIXELS",t[t.DOWNLOAD=3]="DOWNLOAD"})(Ys||(Ys={}));var Fn;(function(t){t[t.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",t[t.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",t[t.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",t[t.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",t[t.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(Fn||(Fn={}));function Yf(t,e){return[e,t]}function hte(t,e){return t*e}function Mp(t){const e=Z(t),n=Math.ceil(e/4);return xv(n)}function Cu(t,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(t/2))]}function fte(t,e){const[n,s]=Cu(t,e);return n*s*4}function h$(t,e){const n=t;let s,r,o,i,a,l,c,u,d,h;return K().getNumber("WEBGL_VERSION")===2?(s=n.R32F,r=n.R16F,o=n.RGBA16F,i=n.RGBA32F,a=n.RED,c=4,u=1,d=n.HALF_FLOAT,h=n.FLOAT,l=n.RGBA8):(s=t.RGBA,r=t.RGBA,o=t.RGBA,i=n.RGBA,a=t.RGBA,c=4,u=4,d=e!=null?e.HALF_FLOAT_OES:null,h=t.FLOAT,l=t.RGBA),{internalFormatFloat:s,internalFormatHalfFloat:r,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:l,downloadUnpackNumChannels:c,defaultNumChannels:u,textureTypeHalfFloat:d,textureTypeFloat:h}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function be(t,e){const n=e();return K().getBool("DEBUG")&&pte(t),n}function pte(t){const e=t.getError();if(e!==t.NO_ERROR)throw new Error("WebGL Error: "+yte(t,e))}const mte=596e-10,gte=65504;function xte(t){return!!(K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||t===0||mte<Math.abs(t)&&Math.abs(t)<gte)}function yte(t,e){switch(e){case t.NO_ERROR:return"NO_ERROR";case t.INVALID_ENUM:return"INVALID_ENUM";case t.INVALID_VALUE:return"INVALID_VALUE";case t.INVALID_OPERATION:return"INVALID_OPERATION";case t.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case t.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case t.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Lp(t,e){return vi(t,()=>t.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function bte(t,e){const n=vi(t,()=>t.createShader(t.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(be(t,()=>t.shaderSource(n,e)),be(t,()=>t.compileShader(n)),t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw console.log(t.getShaderInfoLog(n)),new Error("Failed to compile vertex shader.");return n}function vte(t,e){const n=vi(t,()=>t.createShader(t.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(be(t,()=>t.shaderSource(n,e)),be(t,()=>t.compileShader(n)),K().get("ENGINE_COMPILE_ONLY"))return n;if(t.getShaderParameter(n,t.COMPILE_STATUS)===!1)throw JL(e,t.getShaderInfoLog(n)),new Error("Failed to compile fragment shader.");return n}const wte=/ERROR: [0-9]+:([0-9]+):/g;function JL(t,e){const n=wte.exec(e);if(n==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(t);return}const s=+n[1],r=t.split(`
`),o=r.length.toString().length+2,i=r.map((d,h)=>Ec((h+1).toString(),o)+d);let a=0;for(let d=0;d<i.length;d++)a=Math.max(i[d].length,a);const l=i.slice(0,s-1),c=i.slice(s-1,s),u=i.slice(s);console.log(l.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${Ec(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(u.join(`
`))}function kte(t){return vi(t,()=>t.createProgram(),"Unable to create WebGLProgram.")}function Cte(t,e){if(be(t,()=>t.linkProgram(e)),!K().get("ENGINE_COMPILE_ONLY")&&t.getProgramParameter(e,t.LINK_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Yb(t,e){if(be(t,()=>t.validateProgram(e)),t.getProgramParameter(e,t.VALIDATE_STATUS)===!1)throw console.log(t.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function Ste(t,e){const n=vi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),be(t,()=>t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function $te(t,e){const n=vi(t,()=>t.createBuffer(),"Unable to create WebGLBuffer");return be(t,()=>t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,n)),be(t,()=>t.bufferData(t.ELEMENT_ARRAY_BUFFER,e,t.STATIC_DRAW)),n}function Ite(t){return vi(t,()=>t.createTexture(),"Unable to create WebGLTexture.")}function Tte(t,e){const n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(t<=0||e<=0){const s=`[${t}x${e}]`;throw new Error("Requested texture size "+s+" is invalid.")}if(t>n||e>n){const s=`[${t}x${e}]`,r=`[${n}x${n}]`;throw new Error("Requested texture size "+s+" greater than WebGL maximum on this browser / GPU "+r+".")}}function Ete(t){return vi(t,()=>t.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function WT(t,e,n,s,r,o,i){const a=t.getAttribLocation(e,n);return a===-1?!1:(be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,s)),be(t,()=>t.vertexAttribPointer(a,r,t.FLOAT,!1,o,i)),be(t,()=>t.enableVertexAttribArray(a)),!0)}function Nte(t,e,n){Fte(t,n),be(t,()=>t.activeTexture(t.TEXTURE0+n)),be(t,()=>t.bindTexture(t.TEXTURE_2D,e))}function _te(t,e,n){return vi(t,()=>t.getUniformLocation(e,n),'uniform "'+n+'" not present in program.')}function Rte(t,e,n){return t.getUniformLocation(e,n)}function Ate(t,e,n,s){be(t,()=>Nte(t,e,s)),be(t,()=>t.uniform1i(n,s))}function Qb(t,e,n){be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,n)),be(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,e,0))}function UT(t,e){be(t,()=>t.bindFramebuffer(t.FRAMEBUFFER,e)),be(t,()=>t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,null,0))}function zp(t){const e=t.checkFramebufferStatus(t.FRAMEBUFFER);if(e!==t.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+Dte(t,e))}function Dte(t,e){switch(e){case t.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case t.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case t.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function vi(t,e,n){const s=be(t,()=>e());if(s==null)throw new Error(n);return s}function Fte(t,e){const n=t.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,s=e+t.TEXTURE0;if(s<t.TEXTURE0||s>n){const r=`[gl.TEXTURE0, gl.TEXTURE${n}]`;throw new Error(`textureUnit must be in ${r}.`)}}function nu(t,e=2){return Z(t.slice(0,t.length-e))}function su(t){if(t.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[t.length>1?t[t.length-2]:1,t[t.length-1]]}function Bp(t){let e=[1,1,1];return t.length===0||t.length===1&&t[0]===1||(e=[nu(t),...su(t)]),e}function Ote(t,e=!1){let n=K().getNumber("WEBGL_MAX_TEXTURE_SIZE"),s=K().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");s===1/0&&K().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(s=n/2),e&&(n=n*2,s=s*2,t=t.map((a,l)=>l>=t.length-2?Ak(t[l]):t[l]),t.length===1&&(t=[2,t[0]])),t.length!==2&&(t=pa(t).newShape);let r=Z(t),o=null;t.length<=1&&r<=n?o=[1,r]:t.length===2&&t[0]<=n&&t[1]<=n?o=t:t.length===3&&t[0]*t[1]<=n&&t[2]<=n?o=[t[0]*t[1],t[2]]:t.length===3&&t[0]<=n&&t[1]*t[2]<=n?o=[t[0],t[1]*t[2]]:t.length===4&&t[0]*t[1]*t[2]<=n&&t[3]<=n?o=[t[0]*t[1]*t[2],t[3]]:t.length===4&&t[0]<=n&&t[1]*t[2]*t[3]<=n&&(o=[t[0],t[1]*t[2]*t[3]]);const i=o!=null&&Math.max(...o)>s&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=nu(t);let l=2,c=2;t.length&&([l,c]=su(t)),r=a*(l/2)*(c/2),o=xv(r).map(u=>u*2)}else o=xv(r);return o}function Vp(t){return t%2===0}function Vg(t,e){if(t=t.slice(-2),e=e.slice(-2),lt(t,e)||!t.length||!e.length||t[0]===0||t[1]===0||e[0]===0||e[1]===0)return!0;if(t.length!==e.length){const n=t[t.length-1],s=e[e.length-1];if(n===s||Vp(n)&&Vp(s)&&(t[0]===1||e[0]===1))return!0}return t[1]===e[1]&&Vp(t[0])&&Vp(e[0])}let Zb,Jb;function Pte(t){if(Zb==null){const e=io(t);Zb=e.getParameter(e.MAX_TEXTURE_SIZE)}return Zb}function Mte(t){if(Jb==null){const e=io(t);Jb=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Jb)}function Lte(t){if(t===0)return 0;let e;const n=io(t);return $r(n,"EXT_disjoint_timer_query_webgl2")&&t===2?e=2:$r(n,"EXT_disjoint_timer_query")?e=1:e=0,e}function $r(t,e){return t.getExtension(e)!=null}function HT(t){try{if(io(t)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function zte(t){if(t===0)return!1;const e=io(t);if(t===1){if(!$r(e,"OES_texture_float"))return!1}else if(!$r(e,"EXT_color_buffer_float"))return!1;return Zv(e)}function Bte(t){if(t===0)return!1;const e=io(t);if(t===1){if(!$r(e,"OES_texture_float")||!$r(e,"WEBGL_color_buffer_float"))return!1}else{if($r(e,"EXT_color_buffer_float"))return Zv(e);const s="EXT_color_buffer_half_float";if($r(e,s)){const r=e.getExtension(s);return Vte(e,r)}return!1}return Zv(e)}function Zv(t){const e=h$(t),n=t.createTexture();t.bindTexture(t.TEXTURE_2D,n);const s=1,r=1;t.texImage2D(t.TEXTURE_2D,0,e.internalFormatFloat,s,r,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,o),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,n,0);const i=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(n),t.deleteFramebuffer(o),i}function Vte(t,e){const n=h$(t,e),s=t.createTexture();t.bindTexture(t.TEXTURE_2D,s);const r=1,o=1;t.texImage2D(t.TEXTURE_2D,0,n.internalFormatHalfFloat,r,o,0,n.textureFormatFloat,n.textureTypeHalfFloat,null);const i=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,i),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,s,0);const a=t.checkFramebufferStatus(t.FRAMEBUFFER)===t.FRAMEBUFFER_COMPLETE;return t.bindTexture(t.TEXTURE_2D,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.deleteTexture(s),t.deleteFramebuffer(i),a}function Wte(t){return t!==2?!1:io(t).fenceSync!=null}function Qf(t,e){Array.isArray(t)||(t=[t]),t.forEach(n=>{n!=null&&T(n.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Se=K();Se.registerFlag("HAS_WEBGL",()=>Se.getNumber("WEBGL_VERSION")>0);Se.registerFlag("WEBGL_VERSION",()=>HT(2)?2:HT(1)?1:0);Se.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Se.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Se.get("WEBGL_VERSION")===2);Se.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Se.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Se.registerFlag("WEBGL_PACK",()=>Se.getBool("HAS_WEBGL"));Se.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_CLIP",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_REDUCE",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_LAZILY_UNPACK",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_CONV_IM2COL",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_PACK_CONV2DTRANSPOSE",()=>Se.getBool("WEBGL_PACK"));Se.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>Pte(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>Mte(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const t=Se.getNumber("WEBGL_VERSION");return t===0?0:Lte(t)});Se.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Se.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!YD());Se.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>zte(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Se.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Se.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Se.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>Bte(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_FENCE_API_ENABLED",()=>Wte(Se.getNumber("WEBGL_VERSION")));Se.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Se.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Se.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${t}.`)});Se.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>YD()?1:-1,t=>{if(typeof t!="number")throw new Error(`WEBGL_FLUSH_THRESHOLD must be a number but got ${t}.`);if(t<0&&t!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${t}.`)});Se.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Se.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Se.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Se.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Se.registerFlag("WEBGL_EXP_CONV",()=>!1);Se.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Se.getBool("IS_TEST"));Se.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Se.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Se.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);Se.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ps(){let t,e,n,s,r,o,i,a,l,c;return K().getNumber("WEBGL_VERSION")===2?(t="#version 300 es",e="in",n="out",s="in",r="texture",o="outputColor",i="out vec4 outputColor;",a=K().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",l="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(t="",e="attribute",n="varying",s="varying",r="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,l=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:t,attribute:e,varyingVs:n,varyingFs:s,texture2D:r,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:l,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vl(t,e,n="index"){const s=Te(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / ${r}`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * ${r}`:`index -= ${t[o]} * ${r}`;return`${i}; ${a};`}).join("")}function sy(t,e,n="index"){const s=Te(e);return s.map((r,o)=>{const i=`int ${t[o]} = ${n} / outShapeStrides[${o}]`,a=o===s.length-1?`int ${t[o+1]} = ${n} - ${t[o]} * outShapeStrides[${o}]`:`index -= ${t[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function Ute(t,e){const n=t.length,s=t.map(o=>`${e}[${o}]`),r=new Array(n-1);r[n-2]=s[n-1];for(let o=n-3;o>=0;--o)r[o]=`(${r[o+1]} * ${s[o+1]})`;return r}function Hte(t,e,n="index"){const s=t.map((o,i)=>i),r=Ute(s,e);return r.map((o,i)=>{const a=`int ${t[i]} = ${n} / ${r[i]}`,l=i===r.length-1?`int ${t[i+1]} = ${n} - ${t[i]} * ${r[i]}`:`index -= ${t[i]} * ${r[i]}`;return`${a}; ${l};`}).join("")}function f$(t){const e=Te(t).map(n=>n.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function p$(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const e3=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:t3}=A8;function Gte(t,e,n){const s=[];if(t.forEach(f=>{const p=Z(f.shapeInfo.logicalShape);if(f.shapeInfo.isUniform?s.push(`uniform float ${f.name}${p>1?`[${p}]`:""};`):(s.push(`uniform sampler2D ${f.name};`),s.push(`uniform int offset${f.name};`)),n.enableShapeUniforms){const{uniformShape:m}=m$(n.packedInputs,f.shapeInfo.logicalShape,f.shapeInfo.texShape);switch(m.length){case 1:s.push(`uniform int ${f.name}Shape;`);break;case 2:s.push(`uniform ivec2 ${f.name}Shape;`);break;case 3:s.push(`uniform ivec3 ${f.name}Shape;`);break;case 4:s.push(`uniform ivec4 ${f.name}Shape;`);break}s.push(`uniform ivec2 ${f.name}TexShape;`)}}),n.enableShapeUniforms){switch(e.logicalShape.length){case 1:s.push("uniform int outShape;");break;case 2:s.push("uniform ivec2 outShape;"),s.push("uniform int outShapeStrides;");break;case 3:s.push("uniform ivec3 outShape;"),s.push("uniform ivec2 outShapeStrides;");break;case 4:s.push("uniform ivec4 outShape;"),s.push("uniform ivec3 outShapeStrides;");break}s.push("uniform ivec2 outTexShape;")}n.customUniforms&&n.customUniforms.forEach(f=>{s.push(`uniform ${f.type} ${f.name}${f.arrayIndex?`[${f.arrayIndex}]`:""};`)});const r=s.join(`
`),o=t.map(f=>jte(f,e,n.packedInputs,n.enableShapeUniforms)).join(`
`),i=e.texShape,a=ps(),l=qte(a);let c,u,d=Zte(a);return e.isPacked?(c=Kte(e.logicalShape,i,n.enableShapeUniforms),u=Qte(a)):(c=Xte(e.logicalShape,i,n.enableShapeUniforms),u=Yte(a)),n.packedInputs&&(d+=nne),[d,l,u,r,c,o,n.userCode].join(`
`)}function Su(t,e=!1){const n=t.shapeInfo.logicalShape;switch(n.length){case 0:return pne(t,e);case 1:return gne(t,e);case 2:return yne(t,e);case 3:return vne(t,e);case 4:return kne(t,e);case 5:return Cne(t);case 6:return Sne(t);default:throw new Error(`${n.length}-D input sampling is not yet supported`)}}function n3(t,e){switch(t.shapeInfo.logicalShape.length){case 0:return fne(t);case 1:return mne(t,e);case 2:return xne(t,e);case 3:return bne(t,e);default:return wne(t,e)}}function jte(t,e,n=!1,s){let r="";n?r+=n3(t,s):r+=Su(t,s);const o=t.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(n?r+=$ne(t,e):r+=Ine(t,e)),r}function Kte(t,e,n){switch(t.length){case 0:return s3();case 1:return sne(t,e,n);case 2:return dne(t,e,n);case 3:return one(t,e,n);default:return ane(t,e,n)}}function Xte(t,e,n){switch(t.length){case 0:return s3();case 1:return rne(t,e,n);case 2:return hne(t,e,n);case 3:return ine(t,e,n);case 4:return lne(t,e,n);case 5:return cne(t,e);case 6:return une(t,e);default:throw new Error(`${t.length}-D output sampling is not yet supported`)}}function qte(t){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${t.texture2D}(textureSampler, uv).r;
    }
  `}function Yte(t){return`
    void setOutput(float val) {
      ${t.output} = vec4(val, 0, 0, 0);
    }
  `}function Qte(t){return`
    void setOutput(vec4 val) {
      ${t.output} = val;
    }
  `}function Zte(t){return`${t.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${t.varyingFs} vec2 resultUV;
    ${t.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${t.defineSpecialNaN}
    ${t.defineSpecialInf}
    ${t.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${Jte}
    ${ene}
    ${tne}
  `}const Jte=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,ene=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,tne=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,nne=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function s3(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function sne(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return s[0]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${s[1]}.0);
      }
    `:s[1]===1?n?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${s[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      return 2 * (resTexRC.x * ${s[1]} + resTexRC.y);
    }
  `}function rne(t,e,n){return e[0]===1?n?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?n?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:n?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function one(t,e,n){if(n)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[2]/2),o=r*Math.ceil(t[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec3(b, r, c);
    }
  `}function ine(t,e,n){if(n)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${sy(["r","c","d"],t)}
    return ivec3(r, c, d);
  }
`;const s=Vl(["r","c","d"],t);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec3(r, c, d);
    }
  `}function ane(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],r=Math.ceil(t[t.length-1]/2),o=r*Math.ceil(t[t.length-2]/2);let i=o,a="",l="b, r, c";for(let c=2;c<t.length-1;c++)i*=t[t.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,l=`b${c}, `+l;return`
    ivec${t.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));
      int index = resTexRC.x * ${s[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec${t.length}(${l});
    }
  `}function lne(t,e,n){if(n)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${sy(["r","c","d","d2"],t)}
      return ivec4(r, c, d, d2);
    }
  `;const s=Vl(["r","c","d","d2"],t);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${s}
      return ivec4(r, c, d, d2);
    }
  `}function cne(t,e){const n=Vl(["r","c","d","d2","d3"],t);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function une(t,e){const n=Vl(["r","c","d","d2","d3","d4"],t);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${n}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function dne(t,e,n){const s=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(lt(t,e))return n?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${s[0]}, ${s[1]}));
      }
    `;const r=Math.ceil(t[1]/2);return n?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${s[0]}, ${s[1]}));

      int index = resTexRC.x * ${s[1]} + resTexRC.y;
      int r = 2 * (index / ${r});
      int c = imod(index, ${r}) * 2;

      return ivec2(r, c);
    }
  `}function hne(t,e,n){return lt(t,e)?n?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:t[1]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:t[0]===1?n?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:n?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${t[1]};
      int c = index - r * ${t[1]};
      return ivec2(r, c);
    }
  `}function Wl(t){return`offset${t}`}function fne(t){const e=t.name,n="get"+e.charAt(0).toUpperCase()+e.slice(1),s=ps();return`
    vec4 ${n}() {
      return ${s.texture2D}(${e}, halfCR);
    }
  `}function pne(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`float ${s}() {return ${n};}`;const[r,o]=t.shapeInfo.texShape;if(r===1&&o===1)return`
      float ${s}() {
        return sampleTexture(${n}, halfCR);
      }
    `;const i=Wl(n);if(e)return`
    float ${s}() {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], ${i});
      return sampleTexture(${n}, uv);
    }
  `;const[a,l]=t.shapeInfo.texShape;return`
    float ${s}() {
      vec2 uv = uvFromFlat(${a}, ${l}, ${i});
      return sampleTexture(${n}, uv);
    }
  `}function mne(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=t.shapeInfo.texShape,o=ps();if(e)return`
    vec4 ${s}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${n}, uv);
    }
  `;const i=[Math.ceil(r[0]/2),Math.ceil(r[1]/2)];return`
    vec4 ${s}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${n}, uv);
    }
  `}function gne(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1);if(t.shapeInfo.isUniform)return`
      float ${s}(int index) {
        ${$u(t)}
      }
    `;const r=t.shapeInfo.texShape,o=r[0],i=r[1];if(i===1&&o===1)return`
      float ${s}(int index) {
        return sampleTexture(${n}, halfCR);
      }
    `;const a=Wl(n);return i===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${n}TexShape[0]));
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${n}, uv);
      }
    `:o===1?e?`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${n}TexShape[1]), 0.5);
        return sampleTexture(${n}, uv);
      }
    `:`
      float ${s}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${n}, uv);
      }
    `:e?`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${n}TexShape[0], ${n}TexShape[1], index + ${a});
      return sampleTexture(${n}, uv);
    }
  `:`
    float ${s}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${n}, uv);
    }
  `}function xne(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=o[0],a=o[1],l=ps();if(o!=null&&lt(n,o))return e?`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);

        return ${l.texture2D}(${s}, uv);
      }
    `:`
      vec4 ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${l.texture2D}(${s}, uv);
      }
    `;if(e)return`
    vec4 ${r}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `;const c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],u=Math.ceil(n[1]/2);return`
    vec4 ${r}(int row, int col) {
      vec2 uv = packedUVfrom2D(${u}, ${c[0]}, ${c[1]}, row, col);
      return ${l.texture2D}(${s}, uv);
    }
  `}function yne(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape;if(o!=null&&lt(n,o)){if(e)return`
      float ${r}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `;const h=o[0],f=o[1];return`
    float ${r}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${f}.0, ${h}.0);
      return sampleTexture(${s}, uv);
    }
  `}const{newShape:i,keptDims:a}=pa(n),l=i;if(l.length<n.length){const h=Iu(t,l),f=["row","col"];return`
      ${Su(h,e)}
      float ${r}(int row, int col) {
        return ${r}(${Tu(f,a)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${n[1]}, 1)));
        ${$u(t)}
      }
    `;const c=o[0],u=o[1],d=Wl(s);return u===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${s}TexShape[0]));
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${s}, uv);
    }
  `:c===1?e?`
      float ${r}(int row, int col) {
        float index = dot(vec3(row, col, ${d}), vec3(${s}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${s}TexShape[1]), 0.5);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col) {
      float index = dot(vec3(row, col, ${d}), vec3(${n[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${u}.0, 0.5);
      return sampleTexture(${s}, uv);
    }
  `:e?`
      float ${r}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${s}Shape[1] + col + ${d};
        vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
        return sampleTexture(${s}, uv);
      }
    `:`
  float ${r}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${n[1]} + col + ${d};
    vec2 uv = uvFromFlat(${c}, ${u}, index);
    return sampleTexture(${s}, uv);
  }
`}function bne(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=t.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(n[0]===1){const h=n.slice(1),f=[1,2],p=Iu(t,h),m=["b","row","col"];return`
        ${n3(p,e)}
        vec4 ${r}(int b, int row, int col) {
          return ${r}(${Tu(m,f)});
        }
      `}const a=ps();if(e)return`
    vec4 ${r}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${s}TexShape[0]) / 2.0), ceil(float(${s}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${s}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${s}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `;const l=i[0],c=i[1],u=Math.ceil(n[2]/2),d=u*Math.ceil(n[1]/2);return`
    vec4 ${r}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${l}, ${c}, ${d}, ${u}, b, row, col);
      return ${a.texture2D}(${s}, uv);
    }
  `}function vne(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[1]*n[2],i=n[2],{newShape:a,keptDims:l}=pa(n),c=a;if(c.length<n.length){const m=Iu(t,c),x=["row","col","depth"];return`
        ${Su(m,e)}
        float ${r}(int row, int col, int depth) {
          return ${r}(${Tu(x,l)});
        }
      `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${$u(t)}
      }
    `;const u=t.shapeInfo.texShape,d=u[0],h=u[1],f=t.shapeInfo.flatOffset;if(h===o&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        int stride1 = ${s}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
        float ${r}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${h}.0, ${d}.0);
          return sampleTexture(${s}, uv);
        }
      `;if(h===i&&f==null)return e?`
      float ${r}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${s}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
    float ${r}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${n[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${h}.0, ${d}.0);
      return sampleTexture(${s}, uv);
    }
  `;const p=Wl(s);return e?`
    float ${r}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${s}Shape[1] * ${s}Shape[2];
      int stride1 = ${s}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${p};
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index);
      return sampleTexture(${s}, uv);
    }
    `:`
      float ${r}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${p};
        vec2 uv = uvFromFlat(${d}, ${h}, index);
        return sampleTexture(${s}, uv);
      }
  `}function wne(t,e){const n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=ps();if(e)return`
    vec4 ${s}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${n}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${n}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${n}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${n}TexShape[0]) / 2.0), ceil(float(${n}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${r.texture2D}(${n}, uv);
    }
  `;const o=t.shapeInfo.logicalShape,i=o.length,a=t.shapeInfo.texShape,l=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=l[0],u=l[1],d=Math.ceil(o[i-1]/2);let h=d*Math.ceil(o[i-2]/2),f="int b, int row, int col",p=`b * ${h} + (row / 2) * ${d} + (col / 2)`;for(let m=2;m<i-1;m++)f=`int b${m}, `+f,h*=o[i-m-1],p=`b${m} * ${h} + `+p;return`
    vec4 ${s}(${f}) {
      int index = ${p};
      int texR = index / ${u};
      int texC = index - texR * ${u};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${u}, ${c});
      return ${r.texture2D}(${n}, uv);
    }
  `}function kne(t,e){const n=t.shapeInfo.logicalShape,s=t.name,r="get"+s.charAt(0).toUpperCase()+s.slice(1),o=n[3],i=n[2]*o,a=n[1]*i,{newShape:l,keptDims:c}=pa(n);if(l.length<n.length){const y=Iu(t,l),b=["row","col","depth","depth2"];return`
      ${Su(y,e)}
      float ${r}(int row, int col, int depth, int depth2) {
        return ${r}(${Tu(b,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${$u(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1],p=`int stride2 = ${s}Shape[3];`,m=`int stride1 = ${s}Shape[2] * stride2;`,x=`int stride0 = ${s}Shape[1] * stride1;`;if(f===a&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        ${p}
        ${m}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;if(f===o&&u==null)return e?`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${s}Shape[1] * ${s}Shape[2], ${s}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${s}TexShape[1], ${s}TexShape[0]);
        return sampleTexture(${s}, uv);
      }
    `:`
      float ${r}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${n[1]*n[2]}, ${n[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${s}, uv);
      }
    `;const g=Wl(s);return e?`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${p}
      ${m}
      ${x}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${s}TexShape[0], ${s}TexShape[1], index + ${g});
      return sampleTexture(${s}, uv);
    }
  `:`
    float ${r}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${h}, ${f}, index + ${g});
      return sampleTexture(${s}, uv);
    }
  `}function Cne(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),r=e[4],o=e[3]*r,i=e[2]*o,a=e[1]*i,{newShape:l,keptDims:c}=pa(e);if(l.length<e.length){const m=Iu(t,l),x=["row","col","depth","depth2","depth3"];return`
      ${Su(m)}
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        return ${s}(${Tu(x,c)});
      }
    `}if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${r})) +
          depth3;
        ${$u(t)}
      }
    `;const u=t.shapeInfo.flatOffset,d=t.shapeInfo.texShape,h=d[0],f=d[1];if(f===a&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${r}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(f===r&&u==null)return`
      float ${s}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${f}.0, ${h}.0);
        return sampleTexture(${n}, uv);
      }
    `;const p=Wl(n);return`
    float ${s}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${r} + depth3 + ${p};
      vec2 uv = uvFromFlat(${h}, ${f}, index);
      return sampleTexture(${n}, uv);
    }
  `}function Sne(t){const e=t.shapeInfo.logicalShape,n=t.name,s="get"+n.charAt(0).toUpperCase()+n.slice(1),{newShape:r,keptDims:o}=pa(e);if(r.length<e.length){const x=Iu(t,r),g=["row","col","depth","depth2","depth3","depth4"];return`
      ${Su(x)}
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${s}(${Tu(g,o)});
      }
    `}const i=e[5],a=e[4]*i,l=e[3]*a,c=e[2]*l,u=e[1]*c;if(t.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${u}, ${c}, ${l}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${$u(t)}
      }
    `;const d=t.shapeInfo.flatOffset,h=t.shapeInfo.texShape,f=h[0],p=h[1];if(p===u&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${l}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;if(p===i&&d==null)return`
      float ${s}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${p}.0, ${f}.0);
        return sampleTexture(${n}, uv);
      }
    `;const m=Wl(n);return`
    float ${s}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${u} + col * ${c} + depth * ${l} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${m};
      vec2 uv = uvFromFlat(${f}, ${p}, index);
      return sampleTexture(${n}, uv);
    }
  `}function $u(t){const e=t.name,n=Z(t.shapeInfo.logicalShape);return n<2?`return ${e};`:`
    for (int i = 0; i < ${n}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function $ne(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=t.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=t3(t.shapeInfo.logicalShape,e.logicalShape),l=yt(i),c=i-o;let u;const d=["x","y","z","w","u","v"];o===0?u="":i<2&&a.length>=1?u="coords = 0;":u=a.map(y=>`coords.${d[y+c]} = 0;`).join(`
`);let h="";i<2&&o>0?h="coords":h=t.shapeInfo.logicalShape.map((y,b)=>`coords.${d[b+c]}`).join(", ");let f="return outputValue;";const m=Z(t.shapeInfo.logicalShape)===1,g=Z(e.logicalShape)===1;if(o===1&&!m&&!g)f=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(m&&!g)i===1?f=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:f=`
        return vec4(outputValue.x);
      `;else if(a.length){const y=o-2,b=o-1;a.indexOf(y)>-1&&a.indexOf(b)>-1?f="return vec4(outputValue.x);":a.indexOf(y)>-1?f="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(b)>-1&&(f="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${r}() {
      ${l} coords = getOutputCoords();
      ${u}
      vec4 outputValue = get${s}(${h});
      ${f}
    }
  `}function Ine(t,e){const n=t.name,s=n.charAt(0).toUpperCase()+n.slice(1),r="get"+s+"AtOutCoords",o=e.texShape,i=t.shapeInfo.texShape,a=t.shapeInfo.logicalShape.length,l=e.logicalShape.length;if(!t.shapeInfo.isUniform&&a===l&&t.shapeInfo.flatOffset==null&&lt(i,o))return`
      float ${r}() {
        return sampleTexture(${n}, resultUV);
      }
    `;const c=yt(l),u=t3(t.shapeInfo.logicalShape,e.logicalShape),d=l-a;let h;const f=["x","y","z","w","u","v"];a===0?h="":l<2&&u.length>=1?h="coords = 0;":h=u.map(m=>`coords.${f[m+d]} = 0;`).join(`
`);let p="";return l<2&&a>0?p="coords":p=t.shapeInfo.logicalShape.map((m,x)=>`coords.${f[x+d]}`).join(", "),`
    float ${r}() {
      ${c} coords = getOutputCoords();
      ${h}
      return get${s}(${p});
    }
  `}function yt(t){if(t<=1)return"int";if(t===2)return"ivec2";if(t===3)return"ivec3";if(t===4)return"ivec4";if(t===5)return"ivec5";if(t===6)return"ivec6";throw Error(`GPU for rank ${t} is not yet supported`)}function m$(t,e,n){const{newShape:s,keptDims:r}=pa(e),o=e.length,i=t&&o===3&&e[0]===1,a=i?e.slice(1):s,l=!t&&o>1&&!lt(e,n)&&s.length<o||i;return{useSqueezeShape:l,uniformShape:l?a:e,keptDims:r}}function Iu(t,e){const n=JSON.parse(JSON.stringify(t));return n.shapeInfo.logicalShape=e,n}function Tu(t,e){return e.map(n=>t[n]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tne(t,e,n,s){const r=n.map((u,d)=>{const h={logicalShape:u.shape,texShape:u.isUniform?null:u.texData.texShape,isUniform:u.isUniform,isPacked:u.isUniform?!1:u.texData.isPacked,flatOffset:null};return u.texData!=null&&u.texData.slice!=null&&u.texData.slice.flatOffset>0&&(h.flatOffset=u.texData.slice.flatOffset),{name:e.variableNames[d],shapeInfo:h}}),o=r.map(u=>u.shapeInfo),i={logicalShape:s.shape,texShape:s.texData.texShape,isUniform:!1,isPacked:s.texData.isPacked,flatOffset:null},a=Gte(r,i,e),l=vte(t.gl,a),c=t.createProgram(l);return K().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i,variablesLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:(t.buildVao(c),Object.assign({program:e,fragmentShader:l,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i},r3(t,e,c)))}function r3(t,e,n){const s=[],r=[];let o,i,a,l=null,c=null;c=t.getUniformLocation(n,"NAN",!1),K().getNumber("WEBGL_VERSION")===1&&(l=t.getUniformLocation(n,"INFINITY",!1));const u=!1;for(const d of e.variableNames){const h={name:d,uniform:t.getUniformLocation(n,d,u),offset:t.getUniformLocation(n,`offset${d}`,u)};e.enableShapeUniforms&&(h.shape=t.getUniformLocation(n,`${d}Shape`,u),h.texShape=t.getUniformLocation(n,`${d}TexShape`,u)),s.push(h)}if(e.enableShapeUniforms&&(o=t.getUniformLocation(n,"outShape",u),a=t.getUniformLocation(n,"outShapeStrides",u),i=t.getUniformLocation(n,"outTexShape",u)),e.customUniforms)for(const d of e.customUniforms)r.push(t.getUniformLocation(n,d.name,u));return{variablesLocations:s,customUniformLocations:r,infLoc:l,nanLoc:c,outShapeLocation:o,outShapeStridesLocation:a,outTexShapeLocation:i}}function GT(t,e){if(t.length!==e.length)throw Error(`Binary was compiled with ${t.length} inputs, but was executed with ${e.length} inputs`);t.forEach((n,s)=>{const r=n.logicalShape,o=e[s],i=o.shape;if(!lt(r,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${r} and ${i} must match`);if(n.isUniform&&o.isUniform)return;const a=n.texShape,l=o.isUniform?null:o.texData.texShape;if(!lt(a,l))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${l} must match`)})}function Ene(t,e,n,s,r){e.program.enableShapeUniforms||(GT(e.inShapeInfos,n),GT([e.outShapeInfo],[s]));const o=s.texData.texture,i=s.texData.texShape;s.texData.isPacked?t.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):t.setOutputMatrixTexture(o.texture,i[0],i[1]),t.setProgram(e.webGLProgram),t.bindVertexArray(e.webGLProgram.vao),K().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&t.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&t.gl.uniform1f(e.nanLoc,NaN);for(let l=0;l<n.length;++l){const c=n[l],{uniform:u,offset:d,shape:h,texShape:f}=e.variablesLocations[l];if(h){const{uniformShape:p}=m$(e.program.packedInputs,c.shape,c.texData.texShape);switch(p.length){case 1:t.gl.uniform1iv(h,new Int32Array(p));break;case 2:t.gl.uniform2iv(h,new Int32Array(p));break;case 3:t.gl.uniform3iv(h,new Int32Array(p));break;case 4:t.gl.uniform4iv(h,new Int32Array(p));break}}if(f&&t.gl.uniform2i(f,c.texData.texShape[0],c.texData.texShape[1]),u!=null){if(c.isUniform){if(Z(c.shape)<2)t.gl.uniform1f(u,c.uniformValues[0]);else{let p=c.uniformValues;p instanceof Float32Array||(p=new Float32Array(p)),t.gl.uniform1fv(u,p)}continue}c.texData.slice!=null&&d!=null&&t.gl.uniform1i(d,c.texData.slice.flatOffset),t.setInputMatrixTexture(c.texData.texture.texture,u,l)}}const a=e.outShapeLocation;if(a)switch(s.shape.length){case 1:t.gl.uniform1iv(a,new Int32Array(s.shape));break;case 2:t.gl.uniform2iv(a,new Int32Array(s.shape));break;case 3:t.gl.uniform3iv(a,new Int32Array(s.shape));break;case 4:t.gl.uniform4iv(a,new Int32Array(s.shape));break}if(e.outShapeStridesLocation){const l=Te(s.shape);switch(s.shape.length){case 2:t.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(l));break;case 3:t.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(l));break;case 4:t.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(l));break}}if(e.outTexShapeLocation&&t.gl.uniform2i(e.outTexShapeLocation,s.texData.texShape[0],s.texData.texShape[1]),e.program.customUniforms&&r)for(let l=0;l<e.program.customUniforms.length;++l){const c=e.program.customUniforms[l],u=e.customUniformLocations[l],d=r[l];if(c.type==="float")t.gl.uniform1fv(u,d);else if(c.type==="vec2")t.gl.uniform2fv(u,d);else if(c.type==="vec3")t.gl.uniform3fv(u,d);else if(c.type==="vec4")t.gl.uniform4fv(u,d);else if(c.type==="int")t.gl.uniform1iv(u,d);else if(c.type==="ivec2")t.gl.uniform2iv(u,d);else if(c.type==="ivec3")t.gl.uniform3iv(u,d);else if(c.type==="ivec4")t.gl.uniform4iv(u,d);else throw Error(`uniform type ${c.type} is not supported yet.`)}t.executeProgram()}function Nne(t,e,n){let s="";e.concat(n).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(t.enableShapeUniforms&&!i.isUniform){const l=i.texData.texShape,{useSqueezeShape:c,uniformShape:u,keptDims:d}=m$(t.packedInputs,i.shape,l);let h="",f="",p="";if(u.length===1&&t.packedInputs){const w=[Math.ceil(l[0]/2),Math.ceil(l[1]/2)];h=`${w[0]>1}_${w[1]>1}`}else if(u.length===2&&!t.packedInputs)f=`${u[0]>1}_${u[1]>1}`;else if(u.length>2&&!t.packedInputs){const w=Te(u);p=`${w[0]===l[1]}_${w[w.length-1]===l[1]}`}const m=i.shape.length,x=u.length===2&&lt(i.shape,l),g=Z(i.shape)===1,y=qc(i.shape,n.shape),b=!t.packedInputs&&m===n.shape.length&&lt(l,n.texData.texShape),v=t.packedInputs||u.length>2?"":`${l[0]>1}_${l[1]>1}`;s+=`${m}_${b}_${c?d:""}_${u.length}_${g}_${y}_${x}_${h}_${f}_${p}_${v}_${a}`}else{const l=i.isUniform?"uniform":i.texData.texShape;s+=`${i.shape}_${l}_${a}`}});const r=t.userCode;let o=t.constructor.name;return o+="_"+s+"_"+r+`${K().getNumber("WEBGL_VERSION")}`,o}function Jn(t){return K().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&t<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _ne{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=mh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ps();this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?sy(["r","c","d"],e):Vl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Rne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=mh.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const n=ps();this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?sy(["r","c","d"],e):Vl(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ane{constructor(e){this.variableNames=["A"],this.outTexUsage=Ys.DOWNLOAD;const n=ps();this.outputShape=e,this.userCode=`
      ${e3}

      void main() {
        float x = getAAtOutCoords();
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Dne{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Ys.DOWNLOAD;const n=ps();this.outputShape=e,this.userCode=`
      ${e3}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${n.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fne={R:0,G:1,B:2,A:3};class jT{constructor(e,n=!1,s="RGBA"){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=ps();this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length);let o="result";n&&(o="floor(result * 255. + 0.5)");let i="";for(let a=0;a<s.length;a++){const l=s[a];i+=`
          if(offset == ${a}) {
            result = values[${Fne[l]}];
          }`}this.userCode=`
      ${this.enableShapeUniforms?p$():f$(e)}

      void main() {
        ivec3 coords = getOutputCoords();
        int flatIndex = getFlatIndex(coords);
        float result = 0.;
        int offset = imod(flatIndex, ${s.length});

        flatIndex = idiv(flatIndex, ${s.length}, 1.);

        int r = flatIndex / texShape[1];
        if (r < texShape[0]) {
          int c = imod(flatIndex, texShape[1]);
          vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
          vec4 values = ${r.texture2D}(A, uv);
          ${i}
        }
        ${r.output} = vec4(${o}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class One{constructor(e,n=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const s=ps();this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length);let r="",o="result";n&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const l=i*2+a;r+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${s.texture2D}(A, uv);

            if (offset == 0) {
              result[${l}] = values[0];
            } else if (offset == 1) {
              result[${l}] = values[1];
            } else if (offset == 2) {
              result[${l}] = values[2];
            } else {
              result[${l}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?p$():f$(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${r}

          ${s.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pne(t){const e=ps(),n=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return bte(t,n)}function Mne(t){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return Ste(t,e)}function Lne(t){const e=new Uint16Array([0,1,2,2,1,3]);return $te(t,e)}function Zf(t,e,n,s,r,o){Tte(e,n);const i=Ite(t),a=t.TEXTURE_2D;return be(t,()=>t.bindTexture(a,i)),be(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE)),be(t,()=>t.texParameteri(a,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)),be(t,()=>t.texParameteri(a,t.TEXTURE_MIN_FILTER,t.NEAREST)),be(t,()=>t.texParameteri(a,t.TEXTURE_MAG_FILTER,t.NEAREST)),K().getNumber("WEBGL_VERSION")===1?be(t,()=>t.texImage2D(a,0,s,e,n,0,r,o,null)):be(t,()=>t.texStorage2D(a,1,s,e,n)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null)),{texture:i,texShape:[n,e]}}function o3(t){return t.internalFormatFloat}function zne(t,e,n,s){const[r,o]=Yf(e,n);return Zf(t,r,o,o3(s),s.textureFormatFloat,t.FLOAT)}function i3(t){return t.internalFormatHalfFloat}function Bne(t,e,n,s){const[r,o]=Yf(e,n);return Zf(t,r,o,i3(s),s.textureFormatFloat,s.textureTypeHalfFloat)}function a3(t){return t.downloadTextureFormat}function Vne(t,e,n,s){const[r,o]=Yf(e,n);return Zf(t,r,o,a3(s),t.RGBA,t.UNSIGNED_BYTE)}function l3(t){return t.internalFormatPackedFloat}function Wne(t,e,n,s){const[r,o]=Cu(e,n);return Zf(t,r,o,l3(s),t.RGBA,t.FLOAT)}function c3(t){return t.internalFormatPackedHalfFloat}function Une(t,e,n,s){const[r,o]=Cu(e,n);return Zf(t,r,o,c3(s),t.RGBA,s.textureTypeHalfFloat)}function Hne(t,e,n){return be(t,()=>t.bindBuffer(t.ARRAY_BUFFER,n)),WT(t,e,"clipSpacePos",n,3,20,0)&&WT(t,e,"uv",n,2,20,12)}function Gne(t,e,n,s,r,o){be(t,()=>t.bindTexture(t.TEXTURE_2D,e));let i,a,l;r instanceof Uint8Array?(i=new Uint8Array(n*s*4),a=t.UNSIGNED_BYTE,l=t.RGBA):(i=new Float32Array(n*s*4),a=t.FLOAT,l=o.internalFormatPackedFloat),i.set(r),K().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n,s,t.RGBA,a,i)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,l,n,s,0,t.RGBA,a,i)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function jne(t,e,n){be(t,()=>t.bindTexture(t.TEXTURE_2D,e)),n.data instanceof Uint8Array?K().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,n.width,n.height,t.RGBA,t.UNSIGNED_BYTE,n.data)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,n.width,n.height,0,t.RGBA,t.UNSIGNED_BYTE,n.data)):K().getNumber("WEBGL_VERSION")===2?be(t,()=>t.texSubImage2D(t.TEXTURE_2D,0,0,0,t.RGBA,t.UNSIGNED_BYTE,n)):be(t,()=>t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,n)),be(t,()=>t.bindTexture(t.TEXTURE_2D,null))}function Kne(t,e,n,s){const r=t.createBuffer();be(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,r));const a=4*4*e*n;return be(t,()=>t.bufferData(t.PIXEL_PACK_BUFFER,a,t.STREAM_READ)),be(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,0)),be(t,()=>t.bindBuffer(t.PIXEL_PACK_BUFFER,null)),r}function Xne(t,e,n){const s=t,r=new Float32Array(n);return s.bindBuffer(s.PIXEL_PACK_BUFFER,e),s.getBufferSubData(s.PIXEL_PACK_BUFFER,0,r),s.bindBuffer(s.PIXEL_PACK_BUFFER,null),r}function qne(t,e,n,s){const[r,o]=Yf(e,n),i=4,a=new Uint8Array(hte(e*n,i));return be(t,()=>t.readPixels(0,0,r,o,s.downloadTextureFormat,t.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function Yne(t,e,n,s,r,o,i,a){const l=t,c=new Float32Array(fte(o,i));return l.bindBuffer(l.PIXEL_PACK_BUFFER,e),l.getBufferSubData(l.PIXEL_PACK_BUFFER,0,c),l.bindBuffer(l.PIXEL_PACK_BUFFER,null),c}function Qne(t,e,n){const s=new Float32Array(e*n*4);return be(t,()=>t.readPixels(0,0,n,e,t.RGBA,t.FLOAT,s)),s}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e1{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.itemsToPoll=[];const n=K().getNumber("WEBGL_VERSION");if(e!=null?(this.gl=e,cte(n,e)):this.gl=io(n),e=this.gl,K().getNumber("WEBGL_VERSION")===2){const o=e;this.createVertexArray=()=>be(o,()=>o.createVertexArray()),this.bindVertexArray=i=>be(o,()=>o.bindVertexArray(i)),this.deleteVertexArray=i=>be(o,()=>o.deleteVertexArray(i)),this.getVertexArray=()=>be(o,()=>o.getParameter(o.VERTEX_ARRAY_BINDING))}else if(e!=null){const o=e.getExtension("OES_vertex_array_object");if(o==null)throw new Error("All WebGL1 implementations are expected to offer OES_vertex_array_object.");this.createVertexArray=()=>be(e,()=>o.createVertexArrayOES()),this.bindVertexArray=i=>be(e,()=>o.bindVertexArrayOES(i)),this.deleteVertexArray=i=>be(e,()=>o.deleteVertexArrayOES(i)),this.getVertexArray=()=>be(e,()=>e.getParameter(o.VERTEX_ARRAY_BINDING_OES))}let s="WEBGL_color_buffer_float";const r="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),K().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Lp(this.gl,o),$r(this.gl,i))this.textureHalfFloatExtension=Lp(this.gl,i);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(s),$r(this.gl,r))this.colorBufferHalfFloatExtension=Lp(this.gl,r);else if(K().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(s="EXT_color_buffer_float",$r(this.gl,s))this.colorBufferFloatExtension=this.gl.getExtension(s);else if($r(this.gl,r))this.colorBufferHalfFloatExtension=this.gl.getExtension(r);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=Mne(this.gl),this.indexBuffer=Lne(this.gl),this.framebuffer=Ete(this.gl),this.textureConfig=h$(this.gl,this.textureHalfFloatExtension)}get debug(){return K().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;be(e,()=>e.finish()),be(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),be(e,()=>e.deleteFramebuffer(this.framebuffer)),be(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),be(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),be(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,n){return this.throwIfDisposed(),zne(this.gl,e,n,this.textureConfig)}createFloat16MatrixTexture(e,n){return this.throwIfDisposed(),Bne(this.gl,e,n,this.textureConfig)}createUnsignedBytesMatrixTexture(e,n){return this.throwIfDisposed(),Vne(this.gl,e,n,this.textureConfig)}uploadPixelDataToTexture(e,n){this.throwIfDisposed(),jne(this.gl,e,n)}uploadDenseMatrixToTexture(e,n,s,r){this.throwIfDisposed(),Gne(this.gl,e,n,s,r,this.textureConfig)}createFloat16PackedMatrixTexture(e,n){return this.throwIfDisposed(),Une(this.gl,e,n,this.textureConfig)}createPackedMatrixTexture(e,n){return this.throwIfDisposed(),Wne(this.gl,e,n,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(UT(this.gl,this.framebuffer),this.outputTexture=null),be(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,n,s){return this.downloadMatrixDriver(e,()=>qne(this.gl,n,s,this.textureConfig))}downloadPackedMatrixFromBuffer(e,n,s,r,o,i){return Yne(this.gl,e,n,s,r,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,n){return Xne(this.gl,e,n)}createBufferFromTexture(e,n,s){this.bindTextureToFrameBuffer(e);const r=Kne(this.gl,n,s,this.textureConfig);return this.unbindTextureToFrameBuffer(),r}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let n,s;if(K().getBool("WEBGL_FENCE_API_ENABLED")){const r=e,o=r.fenceSync(r.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),s=()=>{const i=r.clientWaitSync(o,0,0);return i===r.ALREADY_SIGNALED||i===r.CONDITION_SATISFIED},n=o}else K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(n=this.beginQuery(),this.endQuery(),s=()=>this.isQueryAvailable(n,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):s=()=>!0;return{query:n,isFencePassed:s}}downloadMatrixFromPackedTexture(e,n,s){return this.downloadMatrixDriver(e,()=>Qne(this.gl,n,s))}createProgram(e){this.throwIfDisposed();const n=this.gl;this.vertexShader==null&&(this.vertexShader=Pne(n));const s=kte(n);be(n,()=>n.attachShader(s,this.vertexShader)),be(n,()=>n.attachShader(s,e)),Cte(n,s);const r=Object.assign(s,{vao:this.createVertexArray()});return this.debug&&Yb(n,r),r}buildVao(e){this.setProgram(e),this.bindVertexArray(e.vao);const n=this.gl;be(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,this.indexBuffer)),Hne(n,e,this.vertexBuffer)}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&(be(this.gl,()=>this.gl.deleteProgram(e)),this.deleteVertexArray(e.vao))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Yb(this.gl,this.program),be(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,n,s=!0){return this.throwIfDisposed(),s?_te(this.gl,e,n):Rte(this.gl,e,n)}getAttributeLocation(e,n){return this.throwIfDisposed(),be(this.gl,()=>this.gl.getAttribLocation(e,n))}getUniformLocationNoThrow(e,n){return this.throwIfDisposed(),this.gl.getUniformLocation(e,n)}setInputMatrixTexture(e,n,s){this.throwIfDisposed(),this.throwIfNoProgram(),Ate(this.gl,e,n,s)}setOutputMatrixTexture(e,n,s){this.setOutputMatrixTextureDriver(e,s,n)}setOutputPackedMatrixTexture(e,n,s){this.throwIfDisposed();const[r,o]=Cu(n,s);this.setOutputMatrixTextureDriver(e,r,o)}setOutputMatrixWriteRegion(e,n,s,r){this.setOutputMatrixWriteRegionDriver(s,e,r,n)}setOutputPackedMatrixWriteRegion(e,n,s,r){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Yb(this.gl,this.program),zp(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;if(this.debug){const n=this.getVertexArray();console.assert(n===this.program.vao,"VAO changed between setProgram and executeProgram!"),this.debugValidate()}be(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),be(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Lp(this.gl,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.createQuery();return s.beginQuery(r.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),n=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,n),n}endQuery(){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const n=this.gl,s=this.getQueryTimerExtensionWebGL2();n.endQuery(s.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await A2(()=>this.disposed||this.isQueryAvailable(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,n){if(n===0)return null;if(n===2){const s=this.gl;return s.getQueryParameter(e,s.QUERY_RESULT)/1e6}else{const s=this.getQueryTimerExtensionWebGL1();return s.getQueryObjectEXT(e,s.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,n){if(n===0)return!0;if(n===2){const s=this.gl,r=this.getQueryTimerExtensionWebGL2(),o=s.getQueryParameter(e,s.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const s=this.getQueryTimerExtensionWebGL1(),r=s.getQueryObjectEXT(e,s.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),r&&!this.disjoint}}pollFence(e){return new Promise(n=>{this.addItemToPoll(()=>e.isFencePassed(),()=>n())})}pollItems(){const e=Zne(this.itemsToPoll.map(n=>n.isDoneFn));for(let n=0;n<=e;++n){const{resolveFn:s}=this.itemsToPoll[n];s()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,n){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:n}),this.itemsToPoll.length>1)return;let s;"setTimeoutCustom"in K().platform&&(s=K().platform.setTimeoutCustom.bind(K().platform)),A2(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,s)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Qb(this.gl,e,this.framebuffer),this.debug&&zp(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Qb(this.gl,this.outputTexture,this.framebuffer),this.debug&&zp(this.gl)):UT(this.gl,this.framebuffer)}downloadMatrixDriver(e,n){this.bindTextureToFrameBuffer(e);const s=n();return this.unbindTextureToFrameBuffer(),s}setOutputMatrixTextureDriver(e,n,s){this.throwIfDisposed();const r=this.gl;Qb(r,e,this.framebuffer),this.debug&&zp(r),this.outputTexture=e,be(r,()=>r.viewport(0,0,n,s)),be(r,()=>r.scissor(0,0,n,s))}setOutputMatrixWriteRegionDriver(e,n,s,r){this.throwIfDisposed(),be(this.gl,()=>this.gl.scissor(e,n,s,r))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function Zne(t){let e=0;for(;e<t.length&&t[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:Jne,bincountImpl:u3,bincountReduceImpl:ese,bitwiseAndImpl:tse,castImpl:nse,ceilImpl:sse,concatImpl:rse,equalImpl:ose,expImpl:ise,expm1Impl:ase,floorImpl:lse,gatherNdImpl:cse,gatherV2Impl:use,greaterImpl:dse,greaterEqualImpl:hse,lessImpl:fse,lessEqualImpl:pse,linSpaceImpl:mse,logImpl:gse,maxImpl:xse,maximumImpl:yse,minimumImpl:bse,multiplyImpl:vse,negImpl:wse,notEqualImpl:kse,prodImpl:Cse,raggedGatherImpl:Sse,raggedRangeImpl:$se,raggedTensorToTensorImpl:Ise,rangeImpl:Tse,rsqrtImpl:Ese,scatterImpl:Nse,sigmoidImpl:_se,simpleAbsImpl:d3,sliceImpl:Rse,sparseFillEmptyRowsImpl:Ase,sparseReshapeImpl:Dse,sparseSegmentReductionImpl:h3,sqrtImpl:Fse,staticRegexReplaceImpl:Ose,stridedSliceImpl:Pse,stringNGramsImpl:Mse,stringSplitImpl:Lse,stringToHashBucketFastImpl:zse,subImpl:Bse,tileImpl:Vse,topKImpl:Wse,transposeImpl:g$,uniqueImpl:Use}=j7;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f3(t,e){return["x","y","z","w","u","v"].slice(0,e).map(n=>`${t}.${n}`)}function ls(t,e){return e===1?[t]:f3(t,e)}function Hse(t,e){if(t===1)return"rc";let n="";for(let s=0;s<t;s++)n+=e[s],s<t-1&&(n+=",");return n}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gse{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Jn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const n=ls("rc",this.rank),s=yt(this.rank),r=this.getOutOfBoundsCondition(n),o=this.getSetup(n),i=this.getOutput(n);this.userCode=`
        void main() {
          ${s} rc = getOutputCoords();

          if(${r}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const n=[];for(let s=0;s<=1;s++)for(let r=0;r<=1;r++){let o=`${s===0?"r":"rp1"}, ${r===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;n.push(o)}return n}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let n="";for(let s=this.rank-2;s<this.rank;s++)n+=`${e[s]} >= ${this.enableShapeUniforms?`outShape[${s}]`:this.outputShape[s]}`,s<this.rank-1&&(n+="||");return n}getSetup(e){if(this.rank===1)return"";const n=e.slice(-2),s=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],r=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${n[0]};
      int c = ${n[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${s};
      bool rEdge = rp1 >= ${r};
    `}getOutput(e){const n=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${n[0]}),
            cEdge ? 0. : getA(${n[1]}),
            rEdge ? 0. : getA(${n[2]}),
            rEdge || cEdge ? 0. : getA(${n[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p3{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length);let s="";for(let r=0;r<4;r++){let o="thisRC = rc;";r%2===1&&(o+="thisRC.z += 1;"),r>1&&(o+="thisRC.y += 1;"),s+=`
        ${o}
        ${r>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${r}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${r>0?"}":""}
      `}this.userCode=`
      ${jse(n,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?p$():f$(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${s}

        setOutput(result);
      }
    `}}function jse(t,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?Hte(["r","c","d"],"inputShape"):Vl(["r","c","d"],t)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Kse{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.usedTextures={},this.logEnabled=!1}acquireTexture(e,n,s){const r=XT(n,s),o=qT(e,r,s);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=KT(e,r,this.gpgpu.gl,this.gpgpu.textureConfig,s);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const l=this.freeTextures[o].pop();return this.usedTextures[o].push(l),l}let a;return r===Fn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):r===Fn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):r===Fn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):r===Fn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):r===Fn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,n,s,r){if(this.freeTextures==null)return;const o=XT(s,r),i=qT(n,o,r);i in this.freeTextures||(this.freeTextures[i]=[]);const a=KT(n,o,this.gpgpu.gl,this.gpgpu.textureConfig,r),l=K().getNumber("WEBGL_DELETE_TEXTURE_THRESHOLD");l!==-1&&this._numBytesAllocated>l?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],u=c&&c.indexOf(e);if(u==null||u<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c[u]=c[c.length-1],c.pop(),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const n=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*n)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(n=>{this.gpgpu.deleteMatrixTexture(n.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function Xse(t,e){const n=t;if(e===n.R32F)return 4;if(e===n.R16F)return 2;if(e===n.RGBA32F)return 16;if(e===t.RGBA)return 16;if(e===n.RGBA16F)return 8;if(e===n.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function KT(t,e,n,s,r){const o=qse(e,s);let i;if(r){const[l,c]=Cu(t[0],t[1]);i=l*c}else{const[l,c]=Yf(t[0],t[1]);i=l*c}const a=Xse(n,o);return i*a}function qse(t,e){switch(t){case Fn.PACKED_2X2_FLOAT32:return l3(e);case Fn.PACKED_2X2_FLOAT16:return c3(e);case Fn.UNPACKED_FLOAT32:return o3(e);case Fn.UNPACKED_FLOAT16:return i3(e);case Fn.PACKED_4X1_UNSIGNED_BYTE:return a3(e);default:throw new Error(`Unknown physical texture type ${t}`)}}function Yse(t){return K().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?t?Fn.PACKED_2X2_FLOAT32:Fn.UNPACKED_FLOAT32:t?Fn.PACKED_2X2_FLOAT16:Fn.UNPACKED_FLOAT16}function XT(t,e){if(t===Ys.UPLOAD)return Fn.PACKED_2X2_FLOAT32;if(t===Ys.RENDER||t==null)return Yse(e);if(t===Ys.DOWNLOAD||t===Ys.PIXELS)return Fn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${t}`)}function qT(t,e,n){return`${t[0]}_${t[1]}_${e}_${n}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class So{constructor(e,n){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${n}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const Lr="if (isnan(x)) return x;",Qse="return x;",YT="return abs(x);",Zse="return (x >= 0.0) ? x : (exp(x) - 1.0);",Jse=Lr+`
  return (x < 0.0) ? 0.0 : x;
`,ere=Lr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Ti="return x;",tre="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nre="return x;",sre=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,rre=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ore=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,ire="return 1.0 / (1.0 + exp(-1.0 * x));";class Pi{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${n}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class are{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length);const n=e.length,s=ls("rc",n),r=yt(n),o=Hse(n,s),i=s.slice(-2),a=n<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${r} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lre=zF,cre=1e-7,ure=1e-4,Wp={};function dre(t){return t in Wp||(Wp[t]={}),Wp[t]}const hre=K().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),fre=600;function pre(){return K().global.screen==null?1024:K().global.screen.height*K().global.screen.width*window.devicePixelRatio*fre/1024/1024}class ry extends Rk{nextDataId(){return ry.nextDataId++}constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!K().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let n;if(e!=null){if(e instanceof e1)n=e;else{const s=io(K().getNumber("WEBGL_VERSION"),e);n=new e1(s)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const s=io(K().getNumber("WEBGL_VERSION"));n=new e1(s),this.binaryCache=dre(K().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=n,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new Kse(this.gpgpu),this.numMBBeforeWarning=pre(),this.texData=new rD(this,mo())}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}writeTexture(e,n,s,r,o,i){const a=this.makeTensorInfo(n,s),l=this.texData.get(a.dataId);l.isPacked=!1,l.texture={texture:e,texShape:[r,o]},l.texShape=[r,o];const c=Bp(n),u=new jT(c,!1,i),d=this.runWebGLProgram(u,[a],s,[[r,o]]);return d.shape=n,l.texture=null,this.disposeIntermediateTensorInfo(a),d.dataId}write(e,n,s){if((K().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||K().getBool("DEBUG"))&&this.checkNumericalProblems(e),s==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const r={id:this.nextDataId()};return this.texData.set(r,{shape:n,dtype:s,values:e,usage:Ys.UPLOAD,refCount:1}),r}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const n=this.texData.get(e);n.refCount++}decRef(e){if(this.texData.has(e)){const n=this.texData.get(e);n.refCount--}}move(e,n,s,r,o){if(K().getBool("DEBUG")&&this.checkNumericalProblems(n),r==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:s,dtype:r,values:n,usage:Ys.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const n=this.texData.get(e),{values:s,dtype:r,complexTensorInfos:o,slice:i,shape:a,isPacked:l}=n;if(i!=null){let h;l?h=new Pi(a,Ti):h=new So(a,Ti);const f=this.runWebGLProgram(h,[{dataId:e,shape:a,dtype:r}],r),p=this.readSync(f.dataId);return this.disposeIntermediateTensorInfo(f),p}if(s!=null)return this.convertAndCacheOnCPU(e);if(r==="string")return s;const c=this.activeTimers!=null;let u;c&&(u=xs());let d;if(r==="complex64"){const h=this.readSync(o.real.dataId),f=this.readSync(o.imag.dataId);d=ui(h,f)}else d=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=xs()-u),this.convertAndCacheOnCPU(e,d)}async read(e){if(this.pendingRead.has(e)){const p=this.pendingRead.get(e);return new Promise(m=>p.push(m))}const n=this.texData.get(e),{values:s,shape:r,slice:o,dtype:i,complexTensorInfos:a,isPacked:l}=n;if(o!=null){let p;l?p=new Pi(r,Ti):p=new So(r,Ti);const m=this.runWebGLProgram(p,[{dataId:e,shape:r,dtype:i}],i),x=this.read(m.dataId);return this.disposeIntermediateTensorInfo(m),x}if(s!=null)return this.convertAndCacheOnCPU(e);if(K().getBool("DEBUG")&&!K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&K().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,u;if(i!=="complex64"&&K().get("WEBGL_BUFFER_SUPPORTED")){u=this.decode(e);const p=this.texData.get(u.dataId);c=this.gpgpu.createBufferFromTexture(p.texture.texture,...Mp(r))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let d;if(i==="complex64"){const p=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),m=p[0],x=p[1];d=ui(m,x)}else if(c==null)d=this.getValuesFromTexture(e);else{const p=Z(r);d=this.gpgpu.downloadFloat32MatrixFromBuffer(c,p)}if(u!=null&&this.disposeIntermediateTensorInfo(u),c!=null){const p=this.gpgpu.gl;be(p,()=>p.deleteBuffer(c))}const h=this.convertAndCacheOnCPU(e,d),f=this.pendingRead.get(e);return this.pendingRead.delete(e),f.forEach(p=>p(h)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&mo().removeDataId(e,this),this.pendingDeletes--),h}readToGPU(e,n={}){const s=this.texData.get(e),{values:r,shape:o,slice:i,dtype:a,isPacked:l,texture:c}=s;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let f;l?f=new Pi(o,Ti):f=new So(o,Ti);const p=this.runWebGLProgram(f,[{dataId:e,shape:o,dtype:a}],a),m=this.readToGPU(p,n);return this.disposeIntermediateTensorInfo(p),m}if(c==null)throw r!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const u=this.decode(e,n.customTexShape),d=mo().makeTensorFromTensorInfo(u),h=this.texData.get(u.dataId);return Object.assign({tensorRef:d},h.texture)}bufferSync(e){const n=this.readSync(e.dataId);if(e.dtype==="string")try{const s=n.map(r=>sa(r));return Ge(e.shape,e.dtype,s)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ge(e.shape,e.dtype,n)}checkNumericalProblems(e){if(e!=null)for(let n=0;n<e.length;n++){const s=e[n];if(!xte(s))throw K().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${s} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${s} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:n,dtype:s,isPacked:r}=this.texData.get(e),o=Z(n);if(K().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const h=this.decode(e),f=this.texData.get(h.dataId),p=this.gpgpu.downloadMatrixFromPackedTexture(f.texture.texture,...Mp(n)).subarray(0,o);return this.disposeIntermediateTensorInfo(h),p}const i=K().getBool("WEBGL_PACK")&&r===!0,a=i?Bp(n):n,l=i?new Dne(a):new Ane(a),c=this.runWebGLProgram(l,[{shape:a,dtype:s,dataId:e}],"float32"),u=this.texData.get(c.dataId),d=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(u.texture.texture,u.texShape[0],u.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),d}timerAvailable(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const n=this.activeTimers,s=[];let r=!1;this.programTimersStack==null?(this.programTimersStack=s,r=!0):this.activeTimers.push(s),this.activeTimers=s,e();const o=hl(this.activeTimers.map(l=>l.query)).filter(l=>l!=null),i=hl(this.activeTimers.map(l=>l.name)).filter(l=>l!=null);this.activeTimers=n,r&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const l=await Promise.all(o);a.kernelMs=JW(l),a.getExtraProfileInfo=()=>l.map((c,u)=>({name:i[u],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:xs(),endMs:null}}endTimer(e){return K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=xs(),e)}async getQueryTime(e){if(K().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const n=e;return n.endMs-n.startMs}disposeData(e,n=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(n?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!n&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:s}=this.texData.get(e);return s!=null&&(this.disposeData(s.real.dataId,n),this.disposeData(s.imag.dataId,n)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:n,dtype:s,texShape:r,usage:o,isPacked:i,slice:a}=this.texData.get(e),l=a&&a.origDataId||e,c=this.dataRefCount.get(l);c>1?this.dataRefCount.set(l,c-1):(this.dataRefCount.delete(l),n!=null&&(this.numBytesInGPU-=this.computeBytes(r,s),this.textureManager.releaseTexture(n,r,o,i)));const u=this.texData.get(e);u.texture=null,u.texShape=null,u.isPacked=!1,u.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,n=hre){return K().getBool("WEBGL_CPU_FORWARD")&&e.every(s=>this.texData.get(s.dataId).texture==null&&Z(s.shape)<n)}getGPGPUContext(){return this.gpgpu}where(e){Ks("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const n=e.dataSync();return lre(e.shape,n)}packedUnaryOp(e,n,s){const r=new Pi(e.shape,n),o=this.compileAndRun(r,[e],s);return mo().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const r=d3(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,r)}if(K().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,YT,e.dtype);const n=new So(e.shape,YT),s=this.compileAndRun(n,[e]);return mo().makeTensorFromTensorInfo(s)}makeTensorInfo(e,n,s){let r;if(n==="string"&&s!=null&&s.length>0&&Ph(s[0])){const o=s.map(i=>Yi(i));r=this.write(o,e,n)}else r=this.write(s,e,n);return this.texData.get(r).usage=null,{dataId:r,shape:e,dtype:n}}makeOutput(e,n,s){return mo().makeTensorFromTensorInfo(this.makeTensorInfo(e,n,s),this)}unpackTensor(e){const n=new are(e.shape);return this.runWebGLProgram(n,[e],e.dtype)}packTensor(e){const n=new Gse(e.shape),s=!0;return this.runWebGLProgram(n,[e],e.dtype,null,s)}packedReshape(e,n){const s=[nu(e.shape),...su(e.shape)],r={dtype:e.dtype,shape:s,dataId:e.dataId},o=[nu(n),...su(n)],i=new p3(o,s),a=!0,l=[s],c=this.runWebGLProgram(i,[r],e.dtype,l,a);return{dataId:c.dataId,shape:n,dtype:c.dtype}}decode(e,n){const s=this.texData.get(e),{isPacked:r,shape:o,dtype:i}=s;if(n!=null){const h=Z(o),f=n[0]*n[1]*4;T(h<=f,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Bp(o);let l;r?l=new Rne(a):l=new _ne(a);const c=!0,u=[n??Mp(a)],d=this.runWebGLProgram(l,[{shape:a,dtype:i,dataId:e}],i,u,c,n);return{dtype:i,shape:o,dataId:d.dataId}}runWebGLProgram(e,n,s,r,o=!1,i){const a=this.makeTensorInfo(e.outputShape,s),l=this.texData.get(a.dataId);if(e.packedOutput&&(l.isPacked=!0),e.outPackingScheme===mh.DENSE){const g=i??Mp(e.outputShape);l.texShape=g.map(y=>y*2)}if(e.outTexUsage!=null&&(l.usage=e.outTexUsage),Z(a.shape)===0)return l.values=Xn(a.dtype,0),a;const c=[],u=n.map(g=>{if(g.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let y=this.texData.get(g.dataId);if(y.texture==null){if(!e.packedInputs&&Z(g.shape)<=K().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:g.shape,texData:null,isUniform:!0,uniformValues:y.values};e.packedInputs&&(y.isPacked=!0,y.shape=g.shape)}if(this.uploadToGPU(g.dataId),!!y.isPacked!=!!e.packedInputs)g=y.isPacked?this.unpackTensor(g):this.packTensor(g),c.push(g),y=this.texData.get(g.dataId);else if(y.isPacked&&!Vg(y.shape,g.shape)){const b=g,v=g.shape;g.shape=y.shape,g=this.packedReshape(g,v),c.push(g),y=this.texData.get(g.dataId),b.shape=v}return{shape:g.shape,texData:y,isUniform:!1}});this.uploadToGPU(a.dataId);const d={shape:a.shape,texData:l,isUniform:!1},h=Nne(e,u,d),f=this.getAndSaveBinary(h,()=>Tne(this.gpgpu,e,u,d)),p=this.activeTimers!=null;let m;p&&(m=this.startTimer()),K().get("ENGINE_COMPILE_ONLY")||Ene(this.gpgpu,f,u,d,r),c.forEach(g=>this.disposeIntermediateTensorInfo(g)),p&&(m=this.endTimer(m),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(m)}));const x=K().getNumber("WEBGL_FLUSH_THRESHOLD");if(x>0){const g=xs();g-this.lastGlFlushTime>x&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=g)}if(!K().getBool("WEBGL_LAZILY_UNPACK")&&l.isPacked&&o===!1){const g=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),g}return a}compileAndRun(e,n,s,r,o=!1){return s=s||n[0].dtype,this.runWebGLProgram(e,n,s,r,o)}getAndSaveBinary(e,n){return e in this.binaryCache||(this.binaryCache[e]=n()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(K().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(n=>{this.gpgpu.deleteProgram(this.binaryCache[n].webGLProgram),delete this.binaryCache[n]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=j(()=>{if(!K().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=K().getBool("DEBUG");K().set("DEBUG",!1);const n=this.abs(at(1e-8)).dataSync()[0];if(K().set("DEBUG",e),n>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?cre:ure}uploadToGPU(e){const n=this.texData.get(e),{shape:s,dtype:r,values:o,texture:i,usage:a,isPacked:l}=n;if(i!=null)return;const c=this.activeTimers!=null;let u;c&&(u=xs());let d=n.texShape;if(d==null&&(d=Ote(s,l),n.texShape=d),o!=null){const h=Bp(s);let f,p=d[1],m=d[0];const x=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(l||!x)&&([p,m]=Cu(d[0],d[1])),l?f=new One(h,x):f=new jT(h,x);const g=x?[m,p]:d,y=this.makeTensorInfo(g,r),b=this.texData.get(y.dataId);x?b.usage=Ys.PIXELS:b.usage=Ys.UPLOAD,b.texShape=g,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(y.dataId),p,m,o);const v=[[m,p]],w=!0,k=this.runWebGLProgram(f,[y],r,v,w),C=this.texData.get(k.dataId);n.texShape=C.texShape,n.isPacked=C.isPacked,n.usage=C.usage,K().get("ENGINE_COMPILE_ONLY")?this.disposeData(k.dataId):(n.texture=C.texture,n.values=null,this.texData.delete(k.dataId)),this.disposeIntermediateTensorInfo(y),c&&(this.uploadWaitMs+=xs()-u)}else{const h=this.acquireTexture(d,a,r,l);n.texture=h}}convertAndCacheOnCPU(e,n){const s=this.texData.get(e),{dtype:r}=s;return n!=null&&(s.values=mre(n,r)),s.values}acquireTexture(e,n,s,r){if(this.numBytesInGPU+=this.computeBytes(e,s),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,n,r)}computeBytes(e,n){return e[0]*e[1]*gg(n)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,n]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(n));return Promise.all(e)}else{for(const[,n]of Object.entries(this.binaryCache)){const s=new Promise(r=>{try{this.checkCompletion_(n),r(!0)}catch(o){throw o}});e.push(s)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await nO(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(JL(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const e of Object.values(this.binaryCache)){this.gpgpu.buildVao(e.webGLProgram);const{variablesLocations:n,customUniformLocations:s,infLoc:r,nanLoc:o,outShapeLocation:i,outShapeStridesLocation:a,outTexShapeLocation:l}=r3(this.gpgpu,e.program,e.webGLProgram);e.variablesLocations=n,e.customUniformLocations=s,e.infLoc=r,e.nanLoc=o,e.outShapeLocation=i,e.outShapeStridesLocation=a,e.outTexShapeLocation=l}}createTensorFromGPUData(e,n,s){e.channels=e.channels||"RGBA";const{texture:r,height:o,width:i,channels:a}=e,l=mo().backend;if(!l.gpgpu.gl.isTexture(r))throw new Error("The texture is invalid. Also, please make sure the texture and the TFJS WebGL backend are using the same canvas. If you want to use your own custom canvas, you have to create and use the custom TFJS WebGL backend created from the canvas through 'new tf.MathBackendWebGL(customCanvas)'.");const c=l.writeTexture(r,n,s,o,i,a);return mo().makeTensorFromDataId(c,n,s,l)}}ry.nextDataId=0;function mre(t,e){if(e==="float32"||e==="complex64")return t;if(e==="int32"||e==="bool"){const n=e==="int32"?new Int32Array(t.length):new Uint8Array(t.length);for(let s=0;s<n.length;++s)n[s]=Math.round(t[s]);return n}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */QD()&&tF("webgl",()=>new ry,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x$=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class Sl{constructor(e,n,s){this.variableNames=["A","B"],this.outputShape=Le(n,s),this.enableShapeUniforms=Jn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ul=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class Eu{constructor(e,n,s,r=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=Le(n,s);const o=this.outputShape.length;this.enableShapeUniforms=Jn(o);let i="";if(r)if(o===0||Z(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${yt(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const l=ls("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${l[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${l[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ws(t){const{inputs:e,backend:n}=t,{x:s}=e;return n.incRef(s.dataId),{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}const gre={kernelName:sf,backendName:"webgl",kernelFunc:Ws};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ca(t){const{inputs:e,backend:n}=t,{real:s,imag:r}=e,o=n.makeTensorInfo(s.shape,"complex64"),i=n.texData.get(o.dataId),a=Ws({inputs:{x:s},backend:n}),l=Ws({inputs:{x:r},backend:n});return i.complexTensorInfos={real:a,imag:l},o}const xre={kernelName:Hk,backendName:"webgl",kernelFunc:Ca};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const m3="return (a < 0.) ? b * a : a;",g3=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function yre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{alpha:o}=s,i=n.makeTensorInfo([],"float32",ma(o,"float32")),a=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Eu(g3,r.shape,i.shape):new Sl(m3,r.shape,i.shape),l=n.runWebGLProgram(a,[r,i],"float32");return n.disposeIntermediateTensorInfo(i),l}const bre={kernelName:Z0,backendName:"webgl",kernelFunc:yre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const x3="return (a < 0.) ? b * a : a;",y3=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function vre(t){const{inputs:e,backend:n}=t,{x:s,alpha:r}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Eu(y3,s.shape,r.shape):new Sl(x3,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],"float32")}const wre={kernelName:xx,backendName:"webgl",kernelFunc:vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nu="if (isnan(x)) return x;";function st({opSnippet:t,packedOpSnippet:e,cpuKernelImpl:n,dtype:s}){return({inputs:r,backend:o})=>{const{x:i}=r,a=o,l=s||i.dtype;if(a.shouldExecuteOnCPU([i])&&n!=null){const d=a.texData.get(i.dataId),h=n(d.values,l);return a.makeTensorInfo(i.shape,l,h)}const c=K().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let u;return c?u=new Pi(i.shape,e):u=new So(i.shape,t),a.runWebGLProgram(u,[i],l)}}function Bn({opSnippet:t,packedOpSnippet:e,checkOutOfBounds:n=!1,supportsComplex:s=!1,cpuKernelImpl:r,dtype:o}){return({inputs:i,backend:a})=>{const{a:l,b:c}=i,u=a;if(s&&l.dtype==="complex64"){const p=u.texData.get(l.dataId),m=u.texData.get(c.dataId),[x,g]=[[p.complexTensorInfos.real,m.complexTensorInfos.real],[p.complexTensorInfos.imag,m.complexTensorInfos.imag]].map(b=>{const[v,w]=b,k={dataId:v.dataId,dtype:v.dtype,shape:l.shape},C={dataId:w.dataId,dtype:w.dtype,shape:c.shape},S=new Sl(t,l.shape,c.shape);return u.runWebGLProgram(S,[k,C],Bs(v.dtype,w.dtype))}),y=Ca({inputs:{real:x,imag:g},backend:u});return u.disposeIntermediateTensorInfo(x),u.disposeIntermediateTensorInfo(g),y}const d=o||Bs(l.dtype,c.dtype);if((l.dtype==="string"||c.dtype==="string"||u.shouldExecuteOnCPU([l,c]))&&r!=null){const p=u.texData.get(l.dataId).values,m=u.texData.get(c.dataId).values,x=l.dtype==="string"?di(p):p,g=l.dtype==="string"?di(m):m,[y,b]=r(l.shape,c.shape,x,g,d),v=u.makeTensorInfo(b,d),w=u.texData.get(v.dataId);return w.values=y,v}const h=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let f;return h?f=new Eu(e,l.shape,c.shape,n):f=new Sl(t,l.shape,c.shape),u.runWebGLProgram(f,[l,c],d)}}function gh(t,e=!1){if(t==="linear")return e?nre:Qse;if(t==="relu")return e?rre:Jse;if(t==="elu")return e?sre:Zse;if(t==="relu6")return e?ore:ere;if(t==="prelu")return e?y3:x3;if(t==="leakyrelu")return e?g3:m3;if(t==="sigmoid")return e?ire:tre;throw new Error(`Activation ${t} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class b3{constructor(e,n,s,r=!1,o=!1,i=!1,a=null,l=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=s,this.enableShapeUniforms=Jn(this.outputShape.length);const u=r?e[1]:e[2],d=Math.ceil(u/2),h=r?"i * 2, rc.y":"rc.y, i * 2",f=o?"rc.z, i * 2":"i * 2, rc.z",p=r?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],m=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let x="",g="";a&&(l?x=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?x=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:x=`vec4 activation(vec4 x) {
          ${a}
        }`,g="result = activation(result);");const y=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),l&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let b="rc.x",v="rc.x";e[0]<n[0]?b=`imod(rc.x, ${e[0]})`:n[0]<e[0]&&(v=`imod(rc.x, ${n[0]})`),this.userCode=`
      ${x}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${d}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        int batchA = ${b};
        int batchB = ${v};
        for (int i = 0; i < ${d}; i++) {
          vec4 a = getMatrixA(batchA, ${h});
          vec4 b = getMatrixB(batchB, ${f});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${p[0]} * ${m[0]});
          result += (${p[1]} * ${m[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${y}

        ${g}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QT={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class ZT{constructor(e,n,s){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=Le(n,s),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JT="return a * b;";function y$(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=Bs(s.dtype,r.dtype);if(s.dtype==="complex64"){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),c=new ZT(QT.REAL,s.shape,r.shape),u=new ZT(QT.IMAG,s.shape,r.shape),d=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:s.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:s.shape},{dataId:l.complexTensorInfos.real.dataId,dtype:l.complexTensorInfos.real.dtype,shape:r.shape},{dataId:l.complexTensorInfos.imag.dataId,dtype:l.complexTensorInfos.imag.dtype,shape:r.shape}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=Ca({inputs:{real:h,imag:f},backend:n});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}if(n.shouldExecuteOnCPU([s,r])){const a=n.texData.get(s.dataId),l=n.texData.get(r.dataId),[c,u]=vse(s.shape,r.shape,a.values,l.values,o),d=n.makeTensorInfo(u,o),h=n.texData.get(d.dataId);return h.values=c,d}let i;return K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new Eu(JT,s.shape,r.shape):i=new Sl(JT,s.shape,r.shape),n.runWebGLProgram(i,[s,r],o)}const kre={kernelName:ff,backendName:"webgl",kernelFunc:y$};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cre(t,e,n){const s=[nu(t.shape),...su(t.shape)],r={dtype:t.dtype,shape:s,dataId:t.dataId},o=[nu(e),...su(e)],i=new p3(o,s),a=!0,l=[s],c=n.runWebGLProgram(i,[r],t.dtype,l,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{shape:o}=s,i=n,a=Z(r.shape),l=iD(o,a),c=Z(l);T(a===c,()=>`The new shape (${l}) has ${c} elements and the old shape (${r.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const u=i.texData.get(r.dataId);return u.isPacked&&!Vg(r.shape,l)&&!(u.texture!==null&&Vg(u.shape,l))?Cre(r,l,i):(i.incRef(r.dataId),{dataId:r.dataId,shape:l,dtype:r.dtype})}const Sre={kernelName:bx,backendName:"webgl",kernelFunc:ue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class eE{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];const a=Math.floor(s/4)*4,l=s%4;let c="sumValue += dot(values, ones);";if(n!=null){const d=1/n;c=`sumValue += dot(values * ${Gc(d)?d.toPrecision(2):d}, ones);`}let u="";o%s>0&&(u=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${u}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${l===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${l===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${l===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $re{constructor(e,n){this.variableNames=["x"];const{windowSize:s,batchSize:r,inSize:o,outSize:i}=e;this.outputShape=[r,i];let a="0.0",l="";n==="prod"?a="1.0":n==="min"?(a="1.0 / 1e-20",l="min"):n==="max"&&(a="-1.0 / 1e-20",l="max");let c=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="sum"?c="sumValue":n==="prod"?c="prodValue":n==="all"?c="allValue":n==="any"&&(c="anyValue");const u=Math.floor(s/4)*4,d=s%4;let h=`
      if (${n==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${n==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${l}(values, minMaxValue);
        if (${n==="min"} || ${n==="max"}) {
          minMaxValue = ${l}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,f="vec4";n==="all"?(a="1.0",h=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,f="bvec4"):n==="any"&&(a="0.0",h=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,f="bvec4");let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${p}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===2}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${h}
        } else if (${d===3}) {
          ${f} values = ${f}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ire(t){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const n=e.length?e[e.length-1].outSize:t[1],s=Wx(n);e.push({inSize:n,windowSize:s,outSize:Math.ceil(n/s)})}return e}function Hl(t,e,n,s){const r=Ire(t.shape);let o=t;for(let i=0;i<r.length;i++){const{inSize:a,windowSize:l,outSize:c}=r[i];let u,d;n==="mean"?u=i===0?new eE({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},a):new eE({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c}):u=new $re({windowSize:l,inSize:a,batchSize:t.shape[0],outSize:c},n),d=o,o=s.runWebGLProgram(u,[o],e),d.dataId!==t.dataId&&s.disposeIntermediateTensorInfo(d)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tre{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[n[i]];this.outputShape=s,this.rank=s.length;const r=yt(this.rank),o=Ere(n);this.userCode=`
    void main() {
      ${r} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function Ere(t){const e=t.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],s=new Array(e);for(let r=0;r<t.length;r++)s[t[r]]=n[r];return s.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Nre{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const s=new Array(e.length);for(let u=0;u<s.length;u++)s[u]=e[n[u]];if(this.outputShape=s,this.rank=s.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const r=yt(this.rank),o=f3("rc",this.rank),i=new Array(this.rank);for(let u=0;u<n.length;u++)i[n[u]]=o[u];const a=`vec2(${i.slice(-2).join()})`,l=`++${o[this.rank-1]} < ${s[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${r} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${l}) {
        result[1] = ${c};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${s[this.rank-2]}) {
        result[2] = ${c};
        if(${l}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oy(t,e,n){const s=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Nre(t.shape,e):new Tre(t.shape,e);return n.runWebGLProgram(s,[t],t.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _re(t,e,n,s){const r=e,o=t.shape.length,i=je(r,t.shape);let a=i;const l=Wt(a,o),c=l!=null;let u=t;c&&(u=oy(t,l,s),a=sn(a.length,o)),zn("sum",a,o);const[d,h]=An(u.shape,a);let f=d;n&&(f=fn(d,i));const p=Z(h),x=Z(t.shape)/p,g=ue({inputs:{x:u},attrs:{shape:[x,p]},backend:s}),y=$C(t.dtype),b=Hl(g,y,"sum",s),v=ue({inputs:{x:b},attrs:{shape:f},backend:s});return s.disposeIntermediateTensorInfo(g),s.disposeIntermediateTensorInfo(b),c&&s.disposeIntermediateTensorInfo(u),v}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iy(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s;return _re(r,o,i,n)}const Rre={kernelName:$x,backendName:"webgl",kernelFunc:iy};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ds(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{perm:o}=s,i=n,a=r.shape.length,l=new Array(a);for(let u=0;u<l.length;u++)l[u]=r.shape[o[u]];let c;if(i.shouldExecuteOnCPU([r])){const d=i.texData.get(r.dataId).values,h=g$(d,r.shape,r.dtype,o,l);c=i.makeTensorInfo(l,r.dtype);const f=i.texData.get(c.dataId);f.values=h}else c=oy(r,o,i);return c}const Are={kernelName:Nc,backendName:"webgl",kernelFunc:ds};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v3=1e3;function Wg({a:t,b:e,transposeA:n,transposeB:s,backend:r,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:l=null}){const c=t.shape.length,u=e.shape.length,d=n?t.shape[c-2]:t.shape[c-1],h=s?e.shape[u-1]:e.shape[u-2],f=n?t.shape[c-1]:t.shape[c-2],p=s?e.shape[u-2]:e.shape[u-1],m=t.shape.slice(0,-2),x=e.shape.slice(0,-2),g=Z(m),y=Z(x),v=Le(t.shape.slice(0,-2),e.shape.slice(0,-2)).concat([f,p]);T(d===h,()=>`Error in matMul: inner shapes (${d}) and (${h}) of Tensors with shapes ${t.shape} and ${e.shape} and transposeA=${n} and transposeB=${s} must match.`);const w=n?[g,d,f]:[g,f,d],k=s?[y,p,h]:[y,h,p],C=ue({inputs:{x:t},backend:r,attrs:{shape:w}}),S=ue({inputs:{x:e},backend:r,attrs:{shape:k}}),I=[C,S],$=Math.max(g,y),E=n?C.shape[1]:C.shape[2],_=o!=null,D=i!=null,F=l==="leakyrelu",R=l!=null?gh(l,!0):null,P=_||D||F||R!=null;let M;if((f===1||p===1)&&E>v3&&P===!1){let B=C,G=S;n&&(B=ds({inputs:{x:C},backend:r,attrs:{perm:[0,2,1]}}),I.push(B)),s&&(G=ds({inputs:{x:S},backend:r,attrs:{perm:[0,2,1]}}),I.push(G));const X=p!==1,Y=p===1;let J=B;X&&(J=ue({inputs:{x:B},backend:r,attrs:{shape:[$,E,1]}}),I.push(J));const q=p===1?2:1;let ee=G;Y&&(ee=ue({inputs:{x:G},backend:r,attrs:{shape:[$,1,E]}}),I.push(ee));const ne=y$({inputs:{a:J,b:ee},backend:r});M=iy({inputs:{x:ne},backend:r,attrs:{axis:q,keepDims:!0}}),I.push(ne)}else{const B=Bs(t.dtype,e.dtype),G=new b3(w,k,[$,f,p],n,s,_,R,D,F),X=[C,S];if(o!=null&&X.push(o),D&&X.push(i),F){const Y=r.makeTensorInfo([],"float32",ma(a,"float32"));X.push(Y),I.push(Y)}M=r.runWebGLProgram(G,X,B)}const N=ue({inputs:{x:M},backend:r,attrs:{shape:v}});I.push(M);for(const B of I)r.disposeIntermediateTensorInfo(B);return N}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dre(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:l,transposeB:c,activation:u,leakyreluAlpha:d}=s;return Wg({a:r,b:o,transposeA:l,transposeB:c,backend:n,bias:i,preluActivationWeights:a,leakyreluAlpha:d,activation:u})}const Fre={kernelName:xg,backendName:"webgl",kernelFunc:Dre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const tE="return abs(x);";function Ore(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])&&s.dtype!=="complex64"){const o=n.texData.get(s.dataId),i=d3(o.values);return n.makeTensorInfo(s.shape,s.dtype,i)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Pi(s.shape,tE):r=new So(s.shape,tE),n.runWebGLProgram(r,[s],s.dtype)}const Pre={kernelName:A0,backendName:"webgl",kernelFunc:Ore};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mre=Lr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,Lre=st({opSnippet:Mre}),zre={kernelName:Mh,backendName:"webgl",kernelFunc:Lre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bre=Lr+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,Vre=st({opSnippet:Bre}),Wre={kernelName:Lh,backendName:"webgl",kernelFunc:Vre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nE="return a + b;",Ure=Bn({opSnippet:nE,packedOpSnippet:nE,supportsComplex:!0,cpuKernelImpl:Jne}),Hre={kernelName:gu,backendName:"webgl",kernelFunc:Ure};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gre{constructor(e,n){this.outputShape=[],this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`float v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        float result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jre{constructor(e,n){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=n.map((o,i)=>`T${i}`);const s=[];this.variableNames.forEach(o=>{s.push(`vec4 v${o} = get${o}AtOutCoords();`)});const r=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${s.join(`
        `)}

        vec4 result = ${r};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dm(t){const{inputs:e,backend:n}=t,s=e;if(s.length===1)return Ws({inputs:{x:s[0]},backend:n});if(s.length>K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER")){const l=Math.floor(s.length/2),c=Dm({inputs:s.slice(0,l),backend:n}),u=Dm({inputs:s.slice(l),backend:n});return Dm({inputs:[c,u],backend:n})}const r=s.map(l=>l.dtype).reduce((l,c)=>Bs(l,c)),o=s.map(l=>l.shape),a=K().getBool("WEBGL_PACK")?new jre(s[0].shape,o):new Gre(s[0].shape,o);return n.runWebGLProgram(a,s,r)}const Kre={kernelName:Mk,backendName:"webgl",kernelFunc:Dm};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=je(o,r.shape);let c=l;const u=Wt(c,a);let d=r;u!=null&&(d=ds({inputs:{x:r},backend:n,attrs:{perm:u}}),c=sn(c.length,a)),zn("all",c,a);const[h,f]=An(d.shape,c),p=Z(f),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),x=Hl(m,m.dtype,"all",n);let g;if(i){const y=fn(h,l);g=ue({inputs:{x},backend:n,attrs:{shape:y}})}else g=ue({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),u!=null&&n.disposeIntermediateTensorInfo(d),g}const qre={kernelName:Lk,backendName:"webgl",kernelFunc:Xre};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yre(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=je(o,r.shape);let c=l;const u=Wt(c,a);let d=r;u!=null&&(d=ds({inputs:{x:r},backend:n,attrs:{perm:u}}),c=sn(c.length,a)),zn("any",c,a);const[h,f]=An(d.shape,c),p=Z(f),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),x=Hl(m,m.dtype,"any",n);let g;if(i){const y=fn(h,l);g=ue({inputs:{x},backend:n,attrs:{shape:y}})}else g=ue({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),u!=null&&n.disposeIntermediateTensorInfo(d),g}const Qre={kernelName:zk,backendName:"webgl",kernelFunc:Yre};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zre{constructor(e,n,s){this.variableNames=["A"];const{windowSize:r,batchSize:o,outSize:i}=e;s||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=n==="max"?">":"<",l=s?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${r}; i++) {
          int inIdx = ${l};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jre{constructor(e,n,s,r){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,T(e.length>2,()=>`Packed arg${s.charAt(0).toUpperCase()+s.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/n);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),r||this.variableNames.push("bestIndicesA");const a=this.outputShape,l=a.length,c=yt(l),u=ls("coords",l);let d,h;if(i===1){h=l+1;const S=yt(h);d=`
        ${S} sourceLocR = ${S}(${u.join()}, 0);
        ++${u[l-1]};
        ${S} sourceLocG = ${S}(${u.join()}, 0);
        ++${u[l-2]};
        ${S} sourceLocA = ${S}(${u.join()}, 0);
        --${u[l-1]};
        ${S} sourceLocB = ${S}(${u.join()}, 0);
        --${u[l-2]};`}else h=l,d=`
        ${c} sourceLocR = coords;
        ++${u[l-1]};
        ${c} sourceLocG = coords;
        ++${u[l-2]};
        ${c} sourceLocA = coords;
        --${u[l-1]};
        ${c} sourceLocB = coords;
        --${u[l-2]};`;const f=["x","y","z","w","u","v"].slice(0,h),p="."+f[h-1],m=f.map(S=>"int "+S),x=ls("sourceLocR",h-1).concat("inIdx.r"),g=ls("sourceLocG",h-1).concat("inIdx.g"),y=ls("sourceLocB",h-1).concat("inIdx.b"),b=ls("sourceLocA",h-1).concat("inIdx.a"),v=s==="max"?"greaterThan":"lessThan",w=r?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${x.join()}),
                             getBestIndicesAChannel(${g.join()}),
                             getBestIndicesAChannel(${y.join()}),
                             getBestIndicesAChannel(${b.join()})));`,k=`vec4(
            getAChannel(${x.join()}),
            hasNextCol ? getAChannel(${g.join()}) : 0.,
            hasNextRow ? getAChannel(${y.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${b.join()}) : 0.)`,C=r?"":`
      float getBestIndicesAChannel(${m.join()}) {
        return getChannel(getBestIndicesA(${f.join()}),
                                          vec2(${f.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${m.join()}) {
        return getChannel(getA(${f.join()}),
                               vec2(${f.slice(-2).join()}));
      }
      ${C}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${u[l-1]} < ${a[l-1]-1};
        bool hasNextRow = ${u[l-2]} < ${a[l-2]-1};
        ${d}
        ivec4 srcIdx = ivec4(sourceLocR${p}, sourceLocG${p},
          sourceLocB${p}, sourceLocA${p}) * ${n};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${k};

        for (int i = 0; i < ${n}; i++) {
          inIdx = srcIdx;
          ${w}
          vec4 candidate = ${k};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${v}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w3(t,e,n,s=null){let r=e.shape[0],o=e.shape[1];s!=null&&(r=s.shape[0],o=s.shape[1]);const i=Wx(o),a={windowSize:i,inSize:o,batchSize:r,outSize:Math.ceil(o/i)},l=new Zre(a,n,s==null),c=[e];s!=null&&c.push(s);const u=t.runWebGLProgram(l,c,"int32");if(u.shape[1]===1)return u;const d=w3(t,e,n,u);return t.disposeIntermediateTensorInfo(u),d}function k3(t,e,n,s=null){const r=s!=null?s.shape:e.shape,o=r[r.length-1],i=Wx(o),a=new Jre(r,i,n,s==null),l=s==null?[e]:[e,s],c=t.runWebGLProgram(a,l,"int32");if(c.shape.length===e.shape.length){const u=k3(t,e,n,c);return t.disposeIntermediateTensorInfo(c),u}return c}function C3(t,e,n,s){const r=[n];if(zn("arg"+s.charAt(0).toUpperCase()+s.slice(1),r,e.shape.length),!K().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=t.texData.get(e.dataId),a=i!==null&&i.isPacked;let l=e;a&&(l=t.unpackTensor(e),o.push(l));const[c,u]=An(l.shape,r),d=Z(u),h=ue({inputs:{x:l},backend:t,attrs:{shape:[-1,d]}});o.push(h);const f=w3(t,h,s);o.push(f);const p=ue({inputs:{x:f},backend:t,attrs:{shape:c}});return o.forEach(m=>t.disposeIntermediateTensorInfo(m)),p}return k3(t,e,s)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eoe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=je(o,r.shape);const a=Wt(i,r.shape.length);let l=r;const c=[];a!=null&&(l=ds({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=sn(i.length,l.shape.length)),zn("argMax",[i[0]],l.shape.length);const u=C3(n,l,i[0],"max");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const toe={kernelName:D0,backendName:"webgl",kernelFunc:eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function noe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o}=s;let i=je(o,r.shape);const a=Wt(i,r.shape.length);let l=r;const c=[];a!=null&&(l=ds({inputs:{x:r},backend:n,attrs:{perm:a}}),c.push(l),i=sn(i.length,l.shape.length)),zn("argMin",[i[0]],l.shape.length);const u=C3(n,l,i[0],"min");return c.forEach(d=>n.disposeIntermediateTensorInfo(d)),u}const soe={kernelName:F0,backendName:"webgl",kernelFunc:noe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const roe=Lr+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,ooe=st({opSnippet:roe}),ioe={kernelName:zh,backendName:"webgl",kernelFunc:ooe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const aoe=Lr+"return log(x + sqrt(x * x + 1.0));",loe=st({opSnippet:aoe}),coe={kernelName:Bh,backendName:"webgl",kernelFunc:loe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uoe=Lr+`
  return atan(x);
`,doe=st({opSnippet:uoe}),hoe={kernelName:Vh,backendName:"webgl",kernelFunc:doe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const foe=x$+`
  return atan(a, b);
`,poe=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ul+`
  return result;
`,moe=Bn({opSnippet:foe,packedOpSnippet:poe}),goe={kernelName:Uh,backendName:"webgl",kernelFunc:moe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xoe=Lr+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,yoe=st({opSnippet:xoe}),boe={kernelName:Wh,backendName:"webgl",kernelFunc:yoe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xh{constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,l=e.strideWidth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterHeight,h=e.effectiveFilterWidth,f=e.padInfo.top,p=e.padInfo.left;this.outputShape=e.outShape;const m=n==="avg",x=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,g=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let y="0.0";if(m||(y="-1.0 / 1e-20"),s){const S=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${l});
        const ivec2 pads = ivec2(${f}, ${p});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${h};
                wC += ${u}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${S} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${r?o?x:g:`wR * ${h} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const b="max";let v=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(v="avgValue / max(count, 1.0)");const w=Math.floor(i/4)*4,k=i%4,C=`
      if (${m}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${b}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${l});
      const ivec2 pads = ivec2(${f}, ${p});
      const float initializationValue = ${y};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${y});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${d};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${w}; wC += 4) {
            int xC = xCCorner + wC * ${u};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              getValue(batch, xR, xC + 3 * ${u}, d)
            );

            ${C}
          }

          int xC = xCCorner + ${w};
          if (${k===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${k===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              initializationValue,
              initializationValue
            );

            ${C}
          } else if (${k===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${u}, d),
              getValue(batch, xR, xC + 2 * ${u}, d),
              initializationValue
            );

            ${C}
          }
        }
        setOutput(${v});
      }
    `}}class b${constructor(e,n,s,r=!1,o=!1){if(this.variableNames=["x"],n==="avg"&&s)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,l=e.strideHeight,c=e.strideWidth,u=e.dilationDepth,d=e.dilationHeight,h=e.dilationWidth,f=e.effectiveFilterDepth,p=e.effectiveFilterHeight,m=e.effectiveFilterWidth,x=e.padInfo.front,g=e.padInfo.top,y=e.padInfo.left;this.outputShape=e.outShape;const b=n==="avg";let v="0.0";if(b||(v="-1.0 / 1e-20"),s){const $=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${l}, ${c});
        const ivec3 pads = ivec3(${x}, ${g}, ${y});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${f};
              wD += ${u}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${p};
                wR += ${d}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${m};
                  wC += ${h}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${$} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${r?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${p} * ${m} +
                      wR * ${m} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const w="max";let k=`${n}(${n}(${n}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;n==="avg"&&(k="avgValue / max(count, 1.0)");const C=Math.floor(i/4)*4,S=i%4,I=`
      if (${b}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${w}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${l}, ${c});
      const ivec3 pads = ivec3(${x}, ${g}, ${y});
      const float initializationValue = ${v};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${v});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${f};
            wD += ${u}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${p};
            wR += ${d}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${C}; wC += 4) {
              int xC = xCCorner + wC * ${h};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                getValue(batch, xD, xR, xC + 3 * ${h}, ch)
              );

              ${I}
            }

            int xC = xCCorner + ${C};
            if (${S===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${S===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                initializationValue,
                initializationValue
              );

              ${I}
            } else if (${S===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${h}, ch),
                getValue(batch, xD, xR, xC + 2 * ${h}, ch),
                initializationValue
              );

              ${I}
            }
          }
        }
        setOutput(${k});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function voe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Qf(r,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Qn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Pr(r.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&lt(u.inShape,u.outShape))return Ws({inputs:{x:r},backend:n});const d=new xh(u,"avg",!1);return n.runWebGLProgram(d,[r],"float32")}const woe={kernelName:O0,backendName:"webgl",kernelFunc:voe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function koe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:l,dataFormat:c}=s,u=[1,1,1],d=yi(r.shape,o,i,u,a,l,c),h=new b$(d,"avg",!1);return n.runWebGLProgram(h,[r],"float32")}const Coe={kernelName:P0,backendName:"webgl",kernelFunc:koe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Soe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterHeight,c=e.effectiveFilterWidth,u=l-1-e.padInfo.top,d=c-1-e.padInfo.left,h=1/(n*s);this.userCode=`
      const ivec2 pads = ivec2(${u}, ${d});
      const float avgMultiplier = float(${h});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${l};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class $oe{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.effectiveFilterDepth,h=e.effectiveFilterHeight,f=e.effectiveFilterWidth,p=d-1-e.padInfo.front,m=h-1-e.padInfo.top,x=f-1-e.padInfo.left,g=1/(n*s*r);this.userCode=`
      const ivec3 pads = ivec3(${p}, ${m}, ${x});
      const float avgMultiplier = float(${g});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${d};
            wD += ${l}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${f};
                wC += ${u}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ioe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=yi(i.shape,a,l,d,c,u),f=new $oe(h);return n.runWebGLProgram(f,[r],i.dtype)}const Toe={kernelName:Vk,backendName:"webgl",kernelFunc:Ioe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eoe(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o;Qf([r,o],"avgPoolGrad");const{filterSize:a,strides:l,pad:c}=s,u=Pr(i.shape,a,l,1,c),d=new Soe(u);return n.runWebGLProgram(d,[r],i.dtype)}const Noe={kernelName:Bk,backendName:"webgl",kernelFunc:Eoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _oe(t){const{inputs:e,backend:n,attrs:s}=t,{a:r,b:o}=e,{transposeA:i,transposeB:a}=s;return Wg({a:r,b:o,transposeA:i,transposeB:a,backend:n})}const Roe={kernelName:M0,backendName:"webgl",kernelFunc:_oe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Aoe{constructor(e,n,s,r,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],Le(e,n),Le(e,s);let a="0.0";r!=null&&(Le(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="1.0";o!=null&&(Le(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${l};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Doe{constructor(e,n,s,r,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],Le(e,n),Le(e,s);let a="vec4(0.0)";r!=null&&(Le(e,r),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let l="vec4(1.0)";o!=null&&(Le(e,o),this.variableNames.push("scale"),l="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${l};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Foe=({inputs:t,backend:e,attrs:n})=>{const{x:s,mean:r,variance:o,offset:i,scale:a}=t;T(r.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),T(i==null||r.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),T(a==null||r.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:l}=n;l==null&&(l=.001);const c=[s,r,o];let u=null;i!=null&&(u=i.shape,c.push(i));let d=null;a!=null&&(d=a.shape,c.push(a));const h=K().getBool("WEBGL_PACK_NORMALIZATION")?new Doe(s.shape,r.shape,o.shape,u,d,l):new Aoe(s.shape,r.shape,o.shape,u,d,l);return e.runWebGLProgram(h,c,c[0].dtype)},Ooe={kernelName:q0,backendName:"webgl",kernelFunc:Foe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Poe{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const n=yt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const s=Moe(this.rank);let r;const o=e.map((i,a)=>`sourceLoc.${Jv[a]} = start[${a}] + coords.${Jv[a]};`);r=`
        ${n} sourceLoc;
        ${n} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${r}
        setOutput(getSource(${s}));
      }
    `}}const Jv=["x","y","z","w","u","v"];function Moe(t){if(t===1)return"sourceLoc";if(t<=6)return Jv.slice(0,t).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Loe{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const n=yt(this.rank),s=ls("coords",this.rank),r=ls("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${r.slice(-2).join()})`,i=`getChannel(getSource(${r.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
        ++${r[this.rank-1]};
        result.y = ${i};
        --${r[this.rank-1]};
      }
    `,l=this.rank===1?"":`
      --${s[this.rank-1]};
      if (++${s[this.rank-2]} < ${e[this.rank-2]}) {
        ++${r[this.rank-2]};
        result.z = ${i};
        if (++${s[this.rank-1]} < ${e[this.rank-1]}) {
          ++${r[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${n}(${e.map((u,d)=>`start[${d}]`).join()});`:e.map((u,d)=>`${r[d]} = ${s[d]} + start[${d}];`).join(`
`);this.userCode=`
      void main() {
        ${n} coords = getOutputCoords();
        ${n} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zoe(t,e,n,s){const r=s.texData.get(t.dataId),o=s.makeTensorInfo(n,t.dtype),i=s.texData.get(o.dataId);Object.assign(i,r),i.refCount=1,i.shape=n,i.dtype=t.dtype;let a=fS(e,Te(t.shape));r.slice&&(a+=r.slice.flatOffset),i.slice={flatOffset:a,origDataId:r.slice&&r.slice.origDataId||t.dataId};const l=s.dataRefCount.get(i.slice.origDataId)||1;return s.dataRefCount.set(i.slice.origDataId,l+1),o}function _u(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,size:i}=s,[a,l]=Vx(r,o,i);if(uS(r,a,l),Z(l)===0)return n.makeTensorInfo(l,r.dtype,[]);if(n.shouldExecuteOnCPU([r])||r.dtype==="string"){const d=n.texData.get(r.dataId),h=Rse(d.values,a,l,r.shape,r.dtype);return n.makeTensorInfo(l,r.dtype,h)}const{isPacked:c}=n.texData.get(r.dataId),u=hS(r.shape,a,l);if(c||!u){const d=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Loe(l):new Poe(l),h=[a];return n.runWebGLProgram(d,[r],r.dtype,h)}return n.uploadToGPU(r.dataId),zoe(r,a,l,n)}const Boe={kernelName:Sx,backendName:"webgl",kernelFunc:_u};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Voe=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,crops:i}=s;T(r.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((y,b)=>y*b),l=Lf(r.shape,o,a),c=zf(l.length,o.length),u=Bf(r.shape,o,a),d=yS(i,o.length),h=bS(u,i,o.length),f=[],p=ue({inputs:{x:r},backend:n,attrs:{shape:l}}),m=ds({inputs:{x:p},backend:n,attrs:{perm:c}}),x=ue({inputs:{x:m},backend:n,attrs:{shape:u}}),g=_u({inputs:{x},backend:n,attrs:{begin:d,size:h}});return f.push(p),f.push(m),f.push(x),f.forEach(y=>n.disposeIntermediateTensorInfo(y)),g},Woe={kernelName:L0,backendName:"webgl",kernelFunc:Voe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uoe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i}=s,a=n.readSync(r.dataId),l=n.readSync(o.dataId),c=u3(a,l,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,c)}const Hoe={kernelName:Wk,backendName:"webgl",kernelFunc:Uoe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Goe=`
  int r = int(a.r) & int(b.r);
  int g = int(a.g) & int(b.g);
  int rb = int(a.b) & int(b.b);
  int ra = int(a.a) & int(b.a);
  return vec4(r, g, rb, ra);
`,joe=`
  return float(int(a.r) & int(b.r));
`;function Koe(t){const{inputs:e,backend:n}=t,{a:s,b:r}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS"),i=K().getNumber("WEBGL_VERSION");if(n.shouldExecuteOnCPU([s,r])||i===1){const l=n.texData.get(s.dataId).values,c=n.texData.get(r.dataId).values,[u,d]=tse(s.shape,r.shape,l,c,s.dtype),h=n.makeTensorInfo(d,s.dtype),f=n.texData.get(h.dataId);return f.values=u,h}let a;return o?a=new Eu(Goe,s.shape,r.shape,!1):a=new Sl(joe,s.shape,r.shape),n.runWebGLProgram(a,[s,r],s.dtype)}const Xoe={kernelName:Uk,backendName:"webgl",kernelFunc:Koe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qoe(t){const{inputs:e,backend:n}=t,{s0:s,s1:r}=e,o=n.readSync(s.dataId),i=n.readSync(r.dataId),a=Le(Array.from(o),Array.from(i));return n.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const Yoe={kernelName:hD,backendName:"webgl",kernelFunc:qoe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qoe="return float(a != b);",S3=Bn({opSnippet:Qoe,cpuKernelImpl:kse,dtype:"bool"}),Zoe={kernelName:hx,backendName:"webgl",kernelFunc:S3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jf(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ws({inputs:{x:r.complexTensorInfos.real},backend:n})}const Joe={kernelName:pC,backendName:"webgl",kernelFunc:Jf};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eie="return float(int(x));";function tie(t,e){const n=new So(t.shape,eie),s=e.runWebGLProgram(n,[t],"int32");return{dataId:s.dataId,shape:s.shape,dtype:s.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ew(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dtype:o}=s;if(o==="complex64"){if(r.dtype==="complex64")return Ws({inputs:{x:r},backend:n});const i=hn(r.shape),a=ew({inputs:{x:r},backend:n,attrs:{dtype:"float32"}}),l=Ca({inputs:{real:a,imag:i},backend:n});return i.dispose(),n.disposeIntermediateTensorInfo(a),l}if(r.dtype==="complex64"){const i=Jf({inputs:{input:r},backend:n}),a=ew({inputs:{x:i},backend:n,attrs:{dtype:o}});return n.disposeIntermediateTensorInfo(i),a}if(!aD(r.dtype,o)){const i=Ws({inputs:{x:r},backend:n});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(n.shouldExecuteOnCPU([r])){const i=n.texData.get(r.dataId).values,[a,l,c]=nse(i,r.shape,r.dtype,o);return n.makeTensorInfo(a,l,c)}if(o==="int32")return tie(r,n);if(o==="bool"){const i=n.makeTensorInfo([],"bool",Xn("bool",1)),l=S3({inputs:{a:r,b:i},backend:n});return n.disposeIntermediateTensorInfo(i),l}throw new Error(`Error in Cast: failed to cast ${r.dtype} to ${o}`)}const nie={kernelName:Hh,backendName:"webgl",kernelFunc:ew};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sE="return ceil(x);",sie=st({opSnippet:sE,packedOpSnippet:sE,cpuKernelImpl:sse}),rie={kernelName:Gh,backendName:"webgl",kernelFunc:sie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class oie{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class iie{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{clipValueMin:o,clipValueMax:i}=s;let a;K().getBool("WEBGL_PACK_CLIP")?a=new iie(r.shape):a=new oie(r.shape);const l=[[o],[i]];return n.runWebGLProgram(a,[r],r.dtype,l)}const lie={kernelName:jh,backendName:"webgl",kernelFunc:aie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cie{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rE(t,e){return{dataId:e.dataId,dtype:e.dtype,shape:t.shape}}function uie(t){const{inputs:e,backend:n}=t,{x:s}=e,r=n.texData.get(s.dataId),o=new cie(s.shape),i=[rE(s,r.complexTensorInfos.real),rE(s,r.complexTensorInfos.imag)];return n.runWebGLProgram(o,i,i[0].dtype)}const die={kernelName:z0,backendName:"webgl",kernelFunc:uie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hie{constructor(e){this.outputShape=[],this.outputShape=_o(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const n=new Array(e.length-1);n[0]=e[0][1];for(let i=1;i<n.length;i++)n[i]=n[i-1]+e[i][1];const s=[`if (yC < ${n[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<n.length;i++){const a=n[i-1];s.push(`else if (yC < ${n[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const r=n.length,o=n[n.length-1];s.push(`else setOutput(getT${r}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${s.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class fie{constructor(e,n){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=_o(e,n);const s=this.outputShape,r=s.length,o=yt(r),i=ls("coords",r),a=["x","y","z","w","u","v"].slice(0,r);this.variableNames=e.map((m,x)=>`T${x}`);const l=new Array(e.length-1);l[0]=e[0][n];for(let m=1;m<l.length;m++)l[m]=l[m-1]+e[m][n];const c=a[n],u=a.slice(-2),d=a.join();let h=`if (${c} < ${l[0]}) {
        return getChannel(
            getT0(${d}), vec2(${u.join()}));
        }`;for(let m=1;m<l.length;m++){const x=l[m-1];h+=`
        if (${c} < ${l[m]}  && ${c} >= ${l[m-1]}) {
          return getChannel(
            getT${m}(${Up(a,c,x)}),
            vec2(${Up(u,c,x)}));
        }`}const f=l.length,p=l[l.length-1];h+=`
        return getChannel(
          getT${f}(${Up(a,c,p)}),
          vec2(${Up(u,c,p)}));`,this.userCode=`
      float getValue(${a.map(m=>"int "+m)}) {
        ${h}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[r-1]} = ${i[r-1]} + 1;
        if (${i[r-1]} < ${s[r-1]}) {
          result.g = getValue(${i});
        }

        ${i[r-2]} = ${i[r-2]} + 1;
        if (${i[r-2]} < ${s[r-2]}) {
          result.a = getValue(${i});
        }

        ${i[r-1]} = ${i[r-1]} - 1;
        if (${i[r-2]} < ${s[r-2]} &&
            ${i[r-1]} < ${s[r-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Up(t,e,n){const s=t.indexOf(e);return t.map((o,i)=>i===s?`${o} - ${n}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ay(t){const{inputs:e,backend:n}=t,{input:s}=e,r=n.texData.get(s.dataId);return Ws({inputs:{x:r.complexTensorInfos.imag},backend:n})}const pie={kernelName:iC,backendName:"webgl",kernelFunc:ay};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pd(t,e,n){const s=t[0].dtype;if(s==="complex64"){const f=t.map(y=>Jf({inputs:{input:y},backend:n})),p=t.map(y=>ay({inputs:{input:y},backend:n})),m=pd(f,e,n),x=pd(p,e,n),g=Ca({inputs:{real:m,imag:x},backend:n});return f.forEach(y=>n.disposeIntermediateTensorInfo(y)),p.forEach(y=>n.disposeIntermediateTensorInfo(y)),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),g}let r=n.shouldExecuteOnCPU(t);if(s==="string"&&(r=!0),r){const f=t.map(v=>{const k=[-1,Z(v.shape.slice(e))];return ue({inputs:{x:v},backend:n,attrs:{shape:k}})}),p=f.map(v=>({vals:n.readSync(v.dataId),shape:v.shape})),m=_o(f.map(v=>v.shape),1),x=f[0].shape[0]===1,g=rse(p,m,s,x),y=_o(t.map(v=>v.shape),e),b=n.makeTensorInfo(y,s,g);return f.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const o=t.filter(f=>Z(f.shape)>0),i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&o[0].shape.length>1;if(o.length===1){const f=i?new So(t[0].shape,Ti):new Pi(t[0].shape,Ti);return n.runWebGLProgram(f,t,s)}const a=K().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(o.length>a){const f=[];for(let m=0;m<o.length;m+=a){const x=o.slice(m,m+a);f.push(pd(x,e,n))}const p=pd(f,e,n);for(const m of f)n.disposeIntermediateTensorInfo(m);return p}if(i){const f=new fie(o.map(p=>p.shape),e);return n.runWebGLProgram(f,o,s)}const{tensors2D:l,outShape:c}=mie(o,e,n),u=new hie(l.map(f=>f.shape)),d=n.runWebGLProgram(u,l,s);l.forEach(f=>n.disposeIntermediateTensorInfo(f));const h=ue({inputs:{x:d},attrs:{shape:c},backend:n});return n.disposeIntermediateTensorInfo(d),h}function mie(t,e,n){const s=_o(t.map(o=>o.shape),e);return{tensors2D:t.map(o=>ue({inputs:{x:o},attrs:{shape:[-1,Z(o.shape.slice(e))]},backend:n})),outShape:s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $3(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s,o=je(r,e[0].shape)[0],i=e.map(c=>c.shape);mS(i,o);const a=_o(e.map(c=>c.shape),o);if(Z(a)===0)return n.makeTensorInfo(a,e[0].dtype,[]);const l=e.filter(c=>Z(c.shape)>0);return l.length===1?Ws({inputs:{x:l[0]},backend:n}):pd(l,o,n)}const gie={kernelName:B0,backendName:"webgl",kernelFunc:$3};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class I3{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,l=e.strideHeight,c=e.strideWidth,u=e.dilationHeight,d=e.dilationWidth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4,x=e.dataFormat==="channelsLast",g=x?1:2,y=x?2:3,b=x?3:1;let v="",w="";s&&(r?v=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?v=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:v=`
          float activation(float x) {
            ${s}
          }
        `,w="result = activation(result);");const k=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${v}

      const ivec2 strides = ivec2(${l}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${b}];

        ivec2 xRCCorner =
            ivec2(coords[${g}], coords[${y}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${h}; wR++) {
          int xR = xRCorner + wR * ${u};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${f}; wC++) {
            int xC = xCCorner + wC * ${d};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${p}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${x}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${m===1}) {

              if (${x}) {
                dotProd +=
                    getX(batch, xR, xC, ${p}) *
                    getW(wR, wC, ${p}, d2);
              } else {
                dotProd +=
                    getX(batch, ${p}, xR, xC) *
                    getW(wR, wC, ${p}, d2);
              }

            } else if (${m===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2)
              );

              if (${x}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${m===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${p}, d2),
                getW(wR, wC, ${p} + 1, d2),
                getW(wR, wC, ${p} + 2, d2)
              );

              if (${x}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${p}),
                  getX(batch, xR, xC, ${p} + 1),
                  getX(batch, xR, xC, ${p} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${p}, xR, xC),
                  getX(batch, ${p} + 1, xR, xC),
                  getX(batch, ${p} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${k}
        ${w}
        setOutput(result);
      }
    `}}class xie{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const n=e.padInfo.front,s=e.padInfo.top,r=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=e.dilationDepth,c=e.dilationHeight,u=e.dilationWidth,d=e.filterDepth,h=e.filterHeight,f=e.filterWidth,p=Math.floor(e.inChannels/4)*4,m=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${n}, ${s}, ${r});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${d}; wF++) {
          int xF = xFCorner + wF * ${l};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${h}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${f}; wC++) {
              int xC = xCCorner + wC * ${u};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${p}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${m===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${p}) *
                  getW(wF, wR, wC, ${p}, d2);
              } else if (${m===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${m===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${p}),
                  getX(batch, xF, xR, xC, ${p} + 1),
                  getX(batch, xF, xR, xC, ${p} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${p}, d2),
                  getW(wF, wR, wC, ${p} + 1, d2),
                  getW(wF, wR, wC, ${p} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class T3{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Jn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,l=e.dilationWidth,c=e.filterHeight,u=e.filterWidth,d=u;let h=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let x=0;x<u;x++)h+=`
           vec4 xTexelC${x*2};
           int xTexelC${x*2}Ready;
           vec4 xTexelC${x*2+1};
           int xTexelC${x*2+1}Ready;
           vec4 xC${x};`;h+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let x=0;x<u;x++)h+=`
           xTexelC${x*2} = vec4(0.0);
           xTexelC${x*2}Ready = 0;
           xTexelC${x*2+1} = vec4(0.0);
           xTexelC${x*2+1}Ready = 0;
           xC${x} = vec4(0.0);`;h+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let x=0;x<(d+1)/2;x++){const g=x*2;if(h+=`
           xC = xCCorner + ${g*l};
           `,a===1){if(g<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }
               `,l===1&&g>0?h+=`
                 xC${g} = vec4(xTexelC${g-2}.zw, xTexelC${g}.xy);
                 `:h+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${g} = vec4(previous.zw, xTexelC${g}.xy);
                   } else {
                     xC${g} = vec4(0.0, 0.0, xTexelC${g}.xy);
                   }
                   `):h+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xC${g} = xTexelC${g};
                 `,g+1<u)){const y=i%2===0?Ak(l):l;l%2===0&&i%2===1||l%2!==0&&i%2!==1?(h+=`
                   xCOffset = xC + imod(pads[1], 2) + ${y};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                     xTexelC${g+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${g+1}.zw = vec2(0.0);
                     }
                     xTexelC${g+1}Ready = 1;
                   }
                   `,l>1?h+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${g+1} = vec4(previous.zw, xTexelC${g+1}.xy);
                     } else {
                      xC${g+1} = vec4(0.0, 0.0, xTexelC${g+1}.xy);
                     }
                     `:h+=`
                     xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.xy);
                     `):y===1?h+=`
                     xC${g+1} = xTexelC${g};
                     `:h+=`
                     xCOffset = xC + ${y};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                       xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${g+1}.zw = vec2(0.0);
                       }
                       xTexelC${g+1}Ready = 1;
                     }

                     xC${g+1} = xTexelC${g+1};
                     `}}else g<u&&(i%2===1?(h+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.0);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
               `,g+1<u&&(h+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${g+1} = vec4(xTexelC${g+1}.xy, final.xy);
                 `)):(h+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${g}Ready == 0) {
                   xTexelC${g} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${g}.zw = vec2(0.0);
                   }
                   xTexelC${g}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${g+1}Ready == 0) {
                   xTexelC${g+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${g+1}.zw = vec2(0.);
                   }
                   xTexelC${g+1}Ready = 1;
                 }

                 xC${g} = vec4(
                   xTexelC${g}.xy, xTexelC${g+1}.xy);
               `,g+1<u&&(h+=`
                   xC${g+1} = vec4(xTexelC${g}.zw, xTexelC${g+1}.zw);
                 `)));g<u&&(h+=`
             wTexel = getW(r, ${g}, d1, d2);
             dotProd += xC${g}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${g}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,g+1<u&&(h+=`
               wTexel = getW(r, ${g+1}, d1, d2);
               dotProd += xC${g+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${g+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}h+=`
     }
   `,h+=`
     }
   `,h+=`
     }
   `;let f="",p="";s&&(r?f=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${s}
         }`:o?f=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${s}
         }`:f=`vec4 activation(vec4 x) {
           ${s}
         }`,p="result = activation(result);");const m=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${f}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${h}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${m}
         ${p}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yie{constructor(e,n){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Jn(this.outputShape.length);const{dataFormat:s}=n,r=ps(),o=s==="channelsLast",i=o?1:2,a=o?2:3,l=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let u=0;u<=1;u++)for(let d=0;d<=1;d++)c+=`
          blockIndex = rc.z + ${d};
          pos = rc.y + ${u};

          ${l}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${u*2+d}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${r.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ug(t,e){const n=t.length;return n>=3?e?[...t.slice(0,-3),t[n-3]*t[n-2],t[n-1]]:[...t.slice(0,-3),t[n-3],t[n-2]*t[n-1]]:!e&&n===1&&t[0]>1?[t[0],1]:null}function E3({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const l=t.shape,c=s.texData.get(t.dataId),u=n.inChannels,d=l[0]*l[1]*l[2],h=n.outChannels,f=n.dataFormat==="channelsLast",p=!1,m=!1;let x;const g=[];if(o!=null){const v=Ug(o.shape,f);v!=null&&(o=ue({inputs:{x:o},backend:s,attrs:{shape:v}}),g.push(o))}if(r!=null){const v=Ug(r.shape,f);v!=null&&(r=ue({inputs:{x:r},backend:s,attrs:{shape:v}}),g.push(r))}if(!((d===1||h===1)&&u>v3)&&c.isPacked&&f&&c.texture!=null&&l[2]%2!==0&&lt(c.shape.slice(-3),l.slice(-3))){const v=l[0]*l[1]*(l[2]+1),w={dataId:t.dataId,shape:[1,v,n.inChannels],dtype:t.dtype},k=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,T(Vg(c.shape,w.shape),()=>`packed reshape ${c.shape} to ${w.shape} isn't free`);const C=ue({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}});g.push(C);const S=Wg({a:w,b:C,backend:s,transposeA:p,transposeB:m,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),I=s.texData.get(S.dataId);T(I.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=k,I.shape=n.outShape,x=Ws({inputs:{x:S},backend:s}),x.shape=n.outShape,g.push(S)}else{const v=n.outHeight*n.outWidth,w=ue({inputs:{x:t},backend:s,attrs:{shape:f?[n.batchSize,v,n.inChannels]:[n.batchSize,n.inChannels,v]}}),k=ue({inputs:{x:e},backend:s,attrs:{shape:[1,n.inChannels,n.outChannels]}}),C=Wg({a:f?w:k,b:f?k:w,transposeA:!f,transposeB:m,backend:s,bias:r,activation:a,preluActivationWeights:o,leakyreluAlpha:i});x=ue({inputs:{x:C},backend:s,attrs:{shape:n.outShape}}),g.push(w),g.push(k),g.push(C)}for(const v of g)s.disposeIntermediateTensorInfo(v);return x}function N3({x:t,filter:e,convInfo:n,backend:s,bias:r=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:l,filterHeight:c,inChannels:u,outWidth:d,outHeight:h,dataFormat:f}=n,p=f==="channelsLast",m=l*c*u,x=h*d,g=[n.batchSize,m,x],y=!0,b=!1,v=[];if(o!=null){const N=Ug(o.shape,p);N!=null&&(o=ue({inputs:{x:o},backend:s,attrs:{shape:N}}),v.push(o))}if(r!=null){const N=Ug(r.shape,p);N!=null&&(r=ue({inputs:{x:r},backend:s,attrs:{shape:N}}),v.push(r))}const w=ue({inputs:{x:e},backend:s,attrs:{shape:[1,m,Z(e.shape)/m]}});v.push(w);const k=new yie(g,n),C=[t.shape,[n.padInfo.top,n.padInfo.left],[n.strideHeight,n.strideWidth],[n.dilationHeight,n.dilationWidth],[n.inChannels],[n.filterWidth*n.inChannels],[n.outWidth]],S=s.runWebGLProgram(k,[t],"float32",C),I=ue({inputs:{x:S},backend:s,attrs:{shape:g}});v.push(S),v.push(I);const $=r!=null,E=o!=null,_=a==="leakyrelu",D=a?gh(a,!0):null,F=new b3(p?I.shape:w.shape,p?w.shape:I.shape,p?[n.batchSize,x,n.outChannels]:[n.batchSize,n.outChannels,x],y,b,$,D,E,_),R=p?[I,w]:[w,I];if(r&&R.push(r),E&&R.push(o),_){const N=s.makeTensorInfo([],"float32",ma(i,"float32"));R.push(N),v.push(N)}const P=s.runWebGLProgram(F,R,"float32"),M=ue({inputs:{x:P},backend:s,attrs:{shape:n.outShape}});v.push(P);for(const N of v)s.disposeIntermediateTensorInfo(N);return M}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dataFormat:l,dilations:c,dimRoundingMode:u}=s,d=bi(l),h=Ln(r.shape,o.shape,i,c,a,u,!1,d);let f;if(h.filterHeight===1&&h.filterWidth===1&&h.dilationHeight===1&&h.dilationWidth===1&&h.strideHeight===1&&h.strideWidth===1&&(h.padInfo.type==="SAME"||h.padInfo.type==="VALID"))f=E3({x:r,filter:o,convInfo:h,backend:n});else if(h.strideWidth<=2&&d==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const m=new T3(h),x=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];f=n.runWebGLProgram(m,[r,o],"float32",x)}else if(K().getBool("WEBGL_CONV_IM2COL"))f=N3({x:r,filter:o,convInfo:h,backend:n});else{const m=new I3(h);f=n.runWebGLProgram(m,[r,o],"float32")}const p=ue({inputs:{x:f},backend:n,attrs:{shape:h.outShape}});return n.disposeIntermediateTensorInfo(f),p}const vie={kernelName:V0,backendName:"webgl",kernelFunc:bie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              ${i?`float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);`:`float dyValue = getDy(b, d2, yR, yC);
              float xValue = getX(b, d1, xR, xC);
              dotProd += (xValue * dyValue);`}
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class kie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=n-1-e.padInfo.top,l=s-1-e.padInfo.left,c=i?1:2,u=i?2:3,d=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${d}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${u}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Cie{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${n} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${s} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${r} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class Sie{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterDepth,s=e.filterHeight,r=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,l=n-1-e.padInfo.front,c=s-1-e.padInfo.top,u=r-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${l}, ${c}, ${u});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${n}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${n} - 1 - wF;

          for (int wR = 0; wR < ${s}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${s} - 1 - wR;

            for (int wC = 0; wC < ${r}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${r} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,dataFormat:l,dimRoundingMode:c,filterShape:u}=s,d=bi(l),h=Ln(r.shape,u,i,1,a,c,!1,d),f=new wie(h);return n.runWebGLProgram(f,[r,o],"float32")}const Iie={kernelName:Gk,backendName:"webgl",kernelFunc:$ie};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Tie{constructor(e){this.variableNames=["dy","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"strides",type:"vec2"}],this.outputShape=e.inShape,this.enableShapeUniforms=Jn(this.outputShape.length);const n=e.filterHeight,s=e.filterWidth,r=n-1-e.padInfo.top,o=s-1-e.padInfo.left;this.userCode=`
      const ivec2 pads = ivec2(${r}, ${o});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];

        ivec2 dyCorner = ivec2(coords[1], coords[2]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        vec4 result = vec4(0.);
        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / strides[0];
          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);
          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            int wCPerm = ${s} - 1 - wC;

            float dyC = float(dyCCorner + wC) / strides[1];
            bool idyCVal = (dyC >= 0.0) && (dyC < ${e.outWidth}.0)
              && (fract(dyC) == 0.0);
            int idyC = int(dyC);

            float dyC2 = float(dyCCorner + wC + 1) / strides[1];
            bool idyCVal2 = (dyC2 >= 0.0) && (dyC2 < ${e.outWidth}.0)
              && (fract(dyC2) == 0.0);
            int idyC2 = int(dyC2);

            if (idyCVal && idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec4 dySample2 = (idyC / 2 == idyC2 / 2) ?
                  dySample : getDy(batch, idyR, idyC2, d2);

                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));

                dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample2.xy : dySample2.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC, d2);
                vec2 dyValue = mod(float(idyC), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.xy += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            } else if (idyCVal2) {
              for (int d2 = 0; d2 < ${e.outChannels}; d2 += 2) {
                vec4 wValue = getW(wRPerm, wCPerm, d1, d2);
                vec4 dySample = getDy(batch, idyR, idyC2, d2);
                vec2 dyValue = mod(float(idyC2), 2.) == 0. ?
                  dySample.xy : dySample.zw;
                result.zw += vec2(dot(dyValue, wValue.xy),
                  dot(dyValue, wValue.zw));
              }
            }
          }
        }
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{inputShape:i,strides:a,pad:l,dataFormat:c,dimRoundingMode:u}=s,d=bi(c),h=Ln(i,o.shape,a,1,l,u,!1,d);if(K().getBool("WEBGL_PACK_CONV2DTRANSPOSE")&&d==="channelsLast"){const f=[[h.strideHeight,h.strideWidth]],p=new Tie(h);return n.runWebGLProgram(p,[r,o],"float32",f)}else{const f=new kie(h);return n.runWebGLProgram(f,[r,o],"float32")}}const Nie={kernelName:W0,backendName:"webgl",kernelFunc:Eie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,c=ga(r.shape,o.shape,i,l,a),u=new xie(c);return n.runWebGLProgram(u,[r,o],"float32")}const Rie={kernelName:U0,backendName:"webgl",kernelFunc:_ie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,pad:a,filterShape:l}=s,c=ga(r.shape,l,i,1,a),u=new Cie(c);return n.runWebGLProgram(u,[r,o],"float32")}const Die={kernelName:jk,backendName:"webgl",kernelFunc:Aie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fie(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{pad:i,strides:a,inputShape:l}=s,c=ga(l,o.shape,a,1,i),u=new Sie(c);return n.runWebGLProgram(u,[r,o],"float32")}const Oie={kernelName:Kk,backendName:"webgl",kernelFunc:Fie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pie=Nu+`
  return cos(x);
`,Mie=`
  vec4 result = cos(x);
  bvec4 isNaN = isnan(x);
  ${Ul}
  return result;
`,Lie=st({opSnippet:Pie,packedOpSnippet:Mie}),zie={kernelName:Kh,backendName:"webgl",kernelFunc:Lie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bie=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,Vie=st({opSnippet:Bie}),Wie={kernelName:Xh,backendName:"webgl",kernelFunc:Vie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Uie{constructor(e,n,s,r,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,l,c]=e,[u]=n,[d,h]=s;this.outputShape=[u,d,h,c];const f=r==="bilinear"?1:0,[p,m]=[`${a-1}.0`,`${l-1}.0`],[x,g,y]=d>1?[`${(a-1)/(d-1)}`,"(y2-y1) * height_ratio",`y1*${p} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${p}`],[b,v,w]=h>1?[`${(l-1)/(h-1)}`,"(x2-x1) * width_ratio",`x1*${m} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${m}`];this.userCode=`
      const float height_ratio = float(${x});
      const float width_ratio = float(${b});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${g};
        float width_scale = ${v};

        float in_y = ${y};
        if( in_y < 0.0 || in_y > ${p} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${w};
        if( in_x < 0.0 || in_x > ${m} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${f} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Hie=t=>{const{inputs:e,backend:n,attrs:s}=t,{image:r,boxes:o,boxInd:i}=e,{cropSize:a,method:l,extrapolationValue:c}=s,u=new Uie(r.shape,o.shape,a,l,c);return n.runWebGLProgram(u,[r,o,i],"float32")},Gie={kernelName:qk,backendName:"webgl",kernelFunc:Hie};var yh;(function(t){t.Prod="*",t.Sum="+"})(yh||(yh={}));class oE{constructor(e,n,s,r){this.op=e,this.outputShape=n,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===yh.Prod?"1.0":"0.0",a=s?i:`getX(${iE(o,"coords",this.op)})`,l=this.outputShape[this.outputShape.length-1];let c="",u="";s?(c=r?`end != ${l-1}`:"end != 0",u=r?"end + 1":"end - 1"):(c=r?`end + pow2 < ${l}`:"end >= pow2",u=r?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${yt(o)} coords = getOutputCoords();
        int end = ${aE(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${u};
          ${aE(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${iE(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function iE(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.x, ${e}.y`;if(t===3)return`${e}.x, ${e}.y, ${e}.z`;if(t===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}function aE(t,e,n){if(t===1)return`${e}`;if(t===2)return`${e}.y`;if(t===3)return`${e}.z`;if(t===4)return`${e}.w`;throw new Error(`Cumulative ${n} for rank ${t} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _3(t,e,n,s,r,o){const i=e.shape.length,a=Wt([s],i);let l=e;a!=null&&(l=ds({inputs:{x:e},backend:n,attrs:{perm:a}}));const c=sn(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${s}`);const u=l.shape[c];let d=Ws({inputs:{x:l},backend:n});for(let h=0;h<=Math.ceil(Math.log2(u))-1;h++){const f=new oE(t,l.shape,!1,o),p=[[h]],m=d;d=n.runWebGLProgram(f,[d],d.dtype,p),n.disposeIntermediateTensorInfo(m)}if(r){const h=new oE(t,l.shape,r,o),f=d;d=n.runWebGLProgram(h,[d],d.dtype),n.disposeIntermediateTensorInfo(f)}if(a!=null){const h=xa(a),f=ds({inputs:{x:d},backend:n,attrs:{perm:h}});return n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(l),f}return d}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return _3(yh.Prod,r,n,o,i,a)}const Kie={kernelName:Xk,backendName:"webgl",kernelFunc:jie};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,exclusive:i,reverse:a}=s;return _3(yh.Sum,r,n,o,i,a)}const qie={kernelName:H0,backendName:"webgl",kernelFunc:Xie};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,weights:o}=e,{size:i,binaryOutput:a}=s;if(r.shape.length===1){const l=n.readSync(r.dataId),c=n.readSync(o.dataId),u=u3(l,c,o.dtype,o.shape,i);return n.makeTensorInfo([i],o.dtype,u)}else if(r.shape.length===2){const l=n.bufferSync(r),c=n.bufferSync(o),u=ese(l,c,i,a);return n.makeTensorInfo(u.shape,o.dtype,u.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${r.shape.length}.`)}const Qie={kernelName:Yk,backendName:"webgl",kernelFunc:Yie};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zie{constructor(e,n,s){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=n,this.dataFormat=s,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${n};
      int offset_h = imod(h, ${n});
      int in_w = w / ${n};
      int offset_w = imod(w, ${n});
      int offset_d = (offset_h * ${n} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jie(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockSize:o,dataFormat:i}=s,a=r.shape[0],l=i==="NHWC"?r.shape[1]:r.shape[2],c=i==="NHWC"?r.shape[2]:r.shape[3],u=i==="NHWC"?r.shape[3]:r.shape[1],d=l*o,h=c*o,f=u/(o*o),p=i==="NHWC"?[a,d,h,f]:[a,f,d,h],m=new Zie(p,o,i);return n.runWebGLProgram(m,[r],r.dtype)}const eae={kernelName:Qk,backendName:"webgl",kernelFunc:Jie};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class R3{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Jn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,l=e.outChannels/e.inChannels;let c="",u="";s&&(r?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:c=`
          float activation(float x) {
            ${s}
          }
        `,u="result = activation(result);");const d=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${l};
        int q = d2 - d1 * ${l};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${d}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class A3{constructor(e,n=!1,s=null,r=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Jn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,l=e.strideWidth,c=e.dilationWidth,u=e.filterHeight,d=e.filterWidth,h=d;let f=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let g=0;g<d;g++)f+=`
          vec4 xTexelC${g*2};
          int xTexelC${g*2}Ready;
          vec4 xTexelC${g*2+1};
          int xTexelC${g*2+1}Ready;
          vec4 xC${g};`;f+=`
    for (int r = 0; r < ${u}; r++) {
      `;for(let g=0;g<d;g++)f+=`
          xTexelC${g*2} = vec4(0.0);
          xTexelC${g*2}Ready = 0;
          xTexelC${g*2+1} = vec4(0.0);
          xTexelC${g*2+1}Ready = 0;
          xC${g} = vec4(0.0);`;f+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let g=0;g<(h+1)/2;g++){const y=g*2;if(f+=`
          xC = xCCorner + ${y*c};
          `,l===1){if(y<d&&(a%2===1?(f+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }
              `,c===1&&y>0?f+=`
                xC${y} = vec4(xTexelC${y-2}.zw, xTexelC${y}.xy);
                `:f+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${y} = vec4(previous.zw, xTexelC${y}.xy);
                  } else {
                    xC${y} = vec4(0.0, 0.0, xTexelC${y}.xy);
                  }
                  `):f+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xC${y} = xTexelC${y};
                `,y+1<d)){const b=a%2===0?Ak(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(f+=`
                  xCOffset = xC + imod(pads[1], 2) + ${b};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                    xTexelC${y+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${y+1}.zw = vec2(0.0);
                    }
                    xTexelC${y+1}Ready = 1;
                  }
                  `,c>1?f+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${y+1} = vec4(previous.zw, xTexelC${y+1}.xy);
                    } else {
                     xC${y+1} = vec4(0.0, 0.0, xTexelC${y+1}.xy);
                    }
                    `:f+=`
                    xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.xy);
                    `):b===1?f+=`
                    xC${y+1} = xTexelC${y};
                    `:f+=`
                    xCOffset = xC + ${b};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                      xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${y+1}.zw = vec2(0.0);
                      }
                      xTexelC${y+1}Ready = 1;
                    }

                    xC${y+1} = xTexelC${y+1};
                    `}}else y<d&&(a%2===1?(f+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.0);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
              `,y+1<d&&(f+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${y+1} = vec4(xTexelC${y+1}.xy, final.xy);
                `)):(f+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${y}Ready == 0) {
                  xTexelC${y} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${y}.zw = vec2(0.0);
                  }
                  xTexelC${y}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${y+1}Ready == 0) {
                  xTexelC${y+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${y+1}.zw = vec2(0.);
                  }
                  xTexelC${y+1}Ready = 1;
                }

                xC${y} = vec4(
                  xTexelC${y}.xy, xTexelC${y+1}.xy);
              `,y+1<d&&(f+=`
                  xC${y+1} = vec4(xTexelC${y}.zw, xTexelC${y+1}.zw);
                `)));y<d&&(f+=`
            wTexel = getW(r, ${y}, d1, q);
            dotProd += xC${y} * vec4(wTexel.xz, wTexel.xz);
          `,y+1<d&&(f+=`
              wTexel = getW(r, ${y+1}, d1, q);
              dotProd += xC${y+1} * vec4(wTexel.xz, wTexel.xz);
            `))}f+=`
    }
  `,f+=`
      }
    `;let p="",m="";s&&(r?p=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${s}
        }`:o?p=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${s}
        }`:p=`vec4 activation(vec4 x) {
          ${s}
        }`,m="result = activation(result);");const x=n?"result += getBiasAtOutCoords();":"";n&&this.variableNames.push("bias"),r&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${p}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${f}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${x}
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tae(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l,dimRoundingMode:c}=s;let u=l;u==null&&(u=[1,1]),T(Qn(i,u),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${u}'`);const d=Ln(r.shape,o.shape,i,u,a,c,!0);let h;K().getBool("WEBGL_PACK_DEPTHWISECONV")&&d.strideWidth<=2&&d.outChannels/d.inChannels===1?h=new A3(d):h=new R3(d);const f=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];return n.runWebGLProgram(h,[r,o],"float32",f)}const nae={kernelName:G0,backendName:"webgl",kernelFunc:tae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sae{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const n=e.strideHeight,s=e.strideWidth,r=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${n} - ${r};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${s} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class rae{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const n=e.filterHeight,s=e.filterWidth,r=e.strideHeight,o=e.strideWidth,i=n-1-e.padInfo.top,a=s-1-e.padInfo.left,l=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${n}; wR++) {
          float dyR = float(dyRCorner + wR) / ${r}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${n} - 1 - wR;

          for (int wC = 0; wC < ${s}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${s} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${l}; dm++) {
              int d2 = d1 * ${l} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function oae(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,dy:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,filterShape:u}=s,d=Ln(r.shape,u,i,a,l,c,!0),h=new sae(d);return n.runWebGLProgram(h,[r,o],"float32")}const iae={kernelName:Zk,backendName:"webgl",kernelFunc:oae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aae(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,filter:o}=e,{strides:i,dilations:a,pad:l,dimRoundingMode:c,inputShape:u}=s,d=Ln(u,o.shape,i,a,l,c,!0),h=new rae(d);return n.runWebGLProgram(h,[r,o],"float32")}const lae={kernelName:Jk,backendName:"webgl",kernelFunc:aae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cae{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uae(t){const{inputs:e,backend:n}=t,{x:s}=e,r=[...s.shape,...s.shape],o=Z(s.shape),i=ue({inputs:{x:s},backend:n,attrs:{shape:[o]}}),a=new cae(o),l=n.runWebGLProgram(a,[i],i.dtype),c=ue({inputs:{x:l},backend:n,attrs:{shape:r}});return n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(l),c}const dae={kernelName:fD,backendName:"webgl",kernelFunc:uae};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class hae{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:n,inWidth:s,padInfo:r,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:l,dilationHeight:c,dilationWidth:u}=e,{top:d,left:h}=r;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${d}, ${h});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${n}) {
            for (int w = 0; w < ${l}; w++) {
              int wIn = wBeg + w * ${u};

              if (wIn >= 0 && wIn < ${s}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fae(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o}=e,{strides:i,pad:a,dilations:l}=s,c=Df(r.shape,o.shape,i,a,"NHWC",l);let u;const d=new hae(c);u=n.runWebGLProgram(d,[r,o],"float32");const h=ue({inputs:{x:u},backend:n,attrs:{shape:c.outShape}});return n.disposeIntermediateTensorInfo(u),h}const pae={kernelName:j0,backendName:"webgl",kernelFunc:fae};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mae(t){const{inputs:e,backend:n,attrs:s}=t,{equation:r}=s,o=e,{allDims:i,summedDims:a,idDims:l}=TS(r,o.length);NS(i.length,l,o);const{path:c,steps:u}=_S(a,l),d=u.length;let h=null,f=i.length;const p=[];for(let m=0;m<d;++m){for(const x of u[m]){const{permutationIndices:g,expandDims:y}=ES(f,l[x]);let b;RS(g)?b=o[x]:(b=ds({inputs:{x:o[x]},backend:n,attrs:{perm:g}}),p.push(b));const v=b.shape.slice();for(let w=0;w<y.length;++w)v.splice(y[w],0,1);lt(b.shape,v)||(b=ue({inputs:{x:b},backend:n,attrs:{shape:v}}),p.push(b)),h===null?h=b:(h=y$({inputs:{a:b,b:h},backend:n}),p.push(h))}m<d-1&&(c[m]>=0&&(h=iy({inputs:{x:h},backend:n,attrs:{axis:c[m]-(i.length-f),keepDims:!1}}),p.push(h)),f--)}for(const m of p)m!==h&&n.disposeIntermediateTensorInfo(m);return h}const gae={kernelName:eC,backendName:"webgl",kernelFunc:mae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xae="return (x >= 0.0) ? x : (exp(x) - 1.0);",yae=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,bae=st({opSnippet:xae,packedOpSnippet:yae}),vae={kernelName:Yh,backendName:"webgl",kernelFunc:bae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wae="return (b >= 0.0) ? a : a * (b + 1.0);",kae=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,Cae=t=>{const{inputs:e,backend:n}=t,{dy:s,y:r}=e,o=K().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new Eu(kae,s.shape,r.shape):new Sl(wae,s.shape,r.shape);return n.runWebGLProgram(o,[s,r],s.dtype)},Sae={kernelName:tC,backendName:"webgl",kernelFunc:Cae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $ae=`
  return vec4(equal(a, b));
`,Iae="return float(a == b);",Tae=Bn({opSnippet:Iae,packedOpSnippet:$ae,dtype:"bool",cpuKernelImpl:ose}),Eae={kernelName:K0,backendName:"webgl",kernelFunc:Tae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nae=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${vS};
  float a1 = ${wS};
  float a2 = ${kS};
  float a3 = ${CS};
  float a4 = ${SS};
  float a5 = ${$S};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,_ae=st({opSnippet:Nae}),Rae={kernelName:Qh,backendName:"webgl",kernelFunc:_ae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Aae=Nu+`
  return exp(x);
`,Dae=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,D3=st({opSnippet:Aae,packedOpSnippet:Dae,cpuKernelImpl:ise,dtype:"float32"}),Fae={kernelName:Zh,backendName:"webgl",kernelFunc:D3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tw(t){const{inputs:e,attrs:n,backend:s}=t,{dim:r}=n,{input:o}=e,i=o.shape.length,a=o.shape.slice();let l=r;return r<0&&(T(-(i+1)<=r,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),l=i+r+1),a.splice(l,0,1),ue({inputs:{x:o},backend:s,attrs:{shape:a}})}const Oae={kernelName:X0,backendName:"webgl",kernelFunc:tw};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lE="return exp(x) - 1.0;",Pae=st({opSnippet:lE,packedOpSnippet:lE,cpuKernelImpl:ase}),Mae={kernelName:Jh,backendName:"webgl",kernelFunc:Pae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cE{constructor(e,n,s){this.variableNames=["real","imag"];const r=n[1];this.outputShape=n;const o=s?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=s?`${r}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${r});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${r}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F3(t,e,n){const s=n.texData.get(t.dataId),r=Z(t.shape),o=t.shape[t.shape.length-1],i=r/o,a=ue({inputs:{x:t},backend:n,attrs:{shape:[i,o]}}),l=a.shape,c=new cE("real",l,e),u=new cE("imag",l,e),d=[{dataId:s.complexTensorInfos.real.dataId,dtype:s.complexTensorInfos.real.dtype,shape:l},{dataId:s.complexTensorInfos.imag.dataId,dtype:s.complexTensorInfos.imag.dtype,shape:l}],h=n.runWebGLProgram(c,d,"float32"),f=n.runWebGLProgram(u,d,"float32"),p=Ca({inputs:{real:h,imag:f},backend:n});n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f);const m=ue({inputs:{x:p},backend:n,attrs:{shape:t.shape}});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(p),m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lae(t){const{inputs:e,backend:n}=t,{input:s}=e;return F3(s,!1,n)}const zae={kernelName:nC,backendName:"webgl",kernelFunc:Lae};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bae{constructor(e,n){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ep(t){const{backend:e,attrs:n}=t,{shape:s,value:r}=n;let{dtype:o}=n;if(o=o||pu(r),o==="string"){const i=Jt(o,Z(s));return i.fill(r),e.makeTensorInfo(s,o,i)}else{const i=new Bae(s,r),a=[[r]];return e.runWebGLProgram(i,[],o,a)}}const Vae={kernelName:sC,backendName:"webgl",kernelFunc:ep};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Wae{constructor(e){this.variableNames=["Image"],this.outputShape=[];const n=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${n} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${n}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uae={kernelName:rC,backendName:"webgl",kernelFunc:({inputs:t,backend:e})=>{const{image:n}=t,s=e,r=new Wae(n.shape);return s.runWebGLProgram(r,[n],n.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uE="return floor(x);",Hae=st({opSnippet:uE,packedOpSnippet:uE,cpuKernelImpl:lse}),Gae={kernelName:ef,backendName:"webgl",kernelFunc:Hae};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jae=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,Kae=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,Xae=Bn({opSnippet:jae,packedOpSnippet:Kae,dtype:"int32"}),qae={kernelName:tf,backendName:"webgl",kernelFunc:Xae};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Yae{constructor(e){this.variableNames=["A"];const n=ps(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}.0, ${s}.0);

        vec4 values = ${n.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qae{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const n=ps(),[s,r]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${r}.0, ${s}.0);
            vec4 values = ${n.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${n.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zae={kernelName:pU,backendName:"webgl",kernelFunc:Jae};let Yl,t1=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function Jae(t){const{inputs:e,backend:n,attrs:s}=t;let{pixels:r}=e;const{numChannels:o}=s,i=typeof HTMLVideoElement<"u"&&r instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&r instanceof HTMLImageElement,[l,c]=i?[r.videoWidth,r.videoHeight]:[r.width,r.height],u=[c,l],d=[c,l,o];if(a||i){const m=K().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(Yl==null||m!==t1)&&(t1=m,Yl=document.createElement("canvas").getContext("2d",{willReadFrequently:t1})),Yl.canvas.width=l,Yl.canvas.height=c,Yl.drawImage(r,0,0,l,c),r=Yl.canvas}const h=n.makeTensorInfo(u,"int32");n.texData.get(h.dataId).usage=Ys.PIXELS,n.gpgpu.uploadPixelDataToTexture(n.getTexture(h.dataId),r);const f=K().getBool("WEBGL_PACK")?new Qae(d):new Yae(d),p=n.runWebGLProgram(f,[h],"int32");return n.disposeData(h.dataId),p}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ele(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dataFormat:u,dilations:d,dimRoundingMode:h,activation:f,leakyreluAlpha:p}=s,m=bi(u),x=Ln(r.shape,o.shape,l,d,c,h,!1,m);let g;const y=[],b=i!=null,v=a!=null,w=f==="leakyrelu",k=()=>{const S=[r,o],I=($,E)=>{if(E==="NCHW"&&$.shape.length===1&&$.shape[0]!==1){const _=ue({inputs:{x:$},backend:n,attrs:{shape:[$.shape[0],1,1]}});return y.push(_),_}return $};if(b&&S.push(I(i,u)),v&&S.push(I(a,u)),w){const $=n.makeTensorInfo([],"float32",ma(p,"float32"));S.push($),y.push($)}return S};if(x.filterHeight===1&&x.filterWidth===1&&x.dilationHeight===1&&x.dilationWidth===1&&x.strideHeight===1&&x.strideWidth===1&&(x.padInfo.type==="SAME"||x.padInfo.type==="VALID"))g=E3({x:r,filter:o,convInfo:x,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else if(x.strideWidth<=2&&m==="channelsLast"&&K().getBool("WEBGL_EXP_CONV")){const S=f?gh(f,!0):null,I=new T3(x,b,S,v,w),$=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],E=k();g=n.runWebGLProgram(I,E,"float32",$)}else if(K().getBool("WEBGL_CONV_IM2COL"))g=N3({x:r,filter:o,convInfo:x,backend:n,bias:i,activation:f,preluActivationWeights:a,leakyreluAlpha:p});else{const S=f?gh(f,!1):null,I=new I3(x,b,S,v,w),$=k();g=n.runWebGLProgram(I,$,"float32")}const C=ue({inputs:{x:g},backend:n,attrs:{shape:x.outShape}});return y.push(g),y.forEach(S=>n.disposeIntermediateTensorInfo(S)),C}const tle={kernelName:yg,backendName:"webgl",kernelFunc:ele};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nle(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,filter:o,bias:i,preluActivationWeights:a}=e,{strides:l,pad:c,dilations:u,dimRoundingMode:d,activation:h,leakyreluAlpha:f}=s,p=[];let m=u;m==null&&(m=[1,1]),T(Qn(l,m),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${l} and dilations '${m}'`);const x=Ln(r.shape,o.shape,l,m,c,d,!0),g=K().getBool("WEBGL_PACK_DEPTHWISECONV")&&x.strideWidth<=2&&x.outChannels/x.inChannels===1,y=h?gh(h,g):null,b=[r,o],v=i!=null,w=a!=null,k=h==="leakyrelu";if(v&&b.push(i),w&&b.push(a),k){const $=n.makeTensorInfo([],"float32",ma(f,"float32"));b.push($),p.push($)}let C;g?C=new A3(x,v,y,w,k):C=new R3(x,v,y,w,k);const S=[[x.padInfo.top,x.padInfo.left],[x.strideHeight,x.strideWidth],[x.dilationHeight,x.dilationWidth],[x.inHeight,x.inWidth]],I=n.runWebGLProgram(C,b,"float32",S);return p.forEach($=>n.disposeIntermediateTensorInfo($)),I}const sle={kernelName:AD,backendName:"webgl",kernelFunc:nle};class rle{constructor(e,n,s,r){this.sliceDim=e,this.strides=n,this.paramsShape=r,this.variableNames=["x","indices"],this.outputShape=s;const o=yt(s.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ole(t){const{inputs:e,backend:n}=t,{params:s,indices:r}=e,o=r.shape,i=o[o.length-1],a=Z(s.shape),[l,c,u,d]=cS(s,r),h=ue({inputs:{x:r},backend:n,attrs:{shape:[c,i]}}),f=ue({inputs:{x:s},backend:n,attrs:{shape:[Z(s.shape)/u,u]}});if(n.shouldExecuteOnCPU([s,r])||s.dtype==="string"){const g=n.readSync(r.dataId),y=n.bufferSync(s),b=cse(g,y,s.dtype,c,i,u,d,s.shape,a);return n.makeTensorInfo(l,s.dtype,b.values)}const p=new rle(i,d,[c,u],s.shape),m=n.runWebGLProgram(p,[f,h],f.dtype),x=ue({inputs:{x:m},backend:n,attrs:{shape:l}});return n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(m),x}const ile={kernelName:pD,backendName:"webgl",kernelFunc:ole};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ale{constructor(e,n){this.variableNames=["A","indices"],this.outputShape=n,this.rank=n.length;const s=yt(this.rank),r=lle(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${r}));
      }
    `}}function lle(t,e){const n=["resRC.x","resRC.y","resRC.z","resRC.w"],s=[];for(let r=0;r<t.length;r++)r===2?s.push("index"):s.push(`${n[r]}`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O3(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,indices:o}=e,{axis:i,batchDims:a}=s,l=je(i,r.shape)[0];if(K().get("DEBUG")){const y=n.readSync(o.dataId),b=r.shape[l];for(let v=0;v<y.length;++v){const w=y[v];T(w<=b-1&&w>=0,()=>`GatherV2: the index value ${w} is not in [0, ${b-1}]`)}}const c=DS(r,o,l,a),u=Z(o.shape),d=[],h=ue({inputs:{x:r},backend:n,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),f=ue({inputs:{x:o},backend:n,attrs:{shape:[c.batchSize,u/c.batchSize]}});d.push(h),d.push(f);const p=[c.batchSize,c.outerSize,u/c.batchSize,c.sliceSize];if(n.shouldExecuteOnCPU([r,o])||r.dtype==="string"){const y=n.bufferSync(f),b=n.bufferSync(h),v=use(b,y,p);return d.forEach(w=>n.disposeIntermediateTensorInfo(w)),n.makeTensorInfo(c.outputShape,v.dtype,v.values)}const m=new ale(h.shape,p),x=n.runWebGLProgram(m,[h,f],h.dtype);d.push(x);const g=ue({inputs:{x},backend:n,attrs:{shape:c.outputShape}});return d.forEach(y=>n.disposeIntermediateTensorInfo(y)),g}const cle={kernelName:Y0,backendName:"webgl",kernelFunc:O3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ule="return float(a > b);",dle=`
  return vec4(greaterThan(a, b));
`,hle=Bn({opSnippet:ule,packedOpSnippet:dle,cpuKernelImpl:dse,dtype:"bool"}),fle={kernelName:Q0,backendName:"webgl",kernelFunc:hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ple="return float(a >= b);",mle=`
  return vec4(greaterThanEqual(a, b));
`,gle=Bn({opSnippet:ple,packedOpSnippet:mle,dtype:"bool",cpuKernelImpl:hse}),xle={kernelName:nf,backendName:"webgl",kernelFunc:gle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yle(t){const{inputs:e,backend:n}=t,{input:s}=e;return F3(s,!0,n)}const ble={kernelName:oC,backendName:"webgl",kernelFunc:yle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const vle="return float(!isnan(x) && !isinf(x));",wle=st({opSnippet:vle,dtype:"bool"}),kle={kernelName:rf,backendName:"webgl",kernelFunc:wle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cle="return float(isinf(x));",Sle=st({opSnippet:Cle,dtype:"bool"}),$le={kernelName:of,backendName:"webgl",kernelFunc:Sle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ile="return float(isnan(x));",Tle=st({opSnippet:Ile,dtype:"bool"}),Ele={kernelName:af,backendName:"webgl",kernelFunc:Tle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nle="return float(a < b);",_le=`
  return vec4(lessThan(a, b));
`,Rle=Bn({opSnippet:Nle,packedOpSnippet:_le,cpuKernelImpl:fse,dtype:"bool"}),Ale={kernelName:J0,backendName:"webgl",kernelFunc:Rle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dle="return float(a <= b);",Fle=`
  return vec4(lessThanEqual(a, b));
`,Ole=Bn({opSnippet:Dle,packedOpSnippet:Fle,cpuKernelImpl:pse,dtype:"bool"}),Ple={kernelName:ex,backendName:"webgl",kernelFunc:Ole};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mle(t){const{backend:e,attrs:n}=t,{start:s,stop:r,num:o}=n,i=mse(s,r,o);return e.makeTensorInfo([i.length],"float32",i)}const Lle={kernelName:mD,backendName:"webgl",kernelFunc:Mle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const zle=Nu+`
  return x < 0.0 ? 0./0. : log(x);
`,Ble=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,Vle=st({opSnippet:zle,packedOpSnippet:Ble,cpuKernelImpl:gse}),Wle={kernelName:lf,backendName:"webgl",kernelFunc:Vle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ule=Nu+`
  return log(1.0 + x);
`,Hle=st({opSnippet:Ule}),Gle={kernelName:cf,backendName:"webgl",kernelFunc:Hle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jle="return float(a >= 1.0 && b >= 1.0);",Kle=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,Xle=Bn({opSnippet:jle,packedOpSnippet:Kle,dtype:"bool"}),qle={kernelName:tx,backendName:"webgl",kernelFunc:Xle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Yle="return float(!(x >= 1.0));",Qle=st({opSnippet:Yle}),Zle={kernelName:nx,backendName:"webgl",kernelFunc:Qle};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Jle="return float(a >= 1.0 || b >= 1.0);",ece=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,tce=Bn({opSnippet:Jle,packedOpSnippet:ece,dtype:"bool"}),nce={kernelName:sx,backendName:"webgl",kernelFunc:tce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class sce{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[];const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${l};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rce{constructor(e,n,s,r,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=n,a=e[3]-1;this.outputShape=e;let l;const c=`float(${s}) + float(${r}) * sum`;o===.5?l=`inversesqrt(${c})`:o===1?l=`1.0/(${c})`:l=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${l};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oce=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{depthRadius:o,bias:i,alpha:a,beta:l}=s,c=K().getBool("WEBGL_PACK_NORMALIZATION")?new rce(r.shape,o,i,a,l):new sce(r.shape,o,i,a,l);return n.runWebGLProgram(c,[r],r.dtype)},ice={kernelName:rx,backendName:"webgl",kernelFunc:oce};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ace{constructor(e,n,s,r,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=n,this.bias=s,this.alpha=r,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${n})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${n} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${r}) * norm + float(${s});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${r})
                * float(${o})
                * getInputImage(b, r, c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lce=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r,y:o,dy:i}=e,{depthRadius:a,bias:l,alpha:c,beta:u}=s,d=new ace(r.shape,a,l,c,u);return n.runWebGLProgram(d,[r,o,i],r.dtype)},cce={kernelName:aC,backendName:"webgl",kernelFunc:lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uce(t,e,n,s){const r=Z(e),i=Z(t.shape)/r,a=ue({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Hl(a,t.dtype,"max",s),c=ue({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P3(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reductionIndices:o,keepDims:i}=s,a=r.shape.length,l=je(o,r.shape);let c=l;const u=Wt(c,a),d=u!=null,h=n.shouldExecuteOnCPU([r]);let f=r;if(d){if(h){const b=n.texData.get(f.dataId).values,v=new Array(a);for(let C=0;C<v.length;C++)v[C]=r.shape[u[C]];const w=g$(b,r.shape,r.dtype,u,v);f=n.makeTensorInfo(v,r.dtype);const k=n.texData.get(f.dataId);k.values=w}else f=oy(r,u,n);c=sn(c.length,a)}zn("max",c,a);const[p,m]=An(f.shape,c);let x=p;i&&(x=fn(p,l));let g;if(h){const b=n.texData.get(f.dataId).values,v=xse(b,Z(m),x,r.dtype);g=n.makeTensorInfo(x,r.dtype);const w=n.texData.get(g.dataId);w.values=v}else g=uce(f,m,x,n);return d&&n.disposeIntermediateTensorInfo(f),g}const dce={kernelName:ox,backendName:"webgl",kernelFunc:P3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hce=x$+`
  return max(a, b);
`,fce=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ul+`
  return result;
`,pce=Bn({opSnippet:hce,packedOpSnippet:fce,cpuKernelImpl:yse}),mce={kernelName:uf,backendName:"webgl",kernelFunc:pce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;Qf(r,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:l}=s,c=1;T(Qn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const u=Pr(r.shape,o,i,c,a,l);if(u.filterWidth===1&&u.filterHeight===1&&lt(u.inShape,u.outShape))return Ws({inputs:{x:r},backend:n});const d=new xh(u,"max",!1);return n.runWebGLProgram(d,[r],r.dtype)}const xce={kernelName:ix,backendName:"webgl",kernelFunc:gce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{filterSize:o,strides:i,pad:a,dataFormat:l,dimRoundingMode:c}=s,u=[1,1,1],d=yi(r.shape,o,i,u,a,c,l),h=new b$(d,"max",!1);return n.runWebGLProgram(h,[r],r.dtype)}const bce={kernelName:ax,backendName:"webgl",kernelFunc:yce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vce{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideHeight,s=e.strideWidth,r=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,l=i-1-e.padInfo.left,c=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${l});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${r}) {
          float dyR = float(dyRCorner + wR) / ${n}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${s}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class wce{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const n=e.strideDepth,s=e.strideHeight,r=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,l=e.effectiveFilterDepth,c=e.effectiveFilterHeight,u=e.effectiveFilterWidth,d=l-1-e.padInfo.front,h=c-1-e.padInfo.top,f=u-1-e.padInfo.left,p=l*c*u-1;this.userCode=`
      const ivec3 pads = ivec3(${d}, ${h}, ${f});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${l};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${n}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${s}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${u};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${r}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${p} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${u} +
                  wR * ${u} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kce(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o}=e,i=o,{filterSize:a,strides:l,pad:c,dimRoundingMode:u}=s,d=[1,1,1],h=yi(i.shape,a,l,d,c,u),f=new b$(h,"max",!0),p=n.runWebGLProgram(f,[i],i.dtype),m=new wce(h),x=n.runWebGLProgram(m,[r,p],i.dtype);return n.disposeIntermediateTensorInfo(p),x}const Cce={kernelName:cC,backendName:"webgl",kernelFunc:kce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sce(t){const{inputs:e,backend:n,attrs:s}=t,{dy:r,input:o,output:i}=e,a=o;Qf([o,i],"maxPoolGrad");const{filterSize:l,strides:c,pad:u,dimRoundingMode:d}=s,h=Pr(a.shape,l,c,1,u,d),f=!0,p=new xh(h,"max",f),m=n.runWebGLProgram(p,[a],a.dtype),x=new vce(h),g=n.runWebGLProgram(x,[r,m],a.dtype);return n.disposeIntermediateTensorInfo(m),g}const $ce={kernelName:lC,backendName:"webgl",kernelFunc:Sce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ice(t,e,n,s){let r=new xh(n,"max",!1);const o=s.runWebGLProgram(r,[t],"float32");r=new xh(n,"max",!0,!0,e);const i=s.runWebGLProgram(r,[t],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tce={kernelName:gD,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{filterSize:r,strides:o,pad:i,includeBatchInIndex:a}=e,l=n;T(s.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${s.shape.length}.`);const c=[1,1];T(Qn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const u=Pr(s.shape,r,o,c,i),[d,h]=Ice(s,a,u,l);return[d,h]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ece(t,e,n,s){const r=Z(e),i=Z(t.shape)/r,a=ue({inputs:{x:t},attrs:{shape:[i,r]},backend:s}),l=Hl(a,"float32","mean",s),c=ue({inputs:{x:l},attrs:{shape:n},backend:s});return s.disposeIntermediateTensorInfo(a),s.disposeIntermediateTensorInfo(l),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nce={kernelName:lx,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{x:s}=t,{keepDims:r,axis:o}=e,i=n,a=s.shape.length,l=je(o,s.shape);let c=l;const u=Wt(c,a),d=u!=null,h=i.shouldExecuteOnCPU([s]),f=[];let p=s;if(d){if(h){const v=i.texData.get(p.dataId).values,w=new Array(a);for(let S=0;S<w.length;S++)w[S]=s.shape[u[S]];const k=g$(v,s.shape,s.dtype,u,w);p=i.makeTensorInfo(w,s.dtype);const C=i.texData.get(p.dataId);C.values=k}else p=oy(s,u,i);f.push(p),c=sn(c.length,a)}zn("sum",c,a);const[m,x]=An(p.shape,c);let g=m;r&&(g=fn(m,l));const y=Ece(p,x,g,i);for(const b of f)i.disposeIntermediateTensorInfo(b);return y}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _ce(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=je(o,r.shape);let c=l;const u=Wt(c,a);let d=r;u!=null&&(d=ds({inputs:{x:r},backend:n,attrs:{perm:u}}),c=sn(c.length,r.shape.length)),zn("min",c,a);const[h,f]=An(d.shape,c),p=Z(f),m=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,p]}}),x=Hl(m,m.dtype,"min",n);let g;if(i){const y=fn(h,l);g=ue({inputs:{x},backend:n,attrs:{shape:y}})}else g=ue({inputs:{x},backend:n,attrs:{shape:h}});return n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(x),u!=null&&n.disposeIntermediateTensorInfo(d),g}const Rce={kernelName:cx,backendName:"webgl",kernelFunc:_ce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ace=x$+`
  return min(a, b);
`,Dce=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+Ul+`
  return result;
`,Fce=Bn({opSnippet:Ace,packedOpSnippet:Dce,cpuKernelImpl:bse}),Oce={kernelName:df,backendName:"webgl",kernelFunc:Fce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Pce{constructor(e,n,s){this.variableNames=["x"],this.outputShape=n.map((u,d)=>u[0]+e[d]+u[1]);const r=e.length,o=yt(r),i=n.map(u=>u[0]).join(","),a=n.map((u,d)=>u[0]+e[d]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r),c=s==="reflect"?0:1;if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${r}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${l}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Mce{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=n.map((p,m)=>p[0]+e[m]+p[1]);const r=e.length,o=yt(r),i=n.map(p=>p[0]).join(","),a=n.map((p,m)=>p[0]+e[m]).join(","),l=ls("rc",r),c=ls("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=s==="reflect"?0:1;let f="";if(r===1){const p=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${h};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${h};
        }
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
      `}else{const p=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${h}) +
                gte * ((end - 1) * 2 - source + ${h});
        source -= start;
      `;f=`
        ${o} rc = outputLoc;
        ${p}
        result[0] = getChannel(getX(${c.join()}), ${d});
        ${l[r-1]} += 1;
        if(${u}) {
          ${p}
          result[1] = getChannel(getX(${c.join()}), ${d});
        }
        rc = outputLoc;
        ${l[r-2]} += 1;
        if(${l[r-2]} < ${this.outputShape[r-2]}) {
          ${p}
          result[2] = getChannel(getX(${c.join()}), ${d});
          ${l[r-1]} += 1;
          if(${u}) {
            ${p}
            result[3] = getChannel(getX(${c.join()}), ${d});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${f}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lce=({inputs:t,backend:e,attrs:n})=>{const{x:s}=t,{paddings:r,mode:o}=n,i=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new Mce(s.shape,r,o):new Pce(s.shape,r,o);return e.runWebGLProgram(i,[s],s.dtype)},zce={kernelName:ux,backendName:"webgl",kernelFunc:Lce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bce=`if (b == 0.0) return NAN;
  return mod(a, b);`,Vce=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+Ul+`
  return result;
`,Wce=Bn({opSnippet:Bce,packedOpSnippet:Vce}),Uce={kernelName:hf,backendName:"webgl",kernelFunc:Wce};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hce{constructor(e,n,s){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,s],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${n-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${n-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Gce=`
if (a == b) {
  return 1.0;
};
return a / b;`,jce=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,M3=Bn({opSnippet:Gce,packedOpSnippet:jce,checkOutOfBounds:!0}),Kce={kernelName:qh,backendName:"webgl",kernelFunc:M3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dE="return a - b;",L3=Bn({opSnippet:dE,packedOpSnippet:dE,supportsComplex:!0,cpuKernelImpl:Bse}),Xce={kernelName:Ef,backendName:"webgl",kernelFunc:L3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z3(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{dim:o}=s,i=je([o],r.shape),a=P3({inputs:{x:r},backend:n,attrs:{reductionIndices:i,keepDims:!1}}),l=fn(a.shape,i),c=ue({inputs:{x:a},backend:n,attrs:{shape:l}}),u=L3({inputs:{a:r,b:c},backend:n}),d=D3({inputs:{x:u},backend:n}),h=iy({inputs:{x:d},backend:n,attrs:{axis:i,keepDims:!1}}),f=ue({inputs:{x:h},backend:n,attrs:{shape:l}}),p=M3({inputs:{a:d,b:f},backend:n});return n.disposeIntermediateTensorInfo(a),n.disposeIntermediateTensorInfo(c),n.disposeIntermediateTensorInfo(u),n.disposeIntermediateTensorInfo(d),n.disposeIntermediateTensorInfo(h),n.disposeIntermediateTensorInfo(f),p}const qce={kernelName:Ex,backendName:"webgl",kernelFunc:z3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yce(t){const{inputs:e,backend:n,attrs:s}=t,{logits:r}=e,{numSamples:o,seed:i,normalized:a}=s,l=a?r:z3({inputs:{logits:r},backend:n,attrs:{dim:r.shape.length-1}}),c=l.shape[0],u=l.shape[1],d=new Hce(c,u,o),h=[[i]],f=n.runWebGLProgram(d,[l],"int32",h);return a||n.disposeIntermediateTensorInfo(l),f}const Qce={kernelName:xD,backendName:"webgl",kernelFunc:Yce};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zce=Lr+`
  return -x;
`,Jce=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function eue(t){const{inputs:e,backend:n}=t,{x:s}=e;if(n.shouldExecuteOnCPU([s])){const o=n.texData.get(s.dataId),[i,a]=wse(o.values,s.shape,s.dtype);return n.makeTensorInfo(a,s.dtype,i)}let r;return K().getBool("WEBGL_PACK_UNARY_OPERATIONS")?r=new Pi(s.shape,Jce):r=new So(s.shape,Zce),n.runWebGLProgram(r,[s],s.dtype)}const tue={kernelName:dx,backendName:"webgl",kernelFunc:eue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nue=rS;function sue(t){Ks("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l}=s,c=n.readSync(r.dataId),u=n.readSync(o.dataId),{selectedIndices:d}=nue(c,u,i,a,l);return n.makeTensorInfo([d.length],"int32",new Int32Array(d))}const rue={kernelName:uC,backendName:"webgl",kernelFunc:sue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oue=oS;function iue(t){Ks("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,padToMaxOutputSize:c}=s,u=n.readSync(r.dataId),d=n.readSync(o.dataId),{selectedIndices:h,validOutputs:f}=oue(u,d,i,a,l,c);return[n.makeTensorInfo([h.length],"int32",new Int32Array(h)),n.makeTensorInfo([],"int32",new Int32Array([f]))]}const aue={kernelName:dC,backendName:"webgl",kernelFunc:iue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lue=iS;function cue(t){Ks("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:n,attrs:s}=t,{boxes:r,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:l,softNmsSigma:c}=s,u=n.readSync(r.dataId),d=n.readSync(o.dataId),h=i,f=a,p=l,m=c,{selectedIndices:x,selectedScores:g}=lue(u,d,h,f,p,m);return[n.makeTensorInfo([x.length],"int32",new Int32Array(x)),n.makeTensorInfo([g.length],"float32",new Float32Array(g))]}const uue={kernelName:hC,backendName:"webgl",kernelFunc:cue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class due{constructor(e,n,s,r){this.variableNames=["indices"],this.outputShape=[e,n],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${r}), float(${s}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hue=t=>{const{inputs:e,backend:n,attrs:s}=t,{indices:r}=e,{dtype:o,depth:i,onValue:a,offValue:l}=s,c=Z(r.shape),u=new due(c,i,a,l),d=ue({inputs:{x:r},backend:n,attrs:{shape:[c]}}),h=n.runWebGLProgram(u,[d],o);n.disposeIntermediateTensorInfo(d);const f=[...r.shape,i],p=ue({inputs:{x:h},backend:n,attrs:{shape:f}});return n.disposeIntermediateTensorInfo(h),p},fue={kernelName:px,backendName:"webgl",kernelFunc:hue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hg(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="complex64"){const r=Jf({inputs:{input:s},backend:n}),o=Hg({inputs:{x:r},backend:n}),i=ay({inputs:{input:s},backend:n}),a=Hg({inputs:{x:i},backend:n}),l=Ca({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return ep({attrs:{shape:s.shape,dtype:s.dtype,value:s.dtype==="string"?"":0},backend:n})}const pue={kernelName:Rx,backendName:"webgl",kernelFunc:Hg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(t){const{inputs:e,backend:n}=t,{x:s}=e;if(s.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(s.dtype==="complex64"){const r=Jf({inputs:{input:s},backend:n}),o=B3({inputs:{x:r},backend:n}),i=ay({inputs:{input:s},backend:n}),a=Hg({inputs:{x:i},backend:n}),l=Ca({inputs:{real:o,imag:a},backend:n});return n.disposeIntermediateTensorInfo(r),n.disposeIntermediateTensorInfo(o),n.disposeIntermediateTensorInfo(i),n.disposeIntermediateTensorInfo(a),l}else return ep({attrs:{shape:s.shape,dtype:s.dtype,value:1},backend:n})}const mue={kernelName:fx,backendName:"webgl",kernelFunc:B3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gue(t){const{inputs:e,backend:n,attrs:s}=t,{axis:r}=s;if(e.length===1)return tw({inputs:{input:e[0]},backend:n,attrs:{dim:r}});const o=e[0].shape,i=e[0].dtype;e.forEach(u=>{Dk(o,u.shape,"All tensors passed to stack must have matching shapes"),T(i===u.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],l=e.map(u=>{const d=tw({inputs:{input:u},backend:n,attrs:{dim:r}});return a.push(d),d}),c=$3({inputs:l,backend:n,attrs:{axis:r}});return a.forEach(u=>n.disposeIntermediateTensorInfo(u)),c}const xue={kernelName:mx,backendName:"webgl",kernelFunc:gue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yue{constructor(e,n,s){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((c,u)=>c[0]+e[u]+c[1]);const r=e.length,o=yt(r),i=n.map(c=>c[0]).join(","),a=n.map((c,u)=>c[0]+e[u]).join(","),l=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,r);if(r===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${l}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bue{constructor(e,n,s){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=n.map((m,x)=>m[0]+e[x]+m[1]);const r=e.length,o=yt(r),i=n.map(m=>m[0]).join(","),a=n.map((m,x)=>m[0]+e[x]).join(","),l=ls("rc",r),c=ls("source",r),u=`${l[r-1]} < ${this.outputShape[r-1]}`,d=r===1?"source":`vec2(${c.slice(-2).join()})`,h=[`${o} rc = outputLoc;`,`${l[r-1]} += 1;
       if(${u}) {
      `,r===1?"":`}
       rc = outputLoc;
       ${l[r-2]} += 1;
       if(${l[r-2]} < ${this.outputShape[r-2]}) {`,r===1?"":`  ${l[r-1]} += 1;
         if(${u}) {`],f=r===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let p="";for(let m=0,x=r===1?2:4;m<x;m++)p+=`
        ${h[m]}
        if (${f}) {
          result[${m}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${m}] = getChannel(getX(${c.join()}), ${d});
        }
      `;p+=r===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${p}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V3=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{paddings:o,constantValue:i}=s;if(Z(r.shape)===0){const c=o.map((u,d)=>u[0]+r.shape[d]+u[1]);return ep({backend:n,attrs:{shape:c,value:i,dtype:r.dtype}})}const a=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new bue(r.shape,o,i):new yue(r.shape,o,i),l=[[i]];return n.runWebGLProgram(a,[r],r.dtype,l)},vue={kernelName:gx,backendName:"webgl",kernelFunc:V3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wue=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,kue=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+Ul+`
  return result;
`,Cue=Bn({opSnippet:wue,packedOpSnippet:kue}),Sue={kernelName:pf,backendName:"webgl",kernelFunc:Cue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $ue(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{axis:o,keepDims:i}=s,a=r.shape.length,l=[],c=je(o,r.shape);let u=c;const d=Wt(u,a);let h=r;d!=null&&(h=ds({inputs:{x:r},backend:n,attrs:{perm:d}}),u=sn(u.length,a),l.push(h)),zn("prod",u,a);let f;if(n.shouldExecuteOnCPU([h])){const p=n.texData.get(h.dataId).values,{outVals:m,outShape:x,outDtype:g}=Cse(h.shape,h.dtype,p,u);f=n.makeTensorInfo(x,g,m)}else{const[p,m]=An(h.shape,u),x=Z(m),g=ue({inputs:{x:h},backend:n,attrs:{shape:[-1,x]}}),y=$C(r.dtype),b=Hl(g,y,"prod",n);f=ue({inputs:{x:b},backend:n,attrs:{shape:p}}),l.push(g),l.push(b)}if(i){l.push(f);const p=fn(f.shape,c);f=ue({inputs:{x:f},backend:n,attrs:{shape:p}})}return l.forEach(p=>n.disposeIntermediateTensorInfo(p)),f}const Iue={kernelName:yx,backendName:"webgl",kernelFunc:$ue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tue(t){const{inputs:e,backend:n,attrs:s}=t,{paramsNestedSplits:r,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=s,l=r.map(g=>n.readSync(g.dataId)),c=r.map(g=>g.shape),u=n.readSync(o.dataId),d=n.readSync(i.dataId),[h,f,p]=Sse(l,c,u,o.shape,o.dtype,d,i.shape,a),m=h.map(g=>n.makeTensorInfo([g.length],"int32",g)),x=n.makeTensorInfo(p,o.dtype,f);return m.concat([x])}const Eue={kernelName:yD,backendName:"webgl",kernelFunc:Tue};/**
 * @license
 * Copyright 2022 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nue(t){const{inputs:e,backend:n}=t,{starts:s,limits:r,deltas:o}=e,i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=$se(i,s.shape,s.dtype,a,r.shape,l,o.shape),d=n.makeTensorInfo([c.length],"int32",c),h=n.makeTensorInfo([u.length],s.dtype,u);return[d,h]}const _ue={kernelName:bD,backendName:"webgl",kernelFunc:Nue};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rue(t){const{inputs:e,backend:n,attrs:s}=t,{shape:r,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:l}=s,c=n.readSync(r.dataId),u=n.readSync(o.dataId),d=n.readSync(i.dataId),h=a.map(x=>n.readSync(x.dataId)),f=a.map(x=>x.shape),[p,m]=Ise(c,r.shape,u,o.shape,o.dtype,d,i.shape,h,f,l);return n.makeTensorInfo(p,o.dtype,m)}const Aue={kernelName:vD,backendName:"webgl",kernelFunc:Rue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const W3=t=>{const{backend:e,attrs:n}=t,{start:s,stop:r,step:o,dtype:i}=n,a=Tse(s,r,o,i);return e.makeTensorInfo([a.length],i,a)},Due={kernelName:fC,backendName:"webgl",kernelFunc:W3};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fue="return 1.0 / x;",Oue=st({opSnippet:Fue}),Pue={kernelName:mf,backendName:"webgl",kernelFunc:Oue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mue=Lr+`
  return (x < 0.0) ? 0.0 : x;
`,Lue=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,zue=st({opSnippet:Mue,packedOpSnippet:Lue}),Bue={kernelName:gf,backendName:"webgl",kernelFunc:zue};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vue=Lr+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Wue=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Uue=st({opSnippet:Vue,packedOpSnippet:Wue}),Hue={kernelName:xf,backendName:"webgl",kernelFunc:Uue};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Gue{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":h="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jue{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s];let h;o?h="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":h="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${h};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kue(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new jue(r.shape,l,c,o,i):new Gue(r.shape,l,c,o,i);return n.runWebGLProgram(u,[r],"float32")}const Xue={kernelName:wx,backendName:"webgl",kernelFunc:Kue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class que{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${r-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yue(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new que(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const Que={kernelName:gC,backendName:"webgl",kernelFunc:Yue};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Zue{constructor(e,n,s,r,o){this.variableNames=["A"],this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":f="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${u[0]/d[0]},
          ${u[1]/d[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${l}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Jue{constructor(e,n,s,r,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,l,c]=e;this.outputShape=[i,n,s,c];const u=[r&&n>1?a-1:a,r&&s>1?l-1:l],d=[r&&n>1?n-1:n,r&&s>1?s-1:s],h=r?"0.5":"0.0";let f;o?f="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":f="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${u[0]/d[0]},
          ${u[1]/d[1]},
          ${u[1]/d[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${l}.0,
                                     ${l}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${f};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${h})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${s-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ede(t){const{inputs:e,backend:n,attrs:s}=t,{images:r}=e,{alignCorners:o,halfPixelCenters:i,size:a}=s,[l,c]=a,u=K().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new Jue(r.shape,l,c,o,i):new Zue(r.shape,l,c,o,i);return n.runWebGLProgram(u,[r],r.dtype)}const tde={kernelName:vx,backendName:"webgl",kernelFunc:ede};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nde{constructor(e,n,s){this.variableNames=["dy"],this.outputShape=[],this.outputShape=n;const[,r,o]=n,[,i,a]=e,l=[s&&i>1?r-1:r,s&&a>1?o-1:o],c=[s&&i>1?i-1:i,s&&a>1?a-1:a],u=l[0]/c[0],d=l[1]/c[1],h=1/u,f=1/d,p=Math.ceil(h)*2+2,m=Math.ceil(f)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${u});
        const float widthScale = float(${d});

        const float invHeightScale = float(${h});
        const float invWidthScale = float(${f});

        const int winHeight = int(${p});
        const int winWidth = int(${m});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${l[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${l[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${r}) - 1),
                ${s} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${s} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sde(t){const{inputs:e,backend:n,attrs:s}=t,{images:r,dy:o}=e,{alignCorners:i}=s,a=new nde(o.shape,r.shape,i);return n.runWebGLProgram(a,[o],o.dtype)}const rde={kernelName:mC,backendName:"webgl",kernelFunc:sde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ode{constructor(e,n){this.variableNames=["x"];const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);if(this.outputShape=e,s===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const r=a=>n.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,l)=>r(l)).join(","),i=yt(s);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ide{constructor(e,n){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const s=e.length;if(s>4)throw new Error(`WebGL backend: Reverse of rank-${s} tensor is not yet supported`);this.outputShape=e;const r=ls("rc",s),o=`${r[s-1]} + 1 < ${this.outputShape[s-1]}`,i=`${r[s-2]} + 1 < ${this.outputShape[s-2]}`,a=yt(s);s===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${l(r.slice())};
          if(${o}){
            result.g = ${c(r.slice())};
          }
          if(${i}) {
            result.b = ${u(r.slice())};
            if(${o}) {
              result.a = ${d(r.slice())};
            }
          }
          setOutput(result);
        }
    `;function l(p){return h(p)}function c(p){return p[s-1]="("+p[s-1]+" + 1)",h(p)}function u(p){return p[s-2]="("+p[s-2]+" + 1)",h(p)}function d(p){return p[s-1]="("+p[s-1]+" + 1)",p[s-2]="("+p[s-2]+" + 1)",h(p)}function h(p){const m=e.map((y,b)=>f(b,p)),x=m.join(","),g=m.slice(-2).join(",");return`getChannel(getX(${x}), vec2(${g}))`}function f(p,m){return n.indexOf(p)!==-1&&e[p]!==1?`${e[p]} - ${m[p]} - 1`:`${m[p]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ade(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{dims:o}=s,i=r.shape.length,a=je(o,r.shape);if(i===0)return Ws({inputs:{x:r},backend:n});const l=K().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new ide(r.shape,a):new ode(r.shape,a);return n.runWebGLProgram(l,[r],r.dtype)}const lde={kernelName:kx,backendName:"webgl",kernelFunc:ade};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cde{constructor(e,n){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const s=e[1],r=e[2];this.outputShape=e;let o="";typeof n=="number"?o=`float outputValue = ${n.toFixed(2)};`:o=`
        vec3 fill = vec3(${n.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${r} && coordY >= 0 && coordY < ${s}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ude={kernelName:CC,backendName:"webgl",kernelFunc:({inputs:t,attrs:e,backend:n})=>{const{image:s}=t,{radians:r,fillValue:o,center:i}=e,a=n,l=new cde(s.shape,o),[c,u]=xS(i,s.shape[1],s.shape[2]),d=[[c,u,Math.sin(r),Math.cos(r)]];return a.runWebGLProgram(l,[s],s.dtype,d)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const dde=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,hde=st({opSnippet:dde}),fde={kernelName:yf,backendName:"webgl",kernelFunc:hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const pde="return inversesqrt(x);",mde=st({opSnippet:pde,cpuKernelImpl:Ese}),gde={kernelName:bf,backendName:"webgl",kernelFunc:mde};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class v${constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const c=yt(o.length),u=yt(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const x=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${n}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${p};
              found = true;
            }
          }
          setOutput(mix(${x}, sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xde{constructor(e,n,s,r,o,i,a=!0,l=!1){this.variableNames=["updates","indices","defaultValue"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=i;const c=yt(o.length),u=yt(i.length);let d="";s===1?d="i":s===2&&(d="i, j");const h=`getIndices(${d})`;let f="";r===1?f="i":r===2&&(f="i, coords[1]");const p=`getUpdates(${f})`;let m="";l&&(m="coords[0], coords[1]");const x=`getDefaultValue(${m})`,g=n>1?"strides[j]":"strides",y=n>1?"strides[j + 1]":"strides";this.userCode=`
        ${c} strides = ${c}(${o});

        void main() {
          ${u} coords = getOutputCoords();
          vec4 sum = vec4(0.);
          vec4 found = vec4(0.);
          for (int i = 0; i < ${e}; i+=2) {
            ivec2 flattenedIndex = ivec2(0);
            for (int j = 0; j < ${n}; j+=2) {
              ivec4 index = round(${h});
              flattenedIndex += index.xz * ${g};
              if (j + 1 < ${n}) {
                flattenedIndex += index.yw * ${y};
              }
            }
            if (flattenedIndex[0] == coords[0] || flattenedIndex[1] == coords[0] ||
                flattenedIndex[0] == coords[0] + 1 || flattenedIndex[1] == coords[0] + 1) {
              vec4 updVals = ${p};
              if (flattenedIndex[0] == coords[0]) {
                sum.xy += updVals.xy;
                found.xy = vec2(1.);
              } else if (flattenedIndex[0] == coords[0] + 1) {
                sum.zw += updVals.xy;
                found.zw = vec2(1.);
              }
              if (flattenedIndex[1] == coords[0]) {
                sum.xy += updVals.zw;
                found.xy = vec2(1.);
              } else if (flattenedIndex[1] == coords[0] + 1) {
                sum.zw += updVals.zw;
                found.zw = vec2(1.);
              }
            }
          }
          setOutput(mix(${x}, sum, found));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yde(t){const{inputs:e,backend:n,attrs:s}=t,{indices:r,updates:o}=e,{shape:i}=s,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Ll(o,r,i),h=[d/c,c];if(d===0)return n.makeTensorInfo(i,r.dtype);const f=ue({inputs:{x:r},backend:n,attrs:{shape:[l,a]}}),p=ue({inputs:{x:o},backend:n,attrs:{shape:[l,c]}}),m=n.makeTensorInfo([],"float32",new Float32Array([0]));let x;K().getBool("WEBGL_PACK")?x=new xde(l,a,f.shape.length,p.shape.length,u,h):x=new v$(l,a,f.shape.length,p.shape.length,u,h);const g=n.runWebGLProgram(x,[p,f,m],p.dtype),y=ue({inputs:{x:g},backend:n,attrs:{shape:i}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(g),n.disposeIntermediateTensorInfo(m),y}const bde={kernelName:wD,backendName:"webgl",kernelFunc:yde};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vde{constructor(e,n,s,r){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,s];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(n+1))}; ++i) { if (left >= right) break;`,a=K().getNumber("WEBGL_VERSION")===2?o:i,l=r==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${l} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wde(t){const{inputs:e,backend:n,attrs:s}=t,{sortedSequence:r,values:o}=e,{side:i}=s,a=new vde(r.shape[0],r.shape[1],o.shape[1],i),l=[[r.shape[1]]];return n.runWebGLProgram(a,[r,o],"int32",l)}const kde={kernelName:CD,backendName:"webgl",kernelFunc:wde};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Cde{constructor(e,n,s){this.variableNames=["c","a","b"],this.outputShape=n;let r,o;if(s>4)throw Error(`Where for rank ${s} is not yet supported`);if(s===1)o="resRC",r="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],l=[],c=[];for(let u=0;u<n.length;u++)c.push(`${a[u]}`),u<e&&l.push(`${a[u]}`);r=l.join(),o=c.join()}const i=yt(s);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${r});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sde(t){const{inputs:e,backend:n}=t,{condition:s,t:r,e:o}=e,i=new Cde(s.shape.length,r.shape,r.shape.length);return n.runWebGLProgram(i,[s,r,o],Bs(r.dtype,o.dtype))}const $de={kernelName:Cx,backendName:"webgl",kernelFunc:Sde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ide=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${Ux};
  float scale = ${Hx};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,Tde=st({opSnippet:Ide}),Ede={kernelName:vf,backendName:"webgl",kernelFunc:Tde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nde=Nu+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,_de=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,Rde=st({opSnippet:Nde,packedOpSnippet:_de,cpuKernelImpl:_se}),Ade={kernelName:Sf,backendName:"webgl",kernelFunc:Rde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Dde=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,Fde=st({opSnippet:Dde}),Ode={kernelName:Cf,backendName:"webgl",kernelFunc:Fde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pde=Nu+`
  return sin(x);
`,Mde=`
  vec4 result = sin(x);
  bvec4 isNaN = isnan(x);
  ${Ul}
  return result;
`,Lde=st({opSnippet:Pde,packedOpSnippet:Mde}),zde={kernelName:wf,backendName:"webgl",kernelFunc:Lde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Bde=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,Vde=st({opSnippet:Bde}),Wde={kernelName:kf,backendName:"webgl",kernelFunc:Vde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ude=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,Hde=st({opSnippet:Ude}),Gde={kernelName:$f,backendName:"webgl",kernelFunc:Hde};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jde=t=>{const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{blockShape:o,paddings:i}=s;T(r.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((g,y)=>g*y),l=[[0,0]];l.push(...i);for(let g=1+o.length;g<r.shape.length;++g)l.push([0,0]);const c=[],u=V3({inputs:{x:r},backend:n,attrs:{paddings:l,constantValue:0}}),d=Lf(u.shape,o,a,!1),h=zf(d.length,o.length,!1),f=Bf(u.shape,o,a,!1),p=ue({inputs:{x:u},backend:n,attrs:{shape:d}}),m=ds({inputs:{x:p},backend:n,attrs:{perm:h}}),x=ue({inputs:{x:m},backend:n,attrs:{shape:f}});return c.push(u),c.push(p),c.push(m),c.forEach(g=>n.disposeIntermediateTensorInfo(g)),x},Kde={kernelName:Ix,backendName:"webgl",kernelFunc:jde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xde(t){const{inputs:e,backend:n}=t,{indices:s,values:r,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(s.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${s.shape}`);if(r.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${r.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=n.readSync(s.dataId),l=n.readSync(r.dataId),c=n.readSync(o.dataId),u=n.readSync(i.dataId)[0],[d,h,f,p,m]=Ase(a,s.shape,s.dtype,l,r.dtype,c,u);return[n.makeTensorInfo(h,s.dtype,d),n.makeTensorInfo([h[0]],r.dtype,f),n.makeTensorInfo([p.length],"bool",new Uint8Array(p.map(x=>Number(x)))),n.makeTensorInfo([m.length],s.dtype,new Int32Array(m))]}const qde={kernelName:SD,backendName:"webgl",kernelFunc:Xde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yde(t){const{inputs:e,backend:n}=t,{inputIndices:s,inputShape:r,newShape:o}=e;if(s.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${s.shape}`);if(r.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${r.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(n.readSync(r.dataId)),a=n.readSync(s.dataId),l=Array.from(n.readSync(o.dataId)),[c,u,d]=Dse(a,s.shape,s.dtype,i,l);return[n.makeTensorInfo(u,s.dtype,c),n.makeTensorInfo([d.length],o.dtype,new Int32Array(d))]}const Qde={kernelName:$D,backendName:"webgl",kernelFunc:Yde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zde(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=h3(i,s.shape,s.dtype,a,l,!0);return n.makeTensorInfo(u,s.dtype,c)}const Jde={kernelName:ID,backendName:"webgl",kernelFunc:Zde};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ehe(t){const{inputs:e,backend:n}=t,{data:s,indices:r,segmentIds:o}=e;if(s.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(r.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${r.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=n.readSync(s.dataId),a=n.readSync(r.dataId),l=n.readSync(o.dataId),[c,u]=h3(i,s.shape,s.dtype,a,l);return n.makeTensorInfo(u,s.dtype,c)}const the={kernelName:TD,backendName:"webgl",kernelFunc:ehe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nhe(t){const{inputs:e,backend:n,attrs:s}=t,{sparseIndices:r,sparseValues:o,defaultValue:i}=e,{outputShape:a}=s,{sliceRank:l,numUpdates:c,sliceSize:u,strides:d,outputSize:h}=Ll(o,r,a),f=!1;if(o.dtype==="string"){const g=n.bufferSync(r),y=n.bufferSync(o),b=sa(n.readSync(i.dataId)[0]),v=Nse(g,y,a,h,u,c,l,d,b,f);return n.makeTensorInfo(a,v.dtype,v.values)}const p=new v$(c,l,r.shape.length,o.shape.length,d,[h,1],f),m=n.runWebGLProgram(p,[o,r,i],o.dtype),x=ue({inputs:{x:m},backend:n,attrs:{shape:a}});return n.disposeIntermediateTensorInfo(m),x}const she={kernelName:ED,backendName:"webgl",kernelFunc:nhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{numOrSizeSplits:o,axis:i}=s,a=je(i,r.shape)[0],l=AS(r,o,a),c=r.shape.length,u=new Array(c).fill(0),d=r.shape.slice();return l.map(h=>{const f=[...d];f[a]=h;const p=_u({inputs:{x:r},backend:n,attrs:{begin:u,size:f}});return u[a]+=h,p})}const ohe={kernelName:Tx,backendName:"webgl",kernelFunc:rhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const hE="return sqrt(x);",ihe=st({opSnippet:hE,packedOpSnippet:hE,cpuKernelImpl:Fse}),ahe={kernelName:If,backendName:"webgl",kernelFunc:ihe};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lhe="return x * x;",che=st({opSnippet:lhe}),uhe={kernelName:xC,backendName:"webgl",kernelFunc:che};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fE="return (a - b) * (a - b);",dhe=Bn({opSnippet:fE,packedOpSnippet:fE}),hhe={kernelName:Tf,backendName:"webgl",kernelFunc:dhe};/**
 * @license
 * Copyright 2023 Google LLC.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e;if(r.dtype!=="string")throw new Error("Input must be of datatype string");const o=n.readSync(r.dataId),i=di(o),a=Ose(i,"string",s);return n.makeTensorInfo(r.shape,"string",a)}const phe={kernelName:yC,backendName:"webgl",kernelFunc:fhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mhe({inputs:t,attrs:e,backend:n}){const{x:s}=t,r=Lr+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new So(s.shape,r);return n.runWebGLProgram(o,[s],s.dtype)}const ghe={kernelName:Af,backendName:"webgl",kernelFunc:mhe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xhe{constructor(e,n,s){this.variableNames=["x"],this.outputShape=s;const r=s.length,o=yt(s.length),i=yt(s.length);let a="";if(r===1)a="coords * strides + begin";else{let l=0;a=s.map((c,u)=>(l++,s.length===1?`coords * strides[${u}] + begin[${u}]`:`coords[${l-1}] * strides[${u}] + begin[${u}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${n});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{begin:o,end:i,strides:a,beginMask:l,endMask:c,ellipsisMask:u,newAxisMask:d,shrinkAxisMask:h}=s,{finalShapeSparse:f,finalShape:p,isIdentity:m,sliceDim0:x,isSimpleSlice:g,begin:y,end:b,strides:v}=pS(r.shape,o,i,a,l,c,u,d,h);let w;if(m)w=ue({inputs:{x:r},backend:n,attrs:{shape:p}});else if(x||g){T(r.shape.length>=1,()=>`Input must have rank at least 1, got: ${r.shape.length}`);const C=dS(y,b,v),S=_u({inputs:{x:r},backend:n,attrs:{begin:y,size:C}});w=ue({inputs:{x:S},backend:n,attrs:{shape:p}}),n.disposeIntermediateTensorInfo(S)}else if(n.shouldExecuteOnCPU([r])){const S=n.readSync(r.dataId),I=Ge(r.shape,r.dtype,S),$=Pse(f,I,v,y);w=n.makeTensorInfo(p,r.dtype,$.values)}else{const S=new xhe(y,v,f);w=n.runWebGLProgram(S,[r],r.dtype)}const k=ue({inputs:{x:w},backend:n,attrs:{shape:p}});return n.disposeIntermediateTensorInfo(w),k}const bhe={kernelName:bC,backendName:"webgl",kernelFunc:yhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vhe(t){const{inputs:e,backend:n,attrs:s}=t,{separator:r,nGramWidths:o,leftPad:i,rightPad:a,padWidth:l,preserveShortSequences:c}=s,{data:u,dataSplits:d}=e,h=n.readSync(u.dataId),f=n.readSync(d.dataId),[p,m]=Mse(h,f,r,o,i,a,l,c);return[n.makeTensorInfo([p.length],"string",p),n.makeTensorInfo(d.shape,"int32",m)]}const whe={kernelName:ND,backendName:"webgl",kernelFunc:vhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function khe(t){const{inputs:e,backend:n,attrs:s}=t,{skipEmpty:r}=s,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=n.readSync(o.dataId),l=n.readSync(i.dataId)[0],[c,u,d]=Lse(a,l,r),h=u.length;return[n.makeTensorInfo([h,2],"int32",c),n.makeTensorInfo([h],"string",u),n.makeTensorInfo([2],"int32",new Int32Array(d))]}const Che={kernelName:_D,backendName:"webgl",kernelFunc:khe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function She(t){const{inputs:e,backend:n,attrs:s}=t,{numBuckets:r}=s,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(r<=0)throw new Error("Number of buckets must be at least 1");const i=n.readSync(o.dataId),a=zse(i,r);return n.makeTensorInfo(o.shape,"int32",a)}const $he={kernelName:RD,backendName:"webgl",kernelFunc:She};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ihe="return tan(x);",The=st({opSnippet:Ihe}),Ehe={kernelName:Nf,backendName:"webgl",kernelFunc:The};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nhe=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,_he=st({opSnippet:Nhe}),Rhe={kernelName:_f,backendName:"webgl",kernelFunc:_he};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ahe(t){const{inputs:e,backend:n,attrs:s}=t,{tensor:r,indices:o,updates:i}=e,{sliceRank:a,numUpdates:l,sliceSize:c,strides:u,outputSize:d}=Ll(i,o,r.shape),h=[d/c,c];if(d===0)return n.makeTensorInfo(r.shape,o.dtype);const f=ue({inputs:{x:o},backend:n,attrs:{shape:[l,a]}}),p=ue({inputs:{x:i},backend:n,attrs:{shape:[l,c]}}),m=ue({inputs:{x:r},backend:n,attrs:{shape:h}}),x=new v$(l,a,f.shape.length,p.shape.length,u,h,!1,!0),g=n.runWebGLProgram(x,[p,f,m],m.dtype),y=ue({inputs:{x:g},backend:n,attrs:{shape:r.shape}});return n.disposeIntermediateTensorInfo(f),n.disposeIntermediateTensorInfo(p),n.disposeIntermediateTensorInfo(m),n.disposeIntermediateTensorInfo(g),y}const Dhe={kernelName:kD,backendName:"webgl",kernelFunc:Ahe};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Fhe{constructor(e,n){this.variableNames=["A"];const s=new Array(e.length);for(let i=0;i<s.length;i++)s[i]=e[i]*n[i];this.outputShape=s,this.rank=s.length;const r=yt(this.rank),o=Ohe(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function Ohe(t){const e=t.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${t[0]})`;const n=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],s=[];for(let r=0;r<t.length;r++)s.push(`imod(${n[r]}, ${t[r]})`);return s.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U3(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{reps:o}=s;if(r.dtype==="string"||r.shape.length>5){const l=n.readSync(r.dataId),c=r.dtype==="string"?l.map(h=>sa(h)):l,u=Ge(r.shape,r.dtype,c),d=Vse(u,o);return n.makeTensorInfo(d.shape,d.dtype,d.values)}const i=new Fhe(r.shape,o);return n.runWebGLProgram(i,[r],r.dtype)}const Phe={kernelName:Rf,backendName:"webgl",kernelFunc:U3};class Mhe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class Lhe{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ia(t,e){e!==null&&t.disposeIntermediateTensorInfo(e)}function pE(t){let e=1;for(;e<t;)e*=2;return e}function zhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r}=e,{k:o,sorted:i}=s,a=K().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),l=K().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=r.shape,u=c[c.length-1];if(n.shouldExecuteOnCPU([r])||u<a||o>l){const $=n.readSync(r.dataId),[E,_]=Wse($,c,r.dtype,o,i);return[n.makeTensorInfo(E.shape,E.dtype,E.values),n.makeTensorInfo(_.shape,_.dtype,_.values)]}if(o===0)return c[c.length-1]=0,[n.makeTensorInfo(c,r.dtype,[]),n.makeTensorInfo(c,"int32",[])];if(u===1)return[r,ep({attrs:{shape:c,dtype:"int32",value:0},backend:n})];const d=n.texData.get(r.dataId),h=d!==null&&d.isPacked,f=h?n.unpackTensor(r):r,m=Z(c)/u,x=ue({inputs:{x:f},attrs:{shape:[m,u]},backend:n});h&&Ia(n,f);const g=pE(o),y=pE(u);let b=null;const v=()=>b===null?[x,x]:[x,b],w=($,E,_)=>{const D=v(),F=new Mhe(_),P=[[u],[b===null?1:0],[Number.NEGATIVE_INFINITY],[$],[E]],M=b;b=n.runWebGLProgram(F,D,"int32",P),Ia(n,M)};for(let $=1;$<g;$*=2){const E=$*2;for(let _=$;_>=1;_/=2)w(E,_,[m,y])}for(let $=y;$>g;$/=2){const E=v(),_=new Lhe([m,$/2]),F=[[u],[b===null?1:0],[g]],R=b;b=n.runWebGLProgram(_,E,"int32",F),Ia(n,R);const P=g/2,M=P*2;for(let N=P;N>=1;N/=2)w(M,N,b.shape)}let k=b;b=_u({inputs:{x:b},backend:n,attrs:{begin:0,size:[m,o]}}),Ia(n,k);let C=O3({inputs:{x,indices:b},backend:n,attrs:{axis:1,batchDims:1}});Ia(n,x);const S=c.slice(0,-1);S.push(o),k=b,b=ue({inputs:{x:b},attrs:{shape:S},backend:n}),Ia(n,k);const I=C;return C=ue({inputs:{x:C},attrs:{shape:S},backend:n}),Ia(n,I),[C,b]}const Bhe={kernelName:vC,backendName:"webgl",kernelFunc:zhe};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vhe{constructor(e,n,s,r,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=s==="nearest"?1:2;let l;switch(r){case"constant":l=1;break;case"reflect":l=2;break;case"wrap":l=3;break;case"nearest":l=4;break;default:l=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${l} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${l} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${n}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${n}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Whe(t){const{inputs:e,backend:n,attrs:s}=t,{image:r,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:l,outputShape:c}=s,[u,d,h,f]=r.shape,[p,m]=c??[d,h],x=[u,p,m,f],g=new Vhe(d,h,i,a,l,x);return n.runWebGLProgram(g,[r,o],"float32")}const Uhe={kernelName:wC,backendName:"webgl",kernelFunc:Whe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hhe(t){const{inputs:e,attrs:n,backend:s}=t,{axis:r}=n,{x:o}=e;Qf(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=s.readSync(o.dataId),{outputValues:a,outputShape:l,indices:c}=Use(i,r,o.shape,o.dtype);return[s.makeTensorInfo(l,o.dtype,a),s.makeTensorInfo([c.length],"int32",c)]}const Ghe={kernelName:kC,backendName:"webgl",kernelFunc:Hhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jhe(t){const{inputs:e,backend:n,attrs:s}=t,{value:r}=e;let{axis:o}=s;o<0&&(o+=r.shape.length);const i=r,a=i.shape.length,l=r.shape[o],c=new Array(a-1);let u=0;for(let m=0;m<a;m++)m!==o&&(c[u++]=i.shape[m]);const d=[],h=new Array(a).fill(0),f=i.shape.slice();f[o]=1;const p=new Array(l);for(let m=0;m<p.length;m++){h[o]=m;const x=_u({inputs:{x:i},backend:n,attrs:{begin:h,size:f}}),g=ue({inputs:{x},backend:n,attrs:{shape:c}});p[m]=g,d.push(x)}return d.forEach(m=>n.disposeIntermediateTensorInfo(m)),p}const Khe={kernelName:Nx,backendName:"webgl",kernelFunc:jhe};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xhe{constructor(e,n){this.variableNames=["x","segmentIds"];const s=e.windowSize,r=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/s);this.outputShape=[r,a];const l="0.0",c="sumValue",u=Math.floor(s/4)*4,d=s%4,h=`
        sumValue += dot(values, segFilter);
    `;let f="";o%s>0&&(f=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let p="";o%s>0&&(p=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${l};

      float getValue(int batch, int inIdx) {
        ${f}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${p}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${s}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${u}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${h}
        }

        int inIdx = inOffset + ${u};
        if (${d===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${h}
        } else if (${d===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${h}
        } else if (${d===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${h}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qhe(t){const{inputs:e,backend:n,attrs:s}=t,{x:r,segmentIds:o}=e,{numSegments:i}=s,a=r.shape.length,l=[];let c=0;const u=Wt([c],a);let d=r;u!=null&&(d=ds({inputs:{x:r},backend:n,attrs:{perm:u}}),l.push(d),c=sn(1,a)[0]);const h=$O(d.shape,c,i),f=Z([d.shape[c]]),p=ue({inputs:{x:d},backend:n,attrs:{shape:[-1,f]}});l.push(p);const m=$C(r.dtype),x=(v,w,k,C,S)=>{const I=v.shape[0],$=v.shape[1],E=SO($,S),_={windowSize:E,inSize:$,batchSize:I,numSegments:S},D=new Xhe(_,w),F=n.compileAndRun(D,[v,k],C);if(l.push(F),F.shape[1]===S)return F;const R=W3({backend:n,attrs:{start:0,stop:S,step:1,dtype:"float32"}}),P=U3({inputs:{x:R},backend:n,attrs:{reps:[$/E]}});return l.push(R),l.push(P),x(F,w,P,C,S)},g=x(p,"unsortedSegmentSum",o,m,i),y=ue({inputs:{x:g},backend:n,attrs:{shape:h}});let b=y;if(u!=null){l.push(y);const v=xa(u);b=ds({inputs:{x:b},backend:n,attrs:{perm:v}})}return l.forEach(v=>n.disposeIntermediateTensorInfo(v)),b}const Yhe={kernelName:_x,backendName:"webgl",kernelFunc:qhe};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Qhe=[Fre,Pre,zre,Wre,Hre,Kre,qre,Qre,toe,soe,ioe,coe,hoe,goe,boe,woe,Coe,Toe,Noe,Roe,Ooe,Woe,Hoe,Xoe,Yoe,nie,rie,lie,xre,die,gie,vie,Iie,Nie,Rie,Die,Oie,zie,Wie,Gie,Kie,qie,Qie,eae,nae,iae,lae,dae,pae,gae,vae,Sae,Eae,Rae,Fae,Oae,Mae,zae,Vae,Uae,Gae,qae,Zae,tle,sle,ile,cle,fle,xle,gre,ble,pie,kle,$le,Ele,bre,Ale,Ple,Lle,Wle,Gle,qle,Zle,nce,ice,cce,dce,mce,xce,bce,Cce,$ce,Tce,Nce,Rce,Oce,zce,Uce,Qce,kre,tue,rue,aue,uue,Zoe,fue,mue,xue,vue,Sue,wre,Iue,Eue,_ue,Aue,Due,Joe,Kce,Pue,Bue,Hue,Sre,Xue,Que,tde,rde,lde,ude,fde,gde,bde,kde,$de,Ede,Ade,Ode,zde,Wde,Boe,qce,Gde,Kde,qde,Qde,Jde,the,she,ohe,ahe,uhe,hhe,phe,ghe,bhe,whe,Che,$he,Xce,Rre,Ehe,Rhe,Dhe,Phe,Bhe,Uhe,Are,Ghe,Khe,Yhe,pue];for(const t of Qhe)DD(t);const Zhe={black:"#000",white:"#fff"},bh=Zhe,Jhe={50:"#ffebee",100:"#ffcdd2",200:"#ef9a9a",300:"#e57373",400:"#ef5350",500:"#f44336",600:"#e53935",700:"#d32f2f",800:"#c62828",900:"#b71c1c",A100:"#ff8a80",A200:"#ff5252",A400:"#ff1744",A700:"#d50000"},Ql=Jhe,efe={50:"#f3e5f5",100:"#e1bee7",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",600:"#8e24aa",700:"#7b1fa2",800:"#6a1b9a",900:"#4a148c",A100:"#ea80fc",A200:"#e040fb",A400:"#d500f9",A700:"#aa00ff"},Zl=efe,tfe={50:"#e3f2fd",100:"#bbdefb",200:"#90caf9",300:"#64b5f6",400:"#42a5f5",500:"#2196f3",600:"#1e88e5",700:"#1976d2",800:"#1565c0",900:"#0d47a1",A100:"#82b1ff",A200:"#448aff",A400:"#2979ff",A700:"#2962ff"},Jl=tfe,nfe={50:"#e1f5fe",100:"#b3e5fc",200:"#81d4fa",300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",600:"#039be5",700:"#0288d1",800:"#0277bd",900:"#01579b",A100:"#80d8ff",A200:"#40c4ff",A400:"#00b0ff",A700:"#0091ea"},ec=nfe,sfe={50:"#e8f5e9",100:"#c8e6c9",200:"#a5d6a7",300:"#81c784",400:"#66bb6a",500:"#4caf50",600:"#43a047",700:"#388e3c",800:"#2e7d32",900:"#1b5e20",A100:"#b9f6ca",A200:"#69f0ae",A400:"#00e676",A700:"#00c853"},tc=sfe,rfe={50:"#fff3e0",100:"#ffe0b2",200:"#ffcc80",300:"#ffb74d",400:"#ffa726",500:"#ff9800",600:"#fb8c00",700:"#f57c00",800:"#ef6c00",900:"#e65100",A100:"#ffd180",A200:"#ffab40",A400:"#ff9100",A700:"#ff6d00"},Xu=rfe,ofe={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},ife=ofe;function $l(t){let e="https://mui.com/production-error/?code="+t;for(let n=1;n<arguments.length;n+=1)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified MUI error #"+t+"; visit "+e+" for the full message."}const afe=Object.freeze(Object.defineProperty({__proto__:null,default:$l},Symbol.toStringTag,{value:"Module"})),ly="$$material";function L(){return L=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var s in n)({}).hasOwnProperty.call(n,s)&&(t[s]=n[s])}return t},L.apply(null,arguments)}function ze(t,e){if(t==null)return{};var n={};for(var s in t)if({}.hasOwnProperty.call(t,s)){if(e.indexOf(s)!==-1)continue;n[s]=t[s]}return n}var lfe=!1;function cfe(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function ufe(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var dfe=function(){function t(n){var s=this;this._insertTag=function(r){var o;s.tags.length===0?s.insertionPoint?o=s.insertionPoint.nextSibling:s.prepend?o=s.container.firstChild:o=s.before:o=s.tags[s.tags.length-1].nextSibling,s.container.insertBefore(r,o),s.tags.push(r)},this.isSpeedy=n.speedy===void 0?!lfe:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(s){s.forEach(this._insertTag)},e.insert=function(s){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(ufe(this));var r=this.tags[this.tags.length-1];if(this.isSpeedy){var o=cfe(r);try{o.insertRule(s,o.cssRules.length)}catch{}}else r.appendChild(document.createTextNode(s));this.ctr++},e.flush=function(){this.tags.forEach(function(s){var r;return(r=s.parentNode)==null?void 0:r.removeChild(s)}),this.tags=[],this.ctr=0},t}(),ns="-ms-",Gg="-moz-",ct="-webkit-",H3="comm",w$="rule",k$="decl",hfe="@import",G3="@keyframes",ffe="@layer",pfe=Math.abs,cy=String.fromCharCode,mfe=Object.assign;function gfe(t,e){return Hn(t,0)^45?(((e<<2^Hn(t,0))<<2^Hn(t,1))<<2^Hn(t,2))<<2^Hn(t,3):0}function j3(t){return t.trim()}function xfe(t,e){return(t=e.exec(t))?t[0]:t}function ut(t,e,n){return t.replace(e,n)}function nw(t,e){return t.indexOf(e)}function Hn(t,e){return t.charCodeAt(e)|0}function vh(t,e,n){return t.slice(e,n)}function wo(t){return t.length}function C$(t){return t.length}function Hp(t,e){return e.push(t),t}function yfe(t,e){return t.map(e).join("")}var uy=1,ru=1,K3=0,Us=0,yn=0,Ru="";function dy(t,e,n,s,r,o,i){return{value:t,root:e,parent:n,type:s,props:r,children:o,line:uy,column:ru,length:i,return:""}}function qu(t,e){return mfe(dy("",null,null,"",null,null,0),t,{length:-t.length},e)}function bfe(){return yn}function vfe(){return yn=Us>0?Hn(Ru,--Us):0,ru--,yn===10&&(ru=1,uy--),yn}function er(){return yn=Us<K3?Hn(Ru,Us++):0,ru++,yn===10&&(ru=1,uy++),yn}function Do(){return Hn(Ru,Us)}function Fm(){return Us}function tp(t,e){return vh(Ru,t,e)}function wh(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function X3(t){return uy=ru=1,K3=wo(Ru=t),Us=0,[]}function q3(t){return Ru="",t}function Om(t){return j3(tp(Us-1,sw(t===91?t+2:t===40?t+1:t)))}function wfe(t){for(;(yn=Do())&&yn<33;)er();return wh(t)>2||wh(yn)>3?"":" "}function kfe(t,e){for(;--e&&er()&&!(yn<48||yn>102||yn>57&&yn<65||yn>70&&yn<97););return tp(t,Fm()+(e<6&&Do()==32&&er()==32))}function sw(t){for(;er();)switch(yn){case t:return Us;case 34:case 39:t!==34&&t!==39&&sw(yn);break;case 40:t===41&&sw(t);break;case 92:er();break}return Us}function Cfe(t,e){for(;er()&&t+yn!==47+10;)if(t+yn===42+42&&Do()===47)break;return"/*"+tp(e,Us-1)+"*"+cy(t===47?t:er())}function Sfe(t){for(;!wh(Do());)er();return tp(t,Us)}function $fe(t){return q3(Pm("",null,null,null,[""],t=X3(t),0,[0],t))}function Pm(t,e,n,s,r,o,i,a,l){for(var c=0,u=0,d=i,h=0,f=0,p=0,m=1,x=1,g=1,y=0,b="",v=r,w=o,k=s,C=b;x;)switch(p=y,y=er()){case 40:if(p!=108&&Hn(C,d-1)==58){nw(C+=ut(Om(y),"&","&\f"),"&\f")!=-1&&(g=-1);break}case 34:case 39:case 91:C+=Om(y);break;case 9:case 10:case 13:case 32:C+=wfe(p);break;case 92:C+=kfe(Fm()-1,7);continue;case 47:switch(Do()){case 42:case 47:Hp(Ife(Cfe(er(),Fm()),e,n),l);break;default:C+="/"}break;case 123*m:a[c++]=wo(C)*g;case 125*m:case 59:case 0:switch(y){case 0:case 125:x=0;case 59+u:g==-1&&(C=ut(C,/\f/g,"")),f>0&&wo(C)-d&&Hp(f>32?gE(C+";",s,n,d-1):gE(ut(C," ","")+";",s,n,d-2),l);break;case 59:C+=";";default:if(Hp(k=mE(C,e,n,c,u,r,a,b,v=[],w=[],d),o),y===123)if(u===0)Pm(C,e,k,k,v,o,d,a,w);else switch(h===99&&Hn(C,3)===110?100:h){case 100:case 108:case 109:case 115:Pm(t,k,k,s&&Hp(mE(t,k,k,0,0,r,a,b,r,v=[],d),w),r,w,d,a,s?v:w);break;default:Pm(C,k,k,k,[""],w,0,a,w)}}c=u=f=0,m=g=1,b=C="",d=i;break;case 58:d=1+wo(C),f=p;default:if(m<1){if(y==123)--m;else if(y==125&&m++==0&&vfe()==125)continue}switch(C+=cy(y),y*m){case 38:g=u>0?1:(C+="\f",-1);break;case 44:a[c++]=(wo(C)-1)*g,g=1;break;case 64:Do()===45&&(C+=Om(er())),h=Do(),u=d=wo(b=C+=Sfe(Fm())),y++;break;case 45:p===45&&wo(C)==2&&(m=0)}}return o}function mE(t,e,n,s,r,o,i,a,l,c,u){for(var d=r-1,h=r===0?o:[""],f=C$(h),p=0,m=0,x=0;p<s;++p)for(var g=0,y=vh(t,d+1,d=pfe(m=i[p])),b=t;g<f;++g)(b=j3(m>0?h[g]+" "+y:ut(y,/&\f/g,h[g])))&&(l[x++]=b);return dy(t,e,n,r===0?w$:a,l,c,u)}function Ife(t,e,n){return dy(t,e,n,H3,cy(bfe()),vh(t,2,-2),0)}function gE(t,e,n,s){return dy(t,e,n,k$,vh(t,0,s),vh(t,s+1,-1),s)}function Dc(t,e){for(var n="",s=C$(t),r=0;r<s;r++)n+=e(t[r],r,t,e)||"";return n}function Tfe(t,e,n,s){switch(t.type){case ffe:if(t.children.length)break;case hfe:case k$:return t.return=t.return||t.value;case H3:return"";case G3:return t.return=t.value+"{"+Dc(t.children,s)+"}";case w$:t.value=t.props.join(",")}return wo(n=Dc(t.children,s))?t.return=t.value+"{"+n+"}":""}function Efe(t){var e=C$(t);return function(n,s,r,o){for(var i="",a=0;a<e;a++)i+=t[a](n,s,r,o)||"";return i}}function Nfe(t){return function(e){e.root||(e=e.return)&&t(e)}}function Y3(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var _fe=function(e,n,s){for(var r=0,o=0;r=o,o=Do(),r===38&&o===12&&(n[s]=1),!wh(o);)er();return tp(e,Us)},Rfe=function(e,n){var s=-1,r=44;do switch(wh(r)){case 0:r===38&&Do()===12&&(n[s]=1),e[s]+=_fe(Us-1,n,s);break;case 2:e[s]+=Om(r);break;case 4:if(r===44){e[++s]=Do()===58?"&\f":"",n[s]=e[s].length;break}default:e[s]+=cy(r)}while(r=er());return e},Afe=function(e,n){return q3(Rfe(X3(e),n))},xE=new WeakMap,Dfe=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,s=e.parent,r=e.column===s.column&&e.line===s.line;s.type!=="rule";)if(s=s.parent,!s)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!xE.get(s))&&!r){xE.set(e,!0);for(var o=[],i=Afe(n,o),a=s.props,l=0,c=0;l<i.length;l++)for(var u=0;u<a.length;u++,c++)e.props[c]=o[l]?i[l].replace(/&\f/g,a[u]):a[u]+" "+i[l]}}},Ffe=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}};function Q3(t,e){switch(gfe(t,e)){case 5103:return ct+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return ct+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return ct+t+Gg+t+ns+t+t;case 6828:case 4268:return ct+t+ns+t+t;case 6165:return ct+t+ns+"flex-"+t+t;case 5187:return ct+t+ut(t,/(\w+).+(:[^]+)/,ct+"box-$1$2"+ns+"flex-$1$2")+t;case 5443:return ct+t+ns+"flex-item-"+ut(t,/flex-|-self/,"")+t;case 4675:return ct+t+ns+"flex-line-pack"+ut(t,/align-content|flex-|-self/,"")+t;case 5548:return ct+t+ns+ut(t,"shrink","negative")+t;case 5292:return ct+t+ns+ut(t,"basis","preferred-size")+t;case 6060:return ct+"box-"+ut(t,"-grow","")+ct+t+ns+ut(t,"grow","positive")+t;case 4554:return ct+ut(t,/([^-])(transform)/g,"$1"+ct+"$2")+t;case 6187:return ut(ut(ut(t,/(zoom-|grab)/,ct+"$1"),/(image-set)/,ct+"$1"),t,"")+t;case 5495:case 3959:return ut(t,/(image-set\([^]*)/,ct+"$1$`$1");case 4968:return ut(ut(t,/(.+:)(flex-)?(.*)/,ct+"box-pack:$3"+ns+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+ct+t+t;case 4095:case 3583:case 4068:case 2532:return ut(t,/(.+)-inline(.+)/,ct+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(wo(t)-1-e>6)switch(Hn(t,e+1)){case 109:if(Hn(t,e+4)!==45)break;case 102:return ut(t,/(.+:)(.+)-([^]+)/,"$1"+ct+"$2-$3$1"+Gg+(Hn(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~nw(t,"stretch")?Q3(ut(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Hn(t,e+1)!==115)break;case 6444:switch(Hn(t,wo(t)-3-(~nw(t,"!important")&&10))){case 107:return ut(t,":",":"+ct)+t;case 101:return ut(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+ct+(Hn(t,14)===45?"inline-":"")+"box$3$1"+ct+"$2$3$1"+ns+"$2box$3")+t}break;case 5936:switch(Hn(t,e+11)){case 114:return ct+t+ns+ut(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return ct+t+ns+ut(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return ct+t+ns+ut(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return ct+t+ns+t+t}return t}var Ofe=function(e,n,s,r){if(e.length>-1&&!e.return)switch(e.type){case k$:e.return=Q3(e.value,e.length);break;case G3:return Dc([qu(e,{value:ut(e.value,"@","@"+ct)})],r);case w$:if(e.length)return yfe(e.props,function(o){switch(xfe(o,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Dc([qu(e,{props:[ut(o,/:(read-\w+)/,":"+Gg+"$1")]})],r);case"::placeholder":return Dc([qu(e,{props:[ut(o,/:(plac\w+)/,":"+ct+"input-$1")]}),qu(e,{props:[ut(o,/:(plac\w+)/,":"+Gg+"$1")]}),qu(e,{props:[ut(o,/:(plac\w+)/,ns+"input-$1")]})],r)}return""})}},Pfe=[Ofe],Z3=function(e){var n=e.key;if(n==="css"){var s=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(s,function(m){var x=m.getAttribute("data-emotion");x.indexOf(" ")!==-1&&(document.head.appendChild(m),m.setAttribute("data-s",""))})}var r=e.stylisPlugins||Pfe,o={},i,a=[];i=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(m){for(var x=m.getAttribute("data-emotion").split(" "),g=1;g<x.length;g++)o[x[g]]=!0;a.push(m)});var l,c=[Dfe,Ffe];{var u,d=[Tfe,Nfe(function(m){u.insert(m)})],h=Efe(c.concat(r,d)),f=function(x){return Dc($fe(x),h)};l=function(x,g,y,b){u=y,f(x?x+"{"+g.styles+"}":g.styles),b&&(p.inserted[g.name]=!0)}}var p={key:n,sheet:new dfe({key:n,container:i,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:o,registered:{},insert:l};return p.sheet.hydrate(a),p},J3={exports:{}},bt={};/** @license React v16.13.1
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Vn=typeof Symbol=="function"&&Symbol.for,S$=Vn?Symbol.for("react.element"):60103,$$=Vn?Symbol.for("react.portal"):60106,hy=Vn?Symbol.for("react.fragment"):60107,fy=Vn?Symbol.for("react.strict_mode"):60108,py=Vn?Symbol.for("react.profiler"):60114,my=Vn?Symbol.for("react.provider"):60109,gy=Vn?Symbol.for("react.context"):60110,I$=Vn?Symbol.for("react.async_mode"):60111,xy=Vn?Symbol.for("react.concurrent_mode"):60111,yy=Vn?Symbol.for("react.forward_ref"):60112,by=Vn?Symbol.for("react.suspense"):60113,Mfe=Vn?Symbol.for("react.suspense_list"):60120,vy=Vn?Symbol.for("react.memo"):60115,wy=Vn?Symbol.for("react.lazy"):60116,Lfe=Vn?Symbol.for("react.block"):60121,zfe=Vn?Symbol.for("react.fundamental"):60117,Bfe=Vn?Symbol.for("react.responder"):60118,Vfe=Vn?Symbol.for("react.scope"):60119;function cr(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case S$:switch(t=t.type,t){case I$:case xy:case hy:case py:case fy:case by:return t;default:switch(t=t&&t.$$typeof,t){case gy:case yy:case wy:case vy:case my:return t;default:return e}}case $$:return e}}}function ez(t){return cr(t)===xy}bt.AsyncMode=I$;bt.ConcurrentMode=xy;bt.ContextConsumer=gy;bt.ContextProvider=my;bt.Element=S$;bt.ForwardRef=yy;bt.Fragment=hy;bt.Lazy=wy;bt.Memo=vy;bt.Portal=$$;bt.Profiler=py;bt.StrictMode=fy;bt.Suspense=by;bt.isAsyncMode=function(t){return ez(t)||cr(t)===I$};bt.isConcurrentMode=ez;bt.isContextConsumer=function(t){return cr(t)===gy};bt.isContextProvider=function(t){return cr(t)===my};bt.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===S$};bt.isForwardRef=function(t){return cr(t)===yy};bt.isFragment=function(t){return cr(t)===hy};bt.isLazy=function(t){return cr(t)===wy};bt.isMemo=function(t){return cr(t)===vy};bt.isPortal=function(t){return cr(t)===$$};bt.isProfiler=function(t){return cr(t)===py};bt.isStrictMode=function(t){return cr(t)===fy};bt.isSuspense=function(t){return cr(t)===by};bt.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===hy||t===xy||t===py||t===fy||t===by||t===Mfe||typeof t=="object"&&t!==null&&(t.$$typeof===wy||t.$$typeof===vy||t.$$typeof===my||t.$$typeof===gy||t.$$typeof===yy||t.$$typeof===zfe||t.$$typeof===Bfe||t.$$typeof===Vfe||t.$$typeof===Lfe)};bt.typeOf=cr;J3.exports=bt;var Wfe=J3.exports,tz=Wfe,Ufe={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},Hfe={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},nz={};nz[tz.ForwardRef]=Ufe;nz[tz.Memo]=Hfe;var Gfe=!0;function sz(t,e,n){var s="";return n.split(" ").forEach(function(r){t[r]!==void 0?e.push(t[r]+";"):r&&(s+=r+" ")}),s}var T$=function(e,n,s){var r=e.key+"-"+n.name;(s===!1||Gfe===!1)&&e.registered[r]===void 0&&(e.registered[r]=n.styles)},E$=function(e,n,s){T$(e,n,s);var r=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var o=n;do e.insert(n===o?"."+r:"",o,e.sheet,!0),o=o.next;while(o!==void 0)}};function jfe(t){for(var e=0,n,s=0,r=t.length;r>=4;++s,r-=4)n=t.charCodeAt(s)&255|(t.charCodeAt(++s)&255)<<8|(t.charCodeAt(++s)&255)<<16|(t.charCodeAt(++s)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(t.charCodeAt(s+2)&255)<<16;case 2:e^=(t.charCodeAt(s+1)&255)<<8;case 1:e^=t.charCodeAt(s)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var Kfe={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},Xfe=!1,qfe=/[A-Z]|^ms/g,Yfe=/_EMO_([^_]+?)_([^]*?)_EMO_/g,rz=function(e){return e.charCodeAt(1)===45},yE=function(e){return e!=null&&typeof e!="boolean"},n1=Y3(function(t){return rz(t)?t:t.replace(qfe,"-$&").toLowerCase()}),bE=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(Yfe,function(s,r,o){return ko={name:r,styles:o,next:ko},r})}return Kfe[e]!==1&&!rz(e)&&typeof n=="number"&&n!==0?n+"px":n},Qfe="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function kh(t,e,n){if(n==null)return"";var s=n;if(s.__emotion_styles!==void 0)return s;switch(typeof n){case"boolean":return"";case"object":{var r=n;if(r.anim===1)return ko={name:r.name,styles:r.styles,next:ko},r.name;var o=n;if(o.styles!==void 0){var i=o.next;if(i!==void 0)for(;i!==void 0;)ko={name:i.name,styles:i.styles,next:ko},i=i.next;var a=o.styles+";";return a}return Zfe(t,e,n)}case"function":{if(t!==void 0){var l=ko,c=n(t);return ko=l,kh(t,e,c)}break}}var u=n;if(e==null)return u;var d=e[u];return d!==void 0?d:u}function Zfe(t,e,n){var s="";if(Array.isArray(n))for(var r=0;r<n.length;r++)s+=kh(t,e,n[r])+";";else for(var o in n){var i=n[o];if(typeof i!="object"){var a=i;e!=null&&e[a]!==void 0?s+=o+"{"+e[a]+"}":yE(a)&&(s+=n1(o)+":"+bE(o,a)+";")}else{if(o==="NO_COMPONENT_SELECTOR"&&Xfe)throw new Error(Qfe);if(Array.isArray(i)&&typeof i[0]=="string"&&(e==null||e[i[0]]===void 0))for(var l=0;l<i.length;l++)yE(i[l])&&(s+=n1(o)+":"+bE(o,i[l])+";");else{var c=kh(t,e,i);switch(o){case"animation":case"animationName":{s+=n1(o)+":"+c+";";break}default:s+=o+"{"+c+"}"}}}}return s}var vE=/label:\s*([^\s;{]+)\s*(;|$)/g,ko;function ky(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var s=!0,r="";ko=void 0;var o=t[0];if(o==null||o.raw===void 0)s=!1,r+=kh(n,e,o);else{var i=o;r+=i[0]}for(var a=1;a<t.length;a++)if(r+=kh(n,e,t[a]),s){var l=o;r+=l[a]}vE.lastIndex=0;for(var c="",u;(u=vE.exec(r))!==null;)c+="-"+u[1];var d=jfe(r)+c;return{name:d,styles:r,next:ko}}var Jfe=function(e){return e()},oz=C1["useInsertionEffect"]?C1["useInsertionEffect"]:!1,iz=oz||Jfe,wE=oz||A.useLayoutEffect,epe=!1,az=A.createContext(typeof HTMLElement<"u"?Z3({key:"css"}):null),tpe=az.Provider,N$=function(e){return A.forwardRef(function(n,s){var r=A.useContext(az);return e(n,r,s)})},np=A.createContext({}),_$={}.hasOwnProperty,rw="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",npe=function(e,n){var s={};for(var r in n)_$.call(n,r)&&(s[r]=n[r]);return s[rw]=e,s},spe=function(e){var n=e.cache,s=e.serialized,r=e.isStringTag;return T$(n,s,r),iz(function(){return E$(n,s,r)}),null},rpe=N$(function(t,e,n){var s=t.css;typeof s=="string"&&e.registered[s]!==void 0&&(s=e.registered[s]);var r=t[rw],o=[s],i="";typeof t.className=="string"?i=sz(e.registered,o,t.className):t.className!=null&&(i=t.className+" ");var a=ky(o,void 0,A.useContext(np));i+=e.key+"-"+a.name;var l={};for(var c in t)_$.call(t,c)&&c!=="css"&&c!==rw&&!epe&&(l[c]=t[c]);return l.className=i,n&&(l.ref=n),A.createElement(A.Fragment,null,A.createElement(spe,{cache:e,serialized:a,isStringTag:typeof r=="string"}),A.createElement(r,l))}),ope=rpe,s1={exports:{}},kE;function lz(){return kE||(kE=1,function(t){function e(){return t.exports=e=Object.assign?Object.assign.bind():function(n){for(var s=1;s<arguments.length;s++){var r=arguments[s];for(var o in r)({}).hasOwnProperty.call(r,o)&&(n[o]=r[o])}return n},t.exports.__esModule=!0,t.exports.default=t.exports,e.apply(null,arguments)}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(s1)),s1.exports}lz();var CE=function(e,n){var s=arguments;if(n==null||!_$.call(n,"css"))return A.createElement.apply(void 0,s);var r=s.length,o=new Array(r);o[0]=ope,o[1]=npe(e,n);for(var i=2;i<r;i++)o[i]=s[i];return A.createElement.apply(null,o)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(CE||(CE={}));var ipe=N$(function(t,e){var n=t.styles,s=ky([n],void 0,A.useContext(np)),r=A.useRef();return wE(function(){var o=e.key+"-global",i=new e.sheet.constructor({key:o,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),a=!1,l=document.querySelector('style[data-emotion="'+o+" "+s.name+'"]');return e.sheet.tags.length&&(i.before=e.sheet.tags[0]),l!==null&&(a=!0,l.setAttribute("data-emotion",o),i.hydrate([l])),r.current=[i,a],function(){i.flush()}},[e]),wE(function(){var o=r.current,i=o[0],a=o[1];if(a){o[1]=!1;return}if(s.next!==void 0&&E$(e,s.next,!0),i.tags.length){var l=i.tags[i.tags.length-1].nextElementSibling;i.before=l,i.flush()}e.insert("",s,i,!1)},[e,s.name]),null});function cz(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return ky(e)}function Cy(){var t=cz.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var ape=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,lpe=Y3(function(t){return ape.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),cpe=!1,upe=lpe,dpe=function(e){return e!=="theme"},SE=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?upe:dpe},$E=function(e,n,s){var r;if(n){var o=n.shouldForwardProp;r=e.__emotion_forwardProp&&o?function(i){return e.__emotion_forwardProp(i)&&o(i)}:o}return typeof r!="function"&&s&&(r=e.__emotion_forwardProp),r},hpe=function(e){var n=e.cache,s=e.serialized,r=e.isStringTag;return T$(n,s,r),iz(function(){return E$(n,s,r)}),null},fpe=function t(e,n){var s=e.__emotion_real===e,r=s&&e.__emotion_base||e,o,i;n!==void 0&&(o=n.label,i=n.target);var a=$E(e,n,s),l=a||SE(r),c=!l("as");return function(){var u=arguments,d=s&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(o!==void 0&&d.push("label:"+o+";"),u[0]==null||u[0].raw===void 0)d.push.apply(d,u);else{var h=u[0];d.push(h[0]);for(var f=u.length,p=1;p<f;p++)d.push(u[p],h[p])}var m=N$(function(x,g,y){var b=c&&x.as||r,v="",w=[],k=x;if(x.theme==null){k={};for(var C in x)k[C]=x[C];k.theme=A.useContext(np)}typeof x.className=="string"?v=sz(g.registered,w,x.className):x.className!=null&&(v=x.className+" ");var S=ky(d.concat(w),g.registered,k);v+=g.key+"-"+S.name,i!==void 0&&(v+=" "+i);var I=c&&a===void 0?SE(b):l,$={};for(var E in x)c&&E==="as"||I(E)&&($[E]=x[E]);return $.className=v,y&&($.ref=y),A.createElement(A.Fragment,null,A.createElement(hpe,{cache:g,serialized:S,isStringTag:typeof b=="string"}),A.createElement(b,$))});return m.displayName=o!==void 0?o:"Styled("+(typeof r=="string"?r:r.displayName||r.name||"Component")+")",m.defaultProps=e.defaultProps,m.__emotion_real=m,m.__emotion_base=r,m.__emotion_styles=d,m.__emotion_forwardProp=a,Object.defineProperty(m,"toString",{value:function(){return i===void 0&&cpe?"NO_COMPONENT_SELECTOR":"."+i}}),m.withComponent=function(x,g){var y=t(x,L({},n,g,{shouldForwardProp:$E(m,g,!0)}));return y.apply(void 0,d)},m}},ppe=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],ow=fpe.bind(null);ppe.forEach(function(t){ow[t]=ow(t)});var uz={exports:{}},Sy={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var mpe=A,gpe=Symbol.for("react.element"),xpe=Symbol.for("react.fragment"),ype=Object.prototype.hasOwnProperty,bpe=mpe.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,vpe={key:!0,ref:!0,__self:!0,__source:!0};function dz(t,e,n){var s,r={},o=null,i=null;n!==void 0&&(o=""+n),e.key!==void 0&&(o=""+e.key),e.ref!==void 0&&(i=e.ref);for(s in e)ype.call(e,s)&&!vpe.hasOwnProperty(s)&&(r[s]=e[s]);if(t&&t.defaultProps)for(s in e=t.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:gpe,type:t,key:o,ref:i,props:r,_owner:bpe.current}}Sy.Fragment=xpe;Sy.jsx=dz;Sy.jsxs=dz;uz.exports=Sy;var oe=uz.exports;let iw;typeof document=="object"&&(iw=Z3({key:"css",prepend:!0}));function wpe(t){const{injectFirst:e,children:n}=t;return e&&iw?oe.jsx(tpe,{value:iw,children:n}):n}function kpe(t){return t==null||Object.keys(t).length===0}function hz(t){const{styles:e,defaultTheme:n={}}=t,s=typeof e=="function"?r=>e(kpe(r)?n:r):e;return oe.jsx(ipe,{styles:s})}/**
 * @mui/styled-engine v5.16.14
 *
 * @license MIT
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */function fz(t,e){return ow(t,e)}const Cpe=(t,e)=>{Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))},Spe=Object.freeze(Object.defineProperty({__proto__:null,GlobalStyles:hz,StyledEngineProvider:wpe,ThemeContext:np,css:cz,default:fz,internal_processStyles:Cpe,keyframes:Cy},Symbol.toStringTag,{value:"Module"}));function Ri(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function pz(t){if(A.isValidElement(t)||!Ri(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=pz(t[n])}),e}function tr(t,e,n={clone:!0}){const s=n.clone?L({},t):t;return Ri(t)&&Ri(e)&&Object.keys(e).forEach(r=>{A.isValidElement(e[r])?s[r]=e[r]:Ri(e[r])&&Object.prototype.hasOwnProperty.call(t,r)&&Ri(t[r])?s[r]=tr(t[r],e[r],n):n.clone?s[r]=Ri(e[r])?pz(e[r]):e[r]:s[r]=e[r]}),s}const $pe=Object.freeze(Object.defineProperty({__proto__:null,default:tr,isPlainObject:Ri},Symbol.toStringTag,{value:"Module"})),Ipe=["values","unit","step"],Tpe=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,s)=>n.val-s.val),e.reduce((n,s)=>L({},n,{[s.key]:s.val}),{})};function mz(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:s=5}=t,r=ze(t,Ipe),o=Tpe(e),i=Object.keys(o);function a(h){return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n})`}function l(h){return`@media (max-width:${(typeof e[h]=="number"?e[h]:h)-s/100}${n})`}function c(h,f){const p=i.indexOf(f);return`@media (min-width:${typeof e[h]=="number"?e[h]:h}${n}) and (max-width:${(p!==-1&&typeof e[i[p]]=="number"?e[i[p]]:f)-s/100}${n})`}function u(h){return i.indexOf(h)+1<i.length?c(h,i[i.indexOf(h)+1]):a(h)}function d(h){const f=i.indexOf(h);return f===0?a(i[1]):f===i.length-1?l(i[f]):c(h,i[i.indexOf(h)+1]).replace("@media","@media not all and")}return L({keys:i,values:o,up:a,down:l,between:c,only:u,not:d,unit:n},r)}const Epe={borderRadius:4},Npe=Epe;function Od(t,e){return e?tr(t,e,{clone:!1}):t}const R$={xs:0,sm:600,md:900,lg:1200,xl:1536},IE={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${R$[t]}px)`};function hi(t,e,n){const s=t.theme||{};if(Array.isArray(e)){const o=s.breakpoints||IE;return e.reduce((i,a,l)=>(i[o.up(o.keys[l])]=n(e[l]),i),{})}if(typeof e=="object"){const o=s.breakpoints||IE;return Object.keys(e).reduce((i,a)=>{if(Object.keys(o.values||R$).indexOf(a)!==-1){const l=o.up(a);i[l]=n(e[a],a)}else{const l=a;i[l]=e[l]}return i},{})}return n(e)}function _pe(t={}){var e;return((e=t.keys)==null?void 0:e.reduce((s,r)=>{const o=t.up(r);return s[o]={},s},{}))||{}}function Rpe(t,e){return t.reduce((n,s)=>{const r=n[s];return(!r||Object.keys(r).length===0)&&delete n[s],n},e)}function Ue(t){if(typeof t!="string")throw new Error($l(7));return t.charAt(0).toUpperCase()+t.slice(1)}const Ape=Object.freeze(Object.defineProperty({__proto__:null,default:Ue},Symbol.toStringTag,{value:"Module"}));function $y(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const s=`vars.${e}`.split(".").reduce((r,o)=>r&&r[o]?r[o]:null,t);if(s!=null)return s}return e.split(".").reduce((s,r)=>s&&s[r]!=null?s[r]:null,t)}function jg(t,e,n,s=n){let r;return typeof t=="function"?r=t(n):Array.isArray(t)?r=t[n]||s:r=$y(t,n)||s,e&&(r=e(r,s,t)),r}function pn(t){const{prop:e,cssProperty:n=t.prop,themeKey:s,transform:r}=t,o=i=>{if(i[e]==null)return null;const a=i[e],l=i.theme,c=$y(l,s)||{};return hi(i,a,d=>{let h=jg(c,r,d);return d===h&&typeof d=="string"&&(h=jg(c,r,`${e}${d==="default"?"":Ue(d)}`,d)),n===!1?h:{[n]:h}})};return o.propTypes={},o.filterProps=[e],o}function Dpe(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const Fpe={m:"margin",p:"padding"},Ope={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},TE={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},Ppe=Dpe(t=>{if(t.length>2)if(TE[t])t=TE[t];else return[t];const[e,n]=t.split(""),s=Fpe[e],r=Ope[n]||"";return Array.isArray(r)?r.map(o=>s+o):[s+r]}),A$=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],D$=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"];[...A$,...D$];function sp(t,e,n,s){var r;const o=(r=$y(t,e,!1))!=null?r:n;return typeof o=="number"?i=>typeof i=="string"?i:o*i:Array.isArray(o)?i=>typeof i=="string"?i:o[i]:typeof o=="function"?o:()=>{}}function gz(t){return sp(t,"spacing",8)}function rp(t,e){if(typeof e=="string"||e==null)return e;const n=Math.abs(e),s=t(n);return e>=0?s:typeof s=="number"?-s:`-${s}`}function Mpe(t,e){return n=>t.reduce((s,r)=>(s[r]=rp(e,n),s),{})}function Lpe(t,e,n,s){if(e.indexOf(n)===-1)return null;const r=Ppe(n),o=Mpe(r,s),i=t[n];return hi(t,i,o)}function xz(t,e){const n=gz(t.theme);return Object.keys(t).map(s=>Lpe(t,e,s,n)).reduce(Od,{})}function Yt(t){return xz(t,A$)}Yt.propTypes={};Yt.filterProps=A$;function Qt(t){return xz(t,D$)}Qt.propTypes={};Qt.filterProps=D$;function zpe(t=8){if(t.mui)return t;const e=gz({spacing:t}),n=(...s)=>(s.length===0?[1]:s).map(o=>{const i=e(o);return typeof i=="number"?`${i}px`:i}).join(" ");return n.mui=!0,n}function Iy(...t){const e=t.reduce((s,r)=>(r.filterProps.forEach(o=>{s[o]=r}),s),{}),n=s=>Object.keys(s).reduce((r,o)=>e[o]?Od(r,e[o](s)):r,{});return n.propTypes={},n.filterProps=t.reduce((s,r)=>s.concat(r.filterProps),[]),n}function yr(t){return typeof t!="number"?t:`${t}px solid`}function zr(t,e){return pn({prop:t,themeKey:"borders",transform:e})}const Bpe=zr("border",yr),Vpe=zr("borderTop",yr),Wpe=zr("borderRight",yr),Upe=zr("borderBottom",yr),Hpe=zr("borderLeft",yr),Gpe=zr("borderColor"),jpe=zr("borderTopColor"),Kpe=zr("borderRightColor"),Xpe=zr("borderBottomColor"),qpe=zr("borderLeftColor"),Ype=zr("outline",yr),Qpe=zr("outlineColor"),Ty=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=sp(t.theme,"shape.borderRadius",4),n=s=>({borderRadius:rp(e,s)});return hi(t,t.borderRadius,n)}return null};Ty.propTypes={};Ty.filterProps=["borderRadius"];Iy(Bpe,Vpe,Wpe,Upe,Hpe,Gpe,jpe,Kpe,Xpe,qpe,Ty,Ype,Qpe);const Ey=t=>{if(t.gap!==void 0&&t.gap!==null){const e=sp(t.theme,"spacing",8),n=s=>({gap:rp(e,s)});return hi(t,t.gap,n)}return null};Ey.propTypes={};Ey.filterProps=["gap"];const Ny=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=sp(t.theme,"spacing",8),n=s=>({columnGap:rp(e,s)});return hi(t,t.columnGap,n)}return null};Ny.propTypes={};Ny.filterProps=["columnGap"];const _y=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=sp(t.theme,"spacing",8),n=s=>({rowGap:rp(e,s)});return hi(t,t.rowGap,n)}return null};_y.propTypes={};_y.filterProps=["rowGap"];const Zpe=pn({prop:"gridColumn"}),Jpe=pn({prop:"gridRow"}),eme=pn({prop:"gridAutoFlow"}),tme=pn({prop:"gridAutoColumns"}),nme=pn({prop:"gridAutoRows"}),sme=pn({prop:"gridTemplateColumns"}),rme=pn({prop:"gridTemplateRows"}),ome=pn({prop:"gridTemplateAreas"}),ime=pn({prop:"gridArea"});Iy(Ey,Ny,_y,Zpe,Jpe,eme,tme,nme,sme,rme,ome,ime);function Fc(t,e){return e==="grey"?e:t}const ame=pn({prop:"color",themeKey:"palette",transform:Fc}),lme=pn({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Fc}),cme=pn({prop:"backgroundColor",themeKey:"palette",transform:Fc});Iy(ame,lme,cme);function Xs(t){return t<=1&&t!==0?`${t*100}%`:t}const ume=pn({prop:"width",transform:Xs}),F$=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var s,r;const o=((s=t.theme)==null||(s=s.breakpoints)==null||(s=s.values)==null?void 0:s[n])||R$[n];return o?((r=t.theme)==null||(r=r.breakpoints)==null?void 0:r.unit)!=="px"?{maxWidth:`${o}${t.theme.breakpoints.unit}`}:{maxWidth:o}:{maxWidth:Xs(n)}};return hi(t,t.maxWidth,e)}return null};F$.filterProps=["maxWidth"];const dme=pn({prop:"minWidth",transform:Xs}),hme=pn({prop:"height",transform:Xs}),fme=pn({prop:"maxHeight",transform:Xs}),pme=pn({prop:"minHeight",transform:Xs});pn({prop:"size",cssProperty:"width",transform:Xs});pn({prop:"size",cssProperty:"height",transform:Xs});const mme=pn({prop:"boxSizing"});Iy(ume,F$,dme,hme,fme,pme,mme);const gme={border:{themeKey:"borders",transform:yr},borderTop:{themeKey:"borders",transform:yr},borderRight:{themeKey:"borders",transform:yr},borderBottom:{themeKey:"borders",transform:yr},borderLeft:{themeKey:"borders",transform:yr},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:yr},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:Ty},color:{themeKey:"palette",transform:Fc},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Fc},backgroundColor:{themeKey:"palette",transform:Fc},p:{style:Qt},pt:{style:Qt},pr:{style:Qt},pb:{style:Qt},pl:{style:Qt},px:{style:Qt},py:{style:Qt},padding:{style:Qt},paddingTop:{style:Qt},paddingRight:{style:Qt},paddingBottom:{style:Qt},paddingLeft:{style:Qt},paddingX:{style:Qt},paddingY:{style:Qt},paddingInline:{style:Qt},paddingInlineStart:{style:Qt},paddingInlineEnd:{style:Qt},paddingBlock:{style:Qt},paddingBlockStart:{style:Qt},paddingBlockEnd:{style:Qt},m:{style:Yt},mt:{style:Yt},mr:{style:Yt},mb:{style:Yt},ml:{style:Yt},mx:{style:Yt},my:{style:Yt},margin:{style:Yt},marginTop:{style:Yt},marginRight:{style:Yt},marginBottom:{style:Yt},marginLeft:{style:Yt},marginX:{style:Yt},marginY:{style:Yt},marginInline:{style:Yt},marginInlineStart:{style:Yt},marginInlineEnd:{style:Yt},marginBlock:{style:Yt},marginBlockStart:{style:Yt},marginBlockEnd:{style:Yt},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:Ey},rowGap:{style:_y},columnGap:{style:Ny},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:Xs},maxWidth:{style:F$},minWidth:{transform:Xs},height:{transform:Xs},maxHeight:{transform:Xs},minHeight:{transform:Xs},boxSizing:{},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}},op=gme;function xme(...t){const e=t.reduce((s,r)=>s.concat(Object.keys(r)),[]),n=new Set(e);return t.every(s=>n.size===Object.keys(s).length)}function yme(t,e){return typeof t=="function"?t(e):t}function yz(){function t(n,s,r,o){const i={[n]:s,theme:r},a=o[n];if(!a)return{[n]:s};const{cssProperty:l=n,themeKey:c,transform:u,style:d}=a;if(s==null)return null;if(c==="typography"&&s==="inherit")return{[n]:s};const h=$y(r,c)||{};return d?d(i):hi(i,s,p=>{let m=jg(h,u,p);return p===m&&typeof p=="string"&&(m=jg(h,u,`${n}${p==="default"?"":Ue(p)}`,p)),l===!1?m:{[l]:m}})}function e(n){var s;const{sx:r,theme:o={}}=n||{};if(!r)return null;const i=(s=o.unstable_sxConfig)!=null?s:op;function a(l){let c=l;if(typeof l=="function")c=l(o);else if(typeof l!="object")return l;if(!c)return null;const u=_pe(o.breakpoints),d=Object.keys(u);let h=u;return Object.keys(c).forEach(f=>{const p=yme(c[f],o);if(p!=null)if(typeof p=="object")if(i[f])h=Od(h,t(f,p,o,i));else{const m=hi({theme:o},p,x=>({[f]:x}));xme(m,p)?h[f]=e({sx:p,theme:o}):h=Od(h,m)}else h=Od(h,t(f,p,o,i))}),Rpe(d,h)}return Array.isArray(r)?r.map(a):a(r)}return e}const bz=yz();bz.filterProps=["sx"];const Ry=bz;function vz(t,e){const n=this;return n.vars&&typeof n.getColorSchemeSelector=="function"?{[n.getColorSchemeSelector(t).replace(/(\[[^\]]+\])/,"*:where($1)")]:e}:n.palette.mode===t?e:{}}const bme=["breakpoints","palette","spacing","shape"];function O$(t={},...e){const{breakpoints:n={},palette:s={},spacing:r,shape:o={}}=t,i=ze(t,bme),a=mz(n),l=zpe(r);let c=tr({breakpoints:a,direction:"ltr",components:{},palette:L({mode:"light"},s),spacing:l,shape:L({},Npe,o)},i);return c.applyStyles=vz,c=e.reduce((u,d)=>tr(u,d),c),c.unstable_sxConfig=L({},op,i==null?void 0:i.unstable_sxConfig),c.unstable_sx=function(d){return Ry({sx:d,theme:this})},c}const vme=Object.freeze(Object.defineProperty({__proto__:null,default:O$,private_createBreakpoints:mz,unstable_applyStyles:vz},Symbol.toStringTag,{value:"Module"}));function wme(t){return Object.keys(t).length===0}function kme(t=null){const e=A.useContext(np);return!e||wme(e)?t:e}const Cme=O$();function P$(t=Cme){return kme(t)}function Sme({styles:t,themeId:e,defaultTheme:n={}}){const s=P$(n),r=typeof t=="function"?t(e&&s[e]||s):t;return oe.jsx(hz,{styles:r})}const $me=["sx"],Ime=t=>{var e,n;const s={systemProps:{},otherProps:{}},r=(e=t==null||(n=t.theme)==null?void 0:n.unstable_sxConfig)!=null?e:op;return Object.keys(t).forEach(o=>{r[o]?s.systemProps[o]=t[o]:s.otherProps[o]=t[o]}),s};function M$(t){const{sx:e}=t,n=ze(t,$me),{systemProps:s,otherProps:r}=Ime(n);let o;return Array.isArray(e)?o=[s,...e]:typeof e=="function"?o=(...i)=>{const a=e(...i);return Ri(a)?L({},s,a):s}:o=L({},s,e),L({},r,{sx:o})}const Tme=Object.freeze(Object.defineProperty({__proto__:null,default:Ry,extendSxProp:M$,unstable_createStyleFunctionSx:yz,unstable_defaultSxConfig:op},Symbol.toStringTag,{value:"Module"})),EE=t=>t,Eme=()=>{let t=EE;return{configure(e){t=e},generate(e){return t(e)},reset(){t=EE}}},Nme=Eme(),wz=Nme;function kz(t){var e,n,s="";if(typeof t=="string"||typeof t=="number")s+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=kz(t[e]))&&(s&&(s+=" "),s+=n)}else for(n in t)t[n]&&(s&&(s+=" "),s+=n);return s}function We(){for(var t,e,n=0,s="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=kz(t))&&(s&&(s+=" "),s+=e);return s}const _me=["className","component"];function Rme(t={}){const{themeId:e,defaultTheme:n,defaultClassName:s="MuiBox-root",generateClassName:r}=t,o=fz("div",{shouldForwardProp:a=>a!=="theme"&&a!=="sx"&&a!=="as"})(Ry);return A.forwardRef(function(l,c){const u=P$(n),d=M$(l),{className:h,component:f="div"}=d,p=ze(d,_me);return oe.jsx(o,L({as:f,ref:c,className:We(h,r?r(s):s),theme:e&&u[e]||u},p))})}const Ame={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function qt(t,e,n="Mui"){const s=Ame[e];return s?`${n}-${s}`:`${wz.generate(t)}-${e}`}function Ut(t,e,n="Mui"){const s={};return e.forEach(r=>{s[r]=qt(t,r,n)}),s}var Cz={exports:{}},$t={};/**
 * @license React
 * react-is.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L$=Symbol.for("react.transitional.element"),z$=Symbol.for("react.portal"),Ay=Symbol.for("react.fragment"),Dy=Symbol.for("react.strict_mode"),Fy=Symbol.for("react.profiler"),Oy=Symbol.for("react.consumer"),Py=Symbol.for("react.context"),My=Symbol.for("react.forward_ref"),Ly=Symbol.for("react.suspense"),zy=Symbol.for("react.suspense_list"),By=Symbol.for("react.memo"),Vy=Symbol.for("react.lazy"),Dme=Symbol.for("react.view_transition"),Fme=Symbol.for("react.client.reference");function Br(t){if(typeof t=="object"&&t!==null){var e=t.$$typeof;switch(e){case L$:switch(t=t.type,t){case Ay:case Fy:case Dy:case Ly:case zy:case Dme:return t;default:switch(t=t&&t.$$typeof,t){case Py:case My:case Vy:case By:return t;case Oy:return t;default:return e}}case z$:return e}}}$t.ContextConsumer=Oy;$t.ContextProvider=Py;$t.Element=L$;$t.ForwardRef=My;$t.Fragment=Ay;$t.Lazy=Vy;$t.Memo=By;$t.Portal=z$;$t.Profiler=Fy;$t.StrictMode=Dy;$t.Suspense=Ly;$t.SuspenseList=zy;$t.isContextConsumer=function(t){return Br(t)===Oy};$t.isContextProvider=function(t){return Br(t)===Py};$t.isElement=function(t){return typeof t=="object"&&t!==null&&t.$$typeof===L$};$t.isForwardRef=function(t){return Br(t)===My};$t.isFragment=function(t){return Br(t)===Ay};$t.isLazy=function(t){return Br(t)===Vy};$t.isMemo=function(t){return Br(t)===By};$t.isPortal=function(t){return Br(t)===z$};$t.isProfiler=function(t){return Br(t)===Fy};$t.isStrictMode=function(t){return Br(t)===Dy};$t.isSuspense=function(t){return Br(t)===Ly};$t.isSuspenseList=function(t){return Br(t)===zy};$t.isValidElementType=function(t){return typeof t=="string"||typeof t=="function"||t===Ay||t===Fy||t===Dy||t===Ly||t===zy||typeof t=="object"&&t!==null&&(t.$$typeof===Vy||t.$$typeof===By||t.$$typeof===Py||t.$$typeof===Oy||t.$$typeof===My||t.$$typeof===Fme||t.getModuleId!==void 0)};$t.typeOf=Br;Cz.exports=$t;var NE=Cz.exports;const Ome=/^\s*function(?:\s|\s*\/\*.*\*\/\s*)+([^(\s/]*)\s*/;function Sz(t){const e=`${t}`.match(Ome);return e&&e[1]||""}function $z(t,e=""){return t.displayName||t.name||Sz(t)||e}function _E(t,e,n){const s=$z(e);return t.displayName||(s!==""?`${n}(${s})`:n)}function Pme(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return $z(t,"Component");if(typeof t=="object")switch(t.$$typeof){case NE.ForwardRef:return _E(t,t.render,"ForwardRef");case NE.Memo:return _E(t,t.type,"memo");default:return}}}const Mme=Object.freeze(Object.defineProperty({__proto__:null,default:Pme,getFunctionName:Sz},Symbol.toStringTag,{value:"Module"}));function Kg(t,e){const n=L({},e);return Object.keys(t).forEach(s=>{if(s.toString().match(/^(components|slots)$/))n[s]=L({},t[s],n[s]);else if(s.toString().match(/^(componentsProps|slotProps)$/)){const r=t[s]||{},o=e[s];n[s]={},!o||!Object.keys(o)?n[s]=r:!r||!Object.keys(r)?n[s]=o:(n[s]=L({},o),Object.keys(r).forEach(i=>{n[s][i]=Kg(r[i],o[i])}))}else n[s]===void 0&&(n[s]=t[s])}),n}const Lme=typeof window<"u"?A.useLayoutEffect:A.useEffect,ca=Lme;function ac(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}const zme=Object.freeze(Object.defineProperty({__proto__:null,default:ac},Symbol.toStringTag,{value:"Module"}));function RE(...t){return t.reduce((e,n)=>n==null?e:function(...r){e.apply(this,r),n.apply(this,r)},()=>{})}function Iz(t,e=166){let n;function s(...r){const o=()=>{t.apply(this,r)};clearTimeout(n),n=setTimeout(o,e)}return s.clear=()=>{clearTimeout(n)},s}function r1(t,e){var n,s;return A.isValidElement(t)&&e.indexOf((n=t.type.muiName)!=null?n:(s=t.type)==null||(s=s._payload)==null||(s=s.value)==null?void 0:s.muiName)!==-1}function jn(t){return t&&t.ownerDocument||document}function Il(t){return jn(t).defaultView||window}function aw(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let AE=0;function Bme(t){const[e,n]=A.useState(t),s=t||e;return A.useEffect(()=>{e==null&&(AE+=1,n(`mui-${AE}`))},[e]),s}const DE=C1["useId".toString()];function Tz(t){if(DE!==void 0){const e=DE();return t??e}return Bme(t)}function lw({controlled:t,default:e,name:n,state:s="value"}){const{current:r}=A.useRef(t!==void 0),[o,i]=A.useState(e),a=r?t:o,l=A.useCallback(c=>{r||i(c)},[]);return[a,l]}function $o(t){const e=A.useRef(t);return ca(()=>{e.current=t}),A.useRef((...n)=>(0,e.current)(...n)).current}function hs(...t){return A.useMemo(()=>t.every(e=>e==null)?null:e=>{t.forEach(n=>{aw(n,e)})},t)}const FE={};function Vme(t,e){const n=A.useRef(FE);return n.current===FE&&(n.current=t(e)),n}const Wme=[];function Ume(t){A.useEffect(t,Wme)}class Wy{constructor(){this.currentId=null,this.clear=()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)},this.disposeEffect=()=>this.clear}static create(){return new Wy}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function Ez(){const t=Vme(Wy.create).current;return Ume(t.disposeEffect),t}let Uy=!0,cw=!1;const Hme=new Wy,Gme={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function jme(t){const{type:e,tagName:n}=t;return!!(n==="INPUT"&&Gme[e]&&!t.readOnly||n==="TEXTAREA"&&!t.readOnly||t.isContentEditable)}function Kme(t){t.metaKey||t.altKey||t.ctrlKey||(Uy=!0)}function o1(){Uy=!1}function Xme(){this.visibilityState==="hidden"&&cw&&(Uy=!0)}function qme(t){t.addEventListener("keydown",Kme,!0),t.addEventListener("mousedown",o1,!0),t.addEventListener("pointerdown",o1,!0),t.addEventListener("touchstart",o1,!0),t.addEventListener("visibilitychange",Xme,!0)}function Yme(t){const{target:e}=t;try{return e.matches(":focus-visible")}catch{}return Uy||jme(e)}function Nz(){const t=A.useCallback(r=>{r!=null&&qme(r.ownerDocument)},[]),e=A.useRef(!1);function n(){return e.current?(cw=!0,Hme.start(100,()=>{cw=!1}),e.current=!1,!0):!1}function s(r){return Yme(r)?(e.current=!0,!0):!1}return{isFocusVisibleRef:e,onFocus:s,onBlur:n,ref:t}}function _z(t){const e=t.documentElement.clientWidth;return Math.abs(window.innerWidth-e)}const Qme={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",whiteSpace:"nowrap",width:"1px"},Zme=Qme;function an(t,e,n=void 0){const s={};return Object.keys(t).forEach(r=>{s[r]=t[r].reduce((o,i)=>{if(i){const a=e(i);a!==""&&o.push(a),n&&n[i]&&o.push(n[i])}return o},[]).join(" ")}),s}function Ji(t){return typeof t=="string"}function Jme(t,e,n){return t===void 0||Ji(t)?e:L({},e,{ownerState:L({},e.ownerState,n)})}function Pd(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(s=>s.match(/^on[A-Z]/)&&typeof t[s]=="function"&&!e.includes(s)).forEach(s=>{n[s]=t[s]}),n}function OE(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function ege(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:s,externalForwardedProps:r,className:o}=t;if(!e){const f=We(n==null?void 0:n.className,o,r==null?void 0:r.className,s==null?void 0:s.className),p=L({},n==null?void 0:n.style,r==null?void 0:r.style,s==null?void 0:s.style),m=L({},n,r,s);return f.length>0&&(m.className=f),Object.keys(p).length>0&&(m.style=p),{props:m,internalRef:void 0}}const i=Pd(L({},r,s)),a=OE(s),l=OE(r),c=e(i),u=We(c==null?void 0:c.className,n==null?void 0:n.className,o,r==null?void 0:r.className,s==null?void 0:s.className),d=L({},c==null?void 0:c.style,n==null?void 0:n.style,r==null?void 0:r.style,s==null?void 0:s.style),h=L({},c,n,l,a);return u.length>0&&(h.className=u),Object.keys(d).length>0&&(h.style=d),{props:h,internalRef:c.ref}}function tge(t,e,n){return typeof t=="function"?t(e,n):t}const nge=["elementType","externalSlotProps","ownerState","skipResolvingSlotProps"];function Ns(t){var e;const{elementType:n,externalSlotProps:s,ownerState:r,skipResolvingSlotProps:o=!1}=t,i=ze(t,nge),a=o?{}:tge(s,r),{props:l,internalRef:c}=ege(L({},i,{externalSlotProps:a})),u=hs(c,a==null?void 0:a.ref,(e=t.additionalProps)==null?void 0:e.ref);return Jme(n,L({},l,{ref:u}),r)}function ip(t){if(parseInt(A.version,10)>=19){var e;return(t==null||(e=t.props)==null?void 0:e.ref)||null}return(t==null?void 0:t.ref)||null}const sge=A.createContext(),Rz=()=>{const t=A.useContext(sge);return t??!1},rge=A.createContext(void 0);function oge(t){const{theme:e,name:n,props:s}=t;if(!e||!e.components||!e.components[n])return s;const r=e.components[n];return r.defaultProps?Kg(r.defaultProps,s):!r.styleOverrides&&!r.variants?Kg(r,s):s}function ige({props:t,name:e}){const n=A.useContext(rge);return oge({props:t,name:e,theme:{components:n}})}function age(t,e){return L({toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}}},e)}var mn={},Az={exports:{}};(function(t){function e(n){return n&&n.__esModule?n:{default:n}}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports})(Az);var Dz=Az.exports;const lge=mi(afe),cge=mi(zme);var Fz=Dz;Object.defineProperty(mn,"__esModule",{value:!0});var Mi=mn.alpha=Lz;mn.blend=vge;mn.colorChannel=void 0;var uw=mn.darken=V$;mn.decomposeColor=Or;mn.emphasize=zz;var uge=mn.getContrastRatio=mge;mn.getLuminance=Xg;mn.hexToRgb=Oz;mn.hslToRgb=Mz;var dw=mn.lighten=W$;mn.private_safeAlpha=gge;mn.private_safeColorChannel=void 0;mn.private_safeDarken=xge;mn.private_safeEmphasize=bge;mn.private_safeLighten=yge;mn.recomposeColor=Au;mn.rgbToHex=pge;var PE=Fz(lge),dge=Fz(cge);function B$(t,e=0,n=1){return(0,dge.default)(t,e,n)}function Oz(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(s=>s+s)),n?`rgb${n.length===4?"a":""}(${n.map((s,r)=>r<3?parseInt(s,16):Math.round(parseInt(s,16)/255*1e3)/1e3).join(", ")})`:""}function hge(t){const e=t.toString(16);return e.length===1?`0${e}`:e}function Or(t){if(t.type)return t;if(t.charAt(0)==="#")return Or(Oz(t));const e=t.indexOf("("),n=t.substring(0,e);if(["rgb","rgba","hsl","hsla","color"].indexOf(n)===-1)throw new Error((0,PE.default)(9,t));let s=t.substring(e+1,t.length-1),r;if(n==="color"){if(s=s.split(" "),r=s.shift(),s.length===4&&s[3].charAt(0)==="/"&&(s[3]=s[3].slice(1)),["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].indexOf(r)===-1)throw new Error((0,PE.default)(10,r))}else s=s.split(",");return s=s.map(o=>parseFloat(o)),{type:n,values:s,colorSpace:r}}const Pz=t=>{const e=Or(t);return e.values.slice(0,3).map((n,s)=>e.type.indexOf("hsl")!==-1&&s!==0?`${n}%`:n).join(" ")};mn.colorChannel=Pz;const fge=(t,e)=>{try{return Pz(t)}catch{return t}};mn.private_safeColorChannel=fge;function Au(t){const{type:e,colorSpace:n}=t;let{values:s}=t;return e.indexOf("rgb")!==-1?s=s.map((r,o)=>o<3?parseInt(r,10):r):e.indexOf("hsl")!==-1&&(s[1]=`${s[1]}%`,s[2]=`${s[2]}%`),e.indexOf("color")!==-1?s=`${n} ${s.join(" ")}`:s=`${s.join(", ")}`,`${e}(${s})`}function pge(t){if(t.indexOf("#")===0)return t;const{values:e}=Or(t);return`#${e.map((n,s)=>hge(s===3?Math.round(255*n):n)).join("")}`}function Mz(t){t=Or(t);const{values:e}=t,n=e[0],s=e[1]/100,r=e[2]/100,o=s*Math.min(r,1-r),i=(c,u=(c+n/30)%12)=>r-o*Math.max(Math.min(u-3,9-u,1),-1);let a="rgb";const l=[Math.round(i(0)*255),Math.round(i(8)*255),Math.round(i(4)*255)];return t.type==="hsla"&&(a+="a",l.push(e[3])),Au({type:a,values:l})}function Xg(t){t=Or(t);let e=t.type==="hsl"||t.type==="hsla"?Or(Mz(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function mge(t,e){const n=Xg(t),s=Xg(e);return(Math.max(n,s)+.05)/(Math.min(n,s)+.05)}function Lz(t,e){return t=Or(t),e=B$(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,Au(t)}function gge(t,e,n){try{return Lz(t,e)}catch{return t}}function V$(t,e){if(t=Or(t),e=B$(e),t.type.indexOf("hsl")!==-1)t.values[2]*=1-e;else if(t.type.indexOf("rgb")!==-1||t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]*=1-e;return Au(t)}function xge(t,e,n){try{return V$(t,e)}catch{return t}}function W$(t,e){if(t=Or(t),e=B$(e),t.type.indexOf("hsl")!==-1)t.values[2]+=(100-t.values[2])*e;else if(t.type.indexOf("rgb")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.indexOf("color")!==-1)for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return Au(t)}function yge(t,e,n){try{return W$(t,e)}catch{return t}}function zz(t,e=.15){return Xg(t)>.5?V$(t,e):W$(t,e)}function bge(t,e,n){try{return zz(t,e)}catch{return t}}function vge(t,e,n,s=1){const r=(l,c)=>Math.round((l**(1/s)*(1-n)+c**(1/s)*n)**s),o=Or(t),i=Or(e),a=[r(o.values[0],i.values[0]),r(o.values[1],i.values[1]),r(o.values[2],i.values[2])];return Au({type:"rgb",values:a})}const wge=["mode","contrastThreshold","tonalOffset"],ME={text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:bh.white,default:bh.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}},i1={text:{primary:bh.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:bh.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}};function LE(t,e,n,s){const r=s.light||s,o=s.dark||s*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=dw(t.main,r):e==="dark"&&(t.dark=uw(t.main,o)))}function kge(t="light"){return t==="dark"?{main:Jl[200],light:Jl[50],dark:Jl[400]}:{main:Jl[700],light:Jl[400],dark:Jl[800]}}function Cge(t="light"){return t==="dark"?{main:Zl[200],light:Zl[50],dark:Zl[400]}:{main:Zl[500],light:Zl[300],dark:Zl[700]}}function Sge(t="light"){return t==="dark"?{main:Ql[500],light:Ql[300],dark:Ql[700]}:{main:Ql[700],light:Ql[400],dark:Ql[800]}}function $ge(t="light"){return t==="dark"?{main:ec[400],light:ec[300],dark:ec[700]}:{main:ec[700],light:ec[500],dark:ec[900]}}function Ige(t="light"){return t==="dark"?{main:tc[400],light:tc[300],dark:tc[700]}:{main:tc[800],light:tc[500],dark:tc[900]}}function Tge(t="light"){return t==="dark"?{main:Xu[400],light:Xu[300],dark:Xu[700]}:{main:"#ed6c02",light:Xu[500],dark:Xu[900]}}function Ege(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:s=.2}=t,r=ze(t,wge),o=t.primary||kge(e),i=t.secondary||Cge(e),a=t.error||Sge(e),l=t.info||$ge(e),c=t.success||Ige(e),u=t.warning||Tge(e);function d(m){return uge(m,i1.text.primary)>=n?i1.text.primary:ME.text.primary}const h=({color:m,name:x,mainShade:g=500,lightShade:y=300,darkShade:b=700})=>{if(m=L({},m),!m.main&&m[g]&&(m.main=m[g]),!m.hasOwnProperty("main"))throw new Error($l(11,x?` (${x})`:"",g));if(typeof m.main!="string")throw new Error($l(12,x?` (${x})`:"",JSON.stringify(m.main)));return LE(m,"light",y,s),LE(m,"dark",b,s),m.contrastText||(m.contrastText=d(m.main)),m},f={dark:i1,light:ME};return tr(L({common:L({},bh),mode:e,primary:h({color:o,name:"primary"}),secondary:h({color:i,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:h({color:a,name:"error"}),warning:h({color:u,name:"warning"}),info:h({color:l,name:"info"}),success:h({color:c,name:"success"}),grey:ife,contrastThreshold:n,getContrastText:d,augmentColor:h,tonalOffset:s},f[e]),r)}const Nge=["fontFamily","fontSize","fontWeightLight","fontWeightRegular","fontWeightMedium","fontWeightBold","htmlFontSize","allVariants","pxToRem"];function _ge(t){return Math.round(t*1e5)/1e5}const zE={textTransform:"uppercase"},BE='"Roboto", "Helvetica", "Arial", sans-serif';function Rge(t,e){const n=typeof e=="function"?e(t):e,{fontFamily:s=BE,fontSize:r=14,fontWeightLight:o=300,fontWeightRegular:i=400,fontWeightMedium:a=500,fontWeightBold:l=700,htmlFontSize:c=16,allVariants:u,pxToRem:d}=n,h=ze(n,Nge),f=r/14,p=d||(g=>`${g/c*f}rem`),m=(g,y,b,v,w)=>L({fontFamily:s,fontWeight:g,fontSize:p(y),lineHeight:b},s===BE?{letterSpacing:`${_ge(v/y)}em`}:{},w,u),x={h1:m(o,96,1.167,-1.5),h2:m(o,60,1.2,-.5),h3:m(i,48,1.167,0),h4:m(i,34,1.235,.25),h5:m(i,24,1.334,0),h6:m(a,20,1.6,.15),subtitle1:m(i,16,1.75,.15),subtitle2:m(a,14,1.57,.1),body1:m(i,16,1.5,.15),body2:m(i,14,1.43,.15),button:m(a,14,1.75,.4,zE),caption:m(i,12,1.66,.4),overline:m(i,12,2.66,1,zE),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return tr(L({htmlFontSize:c,pxToRem:p,fontFamily:s,fontSize:r,fontWeightLight:o,fontWeightRegular:i,fontWeightMedium:a,fontWeightBold:l},x),h,{clone:!1})}const Age=.2,Dge=.14,Fge=.12;function Lt(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${Age})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${Dge})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${Fge})`].join(",")}const Oge=["none",Lt(0,2,1,-1,0,1,1,0,0,1,3,0),Lt(0,3,1,-2,0,2,2,0,0,1,5,0),Lt(0,3,3,-2,0,3,4,0,0,1,8,0),Lt(0,2,4,-1,0,4,5,0,0,1,10,0),Lt(0,3,5,-1,0,5,8,0,0,1,14,0),Lt(0,3,5,-1,0,6,10,0,0,1,18,0),Lt(0,4,5,-2,0,7,10,1,0,2,16,1),Lt(0,5,5,-3,0,8,10,1,0,3,14,2),Lt(0,5,6,-3,0,9,12,1,0,3,16,2),Lt(0,6,6,-3,0,10,14,1,0,4,18,3),Lt(0,6,7,-4,0,11,15,1,0,4,20,3),Lt(0,7,8,-4,0,12,17,2,0,5,22,4),Lt(0,7,8,-4,0,13,19,2,0,5,24,4),Lt(0,7,9,-4,0,14,21,2,0,5,26,4),Lt(0,8,9,-5,0,15,22,2,0,6,28,5),Lt(0,8,10,-5,0,16,24,2,0,6,30,5),Lt(0,8,11,-5,0,17,26,2,0,6,32,5),Lt(0,9,11,-5,0,18,28,2,0,7,34,6),Lt(0,9,12,-6,0,19,29,2,0,7,36,6),Lt(0,10,13,-6,0,20,31,3,0,8,38,7),Lt(0,10,13,-6,0,21,33,3,0,8,40,7),Lt(0,10,14,-6,0,22,35,3,0,8,42,7),Lt(0,11,14,-7,0,23,36,3,0,9,44,8),Lt(0,11,15,-7,0,24,38,3,0,9,46,8)],Pge=Oge,Mge=["duration","easing","delay"],Lge={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},zge={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function VE(t){return`${Math.round(t)}ms`}function Bge(t){if(!t)return 0;const e=t/36;return Math.round((4+15*e**.25+e/5)*10)}function Vge(t){const e=L({},Lge,t.easing),n=L({},zge,t.duration);return L({getAutoHeightDuration:Bge,create:(r=["all"],o={})=>{const{duration:i=n.standard,easing:a=e.easeInOut,delay:l=0}=o;return ze(o,Mge),(Array.isArray(r)?r:[r]).map(c=>`${c} ${typeof i=="string"?i:VE(i)} ${a} ${typeof l=="string"?l:VE(l)}`).join(",")}},t,{easing:e,duration:n})}const Wge={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500},Uge=Wge,Hge=["breakpoints","mixins","spacing","palette","transitions","typography","shape"];function Bz(t={},...e){const{mixins:n={},palette:s={},transitions:r={},typography:o={}}=t,i=ze(t,Hge);if(t.vars&&t.generateCssVars===void 0)throw new Error($l(18));const a=Ege(s),l=O$(t);let c=tr(l,{mixins:age(l.breakpoints,n),palette:a,shadows:Pge.slice(),typography:Rge(a,o),transitions:Vge(r),zIndex:L({},Uge)});return c=tr(c,i),c=e.reduce((u,d)=>tr(u,d),c),c.unstable_sxConfig=L({},op,i==null?void 0:i.unstable_sxConfig),c.unstable_sx=function(d){return Ry({sx:d,theme:this})},c}const Gge=Bz(),U$=Gge;function Vz(){const t=P$(U$);return t[ly]||t}var ap={},a1={exports:{}},WE;function jge(){return WE||(WE=1,function(t){function e(n,s){if(n==null)return{};var r={};for(var o in n)if({}.hasOwnProperty.call(n,o)){if(s.indexOf(o)!==-1)continue;r[o]=n[o]}return r}t.exports=e,t.exports.__esModule=!0,t.exports.default=t.exports}(a1)),a1.exports}const Kge=mi(Spe),Xge=mi($pe),qge=mi(Ape),Yge=mi(Mme),Qge=mi(vme),Zge=mi(Tme);var Du=Dz;Object.defineProperty(ap,"__esModule",{value:!0});var Jge=ap.default=h0e;ap.shouldForwardProp=Mm;ap.systemDefaultTheme=void 0;var pr=Du(lz()),hw=Du(jge()),UE=i0e(Kge),e0e=Xge;Du(qge);Du(Yge);var t0e=Du(Qge),n0e=Du(Zge);const s0e=["ownerState"],r0e=["variants"],o0e=["name","slot","skipVariantsResolver","skipSx","overridesResolver"];function Wz(t){if(typeof WeakMap!="function")return null;var e=new WeakMap,n=new WeakMap;return(Wz=function(s){return s?n:e})(t)}function i0e(t,e){if(!e&&t&&t.__esModule)return t;if(t===null||typeof t!="object"&&typeof t!="function")return{default:t};var n=Wz(e);if(n&&n.has(t))return n.get(t);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in t)if(o!=="default"&&Object.prototype.hasOwnProperty.call(t,o)){var i=r?Object.getOwnPropertyDescriptor(t,o):null;i&&(i.get||i.set)?Object.defineProperty(s,o,i):s[o]=t[o]}return s.default=t,n&&n.set(t,s),s}function a0e(t){return Object.keys(t).length===0}function l0e(t){return typeof t=="string"&&t.charCodeAt(0)>96}function Mm(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const c0e=ap.systemDefaultTheme=(0,t0e.default)(),u0e=t=>t&&t.charAt(0).toLowerCase()+t.slice(1);function Gp({defaultTheme:t,theme:e,themeId:n}){return a0e(e)?t:e[n]||e}function d0e(t){return t?(e,n)=>n[t]:null}function Lm(t,e){let{ownerState:n}=e,s=(0,hw.default)(e,s0e);const r=typeof t=="function"?t((0,pr.default)({ownerState:n},s)):t;if(Array.isArray(r))return r.flatMap(o=>Lm(o,(0,pr.default)({ownerState:n},s)));if(r&&typeof r=="object"&&Array.isArray(r.variants)){const{variants:o=[]}=r;let a=(0,hw.default)(r,r0e);return o.forEach(l=>{let c=!0;typeof l.props=="function"?c=l.props((0,pr.default)({ownerState:n},s,n)):Object.keys(l.props).forEach(u=>{(n==null?void 0:n[u])!==l.props[u]&&s[u]!==l.props[u]&&(c=!1)}),c&&(Array.isArray(a)||(a=[a]),a.push(typeof l.style=="function"?l.style((0,pr.default)({ownerState:n},s,n)):l.style))}),a}return r}function h0e(t={}){const{themeId:e,defaultTheme:n=c0e,rootShouldForwardProp:s=Mm,slotShouldForwardProp:r=Mm}=t,o=i=>(0,n0e.default)((0,pr.default)({},i,{theme:Gp((0,pr.default)({},i,{defaultTheme:n,themeId:e}))}));return o.__mui_systemSx=!0,(i,a={})=>{(0,UE.internal_processStyles)(i,w=>w.filter(k=>!(k!=null&&k.__mui_systemSx)));const{name:l,slot:c,skipVariantsResolver:u,skipSx:d,overridesResolver:h=d0e(u0e(c))}=a,f=(0,hw.default)(a,o0e),p=u!==void 0?u:c&&c!=="Root"&&c!=="root"||!1,m=d||!1;let x,g=Mm;c==="Root"||c==="root"?g=s:c?g=r:l0e(i)&&(g=void 0);const y=(0,UE.default)(i,(0,pr.default)({shouldForwardProp:g,label:x},f)),b=w=>typeof w=="function"&&w.__emotion_real!==w||(0,e0e.isPlainObject)(w)?k=>Lm(w,(0,pr.default)({},k,{theme:Gp({theme:k.theme,defaultTheme:n,themeId:e})})):w,v=(w,...k)=>{let C=b(w);const S=k?k.map(b):[];l&&h&&S.push(E=>{const _=Gp((0,pr.default)({},E,{defaultTheme:n,themeId:e}));if(!_.components||!_.components[l]||!_.components[l].styleOverrides)return null;const D=_.components[l].styleOverrides,F={};return Object.entries(D).forEach(([R,P])=>{F[R]=Lm(P,(0,pr.default)({},E,{theme:_}))}),h(E,F)}),l&&!p&&S.push(E=>{var _;const D=Gp((0,pr.default)({},E,{defaultTheme:n,themeId:e})),F=D==null||(_=D.components)==null||(_=_[l])==null?void 0:_.variants;return Lm({variants:F},(0,pr.default)({},E,{theme:D}))}),m||S.push(o);const I=S.length-k.length;if(Array.isArray(w)&&I>0){const E=new Array(I).fill("");C=[...w,...E],C.raw=[...w.raw,...E]}const $=y(C,...S);return i.muiName&&($.muiName=i.muiName),$};return y.withConfig&&(v.withConfig=y.withConfig),v}}function Hy(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const f0e=t=>Hy(t)&&t!=="classes",co=f0e,p0e=Jge({themeId:ly,defaultTheme:U$,rootShouldForwardProp:co}),Fe=p0e,m0e=t=>{let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,(e/100).toFixed(2)},HE=m0e;function ln(t){return ige(t)}function g0e(t){return qt("MuiSvgIcon",t)}Ut("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const x0e=["children","className","color","component","fontSize","htmlColor","inheritViewBox","titleAccess","viewBox"],y0e=t=>{const{color:e,fontSize:n,classes:s}=t,r={root:["root",e!=="inherit"&&`color${Ue(e)}`,`fontSize${Ue(n)}`]};return an(r,g0e,s)},b0e=Fe("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${Ue(n.color)}`],e[`fontSize${Ue(n.fontSize)}`]]}})(({theme:t,ownerState:e})=>{var n,s,r,o,i,a,l,c,u,d,h,f,p;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",fill:e.hasSvgAsChild?void 0:"currentColor",flexShrink:0,transition:(n=t.transitions)==null||(s=n.create)==null?void 0:s.call(n,"fill",{duration:(r=t.transitions)==null||(r=r.duration)==null?void 0:r.shorter}),fontSize:{inherit:"inherit",small:((o=t.typography)==null||(i=o.pxToRem)==null?void 0:i.call(o,20))||"1.25rem",medium:((a=t.typography)==null||(l=a.pxToRem)==null?void 0:l.call(a,24))||"1.5rem",large:((c=t.typography)==null||(u=c.pxToRem)==null?void 0:u.call(c,35))||"2.1875rem"}[e.fontSize],color:(d=(h=(t.vars||t).palette)==null||(h=h[e.color])==null?void 0:h.main)!=null?d:{action:(f=(t.vars||t).palette)==null||(f=f.action)==null?void 0:f.active,disabled:(p=(t.vars||t).palette)==null||(p=p.action)==null?void 0:p.disabled,inherit:void 0}[e.color]}}),Uz=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiSvgIcon"}),{children:r,className:o,color:i="inherit",component:a="svg",fontSize:l="medium",htmlColor:c,inheritViewBox:u=!1,titleAccess:d,viewBox:h="0 0 24 24"}=s,f=ze(s,x0e),p=A.isValidElement(r)&&r.type==="svg",m=L({},s,{color:i,component:a,fontSize:l,instanceFontSize:e.fontSize,inheritViewBox:u,viewBox:h,hasSvgAsChild:p}),x={};u||(x.viewBox=h);const g=y0e(m);return oe.jsxs(b0e,L({as:a,className:We(g.root,o),focusable:"false",color:c,"aria-hidden":d?void 0:!0,role:d?"img":void 0,ref:n},x,f,p&&r.props,{ownerState:m,children:[p?r.props.children:r,d?oe.jsx("title",{children:d}):null]}))});Uz.muiName="SvgIcon";const GE=Uz;function v0e(t,e){function n(s,r){return oe.jsx(GE,L({"data-testid":`${e}Icon`,ref:r},s,{children:t}))}return n.muiName=GE.muiName,A.memo(A.forwardRef(n))}function fw(t,e){return fw=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,s){return n.__proto__=s,n},fw(t,e)}function Hz(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,fw(t,e)}const jE={disabled:!1},qg=me.createContext(null);var w0e=function(e){return e.scrollTop},md="unmounted",Oa="exited",Pa="entering",lc="entered",pw="exiting",wi=function(t){Hz(e,t);function e(s,r){var o;o=t.call(this,s,r)||this;var i=r,a=i&&!i.isMounting?s.enter:s.appear,l;return o.appearStatus=null,s.in?a?(l=Oa,o.appearStatus=Pa):l=lc:s.unmountOnExit||s.mountOnEnter?l=md:l=Oa,o.state={status:l},o.nextCallback=null,o}e.getDerivedStateFromProps=function(r,o){var i=r.in;return i&&o.status===md?{status:Oa}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(r){var o=null;if(r!==this.props){var i=this.state.status;this.props.in?i!==Pa&&i!==lc&&(o=Pa):(i===Pa||i===lc)&&(o=pw)}this.updateStatus(!1,o)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var r=this.props.timeout,o,i,a;return o=i=a=r,r!=null&&typeof r!="number"&&(o=r.exit,i=r.enter,a=r.appear!==void 0?r.appear:i),{exit:o,enter:i,appear:a}},n.updateStatus=function(r,o){if(r===void 0&&(r=!1),o!==null)if(this.cancelNextCallback(),o===Pa){if(this.props.unmountOnExit||this.props.mountOnEnter){var i=this.props.nodeRef?this.props.nodeRef.current:_p.findDOMNode(this);i&&w0e(i)}this.performEnter(r)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Oa&&this.setState({status:md})},n.performEnter=function(r){var o=this,i=this.props.enter,a=this.context?this.context.isMounting:r,l=this.props.nodeRef?[a]:[_p.findDOMNode(this),a],c=l[0],u=l[1],d=this.getTimeouts(),h=a?d.appear:d.enter;if(!r&&!i||jE.disabled){this.safeSetState({status:lc},function(){o.props.onEntered(c)});return}this.props.onEnter(c,u),this.safeSetState({status:Pa},function(){o.props.onEntering(c,u),o.onTransitionEnd(h,function(){o.safeSetState({status:lc},function(){o.props.onEntered(c,u)})})})},n.performExit=function(){var r=this,o=this.props.exit,i=this.getTimeouts(),a=this.props.nodeRef?void 0:_p.findDOMNode(this);if(!o||jE.disabled){this.safeSetState({status:Oa},function(){r.props.onExited(a)});return}this.props.onExit(a),this.safeSetState({status:pw},function(){r.props.onExiting(a),r.onTransitionEnd(i.exit,function(){r.safeSetState({status:Oa},function(){r.props.onExited(a)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(r,o){o=this.setNextCallback(o),this.setState(r,o)},n.setNextCallback=function(r){var o=this,i=!0;return this.nextCallback=function(a){i&&(i=!1,o.nextCallback=null,r(a))},this.nextCallback.cancel=function(){i=!1},this.nextCallback},n.onTransitionEnd=function(r,o){this.setNextCallback(o);var i=this.props.nodeRef?this.props.nodeRef.current:_p.findDOMNode(this),a=r==null&&!this.props.addEndListener;if(!i||a){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var l=this.props.nodeRef?[this.nextCallback]:[i,this.nextCallback],c=l[0],u=l[1];this.props.addEndListener(c,u)}r!=null&&setTimeout(this.nextCallback,r)},n.render=function(){var r=this.state.status;if(r===md)return null;var o=this.props,i=o.children;o.in,o.mountOnEnter,o.unmountOnExit,o.appear,o.enter,o.exit,o.timeout,o.addEndListener,o.onEnter,o.onEntering,o.onEntered,o.onExit,o.onExiting,o.onExited,o.nodeRef;var a=ze(o,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return me.createElement(qg.Provider,{value:null},typeof i=="function"?i(r,a):me.cloneElement(me.Children.only(i),a))},e}(me.Component);wi.contextType=qg;wi.propTypes={};function nc(){}wi.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:nc,onEntering:nc,onEntered:nc,onExit:nc,onExiting:nc,onExited:nc};wi.UNMOUNTED=md;wi.EXITED=Oa;wi.ENTERING=Pa;wi.ENTERED=lc;wi.EXITING=pw;const Gz=wi;function k0e(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function H$(t,e){var n=function(o){return e&&A.isValidElement(o)?e(o):o},s=Object.create(null);return t&&A.Children.map(t,function(r){return r}).forEach(function(r){s[r.key]=n(r)}),s}function C0e(t,e){t=t||{},e=e||{};function n(u){return u in e?e[u]:t[u]}var s=Object.create(null),r=[];for(var o in t)o in e?r.length&&(s[o]=r,r=[]):r.push(o);var i,a={};for(var l in e){if(s[l])for(i=0;i<s[l].length;i++){var c=s[l][i];a[s[l][i]]=n(c)}a[l]=n(l)}for(i=0;i<r.length;i++)a[r[i]]=n(r[i]);return a}function qa(t,e,n){return n[e]!=null?n[e]:t.props[e]}function S0e(t,e){return H$(t.children,function(n){return A.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:qa(n,"appear",t),enter:qa(n,"enter",t),exit:qa(n,"exit",t)})})}function $0e(t,e,n){var s=H$(t.children),r=C0e(e,s);return Object.keys(r).forEach(function(o){var i=r[o];if(A.isValidElement(i)){var a=o in e,l=o in s,c=e[o],u=A.isValidElement(c)&&!c.props.in;l&&(!a||u)?r[o]=A.cloneElement(i,{onExited:n.bind(null,i),in:!0,exit:qa(i,"exit",t),enter:qa(i,"enter",t)}):!l&&a&&!u?r[o]=A.cloneElement(i,{in:!1}):l&&a&&A.isValidElement(c)&&(r[o]=A.cloneElement(i,{onExited:n.bind(null,i),in:c.props.in,exit:qa(i,"exit",t),enter:qa(i,"enter",t)}))}}),r}var I0e=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},T0e={component:"div",childFactory:function(e){return e}},G$=function(t){Hz(e,t);function e(s,r){var o;o=t.call(this,s,r)||this;var i=o.handleExited.bind(k0e(o));return o.state={contextValue:{isMounting:!0},handleExited:i,firstRender:!0},o}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(r,o){var i=o.children,a=o.handleExited,l=o.firstRender;return{children:l?S0e(r,a):$0e(r,i,a),firstRender:!1}},n.handleExited=function(r,o){var i=H$(this.props.children);r.key in i||(r.props.onExited&&r.props.onExited(o),this.mounted&&this.setState(function(a){var l=L({},a.children);return delete l[r.key],{children:l}}))},n.render=function(){var r=this.props,o=r.component,i=r.childFactory,a=ze(r,["component","childFactory"]),l=this.state.contextValue,c=I0e(this.state.children).map(i);return delete a.appear,delete a.enter,delete a.exit,o===null?me.createElement(qg.Provider,{value:l},c):me.createElement(qg.Provider,{value:l},me.createElement(o,a,c))},e}(me.Component);G$.propTypes={};G$.defaultProps=T0e;const E0e=G$,jz=t=>t.scrollTop;function Yg(t,e){var n,s;const{timeout:r,easing:o,style:i={}}=t;return{duration:(n=i.transitionDuration)!=null?n:typeof r=="number"?r:r[e.mode]||0,easing:(s=i.transitionTimingFunction)!=null?s:typeof o=="object"?o[e.mode]:o,delay:i.transitionDelay}}function N0e(t){return qt("MuiPaper",t)}Ut("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const _0e=["className","component","elevation","square","variant"],R0e=t=>{const{square:e,elevation:n,variant:s,classes:r}=t,o={root:["root",s,!e&&"rounded",s==="elevation"&&`elevation${n}`]};return an(o,N0e,r)},A0e=Fe("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(({theme:t,ownerState:e})=>{var n;return L({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow")},!e.square&&{borderRadius:t.shape.borderRadius},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.divider}`},e.variant==="elevation"&&L({boxShadow:(t.vars||t).shadows[e.elevation]},!t.vars&&t.palette.mode==="dark"&&{backgroundImage:`linear-gradient(${Mi("#fff",HE(e.elevation))}, ${Mi("#fff",HE(e.elevation))})`},t.vars&&{backgroundImage:(n=t.vars.overlays)==null?void 0:n[e.elevation]}))}),D0e=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiPaper"}),{className:r,component:o="div",elevation:i=1,square:a=!1,variant:l="elevation"}=s,c=ze(s,_0e),u=L({},s,{component:o,elevation:i,square:a,variant:l}),d=R0e(u);return oe.jsx(A0e,L({as:o,ownerState:u,className:We(d.root,r),ref:n},c))}),Ma=D0e;function F0e(t){const{className:e,classes:n,pulsate:s=!1,rippleX:r,rippleY:o,rippleSize:i,in:a,onExited:l,timeout:c}=t,[u,d]=A.useState(!1),h=We(e,n.ripple,n.rippleVisible,s&&n.ripplePulsate),f={width:i,height:i,top:-(i/2)+o,left:-(i/2)+r},p=We(n.child,u&&n.childLeaving,s&&n.childPulsate);return!a&&!u&&d(!0),A.useEffect(()=>{if(!a&&l!=null){const m=setTimeout(l,c);return()=>{clearTimeout(m)}}},[l,a,c]),oe.jsx("span",{className:h,style:f,children:oe.jsx("span",{className:p})})}const O0e=Ut("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),mr=O0e,P0e=["center","classes","className"];let Gy=t=>t,KE,XE,qE,YE;const mw=550,M0e=80,L0e=Cy(KE||(KE=Gy`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`)),z0e=Cy(XE||(XE=Gy`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`)),B0e=Cy(qE||(qE=Gy`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`)),V0e=Fe("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),W0e=Fe(F0e,{name:"MuiTouchRipple",slot:"Ripple"})(YE||(YE=Gy`
  opacity: 0;
  position: absolute;

  &.${0} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  &.${0} {
    animation-duration: ${0}ms;
  }

  & .${0} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${0} {
    opacity: 0;
    animation-name: ${0};
    animation-duration: ${0}ms;
    animation-timing-function: ${0};
  }

  & .${0} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${0};
    animation-duration: 2500ms;
    animation-timing-function: ${0};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`),mr.rippleVisible,L0e,mw,({theme:t})=>t.transitions.easing.easeInOut,mr.ripplePulsate,({theme:t})=>t.transitions.duration.shorter,mr.child,mr.childLeaving,z0e,mw,({theme:t})=>t.transitions.easing.easeInOut,mr.childPulsate,B0e,({theme:t})=>t.transitions.easing.easeInOut),U0e=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiTouchRipple"}),{center:r=!1,classes:o={},className:i}=s,a=ze(s,P0e),[l,c]=A.useState([]),u=A.useRef(0),d=A.useRef(null);A.useEffect(()=>{d.current&&(d.current(),d.current=null)},[l]);const h=A.useRef(!1),f=Ez(),p=A.useRef(null),m=A.useRef(null),x=A.useCallback(v=>{const{pulsate:w,rippleX:k,rippleY:C,rippleSize:S,cb:I}=v;c($=>[...$,oe.jsx(W0e,{classes:{ripple:We(o.ripple,mr.ripple),rippleVisible:We(o.rippleVisible,mr.rippleVisible),ripplePulsate:We(o.ripplePulsate,mr.ripplePulsate),child:We(o.child,mr.child),childLeaving:We(o.childLeaving,mr.childLeaving),childPulsate:We(o.childPulsate,mr.childPulsate)},timeout:mw,pulsate:w,rippleX:k,rippleY:C,rippleSize:S},u.current)]),u.current+=1,d.current=I},[o]),g=A.useCallback((v={},w={},k=()=>{})=>{const{pulsate:C=!1,center:S=r||w.pulsate,fakeElement:I=!1}=w;if((v==null?void 0:v.type)==="mousedown"&&h.current){h.current=!1;return}(v==null?void 0:v.type)==="touchstart"&&(h.current=!0);const $=I?null:m.current,E=$?$.getBoundingClientRect():{width:0,height:0,left:0,top:0};let _,D,F;if(S||v===void 0||v.clientX===0&&v.clientY===0||!v.clientX&&!v.touches)_=Math.round(E.width/2),D=Math.round(E.height/2);else{const{clientX:R,clientY:P}=v.touches&&v.touches.length>0?v.touches[0]:v;_=Math.round(R-E.left),D=Math.round(P-E.top)}if(S)F=Math.sqrt((2*E.width**2+E.height**2)/3),F%2===0&&(F+=1);else{const R=Math.max(Math.abs(($?$.clientWidth:0)-_),_)*2+2,P=Math.max(Math.abs(($?$.clientHeight:0)-D),D)*2+2;F=Math.sqrt(R**2+P**2)}v!=null&&v.touches?p.current===null&&(p.current=()=>{x({pulsate:C,rippleX:_,rippleY:D,rippleSize:F,cb:k})},f.start(M0e,()=>{p.current&&(p.current(),p.current=null)})):x({pulsate:C,rippleX:_,rippleY:D,rippleSize:F,cb:k})},[r,x,f]),y=A.useCallback(()=>{g({},{pulsate:!0})},[g]),b=A.useCallback((v,w)=>{if(f.clear(),(v==null?void 0:v.type)==="touchend"&&p.current){p.current(),p.current=null,f.start(0,()=>{b(v,w)});return}p.current=null,c(k=>k.length>0?k.slice(1):k),d.current=w},[f]);return A.useImperativeHandle(n,()=>({pulsate:y,start:g,stop:b}),[y,g,b]),oe.jsx(V0e,L({className:We(mr.root,o.root,i),ref:m},a,{children:oe.jsx(E0e,{component:null,exit:!0,children:l})}))}),H0e=U0e;function G0e(t){return qt("MuiButtonBase",t)}const j0e=Ut("MuiButtonBase",["root","disabled","focusVisible"]),K0e=j0e,X0e=["action","centerRipple","children","className","component","disabled","disableRipple","disableTouchRipple","focusRipple","focusVisibleClassName","LinkComponent","onBlur","onClick","onContextMenu","onDragLeave","onFocus","onFocusVisible","onKeyDown","onKeyUp","onMouseDown","onMouseLeave","onMouseUp","onTouchEnd","onTouchMove","onTouchStart","tabIndex","TouchRippleProps","touchRippleRef","type"],q0e=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:s,classes:r}=t,i=an({root:["root",e&&"disabled",n&&"focusVisible"]},G0e,r);return n&&s&&(i.root+=` ${s}`),i},Y0e=Fe("button",{name:"MuiButtonBase",slot:"Root",overridesResolver:(t,e)=>e.root})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${K0e.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),Q0e=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiButtonBase"}),{action:r,centerRipple:o=!1,children:i,className:a,component:l="button",disabled:c=!1,disableRipple:u=!1,disableTouchRipple:d=!1,focusRipple:h=!1,LinkComponent:f="a",onBlur:p,onClick:m,onContextMenu:x,onDragLeave:g,onFocus:y,onFocusVisible:b,onKeyDown:v,onKeyUp:w,onMouseDown:k,onMouseLeave:C,onMouseUp:S,onTouchEnd:I,onTouchMove:$,onTouchStart:E,tabIndex:_=0,TouchRippleProps:D,touchRippleRef:F,type:R}=s,P=ze(s,X0e),M=A.useRef(null),N=A.useRef(null),B=hs(N,F),{isFocusVisibleRef:G,onFocus:X,onBlur:Y,ref:J}=Nz(),[q,ee]=A.useState(!1);c&&q&&ee(!1),A.useImperativeHandle(r,()=>({focusVisible:()=>{ee(!0),M.current.focus()}}),[]);const[ne,ce]=A.useState(!1);A.useEffect(()=>{ce(!0)},[]);const ge=ne&&!u&&!c;A.useEffect(()=>{q&&h&&!u&&ne&&N.current.pulsate()},[u,h,q,ne]);function de(te,we,Ve=d){return $o(qe=>(we&&we(qe),!Ve&&N.current&&N.current[te](qe),!0))}const $e=de("start",k),fe=de("stop",x),Ie=de("stop",g),xe=de("stop",S),ye=de("stop",te=>{q&&te.preventDefault(),C&&C(te)}),pe=de("start",E),Re=de("stop",I),Pe=de("stop",$),Ae=de("stop",te=>{Y(te),G.current===!1&&ee(!1),p&&p(te)},!1),At=$o(te=>{M.current||(M.current=te.currentTarget),X(te),G.current===!0&&(ee(!0),b&&b(te)),y&&y(te)}),Oe=()=>{const te=M.current;return l&&l!=="button"&&!(te.tagName==="A"&&te.href)},Xe=A.useRef(!1),wt=$o(te=>{h&&!Xe.current&&q&&N.current&&te.key===" "&&(Xe.current=!0,N.current.stop(te,()=>{N.current.start(te)})),te.target===te.currentTarget&&Oe()&&te.key===" "&&te.preventDefault(),v&&v(te),te.target===te.currentTarget&&Oe()&&te.key==="Enter"&&!c&&(te.preventDefault(),m&&m(te))}),It=$o(te=>{h&&te.key===" "&&N.current&&q&&!te.defaultPrevented&&(Xe.current=!1,N.current.stop(te,()=>{N.current.pulsate(te)})),w&&w(te),m&&te.target===te.currentTarget&&Oe()&&te.key===" "&&!te.defaultPrevented&&m(te)});let He=l;He==="button"&&(P.href||P.to)&&(He=f);const Ht={};He==="button"?(Ht.type=R===void 0?"button":R,Ht.disabled=c):(!P.href&&!P.to&&(Ht.role="button"),c&&(Ht["aria-disabled"]=c));const cn=hs(n,J,M),Mt=L({},s,{centerRipple:o,component:l,disabled:c,disableRipple:u,disableTouchRipple:d,focusRipple:h,tabIndex:_,focusVisible:q}),se=q0e(Mt);return oe.jsxs(Y0e,L({as:He,className:We(se.root,a),ownerState:Mt,onBlur:Ae,onClick:m,onContextMenu:fe,onFocus:At,onKeyDown:wt,onKeyUp:It,onMouseDown:$e,onMouseLeave:ye,onMouseUp:xe,onDragLeave:Ie,onTouchEnd:Re,onTouchMove:Pe,onTouchStart:pe,ref:cn,tabIndex:c?-1:_,type:R},Ht,P,{children:[i,ge?oe.jsx(H0e,L({ref:B,center:o},D)):null]}))}),Z0e=Q0e;function J0e(t){return qt("MuiTypography",t)}Ut("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const exe=["align","className","component","gutterBottom","noWrap","paragraph","variant","variantMapping"],txe=t=>{const{align:e,gutterBottom:n,noWrap:s,paragraph:r,variant:o,classes:i}=t,a={root:["root",o,t.align!=="inherit"&&`align${Ue(e)}`,n&&"gutterBottom",s&&"noWrap",r&&"paragraph"]};return an(a,J0e,i)},nxe=Fe("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${Ue(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(({theme:t,ownerState:e})=>L({margin:0},e.variant==="inherit"&&{font:"inherit"},e.variant!=="inherit"&&t.typography[e.variant],e.align!=="inherit"&&{textAlign:e.align},e.noWrap&&{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},e.gutterBottom&&{marginBottom:"0.35em"},e.paragraph&&{marginBottom:16})),QE={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},sxe={primary:"primary.main",textPrimary:"text.primary",secondary:"secondary.main",textSecondary:"text.secondary",error:"error.main"},rxe=t=>sxe[t]||t,oxe=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiTypography"}),r=rxe(s.color),o=M$(L({},s,{color:r})),{align:i="inherit",className:a,component:l,gutterBottom:c=!1,noWrap:u=!1,paragraph:d=!1,variant:h="body1",variantMapping:f=QE}=o,p=ze(o,exe),m=L({},o,{align:i,color:r,className:a,component:l,gutterBottom:c,noWrap:u,paragraph:d,variant:h,variantMapping:f}),x=l||(d?"p":f[h]||QE[h])||"span",g=txe(m);return oe.jsx(nxe,L({as:x,ref:n,ownerState:m,className:We(g.root,a)},p))}),zt=oxe;function ixe(t){return typeof t=="function"?t():t}const axe=A.forwardRef(function(e,n){const{children:s,container:r,disablePortal:o=!1}=e,[i,a]=A.useState(null),l=hs(A.isValidElement(s)?ip(s):null,n);if(ca(()=>{o||a(ixe(r)||document.body)},[r,o]),ca(()=>{if(i&&!o)return aw(n,i),()=>{aw(n,null)}},[n,i,o]),o){if(A.isValidElement(s)){const c={ref:l};return A.cloneElement(s,c)}return oe.jsx(A.Fragment,{children:s})}return oe.jsx(A.Fragment,{children:i&&_k.createPortal(s,i)})}),lxe=axe,cxe=["onChange","maxRows","minRows","style","value"];function jp(t){return parseInt(t,10)||0}const uxe={shadow:{visibility:"hidden",position:"absolute",overflow:"hidden",height:0,top:0,left:0,transform:"translateZ(0)"}};function dxe(t){for(const e in t)return!1;return!0}function ZE(t){return dxe(t)||t.outerHeightStyle===0&&!t.overflowing}const hxe=A.forwardRef(function(e,n){const{onChange:s,maxRows:r,minRows:o=1,style:i,value:a}=e,l=ze(e,cxe),{current:c}=A.useRef(a!=null),u=A.useRef(null),d=hs(n,u),h=A.useRef(null),f=A.useRef(null),p=A.useCallback(()=>{const b=u.current,v=f.current;if(!b||!v)return;const k=Il(b).getComputedStyle(b);if(k.width==="0px")return{outerHeightStyle:0,overflowing:!1};v.style.width=k.width,v.value=b.value||e.placeholder||"x",v.value.slice(-1)===`
`&&(v.value+=" ");const C=k.boxSizing,S=jp(k.paddingBottom)+jp(k.paddingTop),I=jp(k.borderBottomWidth)+jp(k.borderTopWidth),$=v.scrollHeight;v.value="x";const E=v.scrollHeight;let _=$;o&&(_=Math.max(Number(o)*E,_)),r&&(_=Math.min(Number(r)*E,_)),_=Math.max(_,E);const D=_+(C==="border-box"?S+I:0),F=Math.abs(_-$)<=1;return{outerHeightStyle:D,overflowing:F}},[r,o,e.placeholder]),m=$o(()=>{const b=u.current,v=p();if(!b||!v||ZE(v))return!1;const w=v.outerHeightStyle;return h.current!=null&&h.current!==w}),x=A.useCallback(()=>{const b=u.current,v=p();if(!b||!v||ZE(v))return;const w=v.outerHeightStyle;h.current!==w&&(h.current=w,b.style.height=`${w}px`),b.style.overflow=v.overflowing?"hidden":""},[p]),g=A.useRef(-1);ca(()=>{const b=Iz(x),v=u==null?void 0:u.current;if(!v)return;const w=Il(v);w.addEventListener("resize",b);let k;return typeof ResizeObserver<"u"&&(k=new ResizeObserver(()=>{m()&&(k.unobserve(v),cancelAnimationFrame(g.current),x(),g.current=requestAnimationFrame(()=>{k.observe(v)}))}),k.observe(v)),()=>{b.clear(),cancelAnimationFrame(g.current),w.removeEventListener("resize",b),k&&k.disconnect()}},[p,x,m]),ca(()=>{x()});const y=b=>{c||x(),s&&s(b)};return oe.jsxs(A.Fragment,{children:[oe.jsx("textarea",L({value:a,onChange:y,ref:d,rows:o,style:i},l)),oe.jsx("textarea",{"aria-hidden":!0,className:e.className,readOnly:!0,ref:f,tabIndex:-1,style:L({},uxe.shadow,i,{paddingTop:0,paddingBottom:0})})]})}),fxe=hxe;function Fu({props:t,states:e,muiFormControl:n}){return e.reduce((s,r)=>(s[r]=t[r],n&&typeof t[r]>"u"&&(s[r]=n[r]),s),{})}const pxe=A.createContext(void 0),j$=pxe;function Ou(){return A.useContext(j$)}function mxe(t){return oe.jsx(Sme,L({},t,{defaultTheme:U$,themeId:ly}))}function JE(t){return t!=null&&!(Array.isArray(t)&&t.length===0)}function Qg(t,e=!1){return t&&(JE(t.value)&&t.value!==""||e&&JE(t.defaultValue)&&t.defaultValue!=="")}function gxe(t){return t.startAdornment}function xxe(t){return qt("MuiInputBase",t)}const yxe=Ut("MuiInputBase",["root","formControl","focused","disabled","adornedStart","adornedEnd","error","sizeSmall","multiline","colorSecondary","fullWidth","hiddenLabel","readOnly","input","inputSizeSmall","inputMultiline","inputTypeSearch","inputAdornedStart","inputAdornedEnd","inputHiddenLabel"]),ou=yxe,bxe=["aria-describedby","autoComplete","autoFocus","className","color","components","componentsProps","defaultValue","disabled","disableInjectingGlobalStyles","endAdornment","error","fullWidth","id","inputComponent","inputProps","inputRef","margin","maxRows","minRows","multiline","name","onBlur","onChange","onClick","onFocus","onKeyDown","onKeyUp","placeholder","readOnly","renderSuffix","rows","size","slotProps","slots","startAdornment","type","value"],jy=(t,e)=>{const{ownerState:n}=t;return[e.root,n.formControl&&e.formControl,n.startAdornment&&e.adornedStart,n.endAdornment&&e.adornedEnd,n.error&&e.error,n.size==="small"&&e.sizeSmall,n.multiline&&e.multiline,n.color&&e[`color${Ue(n.color)}`],n.fullWidth&&e.fullWidth,n.hiddenLabel&&e.hiddenLabel]},Ky=(t,e)=>{const{ownerState:n}=t;return[e.input,n.size==="small"&&e.inputSizeSmall,n.multiline&&e.inputMultiline,n.type==="search"&&e.inputTypeSearch,n.startAdornment&&e.inputAdornedStart,n.endAdornment&&e.inputAdornedEnd,n.hiddenLabel&&e.inputHiddenLabel]},vxe=t=>{const{classes:e,color:n,disabled:s,error:r,endAdornment:o,focused:i,formControl:a,fullWidth:l,hiddenLabel:c,multiline:u,readOnly:d,size:h,startAdornment:f,type:p}=t,m={root:["root",`color${Ue(n)}`,s&&"disabled",r&&"error",l&&"fullWidth",i&&"focused",a&&"formControl",h&&h!=="medium"&&`size${Ue(h)}`,u&&"multiline",f&&"adornedStart",o&&"adornedEnd",c&&"hiddenLabel",d&&"readOnly"],input:["input",s&&"disabled",p==="search"&&"inputTypeSearch",u&&"inputMultiline",h==="small"&&"inputSizeSmall",c&&"inputHiddenLabel",f&&"inputAdornedStart",o&&"inputAdornedEnd",d&&"readOnly"]};return an(m,xxe,e)},Xy=Fe("div",{name:"MuiInputBase",slot:"Root",overridesResolver:jy})(({theme:t,ownerState:e})=>L({},t.typography.body1,{color:(t.vars||t).palette.text.primary,lineHeight:"1.4375em",boxSizing:"border-box",position:"relative",cursor:"text",display:"inline-flex",alignItems:"center",[`&.${ou.disabled}`]:{color:(t.vars||t).palette.text.disabled,cursor:"default"}},e.multiline&&L({padding:"4px 0 5px"},e.size==="small"&&{paddingTop:1}),e.fullWidth&&{width:"100%"})),qy=Fe("input",{name:"MuiInputBase",slot:"Input",overridesResolver:Ky})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light",s=L({color:"currentColor"},t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5},{transition:t.transitions.create("opacity",{duration:t.transitions.duration.shorter})}),r={opacity:"0 !important"},o=t.vars?{opacity:t.vars.opacity.inputPlaceholder}:{opacity:n?.42:.5};return L({font:"inherit",letterSpacing:"inherit",color:"currentColor",padding:"4px 0 5px",border:0,boxSizing:"content-box",background:"none",height:"1.4375em",margin:0,WebkitTapHighlightColor:"transparent",display:"block",minWidth:0,width:"100%",animationName:"mui-auto-fill-cancel",animationDuration:"10ms","&::-webkit-input-placeholder":s,"&::-moz-placeholder":s,"&:-ms-input-placeholder":s,"&::-ms-input-placeholder":s,"&:focus":{outline:0},"&:invalid":{boxShadow:"none"},"&::-webkit-search-decoration":{WebkitAppearance:"none"},[`label[data-shrink=false] + .${ou.formControl} &`]:{"&::-webkit-input-placeholder":r,"&::-moz-placeholder":r,"&:-ms-input-placeholder":r,"&::-ms-input-placeholder":r,"&:focus::-webkit-input-placeholder":o,"&:focus::-moz-placeholder":o,"&:focus:-ms-input-placeholder":o,"&:focus::-ms-input-placeholder":o},[`&.${ou.disabled}`]:{opacity:1,WebkitTextFillColor:(t.vars||t).palette.text.disabled},"&:-webkit-autofill":{animationDuration:"5000s",animationName:"mui-auto-fill"}},e.size==="small"&&{paddingTop:1},e.multiline&&{height:"auto",resize:"none",padding:0,paddingTop:0},e.type==="search"&&{MozAppearance:"textfield"})}),wxe=oe.jsx(mxe,{styles:{"@keyframes mui-auto-fill":{from:{display:"block"}},"@keyframes mui-auto-fill-cancel":{from:{display:"block"}}}}),kxe=A.forwardRef(function(e,n){var s;const r=ln({props:e,name:"MuiInputBase"}),{"aria-describedby":o,autoComplete:i,autoFocus:a,className:l,components:c={},componentsProps:u={},defaultValue:d,disabled:h,disableInjectingGlobalStyles:f,endAdornment:p,fullWidth:m=!1,id:x,inputComponent:g="input",inputProps:y={},inputRef:b,maxRows:v,minRows:w,multiline:k=!1,name:C,onBlur:S,onChange:I,onClick:$,onFocus:E,onKeyDown:_,onKeyUp:D,placeholder:F,readOnly:R,renderSuffix:P,rows:M,slotProps:N={},slots:B={},startAdornment:G,type:X="text",value:Y}=r,J=ze(r,bxe),q=y.value!=null?y.value:Y,{current:ee}=A.useRef(q!=null),ne=A.useRef(),ce=A.useCallback(se=>{},[]),ge=hs(ne,b,y.ref,ce),[de,$e]=A.useState(!1),fe=Ou(),Ie=Fu({props:r,muiFormControl:fe,states:["color","disabled","error","hiddenLabel","size","required","filled"]});Ie.focused=fe?fe.focused:de,A.useEffect(()=>{!fe&&h&&de&&($e(!1),S&&S())},[fe,h,de,S]);const xe=fe&&fe.onFilled,ye=fe&&fe.onEmpty,pe=A.useCallback(se=>{Qg(se)?xe&&xe():ye&&ye()},[xe,ye]);ca(()=>{ee&&pe({value:q})},[q,pe,ee]);const Re=se=>{if(Ie.disabled){se.stopPropagation();return}E&&E(se),y.onFocus&&y.onFocus(se),fe&&fe.onFocus?fe.onFocus(se):$e(!0)},Pe=se=>{S&&S(se),y.onBlur&&y.onBlur(se),fe&&fe.onBlur?fe.onBlur(se):$e(!1)},Ae=(se,...te)=>{if(!ee){const we=se.target||ne.current;if(we==null)throw new Error($l(1));pe({value:we.value})}y.onChange&&y.onChange(se,...te),I&&I(se,...te)};A.useEffect(()=>{pe(ne.current)},[]);const At=se=>{ne.current&&se.currentTarget===se.target&&ne.current.focus(),$&&$(se)};let Oe=g,Xe=y;k&&Oe==="input"&&(M?Xe=L({type:void 0,minRows:M,maxRows:M},Xe):Xe=L({type:void 0,maxRows:v,minRows:w},Xe),Oe=fxe);const wt=se=>{pe(se.animationName==="mui-auto-fill-cancel"?ne.current:{value:"x"})};A.useEffect(()=>{fe&&fe.setAdornedStart(!!G)},[fe,G]);const It=L({},r,{color:Ie.color||"primary",disabled:Ie.disabled,endAdornment:p,error:Ie.error,focused:Ie.focused,formControl:fe,fullWidth:m,hiddenLabel:Ie.hiddenLabel,multiline:k,size:Ie.size,startAdornment:G,type:X}),He=vxe(It),Ht=B.root||c.Root||Xy,cn=N.root||u.root||{},Mt=B.input||c.Input||qy;return Xe=L({},Xe,(s=N.input)!=null?s:u.input),oe.jsxs(A.Fragment,{children:[!f&&wxe,oe.jsxs(Ht,L({},cn,!Ji(Ht)&&{ownerState:L({},It,cn.ownerState)},{ref:n,onClick:At},J,{className:We(He.root,cn.className,l,R&&"MuiInputBase-readOnly"),children:[G,oe.jsx(j$.Provider,{value:null,children:oe.jsx(Mt,L({ownerState:It,"aria-invalid":Ie.error,"aria-describedby":o,autoComplete:i,autoFocus:a,defaultValue:d,disabled:Ie.disabled,id:x,onAnimationStart:wt,name:C,placeholder:F,readOnly:R,required:Ie.required,rows:M,value:q,onKeyDown:_,onKeyUp:D,type:X},Xe,!Ji(Mt)&&{as:Oe,ownerState:L({},It,Xe.ownerState)},{ref:ge,className:We(He.input,Xe.className,R&&"MuiInputBase-readOnly"),onBlur:Pe,onChange:Ae,onFocus:Re}))}),p,P?P(L({},Ie,{startAdornment:G})):null]}))]})}),K$=kxe;function Cxe(t){return qt("MuiInput",t)}const Sxe=L({},ou,Ut("MuiInput",["root","underline","input"])),Yu=Sxe;function $xe(t){return qt("MuiOutlinedInput",t)}const Ixe=L({},ou,Ut("MuiOutlinedInput",["root","notchedOutline","input"])),Ci=Ixe;function Txe(t){return qt("MuiFilledInput",t)}const Exe=L({},ou,Ut("MuiFilledInput",["root","underline","input"])),Ta=Exe,Nxe=v0e(oe.jsx("path",{d:"M7 10l5 5 5-5z"}),"ArrowDropDown"),_xe=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"],Rxe={entering:{opacity:1},entered:{opacity:1}},Axe=A.forwardRef(function(e,n){const s=Vz(),r={enter:s.transitions.duration.enteringScreen,exit:s.transitions.duration.leavingScreen},{addEndListener:o,appear:i=!0,children:a,easing:l,in:c,onEnter:u,onEntered:d,onEntering:h,onExit:f,onExited:p,onExiting:m,style:x,timeout:g=r,TransitionComponent:y=Gz}=e,b=ze(e,_xe),v=A.useRef(null),w=hs(v,ip(a),n),k=F=>R=>{if(F){const P=v.current;R===void 0?F(P):F(P,R)}},C=k(h),S=k((F,R)=>{jz(F);const P=Yg({style:x,timeout:g,easing:l},{mode:"enter"});F.style.webkitTransition=s.transitions.create("opacity",P),F.style.transition=s.transitions.create("opacity",P),u&&u(F,R)}),I=k(d),$=k(m),E=k(F=>{const R=Yg({style:x,timeout:g,easing:l},{mode:"exit"});F.style.webkitTransition=s.transitions.create("opacity",R),F.style.transition=s.transitions.create("opacity",R),f&&f(F)}),_=k(p),D=F=>{o&&o(v.current,F)};return oe.jsx(y,L({appear:i,in:c,nodeRef:v,onEnter:S,onEntered:I,onEntering:C,onExit:E,onExited:_,onExiting:$,addEndListener:D,timeout:g},b,{children:(F,R)=>A.cloneElement(a,L({style:L({opacity:0,visibility:F==="exited"&&!c?"hidden":void 0},Rxe[F],x,a.props.style),ref:w},R))}))}),Dxe=Axe;function Fxe(t){return qt("MuiBackdrop",t)}Ut("MuiBackdrop",["root","invisible"]);const Oxe=["children","className","component","components","componentsProps","invisible","open","slotProps","slots","TransitionComponent","transitionDuration"],Pxe=t=>{const{classes:e,invisible:n}=t;return an({root:["root",n&&"invisible"]},Fxe,e)},Mxe=Fe("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})(({ownerState:t})=>L({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent"},t.invisible&&{backgroundColor:"transparent"})),Lxe=A.forwardRef(function(e,n){var s,r,o;const i=ln({props:e,name:"MuiBackdrop"}),{children:a,className:l,component:c="div",components:u={},componentsProps:d={},invisible:h=!1,open:f,slotProps:p={},slots:m={},TransitionComponent:x=Dxe,transitionDuration:g}=i,y=ze(i,Oxe),b=L({},i,{component:c,invisible:h}),v=Pxe(b),w=(s=p.root)!=null?s:d.root;return oe.jsx(x,L({in:f,timeout:g},y,{children:oe.jsx(Mxe,L({"aria-hidden":!0},w,{as:(r=(o=m.root)!=null?o:u.Root)!=null?r:c,className:We(v.root,l,w==null?void 0:w.className),ownerState:L({},b,w==null?void 0:w.ownerState),classes:v,ref:n,children:a}))}))}),zxe=Lxe,Bxe=Ut("MuiBox",["root"]),Vxe=Bxe,Wxe=Bz(),Uxe=Rme({themeId:ly,defaultTheme:Wxe,defaultClassName:Vxe.root,generateClassName:wz.generate}),Kp=Uxe;function Hxe(t){return qt("MuiButton",t)}const Gxe=Ut("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge"]),Xp=Gxe,jxe=A.createContext({}),Kxe=jxe,Xxe=A.createContext(void 0),qxe=Xxe,Yxe=["children","color","component","className","disabled","disableElevation","disableFocusRipple","endIcon","focusVisibleClassName","fullWidth","size","startIcon","type","variant"],Qxe=t=>{const{color:e,disableElevation:n,fullWidth:s,size:r,variant:o,classes:i}=t,a={root:["root",o,`${o}${Ue(e)}`,`size${Ue(r)}`,`${o}Size${Ue(r)}`,`color${Ue(e)}`,n&&"disableElevation",s&&"fullWidth"],label:["label"],startIcon:["icon","startIcon",`iconSize${Ue(r)}`],endIcon:["icon","endIcon",`iconSize${Ue(r)}`]},l=an(a,Hxe,i);return L({},i,l)},Kz=t=>L({},t.size==="small"&&{"& > *:nth-of-type(1)":{fontSize:18}},t.size==="medium"&&{"& > *:nth-of-type(1)":{fontSize:20}},t.size==="large"&&{"& > *:nth-of-type(1)":{fontSize:22}}),Zxe=Fe(Z0e,{shouldForwardProp:t=>co(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${Ue(n.color)}`],e[`size${Ue(n.size)}`],e[`${n.variant}Size${Ue(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth]}})(({theme:t,ownerState:e})=>{var n,s;const r=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],o=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return L({},t.typography.button,{minWidth:64,padding:"6px 16px",borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":L({textDecoration:"none",backgroundColor:t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Mi(t.palette.text.primary,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="text"&&e.color!=="inherit"&&{backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Mi(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="outlined"&&e.color!=="inherit"&&{border:`1px solid ${(t.vars||t).palette[e.color].main}`,backgroundColor:t.vars?`rgba(${t.vars.palette[e.color].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Mi(t.palette[e.color].main,t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}},e.variant==="contained"&&{backgroundColor:t.vars?t.vars.palette.Button.inheritContainedHoverBg:o,boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2],backgroundColor:(t.vars||t).palette.grey[300]}},e.variant==="contained"&&e.color!=="inherit"&&{backgroundColor:(t.vars||t).palette[e.color].dark,"@media (hover: none)":{backgroundColor:(t.vars||t).palette[e.color].main}}),"&:active":L({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[8]}),[`&.${Xp.focusVisible}`]:L({},e.variant==="contained"&&{boxShadow:(t.vars||t).shadows[6]}),[`&.${Xp.disabled}`]:L({color:(t.vars||t).palette.action.disabled},e.variant==="outlined"&&{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`},e.variant==="contained"&&{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground})},e.variant==="text"&&{padding:"6px 8px"},e.variant==="text"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main},e.variant==="outlined"&&{padding:"5px 15px",border:"1px solid currentColor"},e.variant==="outlined"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].main,border:t.vars?`1px solid rgba(${t.vars.palette[e.color].mainChannel} / 0.5)`:`1px solid ${Mi(t.palette[e.color].main,.5)}`},e.variant==="contained"&&{color:t.vars?t.vars.palette.text.primary:(n=(s=t.palette).getContrastText)==null?void 0:n.call(s,t.palette.grey[300]),backgroundColor:t.vars?t.vars.palette.Button.inheritContainedBg:r,boxShadow:(t.vars||t).shadows[2]},e.variant==="contained"&&e.color!=="inherit"&&{color:(t.vars||t).palette[e.color].contrastText,backgroundColor:(t.vars||t).palette[e.color].main},e.color==="inherit"&&{color:"inherit",borderColor:"currentColor"},e.size==="small"&&e.variant==="text"&&{padding:"4px 5px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="text"&&{padding:"8px 11px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="outlined"&&{padding:"3px 9px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="outlined"&&{padding:"7px 21px",fontSize:t.typography.pxToRem(15)},e.size==="small"&&e.variant==="contained"&&{padding:"4px 10px",fontSize:t.typography.pxToRem(13)},e.size==="large"&&e.variant==="contained"&&{padding:"8px 22px",fontSize:t.typography.pxToRem(15)},e.fullWidth&&{width:"100%"})},({ownerState:t})=>t.disableElevation&&{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${Xp.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${Xp.disabled}`]:{boxShadow:"none"}}),Jxe=Fe("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,e[`iconSize${Ue(n.size)}`]]}})(({ownerState:t})=>L({display:"inherit",marginRight:8,marginLeft:-4},t.size==="small"&&{marginLeft:-2},Kz(t))),eye=Fe("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,e[`iconSize${Ue(n.size)}`]]}})(({ownerState:t})=>L({display:"inherit",marginRight:-4,marginLeft:8},t.size==="small"&&{marginRight:-2},Kz(t))),tye=A.forwardRef(function(e,n){const s=A.useContext(Kxe),r=A.useContext(qxe),o=Kg(s,e),i=ln({props:o,name:"MuiButton"}),{children:a,color:l="primary",component:c="button",className:u,disabled:d=!1,disableElevation:h=!1,disableFocusRipple:f=!1,endIcon:p,focusVisibleClassName:m,fullWidth:x=!1,size:g="medium",startIcon:y,type:b,variant:v="text"}=i,w=ze(i,Yxe),k=L({},i,{color:l,component:c,disabled:d,disableElevation:h,disableFocusRipple:f,fullWidth:x,size:g,type:b,variant:v}),C=Qxe(k),S=y&&oe.jsx(Jxe,{className:C.startIcon,ownerState:k,children:y}),I=p&&oe.jsx(eye,{className:C.endIcon,ownerState:k,children:p}),$=r||"";return oe.jsxs(Zxe,L({ownerState:k,className:We(s.className,C.root,u,$),component:c,disabled:d,focusRipple:!f,focusVisibleClassName:We(C.focusVisible,m),ref:n,type:b},w,{classes:C,children:[S,a,I]}))}),qp=tye;function nye(t){const e=jn(t);return e.body===t?Il(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function Md(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function eN(t){return parseInt(Il(t).getComputedStyle(t).paddingRight,10)||0}function sye(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].indexOf(t.tagName)!==-1,s=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||s}function tN(t,e,n,s,r){const o=[e,n,...s];[].forEach.call(t.children,i=>{const a=o.indexOf(i)===-1,l=!sye(i);a&&l&&Md(i,r)})}function l1(t,e){let n=-1;return t.some((s,r)=>e(s)?(n=r,!0):!1),n}function rye(t,e){const n=[],s=t.container;if(!e.disableScrollLock){if(nye(s)){const i=_z(jn(s));n.push({value:s.style.paddingRight,property:"padding-right",el:s}),s.style.paddingRight=`${eN(s)+i}px`;const a=jn(s).querySelectorAll(".mui-fixed");[].forEach.call(a,l=>{n.push({value:l.style.paddingRight,property:"padding-right",el:l}),l.style.paddingRight=`${eN(l)+i}px`})}let o;if(s.parentNode instanceof DocumentFragment)o=jn(s).body;else{const i=s.parentElement,a=Il(s);o=(i==null?void 0:i.nodeName)==="HTML"&&a.getComputedStyle(i).overflowY==="scroll"?i:s}n.push({value:o.style.overflow,property:"overflow",el:o},{value:o.style.overflowX,property:"overflow-x",el:o},{value:o.style.overflowY,property:"overflow-y",el:o}),o.style.overflow="hidden"}return()=>{n.forEach(({value:o,el:i,property:a})=>{o?i.style.setProperty(a,o):i.style.removeProperty(a)})}}function oye(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class iye{constructor(){this.containers=void 0,this.modals=void 0,this.modals=[],this.containers=[]}add(e,n){let s=this.modals.indexOf(e);if(s!==-1)return s;s=this.modals.length,this.modals.push(e),e.modalRef&&Md(e.modalRef,!1);const r=oye(n);tN(n,e.mount,e.modalRef,r,!0);const o=l1(this.containers,i=>i.container===n);return o!==-1?(this.containers[o].modals.push(e),s):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:r}),s)}mount(e,n){const s=l1(this.containers,o=>o.modals.indexOf(e)!==-1),r=this.containers[s];r.restore||(r.restore=rye(r,n))}remove(e,n=!0){const s=this.modals.indexOf(e);if(s===-1)return s;const r=l1(this.containers,i=>i.modals.indexOf(e)!==-1),o=this.containers[r];if(o.modals.splice(o.modals.indexOf(e),1),this.modals.splice(s,1),o.modals.length===0)o.restore&&o.restore(),e.modalRef&&Md(e.modalRef,n),tN(o.container,e.mount,e.modalRef,o.hiddenSiblings,!1),this.containers.splice(r,1);else{const i=o.modals[o.modals.length-1];i.modalRef&&Md(i.modalRef,!1)}return s}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const aye=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function lye(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function cye(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=s=>t.ownerDocument.querySelector(`input[type="radio"]${s}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function uye(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||cye(t))}function dye(t){const e=[],n=[];return Array.from(t.querySelectorAll(aye)).forEach((s,r)=>{const o=lye(s);o===-1||!uye(s)||(o===0?e.push(s):n.push({documentOrder:r,tabIndex:o,node:s}))}),n.sort((s,r)=>s.tabIndex===r.tabIndex?s.documentOrder-r.documentOrder:s.tabIndex-r.tabIndex).map(s=>s.node).concat(e)}function hye(){return!0}function fye(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:s=!1,disableRestoreFocus:r=!1,getTabbable:o=dye,isEnabled:i=hye,open:a}=t,l=A.useRef(!1),c=A.useRef(null),u=A.useRef(null),d=A.useRef(null),h=A.useRef(null),f=A.useRef(!1),p=A.useRef(null),m=hs(ip(e),p),x=A.useRef(null);A.useEffect(()=>{!a||!p.current||(f.current=!n)},[n,a]),A.useEffect(()=>{if(!a||!p.current)return;const b=jn(p.current);return p.current.contains(b.activeElement)||(p.current.hasAttribute("tabIndex")||p.current.setAttribute("tabIndex","-1"),f.current&&p.current.focus()),()=>{r||(d.current&&d.current.focus&&(l.current=!0,d.current.focus()),d.current=null)}},[a]),A.useEffect(()=>{if(!a||!p.current)return;const b=jn(p.current),v=C=>{x.current=C,!(s||!i()||C.key!=="Tab")&&b.activeElement===p.current&&C.shiftKey&&(l.current=!0,u.current&&u.current.focus())},w=()=>{const C=p.current;if(C===null)return;if(!b.hasFocus()||!i()||l.current){l.current=!1;return}if(C.contains(b.activeElement)||s&&b.activeElement!==c.current&&b.activeElement!==u.current)return;if(b.activeElement!==h.current)h.current=null;else if(h.current!==null)return;if(!f.current)return;let S=[];if((b.activeElement===c.current||b.activeElement===u.current)&&(S=o(p.current)),S.length>0){var I,$;const E=!!((I=x.current)!=null&&I.shiftKey&&(($=x.current)==null?void 0:$.key)==="Tab"),_=S[0],D=S[S.length-1];typeof _!="string"&&typeof D!="string"&&(E?D.focus():_.focus())}else C.focus()};b.addEventListener("focusin",w),b.addEventListener("keydown",v,!0);const k=setInterval(()=>{b.activeElement&&b.activeElement.tagName==="BODY"&&w()},50);return()=>{clearInterval(k),b.removeEventListener("focusin",w),b.removeEventListener("keydown",v,!0)}},[n,s,r,i,a,o]);const g=b=>{d.current===null&&(d.current=b.relatedTarget),f.current=!0,h.current=b.target;const v=e.props.onFocus;v&&v(b)},y=b=>{d.current===null&&(d.current=b.relatedTarget),f.current=!0};return oe.jsxs(A.Fragment,{children:[oe.jsx("div",{tabIndex:a?0:-1,onFocus:y,ref:c,"data-testid":"sentinelStart"}),A.cloneElement(e,{ref:m,onFocus:g}),oe.jsx("div",{tabIndex:a?0:-1,onFocus:y,ref:u,"data-testid":"sentinelEnd"})]})}function pye(t){return typeof t=="function"?t():t}function mye(t){return t?t.props.hasOwnProperty("in"):!1}const gye=new iye;function xye(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:s=!1,manager:r=gye,closeAfterTransition:o=!1,onTransitionEnter:i,onTransitionExited:a,children:l,onClose:c,open:u,rootRef:d}=t,h=A.useRef({}),f=A.useRef(null),p=A.useRef(null),m=hs(p,d),[x,g]=A.useState(!u),y=mye(l);let b=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(b=!1);const v=()=>jn(f.current),w=()=>(h.current.modalRef=p.current,h.current.mount=f.current,h.current),k=()=>{r.mount(w(),{disableScrollLock:s}),p.current&&(p.current.scrollTop=0)},C=$o(()=>{const P=pye(e)||v().body;r.add(w(),P),p.current&&k()}),S=A.useCallback(()=>r.isTopModal(w()),[r]),I=$o(P=>{f.current=P,P&&(u&&S()?k():p.current&&Md(p.current,b))}),$=A.useCallback(()=>{r.remove(w(),b)},[b,r]);A.useEffect(()=>()=>{$()},[$]),A.useEffect(()=>{u?C():(!y||!o)&&$()},[u,$,y,o,C]);const E=P=>M=>{var N;(N=P.onKeyDown)==null||N.call(P,M),!(M.key!=="Escape"||M.which===229||!S())&&(n||(M.stopPropagation(),c&&c(M,"escapeKeyDown")))},_=P=>M=>{var N;(N=P.onClick)==null||N.call(P,M),M.target===M.currentTarget&&c&&c(M,"backdropClick")};return{getRootProps:(P={})=>{const M=Pd(t);delete M.onTransitionEnter,delete M.onTransitionExited;const N=L({},M,P);return L({role:"presentation"},N,{onKeyDown:E(N),ref:m})},getBackdropProps:(P={})=>{const M=P;return L({"aria-hidden":!0},M,{onClick:_(M),open:u})},getTransitionProps:()=>{const P=()=>{g(!1),i&&i()},M=()=>{g(!0),a&&a(),o&&$()};return{onEnter:RE(P,l==null?void 0:l.props.onEnter),onExited:RE(M,l==null?void 0:l.props.onExited)}},rootRef:m,portalRef:I,isTopModal:S,exited:x,hasTransition:y}}function yye(t){return qt("MuiModal",t)}Ut("MuiModal",["root","hidden","backdrop"]);const bye=["BackdropComponent","BackdropProps","classes","className","closeAfterTransition","children","container","component","components","componentsProps","disableAutoFocus","disableEnforceFocus","disableEscapeKeyDown","disablePortal","disableRestoreFocus","disableScrollLock","hideBackdrop","keepMounted","onBackdropClick","onClose","onTransitionEnter","onTransitionExited","open","slotProps","slots","theme"],vye=t=>{const{open:e,exited:n,classes:s}=t;return an({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},yye,s)},wye=Fe("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(({theme:t,ownerState:e})=>L({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0},!e.open&&e.exited&&{visibility:"hidden"})),kye=Fe(zxe,{name:"MuiModal",slot:"Backdrop",overridesResolver:(t,e)=>e.backdrop})({zIndex:-1}),Cye=A.forwardRef(function(e,n){var s,r,o,i,a,l;const c=ln({name:"MuiModal",props:e}),{BackdropComponent:u=kye,BackdropProps:d,className:h,closeAfterTransition:f=!1,children:p,container:m,component:x,components:g={},componentsProps:y={},disableAutoFocus:b=!1,disableEnforceFocus:v=!1,disableEscapeKeyDown:w=!1,disablePortal:k=!1,disableRestoreFocus:C=!1,disableScrollLock:S=!1,hideBackdrop:I=!1,keepMounted:$=!1,onBackdropClick:E,open:_,slotProps:D,slots:F}=c,R=ze(c,bye),P=L({},c,{closeAfterTransition:f,disableAutoFocus:b,disableEnforceFocus:v,disableEscapeKeyDown:w,disablePortal:k,disableRestoreFocus:C,disableScrollLock:S,hideBackdrop:I,keepMounted:$}),{getRootProps:M,getBackdropProps:N,getTransitionProps:B,portalRef:G,isTopModal:X,exited:Y,hasTransition:J}=xye(L({},P,{rootRef:n})),q=L({},P,{exited:Y}),ee=vye(q),ne={};if(p.props.tabIndex===void 0&&(ne.tabIndex="-1"),J){const{onEnter:xe,onExited:ye}=B();ne.onEnter=xe,ne.onExited=ye}const ce=(s=(r=F==null?void 0:F.root)!=null?r:g.Root)!=null?s:wye,ge=(o=(i=F==null?void 0:F.backdrop)!=null?i:g.Backdrop)!=null?o:u,de=(a=D==null?void 0:D.root)!=null?a:y.root,$e=(l=D==null?void 0:D.backdrop)!=null?l:y.backdrop,fe=Ns({elementType:ce,externalSlotProps:de,externalForwardedProps:R,getSlotProps:M,additionalProps:{ref:n,as:x},ownerState:q,className:We(h,de==null?void 0:de.className,ee==null?void 0:ee.root,!q.open&&q.exited&&(ee==null?void 0:ee.hidden))}),Ie=Ns({elementType:ge,externalSlotProps:$e,additionalProps:d,getSlotProps:xe=>N(L({},xe,{onClick:ye=>{E&&E(ye),xe!=null&&xe.onClick&&xe.onClick(ye)}})),className:We($e==null?void 0:$e.className,d==null?void 0:d.className,ee==null?void 0:ee.backdrop),ownerState:q});return!$&&!_&&(!J||Y)?null:oe.jsx(lxe,{ref:G,container:m,disablePortal:k,children:oe.jsxs(ce,L({},fe,{children:[!I&&u?oe.jsx(ge,L({},Ie)):null,oe.jsx(fye,{disableEnforceFocus:v,disableAutoFocus:b,disableRestoreFocus:C,isEnabled:X,open:_,children:A.cloneElement(p,ne)})]}))})}),Sye=Cye,$ye=["disableUnderline","components","componentsProps","fullWidth","hiddenLabel","inputComponent","multiline","slotProps","slots","type"],Iye=t=>{const{classes:e,disableUnderline:n}=t,r=an({root:["root",!n&&"underline"],input:["input"]},Txe,e);return L({},e,r)},Tye=Fe(Xy,{shouldForwardProp:t=>co(t)||t==="classes",name:"MuiFilledInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...jy(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{var n;const s=t.palette.mode==="light",r=s?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)",o=s?"rgba(0, 0, 0, 0.06)":"rgba(255, 255, 255, 0.09)",i=s?"rgba(0, 0, 0, 0.09)":"rgba(255, 255, 255, 0.13)",a=s?"rgba(0, 0, 0, 0.12)":"rgba(255, 255, 255, 0.12)";return L({position:"relative",backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o,borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),"&:hover":{backgroundColor:t.vars?t.vars.palette.FilledInput.hoverBg:i,"@media (hover: none)":{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o}},[`&.${Ta.focused}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.bg:o},[`&.${Ta.disabled}`]:{backgroundColor:t.vars?t.vars.palette.FilledInput.disabledBg:a}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(n=(t.vars||t).palette[e.color||"primary"])==null?void 0:n.main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Ta.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Ta.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`:r}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Ta.disabled}, .${Ta.error}):before`]:{borderBottom:`1px solid ${(t.vars||t).palette.text.primary}`},[`&.${Ta.disabled}:before`]:{borderBottomStyle:"dotted"}},e.startAdornment&&{paddingLeft:12},e.endAdornment&&{paddingRight:12},e.multiline&&L({padding:"25px 12px 8px"},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9}))}),Eye=Fe(qy,{name:"MuiFilledInput",slot:"Input",overridesResolver:Ky})(({theme:t,ownerState:e})=>L({paddingTop:25,paddingRight:12,paddingBottom:8,paddingLeft:12},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderTopLeftRadius:"inherit",borderTopRightRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{paddingTop:21,paddingBottom:4},e.hiddenLabel&&{paddingTop:16,paddingBottom:17},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0},e.hiddenLabel&&e.size==="small"&&{paddingTop:8,paddingBottom:9},e.multiline&&{paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0})),Xz=A.forwardRef(function(e,n){var s,r,o,i;const a=ln({props:e,name:"MuiFilledInput"}),{components:l={},componentsProps:c,fullWidth:u=!1,inputComponent:d="input",multiline:h=!1,slotProps:f,slots:p={},type:m="text"}=a,x=ze(a,$ye),g=L({},a,{fullWidth:u,inputComponent:d,multiline:h,type:m}),y=Iye(a),b={root:{ownerState:g},input:{ownerState:g}},v=f??c?tr(b,f??c):b,w=(s=(r=p.root)!=null?r:l.Root)!=null?s:Tye,k=(o=(i=p.input)!=null?i:l.Input)!=null?o:Eye;return oe.jsx(K$,L({slots:{root:w,input:k},componentsProps:v,fullWidth:u,inputComponent:d,multiline:h,ref:n,type:m},x,{classes:y}))});Xz.muiName="Input";const qz=Xz;function Nye(t){return qt("MuiFormControl",t)}Ut("MuiFormControl",["root","marginNone","marginNormal","marginDense","fullWidth","disabled"]);const _ye=["children","className","color","component","disabled","error","focused","fullWidth","hiddenLabel","margin","required","size","variant"],Rye=t=>{const{classes:e,margin:n,fullWidth:s}=t,r={root:["root",n!=="none"&&`margin${Ue(n)}`,s&&"fullWidth"]};return an(r,Nye,e)},Aye=Fe("div",{name:"MuiFormControl",slot:"Root",overridesResolver:({ownerState:t},e)=>L({},e.root,e[`margin${Ue(t.margin)}`],t.fullWidth&&e.fullWidth)})(({ownerState:t})=>L({display:"inline-flex",flexDirection:"column",position:"relative",minWidth:0,padding:0,margin:0,border:0,verticalAlign:"top"},t.margin==="normal"&&{marginTop:16,marginBottom:8},t.margin==="dense"&&{marginTop:8,marginBottom:4},t.fullWidth&&{width:"100%"})),Dye=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiFormControl"}),{children:r,className:o,color:i="primary",component:a="div",disabled:l=!1,error:c=!1,focused:u,fullWidth:d=!1,hiddenLabel:h=!1,margin:f="none",required:p=!1,size:m="medium",variant:x="outlined"}=s,g=ze(s,_ye),y=L({},s,{color:i,component:a,disabled:l,error:c,fullWidth:d,hiddenLabel:h,margin:f,required:p,size:m,variant:x}),b=Rye(y),[v,w]=A.useState(()=>{let D=!1;return r&&A.Children.forEach(r,F=>{if(!r1(F,["Input","Select"]))return;const R=r1(F,["Select"])?F.props.input:F;R&&gxe(R.props)&&(D=!0)}),D}),[k,C]=A.useState(()=>{let D=!1;return r&&A.Children.forEach(r,F=>{r1(F,["Input","Select"])&&(Qg(F.props,!0)||Qg(F.props.inputProps,!0))&&(D=!0)}),D}),[S,I]=A.useState(!1);l&&S&&I(!1);const $=u!==void 0&&!l?u:S;let E;const _=A.useMemo(()=>({adornedStart:v,setAdornedStart:w,color:i,disabled:l,error:c,filled:k,focused:$,fullWidth:d,hiddenLabel:h,size:m,onBlur:()=>{I(!1)},onEmpty:()=>{C(!1)},onFilled:()=>{C(!0)},onFocus:()=>{I(!0)},registerEffect:E,required:p,variant:x}),[v,i,l,c,k,$,d,h,E,p,m,x]);return oe.jsx(j$.Provider,{value:_,children:oe.jsx(Aye,L({as:a,ownerState:y,className:We(b.root,o),ref:n},g,{children:r}))})}),Fye=Dye;function Oye(t){return qt("MuiFormHelperText",t)}const Pye=Ut("MuiFormHelperText",["root","error","disabled","sizeSmall","sizeMedium","contained","focused","filled","required"]),nN=Pye;var sN;const Mye=["children","className","component","disabled","error","filled","focused","margin","required","variant"],Lye=t=>{const{classes:e,contained:n,size:s,disabled:r,error:o,filled:i,focused:a,required:l}=t,c={root:["root",r&&"disabled",o&&"error",s&&`size${Ue(s)}`,n&&"contained",a&&"focused",i&&"filled",l&&"required"]};return an(c,Oye,e)},zye=Fe("p",{name:"MuiFormHelperText",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.size&&e[`size${Ue(n.size)}`],n.contained&&e.contained,n.filled&&e.filled]}})(({theme:t,ownerState:e})=>L({color:(t.vars||t).palette.text.secondary},t.typography.caption,{textAlign:"left",marginTop:3,marginRight:0,marginBottom:0,marginLeft:0,[`&.${nN.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${nN.error}`]:{color:(t.vars||t).palette.error.main}},e.size==="small"&&{marginTop:4},e.contained&&{marginLeft:14,marginRight:14})),Bye=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiFormHelperText"}),{children:r,className:o,component:i="p"}=s,a=ze(s,Mye),l=Ou(),c=Fu({props:s,muiFormControl:l,states:["variant","size","disabled","error","filled","focused","required"]}),u=L({},s,{component:i,contained:c.variant==="filled"||c.variant==="outlined",variant:c.variant,size:c.size,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),d=Lye(u);return oe.jsx(zye,L({as:i,ownerState:u,className:We(d.root,o),ref:n},a,{children:r===" "?sN||(sN=oe.jsx("span",{className:"notranslate",children:""})):r}))}),Vye=Bye;function Wye(t){return qt("MuiFormLabel",t)}const Uye=Ut("MuiFormLabel",["root","colorSecondary","focused","disabled","error","filled","required","asterisk"]),Ld=Uye,Hye=["children","className","color","component","disabled","error","filled","focused","required"],Gye=t=>{const{classes:e,color:n,focused:s,disabled:r,error:o,filled:i,required:a}=t,l={root:["root",`color${Ue(n)}`,r&&"disabled",o&&"error",i&&"filled",s&&"focused",a&&"required"],asterisk:["asterisk",o&&"error"]};return an(l,Wye,e)},jye=Fe("label",{name:"MuiFormLabel",slot:"Root",overridesResolver:({ownerState:t},e)=>L({},e.root,t.color==="secondary"&&e.colorSecondary,t.filled&&e.filled)})(({theme:t,ownerState:e})=>L({color:(t.vars||t).palette.text.secondary},t.typography.body1,{lineHeight:"1.4375em",padding:0,position:"relative",[`&.${Ld.focused}`]:{color:(t.vars||t).palette[e.color].main},[`&.${Ld.disabled}`]:{color:(t.vars||t).palette.text.disabled},[`&.${Ld.error}`]:{color:(t.vars||t).palette.error.main}})),Kye=Fe("span",{name:"MuiFormLabel",slot:"Asterisk",overridesResolver:(t,e)=>e.asterisk})(({theme:t})=>({[`&.${Ld.error}`]:{color:(t.vars||t).palette.error.main}})),Xye=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiFormLabel"}),{children:r,className:o,component:i="label"}=s,a=ze(s,Hye),l=Ou(),c=Fu({props:s,muiFormControl:l,states:["color","required","focused","disabled","error","filled"]}),u=L({},s,{color:c.color||"primary",component:i,disabled:c.disabled,error:c.error,filled:c.filled,focused:c.focused,required:c.required}),d=Gye(u);return oe.jsxs(jye,L({as:i,ownerState:u,className:We(d.root,o),ref:n},a,{children:[r,c.required&&oe.jsxs(Kye,{ownerState:u,"aria-hidden":!0,className:d.asterisk,children:["","*"]})]}))}),qye=Xye,Yye=["addEndListener","appear","children","easing","in","onEnter","onEntered","onEntering","onExit","onExited","onExiting","style","timeout","TransitionComponent"];function gw(t){return`scale(${t}, ${t**2})`}const Qye={entering:{opacity:1,transform:gw(1)},entered:{opacity:1,transform:"none"}},c1=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),Yz=A.forwardRef(function(e,n){const{addEndListener:s,appear:r=!0,children:o,easing:i,in:a,onEnter:l,onEntered:c,onEntering:u,onExit:d,onExited:h,onExiting:f,style:p,timeout:m="auto",TransitionComponent:x=Gz}=e,g=ze(e,Yye),y=Ez(),b=A.useRef(),v=Vz(),w=A.useRef(null),k=hs(w,ip(o),n),C=R=>P=>{if(R){const M=w.current;P===void 0?R(M):R(M,P)}},S=C(u),I=C((R,P)=>{jz(R);const{duration:M,delay:N,easing:B}=Yg({style:p,timeout:m,easing:i},{mode:"enter"});let G;m==="auto"?(G=v.transitions.getAutoHeightDuration(R.clientHeight),b.current=G):G=M,R.style.transition=[v.transitions.create("opacity",{duration:G,delay:N}),v.transitions.create("transform",{duration:c1?G:G*.666,delay:N,easing:B})].join(","),l&&l(R,P)}),$=C(c),E=C(f),_=C(R=>{const{duration:P,delay:M,easing:N}=Yg({style:p,timeout:m,easing:i},{mode:"exit"});let B;m==="auto"?(B=v.transitions.getAutoHeightDuration(R.clientHeight),b.current=B):B=P,R.style.transition=[v.transitions.create("opacity",{duration:B,delay:M}),v.transitions.create("transform",{duration:c1?B:B*.666,delay:c1?M:M||B*.333,easing:N})].join(","),R.style.opacity=0,R.style.transform=gw(.75),d&&d(R)}),D=C(h),F=R=>{m==="auto"&&y.start(b.current||0,R),s&&s(w.current,R)};return oe.jsx(x,L({appear:r,in:a,nodeRef:w,onEnter:I,onEntered:$,onEntering:S,onExit:_,onExited:D,onExiting:E,addEndListener:F,timeout:m==="auto"?null:m},g,{children:(R,P)=>A.cloneElement(o,L({style:L({opacity:0,transform:gw(.75),visibility:R==="exited"&&!a?"hidden":void 0},Qye[R],p,o.props.style),ref:k},P))}))});Yz.muiSupportAuto=!0;const Zye=Yz,Jye=["disableUnderline","components","componentsProps","fullWidth","inputComponent","multiline","slotProps","slots","type"],ebe=t=>{const{classes:e,disableUnderline:n}=t,r=an({root:["root",!n&&"underline"],input:["input"]},Cxe,e);return L({},e,r)},tbe=Fe(Xy,{shouldForwardProp:t=>co(t)||t==="classes",name:"MuiInput",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[...jy(t,e),!n.disableUnderline&&e.underline]}})(({theme:t,ownerState:e})=>{let s=t.palette.mode==="light"?"rgba(0, 0, 0, 0.42)":"rgba(255, 255, 255, 0.7)";return t.vars&&(s=`rgba(${t.vars.palette.common.onBackgroundChannel} / ${t.vars.opacity.inputUnderline})`),L({position:"relative"},e.formControl&&{"label + &":{marginTop:16}},!e.disableUnderline&&{"&::after":{borderBottom:`2px solid ${(t.vars||t).palette[e.color].main}`,left:0,bottom:0,content:'""',position:"absolute",right:0,transform:"scaleX(0)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut}),pointerEvents:"none"},[`&.${Yu.focused}:after`]:{transform:"scaleX(1) translateX(0)"},[`&.${Yu.error}`]:{"&::before, &::after":{borderBottomColor:(t.vars||t).palette.error.main}},"&::before":{borderBottom:`1px solid ${s}`,left:0,bottom:0,content:'"\\00a0"',position:"absolute",right:0,transition:t.transitions.create("border-bottom-color",{duration:t.transitions.duration.shorter}),pointerEvents:"none"},[`&:hover:not(.${Yu.disabled}, .${Yu.error}):before`]:{borderBottom:`2px solid ${(t.vars||t).palette.text.primary}`,"@media (hover: none)":{borderBottom:`1px solid ${s}`}},[`&.${Yu.disabled}:before`]:{borderBottomStyle:"dotted"}})}),nbe=Fe(qy,{name:"MuiInput",slot:"Input",overridesResolver:Ky})({}),Qz=A.forwardRef(function(e,n){var s,r,o,i;const a=ln({props:e,name:"MuiInput"}),{disableUnderline:l,components:c={},componentsProps:u,fullWidth:d=!1,inputComponent:h="input",multiline:f=!1,slotProps:p,slots:m={},type:x="text"}=a,g=ze(a,Jye),y=ebe(a),v={root:{ownerState:{disableUnderline:l}}},w=p??u?tr(p??u,v):v,k=(s=(r=m.root)!=null?r:c.Root)!=null?s:tbe,C=(o=(i=m.input)!=null?i:c.Input)!=null?o:nbe;return oe.jsx(K$,L({slots:{root:k,input:C},slotProps:w,fullWidth:d,inputComponent:h,multiline:f,ref:n,type:x},g,{classes:y}))});Qz.muiName="Input";const Zz=Qz;function sbe(t){return qt("MuiInputLabel",t)}Ut("MuiInputLabel",["root","focused","disabled","error","required","asterisk","formControl","sizeSmall","shrink","animated","standard","filled","outlined"]);const rbe=["disableAnimation","margin","shrink","variant","className"],obe=t=>{const{classes:e,formControl:n,size:s,shrink:r,disableAnimation:o,variant:i,required:a}=t,l={root:["root",n&&"formControl",!o&&"animated",r&&"shrink",s&&s!=="normal"&&`size${Ue(s)}`,i],asterisk:[a&&"asterisk"]},c=an(l,sbe,e);return L({},e,c)},ibe=Fe(qye,{shouldForwardProp:t=>co(t)||t==="classes",name:"MuiInputLabel",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${Ld.asterisk}`]:e.asterisk},e.root,n.formControl&&e.formControl,n.size==="small"&&e.sizeSmall,n.shrink&&e.shrink,!n.disableAnimation&&e.animated,n.focused&&e.focused,e[n.variant]]}})(({theme:t,ownerState:e})=>L({display:"block",transformOrigin:"top left",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:"100%"},e.formControl&&{position:"absolute",left:0,top:0,transform:"translate(0, 20px) scale(1)"},e.size==="small"&&{transform:"translate(0, 17px) scale(1)"},e.shrink&&{transform:"translate(0, -1.5px) scale(0.75)",transformOrigin:"top left",maxWidth:"133%"},!e.disableAnimation&&{transition:t.transitions.create(["color","transform","max-width"],{duration:t.transitions.duration.shorter,easing:t.transitions.easing.easeOut})},e.variant==="filled"&&L({zIndex:1,pointerEvents:"none",transform:"translate(12px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(12px, 13px) scale(1)"},e.shrink&&L({userSelect:"none",pointerEvents:"auto",transform:"translate(12px, 7px) scale(0.75)",maxWidth:"calc(133% - 24px)"},e.size==="small"&&{transform:"translate(12px, 4px) scale(0.75)"})),e.variant==="outlined"&&L({zIndex:1,pointerEvents:"none",transform:"translate(14px, 16px) scale(1)",maxWidth:"calc(100% - 24px)"},e.size==="small"&&{transform:"translate(14px, 9px) scale(1)"},e.shrink&&{userSelect:"none",pointerEvents:"auto",maxWidth:"calc(133% - 32px)",transform:"translate(14px, -9px) scale(0.75)"}))),abe=A.forwardRef(function(e,n){const s=ln({name:"MuiInputLabel",props:e}),{disableAnimation:r=!1,shrink:o,className:i}=s,a=ze(s,rbe),l=Ou();let c=o;typeof c>"u"&&l&&(c=l.filled||l.focused||l.adornedStart);const u=Fu({props:s,muiFormControl:l,states:["size","variant","required","focused"]}),d=L({},s,{disableAnimation:r,formControl:l,shrink:c,size:u.size,variant:u.variant,required:u.required,focused:u.focused}),h=obe(d);return oe.jsx(ibe,L({"data-shrink":c,ownerState:d,ref:n,className:We(h.root,i)},a,{classes:h}))}),lbe=abe,cbe=A.createContext({}),ube=cbe;function dbe(t){return qt("MuiList",t)}Ut("MuiList",["root","padding","dense","subheader"]);const hbe=["children","className","component","dense","disablePadding","subheader"],fbe=t=>{const{classes:e,disablePadding:n,dense:s,subheader:r}=t;return an({root:["root",!n&&"padding",s&&"dense",r&&"subheader"]},dbe,e)},pbe=Fe("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})(({ownerState:t})=>L({listStyle:"none",margin:0,padding:0,position:"relative"},!t.disablePadding&&{paddingTop:8,paddingBottom:8},t.subheader&&{paddingTop:0})),mbe=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiList"}),{children:r,className:o,component:i="ul",dense:a=!1,disablePadding:l=!1,subheader:c}=s,u=ze(s,hbe),d=A.useMemo(()=>({dense:a}),[a]),h=L({},s,{component:i,dense:a,disablePadding:l}),f=fbe(h);return oe.jsx(ube.Provider,{value:d,children:oe.jsxs(pbe,L({as:i,className:We(f.root,o),ref:n,ownerState:h},u,{children:[c,r]}))})}),gbe=mbe,xbe=["actions","autoFocus","autoFocusItem","children","className","disabledItemsFocusable","disableListWrap","onKeyDown","variant"];function u1(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function rN(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function Jz(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.indexOf(e.keys.join(""))===0}function Qu(t,e,n,s,r,o){let i=!1,a=r(t,e,e?n:!1);for(;a;){if(a===t.firstChild){if(i)return!1;i=!0}const l=s?!1:a.disabled||a.getAttribute("aria-disabled")==="true";if(!a.hasAttribute("tabindex")||!Jz(a,o)||l)a=r(t,a,n);else return a.focus(),!0}return!1}const ybe=A.forwardRef(function(e,n){const{actions:s,autoFocus:r=!1,autoFocusItem:o=!1,children:i,className:a,disabledItemsFocusable:l=!1,disableListWrap:c=!1,onKeyDown:u,variant:d="selectedMenu"}=e,h=ze(e,xbe),f=A.useRef(null),p=A.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});ca(()=>{r&&f.current.focus()},[r]),A.useImperativeHandle(s,()=>({adjustStyleForScrollbar:(b,{direction:v})=>{const w=!f.current.style.width;if(b.clientHeight<f.current.clientHeight&&w){const k=`${_z(jn(b))}px`;f.current.style[v==="rtl"?"paddingLeft":"paddingRight"]=k,f.current.style.width=`calc(100% + ${k})`}return f.current}}),[]);const m=b=>{const v=f.current,w=b.key,k=jn(v).activeElement;if(w==="ArrowDown")b.preventDefault(),Qu(v,k,c,l,u1);else if(w==="ArrowUp")b.preventDefault(),Qu(v,k,c,l,rN);else if(w==="Home")b.preventDefault(),Qu(v,null,c,l,u1);else if(w==="End")b.preventDefault(),Qu(v,null,c,l,rN);else if(w.length===1){const C=p.current,S=w.toLowerCase(),I=performance.now();C.keys.length>0&&(I-C.lastTime>500?(C.keys=[],C.repeating=!0,C.previousKeyMatched=!0):C.repeating&&S!==C.keys[0]&&(C.repeating=!1)),C.lastTime=I,C.keys.push(S);const $=k&&!C.repeating&&Jz(k,C);C.previousKeyMatched&&($||Qu(v,k,!1,l,u1,C))?b.preventDefault():C.previousKeyMatched=!1}u&&u(b)},x=hs(f,n);let g=-1;A.Children.forEach(i,(b,v)=>{if(!A.isValidElement(b)){g===v&&(g+=1,g>=i.length&&(g=-1));return}b.props.disabled||(d==="selectedMenu"&&b.props.selected||g===-1)&&(g=v),g===v&&(b.props.disabled||b.props.muiSkipListHighlight||b.type.muiSkipListHighlight)&&(g+=1,g>=i.length&&(g=-1))});const y=A.Children.map(i,(b,v)=>{if(v===g){const w={};return o&&(w.autoFocus=!0),b.props.tabIndex===void 0&&d==="selectedMenu"&&(w.tabIndex=0),A.cloneElement(b,w)}return b});return oe.jsx(gbe,L({role:"menu",ref:x,className:a,onKeyDown:m,tabIndex:r?0:-1},h,{children:y}))}),bbe=ybe;function vbe(t){return qt("MuiPopover",t)}Ut("MuiPopover",["root","paper"]);const wbe=["onEntering"],kbe=["action","anchorEl","anchorOrigin","anchorPosition","anchorReference","children","className","container","elevation","marginThreshold","open","PaperProps","slots","slotProps","transformOrigin","TransitionComponent","transitionDuration","TransitionProps","disableScrollLock"],Cbe=["slotProps"];function oN(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function iN(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function aN(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function d1(t){return typeof t=="function"?t():t}const Sbe=t=>{const{classes:e}=t;return an({root:["root"],paper:["paper"]},vbe,e)},$be=Fe(Sye,{name:"MuiPopover",slot:"Root",overridesResolver:(t,e)=>e.root})({}),eB=Fe(Ma,{name:"MuiPopover",slot:"Paper",overridesResolver:(t,e)=>e.paper})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),Ibe=A.forwardRef(function(e,n){var s,r,o;const i=ln({props:e,name:"MuiPopover"}),{action:a,anchorEl:l,anchorOrigin:c={vertical:"top",horizontal:"left"},anchorPosition:u,anchorReference:d="anchorEl",children:h,className:f,container:p,elevation:m=8,marginThreshold:x=16,open:g,PaperProps:y={},slots:b,slotProps:v,transformOrigin:w={vertical:"top",horizontal:"left"},TransitionComponent:k=Zye,transitionDuration:C="auto",TransitionProps:{onEntering:S}={},disableScrollLock:I=!1}=i,$=ze(i.TransitionProps,wbe),E=ze(i,kbe),_=(s=v==null?void 0:v.paper)!=null?s:y,D=A.useRef(),F=hs(D,_.ref),R=L({},i,{anchorOrigin:c,anchorReference:d,elevation:m,marginThreshold:x,externalPaperSlotProps:_,transformOrigin:w,TransitionComponent:k,transitionDuration:C,TransitionProps:$}),P=Sbe(R),M=A.useCallback(()=>{if(d==="anchorPosition")return u;const xe=d1(l),pe=(xe&&xe.nodeType===1?xe:jn(D.current).body).getBoundingClientRect();return{top:pe.top+oN(pe,c.vertical),left:pe.left+iN(pe,c.horizontal)}},[l,c.horizontal,c.vertical,u,d]),N=A.useCallback(xe=>({vertical:oN(xe,w.vertical),horizontal:iN(xe,w.horizontal)}),[w.horizontal,w.vertical]),B=A.useCallback(xe=>{const ye={width:xe.offsetWidth,height:xe.offsetHeight},pe=N(ye);if(d==="none")return{top:null,left:null,transformOrigin:aN(pe)};const Re=M();let Pe=Re.top-pe.vertical,Ae=Re.left-pe.horizontal;const At=Pe+ye.height,Oe=Ae+ye.width,Xe=Il(d1(l)),wt=Xe.innerHeight-x,It=Xe.innerWidth-x;if(x!==null&&Pe<x){const He=Pe-x;Pe-=He,pe.vertical+=He}else if(x!==null&&At>wt){const He=At-wt;Pe-=He,pe.vertical+=He}if(x!==null&&Ae<x){const He=Ae-x;Ae-=He,pe.horizontal+=He}else if(Oe>It){const He=Oe-It;Ae-=He,pe.horizontal+=He}return{top:`${Math.round(Pe)}px`,left:`${Math.round(Ae)}px`,transformOrigin:aN(pe)}},[l,d,M,N,x]),[G,X]=A.useState(g),Y=A.useCallback(()=>{const xe=D.current;if(!xe)return;const ye=B(xe);ye.top!==null&&(xe.style.top=ye.top),ye.left!==null&&(xe.style.left=ye.left),xe.style.transformOrigin=ye.transformOrigin,X(!0)},[B]);A.useEffect(()=>(I&&window.addEventListener("scroll",Y),()=>window.removeEventListener("scroll",Y)),[l,I,Y]);const J=(xe,ye)=>{S&&S(xe,ye),Y()},q=()=>{X(!1)};A.useEffect(()=>{g&&Y()}),A.useImperativeHandle(a,()=>g?{updatePosition:()=>{Y()}}:null,[g,Y]),A.useEffect(()=>{if(!g)return;const xe=Iz(()=>{Y()}),ye=Il(l);return ye.addEventListener("resize",xe),()=>{xe.clear(),ye.removeEventListener("resize",xe)}},[l,g,Y]);let ee=C;C==="auto"&&!k.muiSupportAuto&&(ee=void 0);const ne=p||(l?jn(d1(l)).body:void 0),ce=(r=b==null?void 0:b.root)!=null?r:$be,ge=(o=b==null?void 0:b.paper)!=null?o:eB,de=Ns({elementType:ge,externalSlotProps:L({},_,{style:G?_.style:L({},_.style,{opacity:0})}),additionalProps:{elevation:m,ref:F},ownerState:R,className:We(P.paper,_==null?void 0:_.className)}),$e=Ns({elementType:ce,externalSlotProps:(v==null?void 0:v.root)||{},externalForwardedProps:E,additionalProps:{ref:n,slotProps:{backdrop:{invisible:!0}},container:ne,open:g},ownerState:R,className:We(P.root,f)}),{slotProps:fe}=$e,Ie=ze($e,Cbe);return oe.jsx(ce,L({},Ie,!Ji(ce)&&{slotProps:fe,disableScrollLock:I},{children:oe.jsx(k,L({appear:!0,in:g,onEntering:J,onExited:q,timeout:ee},$,{children:oe.jsx(ge,L({},de,{children:h}))}))}))}),Tbe=Ibe;function Ebe(t){return qt("MuiMenu",t)}Ut("MuiMenu",["root","paper","list"]);const Nbe=["onEntering"],_be=["autoFocus","children","className","disableAutoFocusItem","MenuListProps","onClose","open","PaperProps","PopoverClasses","transitionDuration","TransitionProps","variant","slots","slotProps"],Rbe={vertical:"top",horizontal:"right"},Abe={vertical:"top",horizontal:"left"},Dbe=t=>{const{classes:e}=t;return an({root:["root"],paper:["paper"],list:["list"]},Ebe,e)},Fbe=Fe(Tbe,{shouldForwardProp:t=>co(t)||t==="classes",name:"MuiMenu",slot:"Root",overridesResolver:(t,e)=>e.root})({}),Obe=Fe(eB,{name:"MuiMenu",slot:"Paper",overridesResolver:(t,e)=>e.paper})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),Pbe=Fe(bbe,{name:"MuiMenu",slot:"List",overridesResolver:(t,e)=>e.list})({outline:0}),Mbe=A.forwardRef(function(e,n){var s,r;const o=ln({props:e,name:"MuiMenu"}),{autoFocus:i=!0,children:a,className:l,disableAutoFocusItem:c=!1,MenuListProps:u={},onClose:d,open:h,PaperProps:f={},PopoverClasses:p,transitionDuration:m="auto",TransitionProps:{onEntering:x}={},variant:g="selectedMenu",slots:y={},slotProps:b={}}=o,v=ze(o.TransitionProps,Nbe),w=ze(o,_be),k=Rz(),C=L({},o,{autoFocus:i,disableAutoFocusItem:c,MenuListProps:u,onEntering:x,PaperProps:f,transitionDuration:m,TransitionProps:v,variant:g}),S=Dbe(C),I=i&&!c&&h,$=A.useRef(null),E=(N,B)=>{$.current&&$.current.adjustStyleForScrollbar(N,{direction:k?"rtl":"ltr"}),x&&x(N,B)},_=N=>{N.key==="Tab"&&(N.preventDefault(),d&&d(N,"tabKeyDown"))};let D=-1;A.Children.map(a,(N,B)=>{A.isValidElement(N)&&(N.props.disabled||(g==="selectedMenu"&&N.props.selected||D===-1)&&(D=B))});const F=(s=y.paper)!=null?s:Obe,R=(r=b.paper)!=null?r:f,P=Ns({elementType:y.root,externalSlotProps:b.root,ownerState:C,className:[S.root,l]}),M=Ns({elementType:F,externalSlotProps:R,ownerState:C,className:S.paper});return oe.jsx(Fbe,L({onClose:d,anchorOrigin:{vertical:"bottom",horizontal:k?"right":"left"},transformOrigin:k?Rbe:Abe,slots:{paper:F,root:y.root},slotProps:{root:P,paper:M},open:h,ref:n,transitionDuration:m,TransitionProps:L({onEntering:E},v),ownerState:C},w,{classes:p,children:oe.jsx(Pbe,L({onKeyDown:_,actions:$,autoFocus:i&&(D===-1||c),autoFocusItem:I,variant:g},u,{className:We(S.list,u.className),children:a}))}))}),Lbe=Mbe;function zbe(t){return qt("MuiNativeSelect",t)}const Bbe=Ut("MuiNativeSelect",["root","select","multiple","filled","outlined","standard","disabled","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),X$=Bbe,Vbe=["className","disabled","error","IconComponent","inputRef","variant"],Wbe=t=>{const{classes:e,variant:n,disabled:s,multiple:r,open:o,error:i}=t,a={select:["select",n,s&&"disabled",r&&"multiple",i&&"error"],icon:["icon",`icon${Ue(n)}`,o&&"iconOpen",s&&"disabled"]};return an(a,zbe,e)},tB=({ownerState:t,theme:e})=>L({MozAppearance:"none",WebkitAppearance:"none",userSelect:"none",borderRadius:0,cursor:"pointer","&:focus":L({},e.vars?{backgroundColor:`rgba(${e.vars.palette.common.onBackgroundChannel} / 0.05)`}:{backgroundColor:e.palette.mode==="light"?"rgba(0, 0, 0, 0.05)":"rgba(255, 255, 255, 0.05)"},{borderRadius:0}),"&::-ms-expand":{display:"none"},[`&.${X$.disabled}`]:{cursor:"default"},"&[multiple]":{height:"auto"},"&:not([multiple]) option, &:not([multiple]) optgroup":{backgroundColor:(e.vars||e).palette.background.paper},"&&&":{paddingRight:24,minWidth:16}},t.variant==="filled"&&{"&&&":{paddingRight:32}},t.variant==="outlined"&&{borderRadius:(e.vars||e).shape.borderRadius,"&:focus":{borderRadius:(e.vars||e).shape.borderRadius},"&&&":{paddingRight:32}}),Ube=Fe("select",{name:"MuiNativeSelect",slot:"Select",shouldForwardProp:co,overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.select,e[n.variant],n.error&&e.error,{[`&.${X$.multiple}`]:e.multiple}]}})(tB),nB=({ownerState:t,theme:e})=>L({position:"absolute",right:0,top:"calc(50% - .5em)",pointerEvents:"none",color:(e.vars||e).palette.action.active,[`&.${X$.disabled}`]:{color:(e.vars||e).palette.action.disabled}},t.open&&{transform:"rotate(180deg)"},t.variant==="filled"&&{right:7},t.variant==="outlined"&&{right:7}),Hbe=Fe("svg",{name:"MuiNativeSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Ue(n.variant)}`],n.open&&e.iconOpen]}})(nB),Gbe=A.forwardRef(function(e,n){const{className:s,disabled:r,error:o,IconComponent:i,inputRef:a,variant:l="standard"}=e,c=ze(e,Vbe),u=L({},e,{disabled:r,variant:l,error:o}),d=Wbe(u);return oe.jsxs(A.Fragment,{children:[oe.jsx(Ube,L({ownerState:u,className:We(d.select,s),disabled:r,ref:a||n},c)),e.multiple?null:oe.jsx(Hbe,{as:i,ownerState:u,className:d.icon})]})}),jbe=Gbe;var lN;const Kbe=["children","classes","className","label","notched"],Xbe=Fe("fieldset",{shouldForwardProp:co})({textAlign:"left",position:"absolute",bottom:0,right:0,top:-5,left:0,margin:0,padding:"0 8px",pointerEvents:"none",borderRadius:"inherit",borderStyle:"solid",borderWidth:1,overflow:"hidden",minWidth:"0%"}),qbe=Fe("legend",{shouldForwardProp:co})(({ownerState:t,theme:e})=>L({float:"unset",width:"auto",overflow:"hidden"},!t.withLabel&&{padding:0,lineHeight:"11px",transition:e.transitions.create("width",{duration:150,easing:e.transitions.easing.easeOut})},t.withLabel&&L({display:"block",padding:0,height:11,fontSize:"0.75em",visibility:"hidden",maxWidth:.01,transition:e.transitions.create("max-width",{duration:50,easing:e.transitions.easing.easeOut}),whiteSpace:"nowrap","& > span":{paddingLeft:5,paddingRight:5,display:"inline-block",opacity:0,visibility:"visible"}},t.notched&&{maxWidth:"100%",transition:e.transitions.create("max-width",{duration:100,easing:e.transitions.easing.easeOut,delay:50})})));function Ybe(t){const{className:e,label:n,notched:s}=t,r=ze(t,Kbe),o=n!=null&&n!=="",i=L({},t,{notched:s,withLabel:o});return oe.jsx(Xbe,L({"aria-hidden":!0,className:e,ownerState:i},r,{children:oe.jsx(qbe,{ownerState:i,children:o?oe.jsx("span",{children:n}):lN||(lN=oe.jsx("span",{className:"notranslate",children:""}))})}))}const Qbe=["components","fullWidth","inputComponent","label","multiline","notched","slots","type"],Zbe=t=>{const{classes:e}=t,s=an({root:["root"],notchedOutline:["notchedOutline"],input:["input"]},$xe,e);return L({},e,s)},Jbe=Fe(Xy,{shouldForwardProp:t=>co(t)||t==="classes",name:"MuiOutlinedInput",slot:"Root",overridesResolver:jy})(({theme:t,ownerState:e})=>{const n=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return L({position:"relative",borderRadius:(t.vars||t).shape.borderRadius,[`&:hover .${Ci.notchedOutline}`]:{borderColor:(t.vars||t).palette.text.primary},"@media (hover: none)":{[`&:hover .${Ci.notchedOutline}`]:{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:n}},[`&.${Ci.focused} .${Ci.notchedOutline}`]:{borderColor:(t.vars||t).palette[e.color].main,borderWidth:2},[`&.${Ci.error} .${Ci.notchedOutline}`]:{borderColor:(t.vars||t).palette.error.main},[`&.${Ci.disabled} .${Ci.notchedOutline}`]:{borderColor:(t.vars||t).palette.action.disabled}},e.startAdornment&&{paddingLeft:14},e.endAdornment&&{paddingRight:14},e.multiline&&L({padding:"16.5px 14px"},e.size==="small"&&{padding:"8.5px 14px"}))}),e1e=Fe(Ybe,{name:"MuiOutlinedInput",slot:"NotchedOutline",overridesResolver:(t,e)=>e.notchedOutline})(({theme:t})=>{const e=t.palette.mode==="light"?"rgba(0, 0, 0, 0.23)":"rgba(255, 255, 255, 0.23)";return{borderColor:t.vars?`rgba(${t.vars.palette.common.onBackgroundChannel} / 0.23)`:e}}),t1e=Fe(qy,{name:"MuiOutlinedInput",slot:"Input",overridesResolver:Ky})(({theme:t,ownerState:e})=>L({padding:"16.5px 14px"},!t.vars&&{"&:-webkit-autofill":{WebkitBoxShadow:t.palette.mode==="light"?null:"0 0 0 100px #266798 inset",WebkitTextFillColor:t.palette.mode==="light"?null:"#fff",caretColor:t.palette.mode==="light"?null:"#fff",borderRadius:"inherit"}},t.vars&&{"&:-webkit-autofill":{borderRadius:"inherit"},[t.getColorSchemeSelector("dark")]:{"&:-webkit-autofill":{WebkitBoxShadow:"0 0 0 100px #266798 inset",WebkitTextFillColor:"#fff",caretColor:"#fff"}}},e.size==="small"&&{padding:"8.5px 14px"},e.multiline&&{padding:0},e.startAdornment&&{paddingLeft:0},e.endAdornment&&{paddingRight:0})),sB=A.forwardRef(function(e,n){var s,r,o,i,a;const l=ln({props:e,name:"MuiOutlinedInput"}),{components:c={},fullWidth:u=!1,inputComponent:d="input",label:h,multiline:f=!1,notched:p,slots:m={},type:x="text"}=l,g=ze(l,Qbe),y=Zbe(l),b=Ou(),v=Fu({props:l,muiFormControl:b,states:["color","disabled","error","focused","hiddenLabel","size","required"]}),w=L({},l,{color:v.color||"primary",disabled:v.disabled,error:v.error,focused:v.focused,formControl:b,fullWidth:u,hiddenLabel:v.hiddenLabel,multiline:f,size:v.size,type:x}),k=(s=(r=m.root)!=null?r:c.Root)!=null?s:Jbe,C=(o=(i=m.input)!=null?i:c.Input)!=null?o:t1e;return oe.jsx(K$,L({slots:{root:k,input:C},renderSuffix:S=>oe.jsx(e1e,{ownerState:w,className:y.notchedOutline,label:h!=null&&h!==""&&v.required?a||(a=oe.jsxs(A.Fragment,{children:[h,"","*"]})):h,notched:typeof p<"u"?p:!!(S.startAdornment||S.filled||S.focused)}),fullWidth:u,inputComponent:d,multiline:f,ref:n,type:x},g,{classes:L({},y,{notchedOutline:null})}))});sB.muiName="Input";const rB=sB;function n1e(t){return qt("MuiSelect",t)}const s1e=Ut("MuiSelect",["root","select","multiple","filled","outlined","standard","disabled","focused","icon","iconOpen","iconFilled","iconOutlined","iconStandard","nativeInput","error"]),Zu=s1e;var cN;const r1e=["aria-describedby","aria-label","autoFocus","autoWidth","children","className","defaultOpen","defaultValue","disabled","displayEmpty","error","IconComponent","inputRef","labelId","MenuProps","multiple","name","onBlur","onChange","onClose","onFocus","onOpen","open","readOnly","renderValue","SelectDisplayProps","tabIndex","type","value","variant"],o1e=Fe("div",{name:"MuiSelect",slot:"Select",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`&.${Zu.select}`]:e.select},{[`&.${Zu.select}`]:e[n.variant]},{[`&.${Zu.error}`]:e.error},{[`&.${Zu.multiple}`]:e.multiple}]}})(tB,{[`&.${Zu.select}`]:{height:"auto",minHeight:"1.4375em",textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden"}}),i1e=Fe("svg",{name:"MuiSelect",slot:"Icon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.icon,n.variant&&e[`icon${Ue(n.variant)}`],n.open&&e.iconOpen]}})(nB),a1e=Fe("input",{shouldForwardProp:t=>Hy(t)&&t!=="classes",name:"MuiSelect",slot:"NativeInput",overridesResolver:(t,e)=>e.nativeInput})({bottom:0,left:0,position:"absolute",opacity:0,pointerEvents:"none",width:"100%",boxSizing:"border-box"});function uN(t,e){return typeof e=="object"&&e!==null?t===e:String(t)===String(e)}function l1e(t){return t==null||typeof t=="string"&&!t.trim()}const c1e=t=>{const{classes:e,variant:n,disabled:s,multiple:r,open:o,error:i}=t,a={select:["select",n,s&&"disabled",r&&"multiple",i&&"error"],icon:["icon",`icon${Ue(n)}`,o&&"iconOpen",s&&"disabled"],nativeInput:["nativeInput"]};return an(a,n1e,e)},u1e=A.forwardRef(function(e,n){var s;const{"aria-describedby":r,"aria-label":o,autoFocus:i,autoWidth:a,children:l,className:c,defaultOpen:u,defaultValue:d,disabled:h,displayEmpty:f,error:p=!1,IconComponent:m,inputRef:x,labelId:g,MenuProps:y={},multiple:b,name:v,onBlur:w,onChange:k,onClose:C,onFocus:S,onOpen:I,open:$,readOnly:E,renderValue:_,SelectDisplayProps:D={},tabIndex:F,value:R,variant:P="standard"}=e,M=ze(e,r1e),[N,B]=lw({controlled:R,default:d,name:"Select"}),[G,X]=lw({controlled:$,default:u,name:"Select"}),Y=A.useRef(null),J=A.useRef(null),[q,ee]=A.useState(null),{current:ne}=A.useRef($!=null),[ce,ge]=A.useState(),de=hs(n,x),$e=A.useCallback(le=>{J.current=le,le&&ee(le)},[]),fe=q==null?void 0:q.parentNode;A.useImperativeHandle(de,()=>({focus:()=>{J.current.focus()},node:Y.current,value:N}),[N]),A.useEffect(()=>{u&&G&&q&&!ne&&(ge(a?null:fe.clientWidth),J.current.focus())},[q,a]),A.useEffect(()=>{i&&J.current.focus()},[i]),A.useEffect(()=>{if(!g)return;const le=jn(J.current).getElementById(g);if(le){const Ye=()=>{getSelection().isCollapsed&&J.current.focus()};return le.addEventListener("click",Ye),()=>{le.removeEventListener("click",Ye)}}},[g]);const Ie=(le,Ye)=>{le?I&&I(Ye):C&&C(Ye),ne||(ge(a?null:fe.clientWidth),X(le))},xe=le=>{le.button===0&&(le.preventDefault(),J.current.focus(),Ie(!0,le))},ye=le=>{Ie(!1,le)},pe=A.Children.toArray(l),Re=le=>{const Ye=pe.find(ht=>ht.props.value===le.target.value);Ye!==void 0&&(B(Ye.props.value),k&&k(le,Ye))},Pe=le=>Ye=>{let ht;if(Ye.currentTarget.hasAttribute("tabindex")){if(b){ht=Array.isArray(N)?N.slice():[];const Je=N.indexOf(le.props.value);Je===-1?ht.push(le.props.value):ht.splice(Je,1)}else ht=le.props.value;if(le.props.onClick&&le.props.onClick(Ye),N!==ht&&(B(ht),k)){const Je=Ye.nativeEvent||Ye,ms=new Je.constructor(Je.type,Je);Object.defineProperty(ms,"target",{writable:!0,value:{value:ht,name:v}}),k(ms,le)}b||Ie(!1,Ye)}},Ae=le=>{E||[" ","ArrowUp","ArrowDown","Enter"].indexOf(le.key)!==-1&&(le.preventDefault(),Ie(!0,le))},At=q!==null&&G,Oe=le=>{!At&&w&&(Object.defineProperty(le,"target",{writable:!0,value:{value:N,name:v}}),w(le))};delete M["aria-invalid"];let Xe,wt;const It=[];let He=!1;(Qg({value:N})||f)&&(_?Xe=_(N):He=!0);const Ht=pe.map(le=>{if(!A.isValidElement(le))return null;let Ye;if(b){if(!Array.isArray(N))throw new Error($l(2));Ye=N.some(ht=>uN(ht,le.props.value)),Ye&&He&&It.push(le.props.children)}else Ye=uN(N,le.props.value),Ye&&He&&(wt=le.props.children);return A.cloneElement(le,{"aria-selected":Ye?"true":"false",onClick:Pe(le),onKeyUp:ht=>{ht.key===" "&&ht.preventDefault(),le.props.onKeyUp&&le.props.onKeyUp(ht)},role:"option",selected:Ye,value:void 0,"data-value":le.props.value})});He&&(b?It.length===0?Xe=null:Xe=It.reduce((le,Ye,ht)=>(le.push(Ye),ht<It.length-1&&le.push(", "),le),[]):Xe=wt);let cn=ce;!a&&ne&&q&&(cn=fe.clientWidth);let Mt;typeof F<"u"?Mt=F:Mt=h?null:0;const se=D.id||(v?`mui-component-select-${v}`:void 0),te=L({},e,{variant:P,value:N,open:At,error:p}),we=c1e(te),Ve=L({},y.PaperProps,(s=y.slotProps)==null?void 0:s.paper),qe=Tz();return oe.jsxs(A.Fragment,{children:[oe.jsx(o1e,L({ref:$e,tabIndex:Mt,role:"combobox","aria-controls":qe,"aria-disabled":h?"true":void 0,"aria-expanded":At?"true":"false","aria-haspopup":"listbox","aria-label":o,"aria-labelledby":[g,se].filter(Boolean).join(" ")||void 0,"aria-describedby":r,onKeyDown:Ae,onMouseDown:h||E?null:xe,onBlur:Oe,onFocus:S},D,{ownerState:te,className:We(D.className,we.select,c),id:se,children:l1e(Xe)?cN||(cN=oe.jsx("span",{className:"notranslate",children:""})):Xe})),oe.jsx(a1e,L({"aria-invalid":p,value:Array.isArray(N)?N.join(","):N,name:v,ref:Y,"aria-hidden":!0,onChange:Re,tabIndex:-1,disabled:h,className:we.nativeInput,autoFocus:i,ownerState:te},M)),oe.jsx(i1e,{as:m,className:we.icon,ownerState:te}),oe.jsx(Lbe,L({id:`menu-${v||""}`,anchorEl:fe,open:At,onClose:ye,anchorOrigin:{vertical:"bottom",horizontal:"center"},transformOrigin:{vertical:"top",horizontal:"center"}},y,{MenuListProps:L({"aria-labelledby":g,role:"listbox","aria-multiselectable":b?"true":void 0,disableListWrap:!0,id:qe},y.MenuListProps),slotProps:L({},y.slotProps,{paper:L({},Ve,{style:L({minWidth:cn},Ve!=null?Ve.style:null)})}),children:Ht}))]})}),d1e=u1e,h1e=["autoWidth","children","classes","className","defaultOpen","displayEmpty","IconComponent","id","input","inputProps","label","labelId","MenuProps","multiple","native","onClose","onOpen","open","renderValue","SelectDisplayProps","variant"],f1e=["root"],p1e=t=>{const{classes:e}=t;return e},q$={name:"MuiSelect",overridesResolver:(t,e)=>e.root,shouldForwardProp:t=>co(t)&&t!=="variant",slot:"Root"},m1e=Fe(Zz,q$)(""),g1e=Fe(rB,q$)(""),x1e=Fe(qz,q$)(""),oB=A.forwardRef(function(e,n){const s=ln({name:"MuiSelect",props:e}),{autoWidth:r=!1,children:o,classes:i={},className:a,defaultOpen:l=!1,displayEmpty:c=!1,IconComponent:u=Nxe,id:d,input:h,inputProps:f,label:p,labelId:m,MenuProps:x,multiple:g=!1,native:y=!1,onClose:b,onOpen:v,open:w,renderValue:k,SelectDisplayProps:C,variant:S="outlined"}=s,I=ze(s,h1e),$=y?jbe:d1e,E=Ou(),_=Fu({props:s,muiFormControl:E,states:["variant","error"]}),D=_.variant||S,F=L({},s,{variant:D,classes:i}),R=p1e(F),P=ze(R,f1e),M=h||{standard:oe.jsx(m1e,{ownerState:F}),outlined:oe.jsx(g1e,{label:p,ownerState:F}),filled:oe.jsx(x1e,{ownerState:F})}[D],N=hs(n,ip(M));return oe.jsx(A.Fragment,{children:A.cloneElement(M,L({inputComponent:$,inputProps:L({children:o,error:_.error,IconComponent:u,variant:D,type:void 0,multiple:g},y?{id:d}:{autoWidth:r,defaultOpen:l,displayEmpty:c,labelId:m,MenuProps:x,onClose:b,onOpen:v,open:w,renderValue:k,SelectDisplayProps:L({id:d},C)},f,{classes:f?tr(P,f.classes):P},h?h.props.inputProps:{})},(g&&y||c)&&D==="outlined"?{notched:!0}:{},{ref:N,className:We(M.props.className,a,R.root)},!h&&{variant:D},I))})});oB.muiName="Select";const y1e=oB;function b1e(t,e,n=(s,r)=>s===r){return t.length===e.length&&t.every((s,r)=>n(s,e[r]))}const v1e=2;function iB(t,e){return t-e}function dN(t,e){var n;const{index:s}=(n=t.reduce((r,o,i)=>{const a=Math.abs(e-o);return r===null||a<r.distance||a===r.distance?{distance:a,index:i}:r},null))!=null?n:{};return s}function Yp(t,e){if(e.current!==void 0&&t.changedTouches){const n=t;for(let s=0;s<n.changedTouches.length;s+=1){const r=n.changedTouches[s];if(r.identifier===e.current)return{x:r.clientX,y:r.clientY}}return!1}return{x:t.clientX,y:t.clientY}}function Zg(t,e,n){return(t-e)*100/(n-e)}function w1e(t,e,n){return(n-e)*t+e}function k1e(t){if(Math.abs(t)<1){const n=t.toExponential().split("e-"),s=n[0].split(".")[1];return(s?s.length:0)+parseInt(n[1],10)}const e=t.toString().split(".")[1];return e?e.length:0}function C1e(t,e,n){const s=Math.round((t-n)/e)*e+n;return Number(s.toFixed(k1e(e)))}function hN({values:t,newValue:e,index:n}){const s=t.slice();return s[n]=e,s.sort(iB)}function Qp({sliderRef:t,activeIndex:e,setActive:n}){var s,r;const o=jn(t.current);if(!((s=t.current)!=null&&s.contains(o.activeElement))||Number(o==null||(r=o.activeElement)==null?void 0:r.getAttribute("data-index"))!==e){var i;(i=t.current)==null||i.querySelector(`[type="range"][data-index="${e}"]`).focus()}n&&n(e)}function Zp(t,e){return typeof t=="number"&&typeof e=="number"?t===e:typeof t=="object"&&typeof e=="object"?b1e(t,e):!1}const S1e={horizontal:{offset:t=>({left:`${t}%`}),leap:t=>({width:`${t}%`})},"horizontal-reverse":{offset:t=>({right:`${t}%`}),leap:t=>({width:`${t}%`})},vertical:{offset:t=>({bottom:`${t}%`}),leap:t=>({height:`${t}%`})}},$1e=t=>t;let Jp;function fN(){return Jp===void 0&&(typeof CSS<"u"&&typeof CSS.supports=="function"?Jp=CSS.supports("touch-action","none"):Jp=!0),Jp}function I1e(t){const{"aria-labelledby":e,defaultValue:n,disabled:s=!1,disableSwap:r=!1,isRtl:o=!1,marks:i=!1,max:a=100,min:l=0,name:c,onChange:u,onChangeCommitted:d,orientation:h="horizontal",rootRef:f,scale:p=$1e,step:m=1,shiftStep:x=10,tabIndex:g,value:y}=t,b=A.useRef(void 0),[v,w]=A.useState(-1),[k,C]=A.useState(-1),[S,I]=A.useState(!1),$=A.useRef(0),[E,_]=lw({controlled:y,default:n??l,name:"Slider"}),D=u&&((se,te,we)=>{const Ve=se.nativeEvent||se,qe=new Ve.constructor(Ve.type,Ve);Object.defineProperty(qe,"target",{writable:!0,value:{value:te,name:c}}),u(qe,te,we)}),F=Array.isArray(E);let R=F?E.slice().sort(iB):[E];R=R.map(se=>se==null?l:ac(se,l,a));const P=i===!0&&m!==null?[...Array(Math.floor((a-l)/m)+1)].map((se,te)=>({value:l+m*te})):i||[],M=P.map(se=>se.value),{isFocusVisibleRef:N,onBlur:B,onFocus:G,ref:X}=Nz(),[Y,J]=A.useState(-1),q=A.useRef(null),ee=hs(X,q),ne=hs(f,ee),ce=se=>te=>{var we;const Ve=Number(te.currentTarget.getAttribute("data-index"));G(te),N.current===!0&&J(Ve),C(Ve),se==null||(we=se.onFocus)==null||we.call(se,te)},ge=se=>te=>{var we;B(te),N.current===!1&&J(-1),C(-1),se==null||(we=se.onBlur)==null||we.call(se,te)},de=(se,te)=>{const we=Number(se.currentTarget.getAttribute("data-index")),Ve=R[we],qe=M.indexOf(Ve);let le=te;if(P&&m==null){const Ye=M[M.length-1];le>Ye?le=Ye:le<M[0]?le=M[0]:le=le<Ve?M[qe-1]:M[qe+1]}if(le=ac(le,l,a),F){r&&(le=ac(le,R[we-1]||-1/0,R[we+1]||1/0));const Ye=le;le=hN({values:R,newValue:le,index:we});let ht=we;r||(ht=le.indexOf(Ye)),Qp({sliderRef:q,activeIndex:ht})}_(le),J(we),D&&!Zp(le,E)&&D(se,le,we),d&&d(se,le)},$e=se=>te=>{var we;if(m!==null){const Ve=Number(te.currentTarget.getAttribute("data-index")),qe=R[Ve];let le=null;(te.key==="ArrowLeft"||te.key==="ArrowDown")&&te.shiftKey||te.key==="PageDown"?le=Math.max(qe-x,l):((te.key==="ArrowRight"||te.key==="ArrowUp")&&te.shiftKey||te.key==="PageUp")&&(le=Math.min(qe+x,a)),le!==null&&(de(te,le),te.preventDefault())}se==null||(we=se.onKeyDown)==null||we.call(se,te)};ca(()=>{if(s&&q.current.contains(document.activeElement)){var se;(se=document.activeElement)==null||se.blur()}},[s]),s&&v!==-1&&w(-1),s&&Y!==-1&&J(-1);const fe=se=>te=>{var we;(we=se.onChange)==null||we.call(se,te),de(te,te.target.valueAsNumber)},Ie=A.useRef(void 0);let xe=h;o&&h==="horizontal"&&(xe+="-reverse");const ye=({finger:se,move:te=!1})=>{const{current:we}=q,{width:Ve,height:qe,bottom:le,left:Ye}=we.getBoundingClientRect();let ht;xe.indexOf("vertical")===0?ht=(le-se.y)/qe:ht=(se.x-Ye)/Ve,xe.indexOf("-reverse")!==-1&&(ht=1-ht);let Je;if(Je=w1e(ht,l,a),m)Je=C1e(Je,m,l);else{const jl=dN(M,Je);Je=M[jl]}Je=ac(Je,l,a);let ms=0;if(F){te?ms=Ie.current:ms=dN(R,Je),r&&(Je=ac(Je,R[ms-1]||-1/0,R[ms+1]||1/0));const jl=Je;Je=hN({values:R,newValue:Je,index:ms}),r&&te||(ms=Je.indexOf(jl),Ie.current=ms)}return{newValue:Je,activeIndex:ms}},pe=$o(se=>{const te=Yp(se,b);if(!te)return;if($.current+=1,se.type==="mousemove"&&se.buttons===0){Re(se);return}const{newValue:we,activeIndex:Ve}=ye({finger:te,move:!0});Qp({sliderRef:q,activeIndex:Ve,setActive:w}),_(we),!S&&$.current>v1e&&I(!0),D&&!Zp(we,E)&&D(se,we,Ve)}),Re=$o(se=>{const te=Yp(se,b);if(I(!1),!te)return;const{newValue:we}=ye({finger:te,move:!0});w(-1),se.type==="touchend"&&C(-1),d&&d(se,we),b.current=void 0,Ae()}),Pe=$o(se=>{if(s)return;fN()||se.preventDefault();const te=se.changedTouches[0];te!=null&&(b.current=te.identifier);const we=Yp(se,b);if(we!==!1){const{newValue:qe,activeIndex:le}=ye({finger:we});Qp({sliderRef:q,activeIndex:le,setActive:w}),_(qe),D&&!Zp(qe,E)&&D(se,qe,le)}$.current=0;const Ve=jn(q.current);Ve.addEventListener("touchmove",pe,{passive:!0}),Ve.addEventListener("touchend",Re,{passive:!0})}),Ae=A.useCallback(()=>{const se=jn(q.current);se.removeEventListener("mousemove",pe),se.removeEventListener("mouseup",Re),se.removeEventListener("touchmove",pe),se.removeEventListener("touchend",Re)},[Re,pe]);A.useEffect(()=>{const{current:se}=q;return se.addEventListener("touchstart",Pe,{passive:fN()}),()=>{se.removeEventListener("touchstart",Pe),Ae()}},[Ae,Pe]),A.useEffect(()=>{s&&Ae()},[s,Ae]);const At=se=>te=>{var we;if((we=se.onMouseDown)==null||we.call(se,te),s||te.defaultPrevented||te.button!==0)return;te.preventDefault();const Ve=Yp(te,b);if(Ve!==!1){const{newValue:le,activeIndex:Ye}=ye({finger:Ve});Qp({sliderRef:q,activeIndex:Ye,setActive:w}),_(le),D&&!Zp(le,E)&&D(te,le,Ye)}$.current=0;const qe=jn(q.current);qe.addEventListener("mousemove",pe,{passive:!0}),qe.addEventListener("mouseup",Re)},Oe=Zg(F?R[0]:l,l,a),Xe=Zg(R[R.length-1],l,a)-Oe,wt=(se={})=>{const te=Pd(se),we={onMouseDown:At(te||{})},Ve=L({},te,we);return L({},se,{ref:ne},Ve)},It=se=>te=>{var we;(we=se.onMouseOver)==null||we.call(se,te);const Ve=Number(te.currentTarget.getAttribute("data-index"));C(Ve)},He=se=>te=>{var we;(we=se.onMouseLeave)==null||we.call(se,te),C(-1)};return{active:v,axis:xe,axisProps:S1e,dragging:S,focusedThumbIndex:Y,getHiddenInputProps:(se={})=>{var te;const we=Pd(se),Ve={onChange:fe(we||{}),onFocus:ce(we||{}),onBlur:ge(we||{}),onKeyDown:$e(we||{})},qe=L({},we,Ve);return L({tabIndex:g,"aria-labelledby":e,"aria-orientation":h,"aria-valuemax":p(a),"aria-valuemin":p(l),name:c,type:"range",min:t.min,max:t.max,step:t.step===null&&t.marks?"any":(te=t.step)!=null?te:void 0,disabled:s},se,qe,{style:L({},Zme,{direction:o?"rtl":"ltr",width:"100%",height:"100%"})})},getRootProps:wt,getThumbProps:(se={})=>{const te=Pd(se),we={onMouseOver:It(te||{}),onMouseLeave:He(te||{})};return L({},se,te,we)},marks:P,open:k,range:F,rootRef:ne,trackLeap:Xe,trackOffset:Oe,values:R,getThumbStyle:se=>({pointerEvents:v!==-1&&v!==se?"none":void 0})}}const T1e=t=>!t||!Ji(t),E1e=T1e;function N1e(t){return qt("MuiSlider",t)}const _1e=Ut("MuiSlider",["root","active","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","disabled","dragging","focusVisible","mark","markActive","marked","markLabel","markLabelActive","rail","sizeSmall","thumb","thumbColorPrimary","thumbColorSecondary","thumbColorError","thumbColorSuccess","thumbColorInfo","thumbColorWarning","track","trackInverted","trackFalse","thumbSizeSmall","valueLabel","valueLabelOpen","valueLabelCircle","valueLabelLabel","vertical"]),Ir=_1e,R1e=t=>{const{open:e}=t;return{offset:We(e&&Ir.valueLabelOpen),circle:Ir.valueLabelCircle,label:Ir.valueLabelLabel}};function A1e(t){const{children:e,className:n,value:s}=t,r=R1e(t);return e?A.cloneElement(e,{className:We(e.props.className)},oe.jsxs(A.Fragment,{children:[e.props.children,oe.jsx("span",{className:We(r.offset,n),"aria-hidden":!0,children:oe.jsx("span",{className:r.circle,children:oe.jsx("span",{className:r.label,children:s})})})]})):null}const D1e=["aria-label","aria-valuetext","aria-labelledby","component","components","componentsProps","color","classes","className","disableSwap","disabled","getAriaLabel","getAriaValueText","marks","max","min","name","onChange","onChangeCommitted","orientation","shiftStep","size","step","scale","slotProps","slots","tabIndex","track","value","valueLabelDisplay","valueLabelFormat"];function pN(t){return t}const F1e=Fe("span",{name:"MuiSlider",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`color${Ue(n.color)}`],n.size!=="medium"&&e[`size${Ue(n.size)}`],n.marked&&e.marked,n.orientation==="vertical"&&e.vertical,n.track==="inverted"&&e.trackInverted,n.track===!1&&e.trackFalse]}})(({theme:t})=>{var e;return{borderRadius:12,boxSizing:"content-box",display:"inline-block",position:"relative",cursor:"pointer",touchAction:"none",WebkitTapHighlightColor:"transparent","@media print":{colorAdjust:"exact"},[`&.${Ir.disabled}`]:{pointerEvents:"none",cursor:"default",color:(t.vars||t).palette.grey[400]},[`&.${Ir.dragging}`]:{[`& .${Ir.thumb}, & .${Ir.track}`]:{transition:"none"}},variants:[...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var s;return((s=t.vars)!=null?s:t).palette[n].main}).map(n=>({props:{color:n},style:{color:(t.vars||t).palette[n].main}})),{props:{orientation:"horizontal"},style:{height:4,width:"100%",padding:"13px 0","@media (pointer: coarse)":{padding:"20px 0"}}},{props:{orientation:"horizontal",size:"small"},style:{height:2}},{props:{orientation:"horizontal",marked:!0},style:{marginBottom:20}},{props:{orientation:"vertical"},style:{height:"100%",width:4,padding:"0 13px","@media (pointer: coarse)":{padding:"0 20px"}}},{props:{orientation:"vertical",size:"small"},style:{width:2}},{props:{orientation:"vertical",marked:!0},style:{marginRight:44}}]}}),O1e=Fe("span",{name:"MuiSlider",slot:"Rail",overridesResolver:(t,e)=>e.rail})({display:"block",position:"absolute",borderRadius:"inherit",backgroundColor:"currentColor",opacity:.38,variants:[{props:{orientation:"horizontal"},style:{width:"100%",height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{height:"100%",width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:"inverted"},style:{opacity:1}}]}),P1e=Fe("span",{name:"MuiSlider",slot:"Track",overridesResolver:(t,e)=>e.track})(({theme:t})=>{var e;return{display:"block",position:"absolute",borderRadius:"inherit",border:"1px solid currentColor",backgroundColor:"currentColor",transition:t.transitions.create(["left","width","bottom","height"],{duration:t.transitions.duration.shortest}),variants:[{props:{size:"small"},style:{border:"none"}},{props:{orientation:"horizontal"},style:{height:"inherit",top:"50%",transform:"translateY(-50%)"}},{props:{orientation:"vertical"},style:{width:"inherit",left:"50%",transform:"translateX(-50%)"}},{props:{track:!1},style:{display:"none"}},...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var s;return((s=t.vars)!=null?s:t).palette[n].main}).map(n=>({props:{color:n,track:"inverted"},style:L({},t.vars?{backgroundColor:t.vars.palette.Slider[`${n}Track`],borderColor:t.vars.palette.Slider[`${n}Track`]}:L({backgroundColor:dw(t.palette[n].main,.62),borderColor:dw(t.palette[n].main,.62)},t.applyStyles("dark",{backgroundColor:uw(t.palette[n].main,.5)}),t.applyStyles("dark",{borderColor:uw(t.palette[n].main,.5)})))}))]}}),M1e=Fe("span",{name:"MuiSlider",slot:"Thumb",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.thumb,e[`thumbColor${Ue(n.color)}`],n.size!=="medium"&&e[`thumbSize${Ue(n.size)}`]]}})(({theme:t})=>{var e;return{position:"absolute",width:20,height:20,boxSizing:"border-box",borderRadius:"50%",outline:0,backgroundColor:"currentColor",display:"flex",alignItems:"center",justifyContent:"center",transition:t.transitions.create(["box-shadow","left","bottom"],{duration:t.transitions.duration.shortest}),"&::before":{position:"absolute",content:'""',borderRadius:"inherit",width:"100%",height:"100%",boxShadow:(t.vars||t).shadows[2]},"&::after":{position:"absolute",content:'""',borderRadius:"50%",width:42,height:42,top:"50%",left:"50%",transform:"translate(-50%, -50%)"},[`&.${Ir.disabled}`]:{"&:hover":{boxShadow:"none"}},variants:[{props:{size:"small"},style:{width:12,height:12,"&::before":{boxShadow:"none"}}},{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-50%, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 50%)"}},...Object.keys(((e=t.vars)!=null?e:t).palette).filter(n=>{var s;return((s=t.vars)!=null?s:t).palette[n].main}).map(n=>({props:{color:n},style:{[`&:hover, &.${Ir.focusVisible}`]:L({},t.vars?{boxShadow:`0px 0px 0px 8px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 8px ${Mi(t.palette[n].main,.16)}`},{"@media (hover: none)":{boxShadow:"none"}}),[`&.${Ir.active}`]:L({},t.vars?{boxShadow:`0px 0px 0px 14px rgba(${t.vars.palette[n].mainChannel} / 0.16)`}:{boxShadow:`0px 0px 0px 14px ${Mi(t.palette[n].main,.16)}`})}}))]}}),L1e=Fe(A1e,{name:"MuiSlider",slot:"ValueLabel",overridesResolver:(t,e)=>e.valueLabel})(({theme:t})=>L({zIndex:1,whiteSpace:"nowrap"},t.typography.body2,{fontWeight:500,transition:t.transitions.create(["transform"],{duration:t.transitions.duration.shortest}),position:"absolute",backgroundColor:(t.vars||t).palette.grey[600],borderRadius:2,color:(t.vars||t).palette.common.white,display:"flex",alignItems:"center",justifyContent:"center",padding:"0.25rem 0.75rem",variants:[{props:{orientation:"horizontal"},style:{transform:"translateY(-100%) scale(0)",top:"-10px",transformOrigin:"bottom center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, 50%) rotate(45deg)",backgroundColor:"inherit",bottom:0,left:"50%"},[`&.${Ir.valueLabelOpen}`]:{transform:"translateY(-100%) scale(1)"}}},{props:{orientation:"vertical"},style:{transform:"translateY(-50%) scale(0)",right:"30px",top:"50%",transformOrigin:"right center","&::before":{position:"absolute",content:'""',width:8,height:8,transform:"translate(-50%, -50%) rotate(45deg)",backgroundColor:"inherit",right:-8,top:"50%"},[`&.${Ir.valueLabelOpen}`]:{transform:"translateY(-50%) scale(1)"}}},{props:{size:"small"},style:{fontSize:t.typography.pxToRem(12),padding:"0.25rem 0.5rem"}},{props:{orientation:"vertical",size:"small"},style:{right:"20px"}}]})),z1e=Fe("span",{name:"MuiSlider",slot:"Mark",shouldForwardProp:t=>Hy(t)&&t!=="markActive",overridesResolver:(t,e)=>{const{markActive:n}=t;return[e.mark,n&&e.markActive]}})(({theme:t})=>({position:"absolute",width:2,height:2,borderRadius:1,backgroundColor:"currentColor",variants:[{props:{orientation:"horizontal"},style:{top:"50%",transform:"translate(-1px, -50%)"}},{props:{orientation:"vertical"},style:{left:"50%",transform:"translate(-50%, 1px)"}},{props:{markActive:!0},style:{backgroundColor:(t.vars||t).palette.background.paper,opacity:.8}}]})),B1e=Fe("span",{name:"MuiSlider",slot:"MarkLabel",shouldForwardProp:t=>Hy(t)&&t!=="markLabelActive",overridesResolver:(t,e)=>e.markLabel})(({theme:t})=>L({},t.typography.body2,{color:(t.vars||t).palette.text.secondary,position:"absolute",whiteSpace:"nowrap",variants:[{props:{orientation:"horizontal"},style:{top:30,transform:"translateX(-50%)","@media (pointer: coarse)":{top:40}}},{props:{orientation:"vertical"},style:{left:36,transform:"translateY(50%)","@media (pointer: coarse)":{left:44}}},{props:{markLabelActive:!0},style:{color:(t.vars||t).palette.text.primary}}]})),V1e=t=>{const{disabled:e,dragging:n,marked:s,orientation:r,track:o,classes:i,color:a,size:l}=t,c={root:["root",e&&"disabled",n&&"dragging",s&&"marked",r==="vertical"&&"vertical",o==="inverted"&&"trackInverted",o===!1&&"trackFalse",a&&`color${Ue(a)}`,l&&`size${Ue(l)}`],rail:["rail"],track:["track"],mark:["mark"],markActive:["markActive"],markLabel:["markLabel"],markLabelActive:["markLabelActive"],valueLabel:["valueLabel"],thumb:["thumb",e&&"disabled",l&&`thumbSize${Ue(l)}`,a&&`thumbColor${Ue(a)}`],active:["active"],disabled:["disabled"],focusVisible:["focusVisible"]};return an(c,N1e,i)},W1e=({children:t})=>t,U1e=A.forwardRef(function(e,n){var s,r,o,i,a,l,c,u,d,h,f,p,m,x,g,y,b,v,w,k,C,S,I,$;const E=ln({props:e,name:"MuiSlider"}),_=Rz(),{"aria-label":D,"aria-valuetext":F,"aria-labelledby":R,component:P="span",components:M={},componentsProps:N={},color:B="primary",classes:G,className:X,disableSwap:Y=!1,disabled:J=!1,getAriaLabel:q,getAriaValueText:ee,marks:ne=!1,max:ce=100,min:ge=0,orientation:de="horizontal",shiftStep:$e=10,size:fe="medium",step:Ie=1,scale:xe=pN,slotProps:ye,slots:pe,track:Re="normal",valueLabelDisplay:Pe="off",valueLabelFormat:Ae=pN}=E,At=ze(E,D1e),Oe=L({},E,{isRtl:_,max:ce,min:ge,classes:G,disabled:J,disableSwap:Y,orientation:de,marks:ne,color:B,size:fe,step:Ie,shiftStep:$e,scale:xe,track:Re,valueLabelDisplay:Pe,valueLabelFormat:Ae}),{axisProps:Xe,getRootProps:wt,getHiddenInputProps:It,getThumbProps:He,open:Ht,active:cn,axis:Mt,focusedThumbIndex:se,range:te,dragging:we,marks:Ve,values:qe,trackOffset:le,trackLeap:Ye,getThumbStyle:ht}=I1e(L({},Oe,{rootRef:n}));Oe.marked=Ve.length>0&&Ve.some(gn=>gn.label),Oe.dragging=we,Oe.focusedThumbIndex=se;const Je=V1e(Oe),ms=(s=(r=pe==null?void 0:pe.root)!=null?r:M.Root)!=null?s:F1e,jl=(o=(i=pe==null?void 0:pe.rail)!=null?i:M.Rail)!=null?o:O1e,bI=(a=(l=pe==null?void 0:pe.track)!=null?l:M.Track)!=null?a:P1e,vI=(c=(u=pe==null?void 0:pe.thumb)!=null?u:M.Thumb)!=null?c:M1e,wI=(d=(h=pe==null?void 0:pe.valueLabel)!=null?h:M.ValueLabel)!=null?d:L1e,sb=(f=(p=pe==null?void 0:pe.mark)!=null?p:M.Mark)!=null?f:z1e,rb=(m=(x=pe==null?void 0:pe.markLabel)!=null?x:M.MarkLabel)!=null?m:B1e,kI=(g=(y=pe==null?void 0:pe.input)!=null?y:M.Input)!=null?g:"input",ob=(b=ye==null?void 0:ye.root)!=null?b:N.root,v4=(v=ye==null?void 0:ye.rail)!=null?v:N.rail,ib=(w=ye==null?void 0:ye.track)!=null?w:N.track,ab=(k=ye==null?void 0:ye.thumb)!=null?k:N.thumb,lb=(C=ye==null?void 0:ye.valueLabel)!=null?C:N.valueLabel,w4=(S=ye==null?void 0:ye.mark)!=null?S:N.mark,k4=(I=ye==null?void 0:ye.markLabel)!=null?I:N.markLabel,C4=($=ye==null?void 0:ye.input)!=null?$:N.input,S4=Ns({elementType:ms,getSlotProps:wt,externalSlotProps:ob,externalForwardedProps:At,additionalProps:L({},E1e(ms)&&{as:P}),ownerState:L({},Oe,ob==null?void 0:ob.ownerState),className:[Je.root,X]}),$4=Ns({elementType:jl,externalSlotProps:v4,ownerState:Oe,className:Je.rail}),I4=Ns({elementType:bI,externalSlotProps:ib,additionalProps:{style:L({},Xe[Mt].offset(le),Xe[Mt].leap(Ye))},ownerState:L({},Oe,ib==null?void 0:ib.ownerState),className:Je.track}),cb=Ns({elementType:vI,getSlotProps:He,externalSlotProps:ab,ownerState:L({},Oe,ab==null?void 0:ab.ownerState),className:Je.thumb}),T4=Ns({elementType:wI,externalSlotProps:lb,ownerState:L({},Oe,lb==null?void 0:lb.ownerState),className:Je.valueLabel}),ub=Ns({elementType:sb,externalSlotProps:w4,ownerState:Oe,className:Je.mark}),db=Ns({elementType:rb,externalSlotProps:k4,ownerState:Oe,className:Je.markLabel}),E4=Ns({elementType:kI,getSlotProps:It,externalSlotProps:C4,ownerState:Oe});return oe.jsxs(ms,L({},S4,{children:[oe.jsx(jl,L({},$4)),oe.jsx(bI,L({},I4)),Ve.filter(gn=>gn.value>=ge&&gn.value<=ce).map((gn,Wn)=>{const hb=Zg(gn.value,ge,ce),hp=Xe[Mt].offset(hb);let Wo;return Re===!1?Wo=qe.indexOf(gn.value)!==-1:Wo=Re==="normal"&&(te?gn.value>=qe[0]&&gn.value<=qe[qe.length-1]:gn.value<=qe[0])||Re==="inverted"&&(te?gn.value<=qe[0]||gn.value>=qe[qe.length-1]:gn.value>=qe[0]),oe.jsxs(A.Fragment,{children:[oe.jsx(sb,L({"data-index":Wn},ub,!Ji(sb)&&{markActive:Wo},{style:L({},hp,ub.style),className:We(ub.className,Wo&&Je.markActive)})),gn.label!=null?oe.jsx(rb,L({"aria-hidden":!0,"data-index":Wn},db,!Ji(rb)&&{markLabelActive:Wo},{style:L({},hp,db.style),className:We(Je.markLabel,db.className,Wo&&Je.markLabelActive),children:gn.label})):null]},Wn)}),qe.map((gn,Wn)=>{const hb=Zg(gn,ge,ce),hp=Xe[Mt].offset(hb),Wo=Pe==="off"?W1e:wI;return oe.jsx(Wo,L({},!Ji(Wo)&&{valueLabelFormat:Ae,valueLabelDisplay:Pe,value:typeof Ae=="function"?Ae(xe(gn),Wn):Ae,index:Wn,open:Ht===Wn||cn===Wn||Pe==="on",disabled:J},T4,{children:oe.jsx(vI,L({"data-index":Wn},cb,{className:We(Je.thumb,cb.className,cn===Wn&&Je.active,se===Wn&&Je.focusVisible),style:L({},hp,ht(Wn),cb.style),children:oe.jsx(kI,L({"data-index":Wn,"aria-label":q?q(Wn):D,"aria-valuenow":xe(gn),"aria-labelledby":R,"aria-valuetext":ee?ee(xe(gn),Wn):F,value:qe[Wn]},E4))}))}),Wn)})]}))}),em=U1e;function H1e(t){return qt("MuiTextField",t)}Ut("MuiTextField",["root"]);const G1e=["autoComplete","autoFocus","children","className","color","defaultValue","disabled","error","FormHelperTextProps","fullWidth","helperText","id","InputLabelProps","inputProps","InputProps","inputRef","label","maxRows","minRows","multiline","name","onBlur","onChange","onFocus","placeholder","required","rows","select","SelectProps","type","value","variant"],j1e={standard:Zz,filled:qz,outlined:rB},K1e=t=>{const{classes:e}=t;return an({root:["root"]},H1e,e)},X1e=Fe(Fye,{name:"MuiTextField",slot:"Root",overridesResolver:(t,e)=>e.root})({}),q1e=A.forwardRef(function(e,n){const s=ln({props:e,name:"MuiTextField"}),{autoComplete:r,autoFocus:o=!1,children:i,className:a,color:l="primary",defaultValue:c,disabled:u=!1,error:d=!1,FormHelperTextProps:h,fullWidth:f=!1,helperText:p,id:m,InputLabelProps:x,inputProps:g,InputProps:y,inputRef:b,label:v,maxRows:w,minRows:k,multiline:C=!1,name:S,onBlur:I,onChange:$,onFocus:E,placeholder:_,required:D=!1,rows:F,select:R=!1,SelectProps:P,type:M,value:N,variant:B="outlined"}=s,G=ze(s,G1e),X=L({},s,{autoFocus:o,color:l,disabled:u,error:d,fullWidth:f,multiline:C,required:D,select:R,variant:B}),Y=K1e(X),J={};B==="outlined"&&(x&&typeof x.shrink<"u"&&(J.notched=x.shrink),J.label=v),R&&((!P||!P.native)&&(J.id=void 0),J["aria-describedby"]=void 0);const q=Tz(m),ee=p&&q?`${q}-helper-text`:void 0,ne=v&&q?`${q}-label`:void 0,ce=j1e[B],ge=oe.jsx(ce,L({"aria-describedby":ee,autoComplete:r,autoFocus:o,defaultValue:c,fullWidth:f,multiline:C,name:S,rows:F,maxRows:w,minRows:k,type:M,value:N,id:q,inputRef:b,onBlur:I,onChange:$,onFocus:E,placeholder:_,inputProps:g},J,y));return oe.jsxs(X1e,L({className:We(Y.root,a),disabled:u,error:d,fullWidth:f,ref:n,required:D,color:l,variant:B,ownerState:X},G,{children:[v!=null&&v!==""&&oe.jsx(lbe,L({htmlFor:q,id:ne},x,{children:v})),R?oe.jsx(y1e,L({"aria-describedby":ee,id:q,labelId:ne,value:N,input:ge},P,{children:i})):ge,p&&oe.jsx(Vye,L({id:ee},h,{children:p}))]}))}),tm=q1e;/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function lp(t){return t+.5|0}const Li=(t,e,n)=>Math.max(Math.min(t,n),e);function gd(t){return Li(lp(t*2.55),0,255)}function ea(t){return Li(lp(t*255),0,255)}function Yo(t){return Li(lp(t/2.55)/100,0,1)}function mN(t){return Li(lp(t*100),0,100)}const hr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},xw=[..."0123456789ABCDEF"],Y1e=t=>xw[t&15],Q1e=t=>xw[(t&240)>>4]+xw[t&15],nm=t=>(t&240)>>4===(t&15),Z1e=t=>nm(t.r)&&nm(t.g)&&nm(t.b)&&nm(t.a);function J1e(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&hr[t[1]]*17,g:255&hr[t[2]]*17,b:255&hr[t[3]]*17,a:e===5?hr[t[4]]*17:255}:(e===7||e===9)&&(n={r:hr[t[1]]<<4|hr[t[2]],g:hr[t[3]]<<4|hr[t[4]],b:hr[t[5]]<<4|hr[t[6]],a:e===9?hr[t[7]]<<4|hr[t[8]]:255})),n}const eve=(t,e)=>t<255?e(t):"";function tve(t){var e=Z1e(t)?Y1e:Q1e;return t?"#"+e(t.r)+e(t.g)+e(t.b)+eve(t.a,e):void 0}const nve=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function aB(t,e,n){const s=e*Math.min(n,1-n),r=(o,i=(o+t/30)%12)=>n-s*Math.max(Math.min(i-3,9-i,1),-1);return[r(0),r(8),r(4)]}function sve(t,e,n){const s=(r,o=(r+t/60)%6)=>n-n*e*Math.max(Math.min(o,4-o,1),0);return[s(5),s(3),s(1)]}function rve(t,e,n){const s=aB(t,1,.5);let r;for(e+n>1&&(r=1/(e+n),e*=r,n*=r),r=0;r<3;r++)s[r]*=1-e-n,s[r]+=e;return s}function ove(t,e,n,s,r){return t===r?(e-n)/s+(e<n?6:0):e===r?(n-t)/s+2:(t-e)/s+4}function Y$(t){const n=t.r/255,s=t.g/255,r=t.b/255,o=Math.max(n,s,r),i=Math.min(n,s,r),a=(o+i)/2;let l,c,u;return o!==i&&(u=o-i,c=a>.5?u/(2-o-i):u/(o+i),l=ove(n,s,r,u,o),l=l*60+.5),[l|0,c||0,a]}function Q$(t,e,n,s){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,s)).map(ea)}function Z$(t,e,n){return Q$(aB,t,e,n)}function ive(t,e,n){return Q$(rve,t,e,n)}function ave(t,e,n){return Q$(sve,t,e,n)}function lB(t){return(t%360+360)%360}function lve(t){const e=nve.exec(t);let n=255,s;if(!e)return;e[5]!==s&&(n=e[6]?gd(+e[5]):ea(+e[5]));const r=lB(+e[2]),o=+e[3]/100,i=+e[4]/100;return e[1]==="hwb"?s=ive(r,o,i):e[1]==="hsv"?s=ave(r,o,i):s=Z$(r,o,i),{r:s[0],g:s[1],b:s[2],a:n}}function cve(t,e){var n=Y$(t);n[0]=lB(n[0]+e),n=Z$(n),t.r=n[0],t.g=n[1],t.b=n[2]}function uve(t){if(!t)return;const e=Y$(t),n=e[0],s=mN(e[1]),r=mN(e[2]);return t.a<255?`hsla(${n}, ${s}%, ${r}%, ${Yo(t.a)})`:`hsl(${n}, ${s}%, ${r}%)`}const gN={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},xN={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function dve(){const t={},e=Object.keys(xN),n=Object.keys(gN);let s,r,o,i,a;for(s=0;s<e.length;s++){for(i=a=e[s],r=0;r<n.length;r++)o=n[r],a=a.replace(o,gN[o]);o=parseInt(xN[i],16),t[a]=[o>>16&255,o>>8&255,o&255]}return t}let sm;function hve(t){sm||(sm=dve(),sm.transparent=[0,0,0,0]);const e=sm[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const fve=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function pve(t){const e=fve.exec(t);let n=255,s,r,o;if(e){if(e[7]!==s){const i=+e[7];n=e[8]?gd(i):Li(i*255,0,255)}return s=+e[1],r=+e[3],o=+e[5],s=255&(e[2]?gd(s):Li(s,0,255)),r=255&(e[4]?gd(r):Li(r,0,255)),o=255&(e[6]?gd(o):Li(o,0,255)),{r:s,g:r,b:o,a:n}}}function mve(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${Yo(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const h1=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,sc=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function gve(t,e,n){const s=sc(Yo(t.r)),r=sc(Yo(t.g)),o=sc(Yo(t.b));return{r:ea(h1(s+n*(sc(Yo(e.r))-s))),g:ea(h1(r+n*(sc(Yo(e.g))-r))),b:ea(h1(o+n*(sc(Yo(e.b))-o))),a:t.a+n*(e.a-t.a)}}function rm(t,e,n){if(t){let s=Y$(t);s[e]=Math.max(0,Math.min(s[e]+s[e]*n,e===0?360:1)),s=Z$(s),t.r=s[0],t.g=s[1],t.b=s[2]}}function cB(t,e){return t&&Object.assign(e||{},t)}function yN(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=ea(t[3]))):(e=cB(t,{r:0,g:0,b:0,a:1}),e.a=ea(e.a)),e}function xve(t){return t.charAt(0)==="r"?pve(t):lve(t)}let uB=class yw{constructor(e){if(e instanceof yw)return e;const n=typeof e;let s;n==="object"?s=yN(e):n==="string"&&(s=J1e(e)||hve(e)||xve(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=cB(this._rgb);return e&&(e.a=Yo(e.a)),e}set rgb(e){this._rgb=yN(e)}rgbString(){return this._valid?mve(this._rgb):void 0}hexString(){return this._valid?tve(this._rgb):void 0}hslString(){return this._valid?uve(this._rgb):void 0}mix(e,n){if(e){const s=this.rgb,r=e.rgb;let o;const i=n===o?.5:n,a=2*i-1,l=s.a-r.a,c=((a*l===-1?a:(a+l)/(1+a*l))+1)/2;o=1-c,s.r=255&c*s.r+o*r.r+.5,s.g=255&c*s.g+o*r.g+.5,s.b=255&c*s.b+o*r.b+.5,s.a=i*s.a+(1-i)*r.a,this.rgb=s}return this}interpolate(e,n){return e&&(this._rgb=gve(this._rgb,e._rgb,n)),this}clone(){return new yw(this.rgb)}alpha(e){return this._rgb.a=ea(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=lp(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return rm(this._rgb,2,e),this}darken(e){return rm(this._rgb,2,-e),this}saturate(e){return rm(this._rgb,1,e),this}desaturate(e){return rm(this._rgb,1,-e),this}rotate(e){return cve(this._rgb,e),this}};/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function Uo(){}const yve=(()=>{let t=0;return()=>t++})();function gt(t){return t==null}function jt(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function dt(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function On(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Gs(t,e){return On(t)?t:e}function et(t,e){return typeof t>"u"?e:t}const bve=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function Tt(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function mt(t,e,n,s){let r,o,i;if(jt(t))if(o=t.length,s)for(r=o-1;r>=0;r--)e.call(n,t[r],r);else for(r=0;r<o;r++)e.call(n,t[r],r);else if(dt(t))for(i=Object.keys(t),o=i.length,r=0;r<o;r++)e.call(n,t[i[r]],i[r])}function Jg(t,e){let n,s,r,o;if(!t||!e||t.length!==e.length)return!1;for(n=0,s=t.length;n<s;++n)if(r=t[n],o=e[n],r.datasetIndex!==o.datasetIndex||r.index!==o.index)return!1;return!0}function e0(t){if(jt(t))return t.map(e0);if(dt(t)){const e=Object.create(null),n=Object.keys(t),s=n.length;let r=0;for(;r<s;++r)e[n[r]]=e0(t[n[r]]);return e}return t}function dB(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function vve(t,e,n,s){if(!dB(t))return;const r=e[t],o=n[t];dt(r)&&dt(o)?Ch(r,o,s):e[t]=e0(o)}function Ch(t,e,n){const s=jt(e)?e:[e],r=s.length;if(!dt(t))return t;n=n||{};const o=n.merger||vve;let i;for(let a=0;a<r;++a){if(i=s[a],!dt(i))continue;const l=Object.keys(i);for(let c=0,u=l.length;c<u;++c)o(l[c],t,i,n)}return t}function zd(t,e){return Ch(t,e,{merger:wve})}function wve(t,e,n){if(!dB(t))return;const s=e[t],r=n[t];dt(s)&&dt(r)?zd(s,r):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=e0(r))}const bN={"":t=>t,x:t=>t.x,y:t=>t.y};function kve(t){const e=t.split("."),n=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(n.push(s),s="");return n}function Cve(t){const e=kve(t);return n=>{for(const s of e){if(s==="")break;n=n&&n[s]}return n}}function t0(t,e){return(bN[e]||(bN[e]=Cve(e)))(t)}function J$(t){return t.charAt(0).toUpperCase()+t.slice(1)}const n0=t=>typeof t<"u",ua=t=>typeof t=="function",vN=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function Sve(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const Sn=Math.PI,_r=2*Sn,$ve=_r+Sn,s0=Number.POSITIVE_INFINITY,Ive=Sn/180,Qs=Sn/2,Ea=Sn/4,wN=Sn*2/3,zi=Math.log10,iu=Math.sign;function Bd(t,e,n){return Math.abs(t-e)<n}function kN(t){const e=Math.round(t);t=Bd(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(zi(t))),s=t/n;return(s<=1?1:s<=2?2:s<=5?5:10)*n}function Tve(t){const e=[],n=Math.sqrt(t);let s;for(s=1;s<n;s++)t%s===0&&(e.push(s),e.push(t/s));return n===(n|0)&&e.push(n),e.sort((r,o)=>r-o).pop(),e}function Eve(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function Sh(t){return!Eve(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function Nve(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function hB(t,e,n){let s,r,o;for(s=0,r=t.length;s<r;s++)o=t[s][n],isNaN(o)||(e.min=Math.min(e.min,o),e.max=Math.max(e.max,o))}function Bi(t){return t*(Sn/180)}function eI(t){return t*(180/Sn)}function CN(t){if(!On(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function _ve(t,e){const n=e.x-t.x,s=e.y-t.y,r=Math.sqrt(n*n+s*s);let o=Math.atan2(s,n);return o<-.5*Sn&&(o+=_r),{angle:o,distance:r}}function bw(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function Rve(t,e){return(t-e+$ve)%_r-Sn}function jr(t){return(t%_r+_r)%_r}function fB(t,e,n,s){const r=jr(t),o=jr(e),i=jr(n),a=jr(o-r),l=jr(i-r),c=jr(r-o),u=jr(r-i);return r===o||r===i||s&&o===i||a>l&&c<u}function Tr(t,e,n){return Math.max(e,Math.min(n,t))}function Ave(t){return Tr(t,-32768,32767)}function xd(t,e,n,s=1e-6){return t>=Math.min(e,n)-s&&t<=Math.max(e,n)+s}function tI(t,e,n){n=n||(i=>t[i]<e);let s=t.length-1,r=0,o;for(;s-r>1;)o=r+s>>1,n(o)?r=o:s=o;return{lo:r,hi:s}}const Ya=(t,e,n,s)=>tI(t,n,s?r=>{const o=t[r][e];return o<n||o===n&&t[r+1][e]===n}:r=>t[r][e]<n),Dve=(t,e,n)=>tI(t,n,s=>t[s][e]>=n);function Fve(t,e,n){let s=0,r=t.length;for(;s<r&&t[s]<e;)s++;for(;r>s&&t[r-1]>n;)r--;return s>0||r<t.length?t.slice(s,r):t}const pB=["push","pop","shift","splice","unshift"];function Ove(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),pB.forEach(n=>{const s="_onData"+J$(n),r=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...o){const i=r.apply(this,o);return t._chartjs.listeners.forEach(a=>{typeof a[s]=="function"&&a[s](...o)}),i}})})}function SN(t,e){const n=t._chartjs;if(!n)return;const s=n.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(pB.forEach(o=>{delete t[o]}),delete t._chartjs)}function Pve(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const mB=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function gB(t,e){let n=[],s=!1;return function(...r){n=r,s||(s=!0,mB.call(window,()=>{s=!1,t.apply(e,n)}))}}function Mve(t,e){let n;return function(...s){return e?(clearTimeout(n),n=setTimeout(t,e,s)):t.apply(this,s),e}}const nI=t=>t==="start"?"left":t==="end"?"right":"center",ss=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Lve=(t,e,n,s)=>t===(s?"left":"right")?n:t==="center"?(e+n)/2:e;function zve(t,e,n){const s=e.length;let r=0,o=s;if(t._sorted){const{iScale:i,vScale:a,_parsed:l}=t,c=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null,u=i.axis,{min:d,max:h,minDefined:f,maxDefined:p}=i.getUserBounds();if(f){if(r=Math.min(Ya(l,u,d).lo,n?s:Ya(e,u,i.getPixelForValue(d)).lo),c){const m=l.slice(0,r+1).reverse().findIndex(x=>!gt(x[a.axis]));r-=Math.max(0,m)}r=Tr(r,0,s-1)}if(p){let m=Math.max(Ya(l,i.axis,h,!0).hi+1,n?0:Ya(e,u,i.getPixelForValue(h),!0).hi+1);if(c){const x=l.slice(m-1).findIndex(g=>!gt(g[a.axis]));m+=Math.max(0,x)}o=Tr(m,r,s)-r}else o=s-r}return{start:r,count:o}}function Bve(t){const{xScale:e,yScale:n,_scaleRanges:s}=t,r={xmin:e.min,xmax:e.max,ymin:n.min,ymax:n.max};if(!s)return t._scaleRanges=r,!0;const o=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==n.min||s.ymax!==n.max;return Object.assign(s,r),o}const om=t=>t===0||t===1,$N=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*_r/n)),IN=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*_r/n)+1,Vd={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*Qs)+1,easeOutSine:t=>Math.sin(t*Qs),easeInOutSine:t=>-.5*(Math.cos(Sn*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>om(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>om(t)?t:$N(t,.075,.3),easeOutElastic:t=>om(t)?t:IN(t,.075,.3),easeInOutElastic(t){return om(t)?t:t<.5?.5*$N(t*2,.1125,.45):.5+.5*IN(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-Vd.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?Vd.easeInBounce(t*2)*.5:Vd.easeOutBounce(t*2-1)*.5+.5};function sI(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function TN(t){return sI(t)?t:new uB(t)}function f1(t){return sI(t)?t:new uB(t).saturate(.5).darken(.1).hexString()}const Vve=["x","y","borderWidth","radius","tension"],Wve=["color","borderColor","backgroundColor"];function Uve(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Wve},numbers:{type:"number",properties:Vve}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Hve(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const EN=new Map;function Gve(t,e){e=e||{};const n=t+JSON.stringify(e);let s=EN.get(n);return s||(s=new Intl.NumberFormat(t,e),EN.set(n,s)),s}function rI(t,e,n){return Gve(e,n).format(t)}const xB={values(t){return jt(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const s=this.chart.options.locale;let r,o=t;if(n.length>1){const c=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(c<1e-4||c>1e15)&&(r="scientific"),o=jve(t,n)}const i=zi(Math.abs(o)),a=isNaN(i)?1:Math.max(Math.min(-1*Math.floor(i),20),0),l={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(l,this.options.ticks.format),rI(t,s,l)},logarithmic(t,e,n){if(t===0)return"0";const s=n[e].significand||t/Math.pow(10,Math.floor(zi(t)));return[1,2,3,5,10,15].includes(s)||e>.8*n.length?xB.numeric.call(this,t,e,n):""}};function jve(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var Yy={formatters:xB};function Kve(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:Yy.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Tl=Object.create(null),vw=Object.create(null);function Wd(t,e){if(!e)return t;const n=e.split(".");for(let s=0,r=n.length;s<r;++s){const o=n[s];t=t[o]||(t[o]=Object.create(null))}return t}function p1(t,e,n){return typeof e=="string"?Ch(Wd(t,e),n):Ch(Wd(t,""),e)}class Xve{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>f1(r.backgroundColor),this.hoverBorderColor=(s,r)=>f1(r.borderColor),this.hoverColor=(s,r)=>f1(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return p1(this,e,n)}get(e){return Wd(this,e)}describe(e,n){return p1(vw,e,n)}override(e,n){return p1(Tl,e,n)}route(e,n,s,r){const o=Wd(this,e),i=Wd(this,s),a="_"+n;Object.defineProperties(o,{[a]:{value:o[n],writable:!0},[n]:{enumerable:!0,get(){const l=this[a],c=i[r];return dt(l)?Object.assign({},c,l):et(l,c)},set(l){this[a]=l}}})}apply(e){e.forEach(n=>n(this))}}var en=new Xve({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Uve,Hve,Kve]);function qve(t){return!t||gt(t.size)||gt(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function r0(t,e,n,s,r){let o=e[r];return o||(o=e[r]=t.measureText(r).width,n.push(r)),o>s&&(s=o),s}function Yve(t,e,n,s){s=s||{};let r=s.data=s.data||{},o=s.garbageCollect=s.garbageCollect||[];s.font!==e&&(r=s.data={},o=s.garbageCollect=[],s.font=e),t.save(),t.font=e;let i=0;const a=n.length;let l,c,u,d,h;for(l=0;l<a;l++)if(d=n[l],d!=null&&!jt(d))i=r0(t,r,o,i,d);else if(jt(d))for(c=0,u=d.length;c<u;c++)h=d[c],h!=null&&!jt(h)&&(i=r0(t,r,o,i,h));t.restore();const f=o.length/2;if(f>n.length){for(l=0;l<f;l++)delete r[o[l]];o.splice(0,f)}return i}function Na(t,e,n){const s=t.currentDevicePixelRatio,r=n!==0?Math.max(n/2,.5):0;return Math.round((e-r)*s)/s+r}function NN(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function ww(t,e,n,s){yB(t,e,n,s,null)}function yB(t,e,n,s,r){let o,i,a,l,c,u,d,h;const f=e.pointStyle,p=e.rotation,m=e.radius;let x=(p||0)*Ive;if(f&&typeof f=="object"&&(o=f.toString(),o==="[object HTMLImageElement]"||o==="[object HTMLCanvasElement]")){t.save(),t.translate(n,s),t.rotate(x),t.drawImage(f,-f.width/2,-f.height/2,f.width,f.height),t.restore();return}if(!(isNaN(m)||m<=0)){switch(t.beginPath(),f){default:r?t.ellipse(n,s,r/2,m,0,0,_r):t.arc(n,s,m,0,_r),t.closePath();break;case"triangle":u=r?r/2:m,t.moveTo(n+Math.sin(x)*u,s-Math.cos(x)*m),x+=wN,t.lineTo(n+Math.sin(x)*u,s-Math.cos(x)*m),x+=wN,t.lineTo(n+Math.sin(x)*u,s-Math.cos(x)*m),t.closePath();break;case"rectRounded":c=m*.516,l=m-c,i=Math.cos(x+Ea)*l,d=Math.cos(x+Ea)*(r?r/2-c:l),a=Math.sin(x+Ea)*l,h=Math.sin(x+Ea)*(r?r/2-c:l),t.arc(n-d,s-a,c,x-Sn,x-Qs),t.arc(n+h,s-i,c,x-Qs,x),t.arc(n+d,s+a,c,x,x+Qs),t.arc(n-h,s+i,c,x+Qs,x+Sn),t.closePath();break;case"rect":if(!p){l=Math.SQRT1_2*m,u=r?r/2:l,t.rect(n-u,s-l,2*u,2*l);break}x+=Ea;case"rectRot":d=Math.cos(x)*(r?r/2:m),i=Math.cos(x)*m,a=Math.sin(x)*m,h=Math.sin(x)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+h,s-i),t.lineTo(n+d,s+a),t.lineTo(n-h,s+i),t.closePath();break;case"crossRot":x+=Ea;case"cross":d=Math.cos(x)*(r?r/2:m),i=Math.cos(x)*m,a=Math.sin(x)*m,h=Math.sin(x)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-i),t.lineTo(n-h,s+i);break;case"star":d=Math.cos(x)*(r?r/2:m),i=Math.cos(x)*m,a=Math.sin(x)*m,h=Math.sin(x)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-i),t.lineTo(n-h,s+i),x+=Ea,d=Math.cos(x)*(r?r/2:m),i=Math.cos(x)*m,a=Math.sin(x)*m,h=Math.sin(x)*(r?r/2:m),t.moveTo(n-d,s-a),t.lineTo(n+d,s+a),t.moveTo(n+h,s-i),t.lineTo(n-h,s+i);break;case"line":i=r?r/2:Math.cos(x)*m,a=Math.sin(x)*m,t.moveTo(n-i,s-a),t.lineTo(n+i,s+a);break;case"dash":t.moveTo(n,s),t.lineTo(n+Math.cos(x)*(r?r/2:m),s+Math.sin(x)*m);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function ti(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function oI(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function iI(t){t.restore()}function Qve(t,e,n,s,r){if(!e)return t.lineTo(n.x,n.y);if(r==="middle"){const o=(e.x+n.x)/2;t.lineTo(o,e.y),t.lineTo(o,n.y)}else r==="after"!=!!s?t.lineTo(e.x,n.y):t.lineTo(n.x,e.y);t.lineTo(n.x,n.y)}function Zve(t,e,n,s){if(!e)return t.lineTo(n.x,n.y);t.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?n.cp2x:n.cp1x,s?n.cp2y:n.cp1y,n.x,n.y)}function Jve(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),gt(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function ewe(t,e,n,s,r){if(r.strikethrough||r.underline){const o=t.measureText(s),i=e-o.actualBoundingBoxLeft,a=e+o.actualBoundingBoxRight,l=n-o.actualBoundingBoxAscent,c=n+o.actualBoundingBoxDescent,u=r.strikethrough?(l+c)/2:c;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=r.decorationWidth||2,t.moveTo(i,u),t.lineTo(a,u),t.stroke()}}function twe(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function El(t,e,n,s,r,o={}){const i=jt(e)?e:[e],a=o.strokeWidth>0&&o.strokeColor!=="";let l,c;for(t.save(),t.font=r.string,Jve(t,o),l=0;l<i.length;++l)c=i[l],o.backdrop&&twe(t,o.backdrop),a&&(o.strokeColor&&(t.strokeStyle=o.strokeColor),gt(o.strokeWidth)||(t.lineWidth=o.strokeWidth),t.strokeText(c,n,s,o.maxWidth)),t.fillText(c,n,s,o.maxWidth),ewe(t,n,s,c,o),s+=Number(r.lineHeight);t.restore()}function o0(t,e){const{x:n,y:s,w:r,h:o,radius:i}=e;t.arc(n+i.topLeft,s+i.topLeft,i.topLeft,1.5*Sn,Sn,!0),t.lineTo(n,s+o-i.bottomLeft),t.arc(n+i.bottomLeft,s+o-i.bottomLeft,i.bottomLeft,Sn,Qs,!0),t.lineTo(n+r-i.bottomRight,s+o),t.arc(n+r-i.bottomRight,s+o-i.bottomRight,i.bottomRight,Qs,0,!0),t.lineTo(n+r,s+i.topRight),t.arc(n+r-i.topRight,s+i.topRight,i.topRight,0,-Qs,!0),t.lineTo(n+i.topLeft,s)}const nwe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,swe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function rwe(t,e){const n=(""+t).match(nwe);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const owe=t=>+t||0;function bB(t,e){const n={},s=dt(e),r=s?Object.keys(e):e,o=dt(t)?s?i=>et(t[i],t[e[i]]):i=>t[i]:()=>t;for(const i of r)n[i]=owe(o(i));return n}function iwe(t){return bB(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Oc(t){return bB(t,["topLeft","topRight","bottomLeft","bottomRight"])}function fs(t){const e=iwe(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Rn(t,e){t=t||{},e=e||en.font;let n=et(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let s=et(t.style,e.style);s&&!(""+s).match(swe)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:et(t.family,e.family),lineHeight:rwe(et(t.lineHeight,e.lineHeight),n),size:n,style:s,weight:et(t.weight,e.weight),string:""};return r.string=qve(r),r}function im(t,e,n,s){let r=!0,o,i,a;for(o=0,i=t.length;o<i;++o)if(a=t[o],a!==void 0&&(e!==void 0&&typeof a=="function"&&(a=a(e),r=!1),n!==void 0&&jt(a)&&(a=a[n%a.length],r=!1),a!==void 0))return s&&!r&&(s.cacheable=!1),a}function awe(t,e,n){const{min:s,max:r}=t,o=bve(e,(r-s)/2),i=(a,l)=>n&&a===0?0:a+l;return{min:i(s,-Math.abs(o)),max:i(r,o)}}function Sa(t,e){return Object.assign(Object.create(t),e)}function aI(t,e=[""],n,s,r=()=>t[0]){const o=n||t;typeof s>"u"&&(s=CB("_fallback",t));const i={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:o,_fallback:s,_getTarget:r,override:a=>aI([a,...t],e,o,s)};return new Proxy(i,{deleteProperty(a,l){return delete a[l],delete a._keys,delete t[0][l],!0},get(a,l){return wB(a,l,()=>mwe(l,e,t,a))},getOwnPropertyDescriptor(a,l){return Reflect.getOwnPropertyDescriptor(a._scopes[0],l)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(a,l){return RN(a).includes(l)},ownKeys(a){return RN(a)},set(a,l,c){const u=a._storage||(a._storage=r());return a[l]=u[l]=c,delete a._keys,!0}})}function au(t,e,n,s){const r={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:vB(t,s),setContext:o=>au(t,o,n,s),override:o=>au(t.override(o),e,n,s)};return new Proxy(r,{deleteProperty(o,i){return delete o[i],delete t[i],!0},get(o,i,a){return wB(o,i,()=>cwe(o,i,a))},getOwnPropertyDescriptor(o,i){return o._descriptors.allKeys?Reflect.has(t,i)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,i)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(o,i){return Reflect.has(t,i)},ownKeys(){return Reflect.ownKeys(t)},set(o,i,a){return t[i]=a,delete o[i],!0}})}function vB(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=t;return{allKeys:r,scriptable:n,indexable:s,isScriptable:ua(n)?n:()=>n,isIndexable:ua(s)?s:()=>s}}const lwe=(t,e)=>t?t+J$(e):e,lI=(t,e)=>dt(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function wB(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const s=n();return t[e]=s,s}function cwe(t,e,n){const{_proxy:s,_context:r,_subProxy:o,_descriptors:i}=t;let a=s[e];return ua(a)&&i.isScriptable(e)&&(a=uwe(e,a,t,n)),jt(a)&&a.length&&(a=dwe(e,a,t,i.isIndexable)),lI(e,a)&&(a=au(a,r,o&&o[e],i)),a}function uwe(t,e,n,s){const{_proxy:r,_context:o,_subProxy:i,_stack:a}=n;if(a.has(t))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+t);a.add(t);let l=e(o,i||s);return a.delete(t),lI(t,l)&&(l=cI(r._scopes,r,t,l)),l}function dwe(t,e,n,s){const{_proxy:r,_context:o,_subProxy:i,_descriptors:a}=n;if(typeof o.index<"u"&&s(t))return e[o.index%e.length];if(dt(e[0])){const l=e,c=r._scopes.filter(u=>u!==l);e=[];for(const u of l){const d=cI(c,r,t,u);e.push(au(d,o,i&&i[t],a))}}return e}function kB(t,e,n){return ua(t)?t(e,n):t}const hwe=(t,e)=>t===!0?e:typeof t=="string"?t0(e,t):void 0;function fwe(t,e,n,s,r){for(const o of e){const i=hwe(n,o);if(i){t.add(i);const a=kB(i._fallback,n,r);if(typeof a<"u"&&a!==n&&a!==s)return a}else if(i===!1&&typeof s<"u"&&n!==s)return null}return!1}function cI(t,e,n,s){const r=e._rootScopes,o=kB(e._fallback,n,s),i=[...t,...r],a=new Set;a.add(s);let l=_N(a,i,n,o||n,s);return l===null||typeof o<"u"&&o!==n&&(l=_N(a,i,o,l,s),l===null)?!1:aI(Array.from(a),[""],r,o,()=>pwe(e,n,s))}function _N(t,e,n,s,r){for(;n;)n=fwe(t,e,n,s,r);return n}function pwe(t,e,n){const s=t._getTarget();e in s||(s[e]={});const r=s[e];return jt(r)&&dt(n)?n:r||{}}function mwe(t,e,n,s){let r;for(const o of e)if(r=CB(lwe(o,t),n),typeof r<"u")return lI(t,r)?cI(n,s,t,r):r}function CB(t,e){for(const n of e){if(!n)continue;const s=n[t];if(typeof s<"u")return s}}function RN(t){let e=t._keys;return e||(e=t._keys=gwe(t._scopes)),e}function gwe(t){const e=new Set;for(const n of t)for(const s of Object.keys(n).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const xwe=Number.EPSILON||1e-14,lu=(t,e)=>e<t.length&&!t[e].skip&&t[e],SB=t=>t==="x"?"y":"x";function ywe(t,e,n,s){const r=t.skip?e:t,o=e,i=n.skip?e:n,a=bw(o,r),l=bw(i,o);let c=a/(a+l),u=l/(a+l);c=isNaN(c)?0:c,u=isNaN(u)?0:u;const d=s*c,h=s*u;return{previous:{x:o.x-d*(i.x-r.x),y:o.y-d*(i.y-r.y)},next:{x:o.x+h*(i.x-r.x),y:o.y+h*(i.y-r.y)}}}function bwe(t,e,n){const s=t.length;let r,o,i,a,l,c=lu(t,0);for(let u=0;u<s-1;++u)if(l=c,c=lu(t,u+1),!(!l||!c)){if(Bd(e[u],0,xwe)){n[u]=n[u+1]=0;continue}r=n[u]/e[u],o=n[u+1]/e[u],a=Math.pow(r,2)+Math.pow(o,2),!(a<=9)&&(i=3/Math.sqrt(a),n[u]=r*i*e[u],n[u+1]=o*i*e[u])}}function vwe(t,e,n="x"){const s=SB(n),r=t.length;let o,i,a,l=lu(t,0);for(let c=0;c<r;++c){if(i=a,a=l,l=lu(t,c+1),!a)continue;const u=a[n],d=a[s];i&&(o=(u-i[n])/3,a[`cp1${n}`]=u-o,a[`cp1${s}`]=d-o*e[c]),l&&(o=(l[n]-u)/3,a[`cp2${n}`]=u+o,a[`cp2${s}`]=d+o*e[c])}}function wwe(t,e="x"){const n=SB(e),s=t.length,r=Array(s).fill(0),o=Array(s);let i,a,l,c=lu(t,0);for(i=0;i<s;++i)if(a=l,l=c,c=lu(t,i+1),!!l){if(c){const u=c[e]-l[e];r[i]=u!==0?(c[n]-l[n])/u:0}o[i]=a?c?iu(r[i-1])!==iu(r[i])?0:(r[i-1]+r[i])/2:r[i-1]:r[i]}bwe(t,r,o),vwe(t,o,e)}function am(t,e,n){return Math.max(Math.min(t,n),e)}function kwe(t,e){let n,s,r,o,i,a=ti(t[0],e);for(n=0,s=t.length;n<s;++n)i=o,o=a,a=n<s-1&&ti(t[n+1],e),o&&(r=t[n],i&&(r.cp1x=am(r.cp1x,e.left,e.right),r.cp1y=am(r.cp1y,e.top,e.bottom)),a&&(r.cp2x=am(r.cp2x,e.left,e.right),r.cp2y=am(r.cp2y,e.top,e.bottom)))}function Cwe(t,e,n,s,r){let o,i,a,l;if(e.spanGaps&&(t=t.filter(c=>!c.skip)),e.cubicInterpolationMode==="monotone")wwe(t,r);else{let c=s?t[t.length-1]:t[0];for(o=0,i=t.length;o<i;++o)a=t[o],l=ywe(c,a,t[Math.min(o+1,i-(s?0:1))%i],e.tension),a.cp1x=l.previous.x,a.cp1y=l.previous.y,a.cp2x=l.next.x,a.cp2y=l.next.y,c=a}e.capBezierPoints&&kwe(t,n)}function uI(){return typeof window<"u"&&typeof document<"u"}function dI(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function i0(t,e,n){let s;return typeof t=="string"?(s=parseInt(t,10),t.indexOf("%")!==-1&&(s=s/100*e.parentNode[n])):s=t,s}const Qy=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function Swe(t,e){return Qy(t).getPropertyValue(e)}const $we=["top","right","bottom","left"];function rl(t,e,n){const s={};n=n?"-"+n:"";for(let r=0;r<4;r++){const o=$we[r];s[o]=parseFloat(t[e+"-"+o+n])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Iwe=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function Twe(t,e){const n=t.touches,s=n&&n.length?n[0]:t,{offsetX:r,offsetY:o}=s;let i=!1,a,l;if(Iwe(r,o,t.target))a=r,l=o;else{const c=e.getBoundingClientRect();a=s.clientX-c.left,l=s.clientY-c.top,i=!0}return{x:a,y:l,box:i}}function La(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:s}=e,r=Qy(n),o=r.boxSizing==="border-box",i=rl(r,"padding"),a=rl(r,"border","width"),{x:l,y:c,box:u}=Twe(t,n),d=i.left+(u&&a.left),h=i.top+(u&&a.top);let{width:f,height:p}=e;return o&&(f-=i.width+a.width,p-=i.height+a.height),{x:Math.round((l-d)/f*n.width/s),y:Math.round((c-h)/p*n.height/s)}}function Ewe(t,e,n){let s,r;if(e===void 0||n===void 0){const o=t&&dI(t);if(!o)e=t.clientWidth,n=t.clientHeight;else{const i=o.getBoundingClientRect(),a=Qy(o),l=rl(a,"border","width"),c=rl(a,"padding");e=i.width-c.width-l.width,n=i.height-c.height-l.height,s=i0(a.maxWidth,o,"clientWidth"),r=i0(a.maxHeight,o,"clientHeight")}}return{width:e,height:n,maxWidth:s||s0,maxHeight:r||s0}}const lm=t=>Math.round(t*10)/10;function Nwe(t,e,n,s){const r=Qy(t),o=rl(r,"margin"),i=i0(r.maxWidth,t,"clientWidth")||s0,a=i0(r.maxHeight,t,"clientHeight")||s0,l=Ewe(t,e,n);let{width:c,height:u}=l;if(r.boxSizing==="content-box"){const h=rl(r,"border","width"),f=rl(r,"padding");c-=f.width+h.width,u-=f.height+h.height}return c=Math.max(0,c-o.width),u=Math.max(0,s?c/s:u-o.height),c=lm(Math.min(c,i,l.maxWidth)),u=lm(Math.min(u,a,l.maxHeight)),c&&!u&&(u=lm(c/2)),(e!==void 0||n!==void 0)&&s&&l.height&&u>l.height&&(u=l.height,c=lm(Math.floor(u*s))),{width:c,height:u}}function AN(t,e,n){const s=e||1,r=Math.floor(t.height*s),o=Math.floor(t.width*s);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const i=t.canvas;return i.style&&(n||!i.style.height&&!i.style.width)&&(i.style.height=`${t.height}px`,i.style.width=`${t.width}px`),t.currentDevicePixelRatio!==s||i.height!==r||i.width!==o?(t.currentDevicePixelRatio=s,i.height=r,i.width=o,t.ctx.setTransform(s,0,0,s,0,0),!0):!1}const _we=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};uI()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function DN(t,e){const n=Swe(t,e),s=n&&n.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function za(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:t.y+n*(e.y-t.y)}}function Rwe(t,e,n,s){return{x:t.x+n*(e.x-t.x),y:s==="middle"?n<.5?t.y:e.y:s==="after"?n<1?t.y:e.y:n>0?e.y:t.y}}function Awe(t,e,n,s){const r={x:t.cp2x,y:t.cp2y},o={x:e.cp1x,y:e.cp1y},i=za(t,r,n),a=za(r,o,n),l=za(o,e,n),c=za(i,a,n),u=za(a,l,n);return za(c,u,n)}const Dwe=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,s){return n-s},leftForLtr(n,s){return n-s}}},Fwe=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Pc(t,e,n){return t?Dwe(e,n):Fwe()}function $B(t,e){let n,s;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,s=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=s)}function IB(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function TB(t){return t==="angle"?{between:fB,compare:Rve,normalize:jr}:{between:xd,compare:(e,n)=>e-n,normalize:e=>e}}function FN({start:t,end:e,count:n,loop:s,style:r}){return{start:t%n,end:e%n,loop:s&&(e-t+1)%n===0,style:r}}function Owe(t,e,n){const{property:s,start:r,end:o}=n,{between:i,normalize:a}=TB(s),l=e.length;let{start:c,end:u,loop:d}=t,h,f;if(d){for(c+=l,u+=l,h=0,f=l;h<f&&i(a(e[c%l][s]),r,o);++h)c--,u--;c%=l,u%=l}return u<c&&(u+=l),{start:c,end:u,loop:d,style:t.style}}function Pwe(t,e,n){if(!n)return[t];const{property:s,start:r,end:o}=n,i=e.length,{compare:a,between:l,normalize:c}=TB(s),{start:u,end:d,loop:h,style:f}=Owe(t,e,n),p=[];let m=!1,x=null,g,y,b;const v=()=>l(r,b,g)&&a(r,b)!==0,w=()=>a(o,g)===0||l(o,b,g),k=()=>m||v(),C=()=>!m||w();for(let S=u,I=u;S<=d;++S)y=e[S%i],!y.skip&&(g=c(y[s]),g!==b&&(m=l(g,r,o),x===null&&k()&&(x=a(g,r)===0?S:I),x!==null&&C()&&(p.push(FN({start:x,end:S,loop:h,count:i,style:f})),x=null),I=S,b=g));return x!==null&&p.push(FN({start:x,end:d,loop:h,count:i,style:f})),p}function Mwe(t,e){const n=[],s=t.segments;for(let r=0;r<s.length;r++){const o=Pwe(s[r],t.points,e);o.length&&n.push(...o)}return n}function Lwe(t,e,n,s){let r=0,o=e-1;if(n&&!s)for(;r<e&&!t[r].skip;)r++;for(;r<e&&t[r].skip;)r++;for(r%=e,n&&(o+=r);o>r&&t[o%e].skip;)o--;return o%=e,{start:r,end:o}}function zwe(t,e,n,s){const r=t.length,o=[];let i=e,a=t[e],l;for(l=e+1;l<=n;++l){const c=t[l%r];c.skip||c.stop?a.skip||(s=!1,o.push({start:e%r,end:(l-1)%r,loop:s}),e=i=c.stop?l:null):(i=l,a.skip&&(e=l)),a=c}return i!==null&&o.push({start:e%r,end:i%r,loop:s}),o}function Bwe(t,e){const n=t.points,s=t.options.spanGaps,r=n.length;if(!r)return[];const o=!!t._loop,{start:i,end:a}=Lwe(n,r,o,s);if(s===!0)return ON(t,[{start:i,end:a,loop:o}],n,e);const l=a<i?a+r:a,c=!!t._fullLoop&&i===0&&a===r-1;return ON(t,zwe(n,i,l,c),n,e)}function ON(t,e,n,s){return!s||!s.setContext||!n?e:Vwe(t,e,n,s)}function Vwe(t,e,n,s){const r=t._chart.getContext(),o=PN(t.options),{_datasetIndex:i,options:{spanGaps:a}}=t,l=n.length,c=[];let u=o,d=e[0].start,h=d;function f(p,m,x,g){const y=a?-1:1;if(p!==m){for(p+=l;n[p%l].skip;)p-=y;for(;n[m%l].skip;)m+=y;p%l!==m%l&&(c.push({start:p%l,end:m%l,loop:x,style:g}),u=g,d=m%l)}}for(const p of e){d=a?d:p.start;let m=n[d%l],x;for(h=d+1;h<=p.end;h++){const g=n[h%l];x=PN(s.setContext(Sa(r,{type:"segment",p0:m,p1:g,p0DataIndex:(h-1)%l,p1DataIndex:h%l,datasetIndex:i}))),Wwe(x,u)&&f(d,h-1,p.loop,u),m=g,u=x}d<h-1&&f(d,h-1,p.loop,u)}return c}function PN(t){return{backgroundColor:t.backgroundColor,borderCapStyle:t.borderCapStyle,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderJoinStyle:t.borderJoinStyle,borderWidth:t.borderWidth,borderColor:t.borderColor}}function Wwe(t,e){if(!e)return!1;const n=[],s=function(r,o){return sI(o)?(n.includes(o)||n.push(o),n.indexOf(o)):o};return JSON.stringify(t,s)!==JSON.stringify(e,s)}function cm(t,e,n){return t.options.clip?t[n]:e[n]}function Uwe(t,e){const{xScale:n,yScale:s}=t;return n&&s?{left:cm(n,e,"left"),right:cm(n,e,"right"),top:cm(s,e,"top"),bottom:cm(s,e,"bottom")}:e}function Hwe(t,e){const n=e._clip;if(n.disabled)return!1;const s=Uwe(e,t.chartArea);return{left:n.left===!1?0:s.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:s.right+(n.right===!0?0:n.right),top:n.top===!1?0:s.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:s.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.4.9
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class Gwe{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,s,r){const o=n.listeners[r],i=n.duration;o.forEach(a=>a({chart:e,initial:n.initial,numSteps:i,currentStep:Math.min(s-n.start,i)}))}_refresh(){this._request||(this._running=!0,this._request=mB.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const o=s.items;let i=o.length-1,a=!1,l;for(;i>=0;--i)l=o[i],l._active?(l._total>s.duration&&(s.duration=l._total),l.tick(e),a=!0):(o[i]=o[o.length-1],o.pop());a&&(r.draw(),this._notify(r,s,e,"progress")),o.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),n+=o.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let s=n.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,s)),s}listen(e,n,s){this._getAnims(e).listeners[n].push(s)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const s=n.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Go=new Gwe;const MN="transparent",jwe={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const s=TN(t||MN),r=s.valid&&TN(e||MN);return r&&r.valid?r.mix(s,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class Kwe{constructor(e,n,s,r){const o=n[s];r=im([e.to,r,o,e.from]);const i=im([e.from,o,r]);this._active=!0,this._fn=e.fn||jwe[e.type||typeof i],this._easing=Vd[e.easing]||Vd.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=s,this._from=i,this._to=r,this._promises=void 0}active(){return this._active}update(e,n,s){if(this._active){this._notify(!1);const r=this._target[this._prop],o=s-this._start,i=this._duration-o;this._start=s,this._duration=Math.floor(Math.max(i,e.duration)),this._total+=o,this._loop=!!e.loop,this._to=im([e.to,n,r,e.from]),this._from=im([e.from,r,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,s=this._duration,r=this._prop,o=this._from,i=this._loop,a=this._to;let l;if(this._active=o!==a&&(i||n<s),!this._active){this._target[r]=a,this._notify(!0);return}if(n<0){this._target[r]=o;return}l=n/s%2,l=i&&l>1?2-l:l,l=this._easing(Math.min(1,Math.max(0,l))),this._target[r]=this._fn(o,a,l)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,s)=>{e.push({res:n,rej:s})})}_notify(e){const n=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][n]()}}class EB{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!dt(e))return;const n=Object.keys(en.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const o=e[r];if(!dt(o))return;const i={};for(const a of n)i[a]=o[a];(jt(o.properties)&&o.properties||[r]).forEach(a=>{(a===r||!s.has(a))&&s.set(a,i)})})}_animateOptions(e,n){const s=n.options,r=qwe(e,s);if(!r)return[];const o=this._createAnimations(r,s);return s.$shared&&Xwe(e.options.$animations,s).then(()=>{e.options=s},()=>{}),o}_createAnimations(e,n){const s=this._properties,r=[],o=e.$animations||(e.$animations={}),i=Object.keys(n),a=Date.now();let l;for(l=i.length-1;l>=0;--l){const c=i[l];if(c.charAt(0)==="$")continue;if(c==="options"){r.push(...this._animateOptions(e,n));continue}const u=n[c];let d=o[c];const h=s.get(c);if(d)if(h&&d.active()){d.update(h,u,a);continue}else d.cancel();if(!h||!h.duration){e[c]=u;continue}o[c]=d=new Kwe(h,e,c,u),r.push(d)}return r}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const s=this._createAnimations(e,n);if(s.length)return Go.add(this._chart,s),!0}}function Xwe(t,e){const n=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const o=t[s[r]];o&&o.active()&&n.push(o.wait())}return Promise.all(n)}function qwe(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function LN(t,e){const n=t&&t.options||{},s=n.reverse,r=n.min===void 0?e:0,o=n.max===void 0?e:0;return{start:s?o:r,end:s?r:o}}function Ywe(t,e,n){if(n===!1)return!1;const s=LN(t,n),r=LN(e,n);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function Qwe(t){let e,n,s,r;return dt(t)?(e=t.top,n=t.right,s=t.bottom,r=t.left):e=n=s=r=t,{top:e,right:n,bottom:s,left:r,disabled:t===!1}}function NB(t,e){const n=[],s=t._getSortedDatasetMetas(e);let r,o;for(r=0,o=s.length;r<o;++r)n.push(s[r].index);return n}function zN(t,e,n,s={}){const r=t.keys,o=s.mode==="single";let i,a,l,c;if(e===null)return;let u=!1;for(i=0,a=r.length;i<a;++i){if(l=+r[i],l===n){if(u=!0,s.all)continue;break}c=t.values[l],On(c)&&(o||e===0||iu(e)===iu(c))&&(e+=c)}return!u&&!s.all?0:e}function Zwe(t,e){const{iScale:n,vScale:s}=e,r=n.axis==="x"?"x":"y",o=s.axis==="x"?"x":"y",i=Object.keys(t),a=new Array(i.length);let l,c,u;for(l=0,c=i.length;l<c;++l)u=i[l],a[l]={[r]:u,[o]:t[u]};return a}function m1(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function Jwe(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function eke(t){const{min:e,max:n,minDefined:s,maxDefined:r}=t.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?n:Number.POSITIVE_INFINITY}}function tke(t,e,n){const s=t[e]||(t[e]={});return s[n]||(s[n]={})}function BN(t,e,n,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const o=t[r.index];if(n&&o>0||!n&&o<0)return r.index}return null}function VN(t,e){const{chart:n,_cachedMeta:s}=t,r=n._stacks||(n._stacks={}),{iScale:o,vScale:i,index:a}=s,l=o.axis,c=i.axis,u=Jwe(o,i,s),d=e.length;let h;for(let f=0;f<d;++f){const p=e[f],{[l]:m,[c]:x}=p,g=p._stacks||(p._stacks={});h=g[c]=tke(r,u,m),h[a]=x,h._top=BN(h,i,!0,s.type),h._bottom=BN(h,i,!1,s.type);const y=h._visualValues||(h._visualValues={});y[a]=x}}function g1(t,e){const n=t.scales;return Object.keys(n).filter(s=>n[s].axis===e).shift()}function nke(t,e){return Sa(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function ske(t,e,n){return Sa(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function Ju(t,e){const n=t.controller.index,s=t.vScale&&t.vScale.axis;if(s){e=e||t._parsed;for(const r of e){const o=r._stacks;if(!o||o[s]===void 0||o[s][n]===void 0)return;delete o[s][n],o[s]._visualValues!==void 0&&o[s]._visualValues[n]!==void 0&&delete o[s]._visualValues[n]}}}const x1=t=>t==="reset"||t==="none",WN=(t,e)=>e?t:Object.assign({},t),rke=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:NB(n,!0),values:null};class Ud{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=m1(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Ju(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,s=this.getDataset(),r=(d,h,f,p)=>d==="x"?h:d==="r"?p:f,o=n.xAxisID=et(s.xAxisID,g1(e,"x")),i=n.yAxisID=et(s.yAxisID,g1(e,"y")),a=n.rAxisID=et(s.rAxisID,g1(e,"r")),l=n.indexAxis,c=n.iAxisID=r(l,o,i,a),u=n.vAxisID=r(l,i,o,a);n.xScale=this.getScaleForId(o),n.yScale=this.getScaleForId(i),n.rScale=this.getScaleForId(a),n.iScale=this.getScaleForId(c),n.vScale=this.getScaleForId(u)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&SN(this._data,this),e._stacked&&Ju(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),s=this._data;if(dt(n)){const r=this._cachedMeta;this._data=Zwe(n,r)}else if(s!==n){if(s){SN(s,this);const r=this._cachedMeta;Ju(r),r._parsed=[]}n&&Object.isExtensible(n)&&Ove(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const o=n._stacked;n._stacked=m1(n.vScale,n),n.stack!==s.stack&&(r=!0,Ju(n),n.stack=s.stack),this._resyncElements(e),(r||o!==n._stacked)&&(VN(this,n._parsed),n._stacked=m1(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:s,_data:r}=this,{iScale:o,_stacked:i}=s,a=o.axis;let l=e===0&&n===r.length?!0:s._sorted,c=e>0&&s._parsed[e-1],u,d,h;if(this._parsing===!1)s._parsed=r,s._sorted=!0,h=r;else{jt(r[e])?h=this.parseArrayData(s,r,e,n):dt(r[e])?h=this.parseObjectData(s,r,e,n):h=this.parsePrimitiveData(s,r,e,n);const f=()=>d[a]===null||c&&d[a]<c[a];for(u=0;u<n;++u)s._parsed[u+e]=d=h[u],l&&(f()&&(l=!1),c=d);s._sorted=l}i&&VN(this,h)}parsePrimitiveData(e,n,s,r){const{iScale:o,vScale:i}=e,a=o.axis,l=i.axis,c=o.getLabels(),u=o===i,d=new Array(r);let h,f,p;for(h=0,f=r;h<f;++h)p=h+s,d[h]={[a]:u||o.parse(c[p],p),[l]:i.parse(n[p],p)};return d}parseArrayData(e,n,s,r){const{xScale:o,yScale:i}=e,a=new Array(r);let l,c,u,d;for(l=0,c=r;l<c;++l)u=l+s,d=n[u],a[l]={x:o.parse(d[0],u),y:i.parse(d[1],u)};return a}parseObjectData(e,n,s,r){const{xScale:o,yScale:i}=e,{xAxisKey:a="x",yAxisKey:l="y"}=this._parsing,c=new Array(r);let u,d,h,f;for(u=0,d=r;u<d;++u)h=u+s,f=n[h],c[u]={x:o.parse(t0(f,a),h),y:i.parse(t0(f,l),h)};return c}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,s){const r=this.chart,o=this._cachedMeta,i=n[e.axis],a={keys:NB(r,!0),values:n._stacks[e.axis]._visualValues};return zN(a,i,o.index,{mode:s})}updateRangeFromParsed(e,n,s,r){const o=s[n.axis];let i=o===null?NaN:o;const a=r&&s._stacks[n.axis];r&&a&&(r.values=a,i=zN(r,o,this._cachedMeta.index)),e.min=Math.min(e.min,i),e.max=Math.max(e.max,i)}getMinMax(e,n){const s=this._cachedMeta,r=s._parsed,o=s._sorted&&e===s.iScale,i=r.length,a=this._getOtherScale(e),l=rke(n,s,this.chart),c={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:u,max:d}=eke(a);let h,f;function p(){f=r[h];const m=f[a.axis];return!On(f[e.axis])||u>m||d<m}for(h=0;h<i&&!(!p()&&(this.updateRangeFromParsed(c,e,f,l),o));++h);if(o){for(h=i-1;h>=0;--h)if(!p()){this.updateRangeFromParsed(c,e,f,l);break}}return c}getAllParsedValues(e){const n=this._cachedMeta._parsed,s=[];let r,o,i;for(r=0,o=n.length;r<o;++r)i=n[r][e.axis],On(i)&&s.push(i);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,s=n.iScale,r=n.vScale,o=this.getParsed(e);return{label:s?""+s.getLabelForValue(o[s.axis]):"",value:r?""+r.getLabelForValue(o[r.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=Qwe(et(this.options.clip,Ywe(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,s=this._cachedMeta,r=s.data||[],o=n.chartArea,i=[],a=this._drawStart||0,l=this._drawCount||r.length-a,c=this.options.drawActiveElementsOnTop;let u;for(s.dataset&&s.dataset.draw(e,o,a,l),u=a;u<a+l;++u){const d=r[u];d.hidden||(d.active&&c?i.push(d):d.draw(e,o))}for(u=0;u<i.length;++u)i[u].draw(e,o)}getStyle(e,n){const s=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,n,s){const r=this.getDataset();let o;if(e>=0&&e<this._cachedMeta.data.length){const i=this._cachedMeta.data[e];o=i.$context||(i.$context=ske(this.getContext(),e,i)),o.parsed=this.getParsed(e),o.raw=r.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=nke(this.chart.getContext(),this.index)),o.dataset=r,o.index=o.datasetIndex=this.index;return o.active=!!n,o.mode=s,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",s){const r=n==="active",o=this._cachedDataOpts,i=e+"-"+n,a=o[i],l=this.enableOptionSharing&&n0(s);if(a)return WN(a,l);const c=this.chart.config,u=c.datasetElementScopeKeys(this._type,e),d=r?[`${e}Hover`,"hover",e,""]:[e,""],h=c.getOptionScopes(this.getDataset(),u),f=Object.keys(en.elements[e]),p=()=>this.getContext(s,r,n),m=c.resolveNamedOptions(h,f,p,d);return m.$shared&&(m.$shared=l,o[i]=Object.freeze(WN(m,l))),m}_resolveAnimations(e,n,s){const r=this.chart,o=this._cachedDataOpts,i=`animation-${n}`,a=o[i];if(a)return a;let l;if(r.options.animation!==!1){const u=this.chart.config,d=u.datasetAnimationScopeKeys(this._type,n),h=u.getOptionScopes(this.getDataset(),d);l=u.createResolver(h,this.getContext(e,s,n))}const c=new EB(r,l&&l.animations);return l&&l._cacheable&&(o[i]=Object.freeze(c)),c}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||x1(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const s=this.resolveDataElementOptions(e,n),r=this._sharedOptions,o=this.getSharedOptions(s),i=this.includeOptions(n,o)||o!==r;return this.updateSharedOptions(o,n,s),{sharedOptions:o,includeOptions:i}}updateElement(e,n,s,r){x1(r)?Object.assign(e,s):this._resolveAnimations(n,r).update(e,s)}updateSharedOptions(e,n,s){e&&!x1(n)&&this._resolveAnimations(void 0,n).update(e,s)}_setStyle(e,n,s,r){e.active=r;const o=this.getStyle(n,r);this._resolveAnimations(n,s,r).update(e,{options:!r&&this.getSharedOptions(o)||o})}removeHoverStyle(e,n,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,n,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,s=this._cachedMeta.data;for(const[a,l,c]of this._syncList)this[a](l,c);this._syncList=[];const r=s.length,o=n.length,i=Math.min(o,r);i&&this.parse(0,i),o>r?this._insertElements(r,o-r,e):o<r&&this._removeElements(o,r-o)}_insertElements(e,n,s=!0){const r=this._cachedMeta,o=r.data,i=e+n;let a;const l=c=>{for(c.length+=n,a=c.length-1;a>=i;a--)c[a]=c[a-n]};for(l(o),a=e;a<i;++a)o[a]=new this.dataElementType;this._parsing&&l(r._parsed),this.parse(e,n),s&&this.updateElements(o,e,n,"reset")}updateElements(e,n,s,r){}_removeElements(e,n){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,n);s._stacked&&Ju(s,r)}s.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,s,r]=e;this[n](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}Me(Ud,"defaults",{}),Me(Ud,"datasetElementType",null),Me(Ud,"dataElementType",null);class zm extends Ud{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const n=this._cachedMeta,{dataset:s,data:r=[],_dataset:o}=n,i=this.chart._animationsDisabled;let{start:a,count:l}=zve(n,r,i);this._drawStart=a,this._drawCount=l,Bve(n)&&(a=0,l=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!o._decimated,s.points=r;const c=this.resolveDatasetElementOptions(e);this.options.showLine||(c.borderWidth=0),c.segment=this.options.segment,this.updateElement(s,void 0,{animated:!i,options:c},e),this.updateElements(r,a,l,e)}updateElements(e,n,s,r){const o=r==="reset",{iScale:i,vScale:a,_stacked:l,_dataset:c}=this._cachedMeta,{sharedOptions:u,includeOptions:d}=this._getSharedOptions(n,r),h=i.axis,f=a.axis,{spanGaps:p,segment:m}=this.options,x=Sh(p)?p:Number.POSITIVE_INFINITY,g=this.chart._animationsDisabled||o||r==="none",y=n+s,b=e.length;let v=n>0&&this.getParsed(n-1);for(let w=0;w<b;++w){const k=e[w],C=g?k:{};if(w<n||w>=y){C.skip=!0;continue}const S=this.getParsed(w),I=gt(S[f]),$=C[h]=i.getPixelForValue(S[h],w),E=C[f]=o||I?a.getBasePixel():a.getPixelForValue(l?this.applyStack(a,S,l):S[f],w);C.skip=isNaN($)||isNaN(E)||I,C.stop=w>0&&Math.abs(S[h]-v[h])>x,m&&(C.parsed=S,C.raw=c.data[w]),d&&(C.options=u||this.resolveDataElementOptions(w,k.active?"active":r)),g||this.updateElement(k,w,C,r),v=S}}getMaxOverflow(){const e=this._cachedMeta,n=e.dataset,s=n.options&&n.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const o=r[0].size(this.resolveDataElementOptions(0)),i=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,o,i)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}Me(zm,"id","line"),Me(zm,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),Me(zm,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function _a(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class hI{constructor(e){Me(this,"options");this.options=e||{}}static override(e){Object.assign(hI.prototype,e)}init(){}formats(){return _a()}parse(){return _a()}format(){return _a()}add(){return _a()}diff(){return _a()}startOf(){return _a()}endOf(){return _a()}}var oke={_date:hI};function ike(t,e,n,s){const{controller:r,data:o,_sorted:i}=t,a=r._cachedMeta.iScale,l=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(a&&e===a.axis&&e!=="r"&&i&&o.length){const c=a._reversePixels?Dve:Ya;if(s){if(r._sharedOptions){const u=o[0],d=typeof u.getRange=="function"&&u.getRange(e);if(d){const h=c(o,e,n-d),f=c(o,e,n+d);return{lo:h.lo,hi:f.hi}}}}else{const u=c(o,e,n);if(l){const{vScale:d}=r._cachedMeta,{_parsed:h}=t,f=h.slice(0,u.lo+1).reverse().findIndex(m=>!gt(m[d.axis]));u.lo-=Math.max(0,f);const p=h.slice(u.hi).findIndex(m=>!gt(m[d.axis]));u.hi+=Math.max(0,p)}return u}}return{lo:0,hi:o.length-1}}function cp(t,e,n,s,r){const o=t.getSortedVisibleDatasetMetas(),i=n[e];for(let a=0,l=o.length;a<l;++a){const{index:c,data:u}=o[a],{lo:d,hi:h}=ike(o[a],e,i,r);for(let f=d;f<=h;++f){const p=u[f];p.skip||s(p,c,f)}}}function ake(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(s,r){const o=e?Math.abs(s.x-r.x):0,i=n?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(o,2)+Math.pow(i,2))}}function y1(t,e,n,s,r){const o=[];return!r&&!t.isPointInArea(e)||cp(t,n,e,function(a,l,c){!r&&!ti(a,t.chartArea,0)||a.inRange(e.x,e.y,s)&&o.push({element:a,datasetIndex:l,index:c})},!0),o}function lke(t,e,n,s){let r=[];function o(i,a,l){const{startAngle:c,endAngle:u}=i.getProps(["startAngle","endAngle"],s),{angle:d}=_ve(i,{x:e.x,y:e.y});fB(d,c,u)&&r.push({element:i,datasetIndex:a,index:l})}return cp(t,n,e,o),r}function cke(t,e,n,s,r,o){let i=[];const a=ake(n);let l=Number.POSITIVE_INFINITY;function c(u,d,h){const f=u.inRange(e.x,e.y,r);if(s&&!f)return;const p=u.getCenterPoint(r);if(!(!!o||t.isPointInArea(p))&&!f)return;const x=a(e,p);x<l?(i=[{element:u,datasetIndex:d,index:h}],l=x):x===l&&i.push({element:u,datasetIndex:d,index:h})}return cp(t,n,e,c),i}function b1(t,e,n,s,r,o){return!o&&!t.isPointInArea(e)?[]:n==="r"&&!s?lke(t,e,n,r):cke(t,e,n,s,r,o)}function UN(t,e,n,s,r){const o=[],i=n==="x"?"inXRange":"inYRange";let a=!1;return cp(t,n,e,(l,c,u)=>{l[i]&&l[i](e[n],r)&&(o.push({element:l,datasetIndex:c,index:u}),a=a||l.inRange(e.x,e.y,r))}),s&&!a?[]:o}var uke={evaluateInteractionItems:cp,modes:{index(t,e,n,s){const r=La(e,t),o=n.axis||"x",i=n.includeInvisible||!1,a=n.intersect?y1(t,r,o,s,i):b1(t,r,o,!1,s,i),l=[];return a.length?(t.getSortedVisibleDatasetMetas().forEach(c=>{const u=a[0].index,d=c.data[u];d&&!d.skip&&l.push({element:d,datasetIndex:c.index,index:u})}),l):[]},dataset(t,e,n,s){const r=La(e,t),o=n.axis||"xy",i=n.includeInvisible||!1;let a=n.intersect?y1(t,r,o,s,i):b1(t,r,o,!1,s,i);if(a.length>0){const l=a[0].datasetIndex,c=t.getDatasetMeta(l).data;a=[];for(let u=0;u<c.length;++u)a.push({element:c[u],datasetIndex:l,index:u})}return a},point(t,e,n,s){const r=La(e,t),o=n.axis||"xy",i=n.includeInvisible||!1;return y1(t,r,o,s,i)},nearest(t,e,n,s){const r=La(e,t),o=n.axis||"xy",i=n.includeInvisible||!1;return b1(t,r,o,n.intersect,s,i)},x(t,e,n,s){const r=La(e,t);return UN(t,r,"x",n.intersect,s)},y(t,e,n,s){const r=La(e,t);return UN(t,r,"y",n.intersect,s)}}};const _B=["left","top","right","bottom"];function ed(t,e){return t.filter(n=>n.pos===e)}function HN(t,e){return t.filter(n=>_B.indexOf(n.pos)===-1&&n.box.axis===e)}function td(t,e){return t.sort((n,s)=>{const r=e?s:n,o=e?n:s;return r.weight===o.weight?r.index-o.index:r.weight-o.weight})}function dke(t){const e=[];let n,s,r,o,i,a;for(n=0,s=(t||[]).length;n<s;++n)r=t[n],{position:o,options:{stack:i,stackWeight:a=1}}=r,e.push({index:n,box:r,pos:o,horizontal:r.isHorizontal(),weight:r.weight,stack:i&&o+i,stackWeight:a});return e}function hke(t){const e={};for(const n of t){const{stack:s,pos:r,stackWeight:o}=n;if(!s||!_B.includes(r))continue;const i=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});i.count++,i.weight+=o}return e}function fke(t,e){const n=hke(t),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let o,i,a;for(o=0,i=t.length;o<i;++o){a=t[o];const{fullSize:l}=a.box,c=n[a.stack],u=c&&a.stackWeight/c.weight;a.horizontal?(a.width=u?u*s:l&&e.availableWidth,a.height=r):(a.width=s,a.height=u?u*r:l&&e.availableHeight)}return n}function pke(t){const e=dke(t),n=td(e.filter(c=>c.box.fullSize),!0),s=td(ed(e,"left"),!0),r=td(ed(e,"right")),o=td(ed(e,"top"),!0),i=td(ed(e,"bottom")),a=HN(e,"x"),l=HN(e,"y");return{fullSize:n,leftAndTop:s.concat(o),rightAndBottom:r.concat(l).concat(i).concat(a),chartArea:ed(e,"chartArea"),vertical:s.concat(r).concat(l),horizontal:o.concat(i).concat(a)}}function GN(t,e,n,s){return Math.max(t[n],e[n])+Math.max(t[s],e[s])}function RB(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function mke(t,e,n,s){const{pos:r,box:o}=n,i=t.maxPadding;if(!dt(r)){n.size&&(t[r]-=n.size);const d=s[n.stack]||{size:0,count:1};d.size=Math.max(d.size,n.horizontal?o.height:o.width),n.size=d.size/d.count,t[r]+=n.size}o.getPadding&&RB(i,o.getPadding());const a=Math.max(0,e.outerWidth-GN(i,t,"left","right")),l=Math.max(0,e.outerHeight-GN(i,t,"top","bottom")),c=a!==t.w,u=l!==t.h;return t.w=a,t.h=l,n.horizontal?{same:c,other:u}:{same:u,other:c}}function gke(t){const e=t.maxPadding;function n(s){const r=Math.max(e[s]-t[s],0);return t[s]+=r,r}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function xke(t,e){const n=e.maxPadding;function s(r){const o={left:0,top:0,right:0,bottom:0};return r.forEach(i=>{o[i]=Math.max(e[i],n[i])}),o}return s(t?["left","right"]:["top","bottom"])}function yd(t,e,n,s){const r=[];let o,i,a,l,c,u;for(o=0,i=t.length,c=0;o<i;++o){a=t[o],l=a.box,l.update(a.width||e.w,a.height||e.h,xke(a.horizontal,e));const{same:d,other:h}=mke(e,n,a,s);c|=d&&r.length,u=u||h,l.fullSize||r.push(a)}return c&&yd(r,e,n,s)||u}function um(t,e,n,s,r){t.top=n,t.left=e,t.right=e+s,t.bottom=n+r,t.width=s,t.height=r}function jN(t,e,n,s){const r=n.padding;let{x:o,y:i}=e;for(const a of t){const l=a.box,c=s[a.stack]||{count:1,placed:0,weight:1},u=a.stackWeight/c.weight||1;if(a.horizontal){const d=e.w*u,h=c.size||l.height;n0(c.start)&&(i=c.start),l.fullSize?um(l,r.left,i,n.outerWidth-r.right-r.left,h):um(l,e.left+c.placed,i,d,h),c.start=i,c.placed+=d,i=l.bottom}else{const d=e.h*u,h=c.size||l.width;n0(c.start)&&(o=c.start),l.fullSize?um(l,o,r.top,h,n.outerHeight-r.bottom-r.top):um(l,o,e.top+c.placed,h,d),c.start=o,c.placed+=d,o=l.right}}e.x=o,e.y=i}var Er={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,s){if(!t)return;const r=fs(t.options.layout.padding),o=Math.max(e-r.width,0),i=Math.max(n-r.height,0),a=pke(t.boxes),l=a.vertical,c=a.horizontal;mt(t.boxes,m=>{typeof m.beforeLayout=="function"&&m.beforeLayout()});const u=l.reduce((m,x)=>x.box.options&&x.box.options.display===!1?m:m+1,0)||1,d=Object.freeze({outerWidth:e,outerHeight:n,padding:r,availableWidth:o,availableHeight:i,vBoxMaxWidth:o/2/u,hBoxMaxHeight:i/2}),h=Object.assign({},r);RB(h,fs(s));const f=Object.assign({maxPadding:h,w:o,h:i,x:r.left,y:r.top},r),p=fke(l.concat(c),d);yd(a.fullSize,f,d,p),yd(l,f,d,p),yd(c,f,d,p)&&yd(l,f,d,p),gke(f),jN(a.leftAndTop,f,d,p),f.x+=f.w,f.y+=f.h,jN(a.rightAndBottom,f,d,p),t.chartArea={left:f.left,top:f.top,right:f.left+f.w,bottom:f.top+f.h,height:f.h,width:f.w},mt(a.chartArea,m=>{const x=m.box;Object.assign(x,t.chartArea),x.update(f.w,f.h,{left:0,top:0,right:0,bottom:0})})}};class AB{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,s){}removeEventListener(e,n,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,s,r){return n=Math.max(0,n||e.width),s=s||e.height,{width:n,height:Math.max(0,r?Math.floor(n/r):s)}}isAttached(e){return!0}updateConfig(e){}}class yke extends AB{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Bm="$chartjs",bke={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},KN=t=>t===null||t==="";function vke(t,e){const n=t.style,s=t.getAttribute("height"),r=t.getAttribute("width");if(t[Bm]={initial:{height:s,width:r,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",KN(r)){const o=DN(t,"width");o!==void 0&&(t.width=o)}if(KN(s))if(t.style.height==="")t.height=t.width/(e||2);else{const o=DN(t,"height");o!==void 0&&(t.height=o)}return t}const DB=_we?{passive:!0}:!1;function wke(t,e,n){t&&t.addEventListener(e,n,DB)}function kke(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,DB)}function Cke(t,e){const n=bke[t.type]||t.type,{x:s,y:r}=La(t,e);return{type:n,chart:e,native:t,x:s!==void 0?s:null,y:r!==void 0?r:null}}function a0(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function Ske(t,e,n){const s=t.canvas,r=new MutationObserver(o=>{let i=!1;for(const a of o)i=i||a0(a.addedNodes,s),i=i&&!a0(a.removedNodes,s);i&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}function $ke(t,e,n){const s=t.canvas,r=new MutationObserver(o=>{let i=!1;for(const a of o)i=i||a0(a.removedNodes,s),i=i&&!a0(a.addedNodes,s);i&&n()});return r.observe(document,{childList:!0,subtree:!0}),r}const $h=new Map;let XN=0;function FB(){const t=window.devicePixelRatio;t!==XN&&(XN=t,$h.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function Ike(t,e){$h.size||window.addEventListener("resize",FB),$h.set(t,e)}function Tke(t){$h.delete(t),$h.size||window.removeEventListener("resize",FB)}function Eke(t,e,n){const s=t.canvas,r=s&&dI(s);if(!r)return;const o=gB((a,l)=>{const c=r.clientWidth;n(a,l),c<r.clientWidth&&n()},window),i=new ResizeObserver(a=>{const l=a[0],c=l.contentRect.width,u=l.contentRect.height;c===0&&u===0||o(c,u)});return i.observe(r),Ike(t,o),i}function v1(t,e,n){n&&n.disconnect(),e==="resize"&&Tke(t)}function Nke(t,e,n){const s=t.canvas,r=gB(o=>{t.ctx!==null&&n(Cke(o,t))},t);return wke(s,e,r),r}class _ke extends AB{acquireContext(e,n){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(vke(e,n),s):null}releaseContext(e){const n=e.canvas;if(!n[Bm])return!1;const s=n[Bm].initial;["height","width"].forEach(o=>{const i=s[o];gt(i)?n.removeAttribute(o):n.setAttribute(o,i)});const r=s.style||{};return Object.keys(r).forEach(o=>{n.style[o]=r[o]}),n.width=n.width,delete n[Bm],!0}addEventListener(e,n,s){this.removeEventListener(e,n);const r=e.$proxies||(e.$proxies={}),i={attach:Ske,detach:$ke,resize:Eke}[n]||Nke;r[n]=i(e,n,s)}removeEventListener(e,n){const s=e.$proxies||(e.$proxies={}),r=s[n];if(!r)return;({attach:v1,detach:v1,resize:v1}[n]||kke)(e,n,r),s[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,s,r){return Nwe(e,n,s,r)}isAttached(e){const n=e&&dI(e);return!!(n&&n.isConnected)}}function Rke(t){return!uI()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?yke:_ke}class fi{constructor(){Me(this,"x");Me(this,"y");Me(this,"active",!1);Me(this,"options");Me(this,"$animations")}tooltipPosition(e){const{x:n,y:s}=this.getProps(["x","y"],e);return{x:n,y:s}}hasValue(){return Sh(this.x)&&Sh(this.y)}getProps(e,n){const s=this.$animations;if(!n||!s)return this;const r={};return e.forEach(o=>{r[o]=s[o]&&s[o].active()?s[o]._to:this[o]}),r}}Me(fi,"defaults",{}),Me(fi,"defaultRoutes");function Ake(t,e){const n=t.options.ticks,s=Dke(t),r=Math.min(n.maxTicksLimit||s,s),o=n.major.enabled?Oke(e):[],i=o.length,a=o[0],l=o[i-1],c=[];if(i>r)return Pke(e,c,o,i/r),c;const u=Fke(o,e,r);if(i>0){let d,h;const f=i>1?Math.round((l-a)/(i-1)):null;for(dm(e,c,u,gt(f)?0:a-f,a),d=0,h=i-1;d<h;d++)dm(e,c,u,o[d],o[d+1]);return dm(e,c,u,l,gt(f)?e.length:l+f),c}return dm(e,c,u),c}function Dke(t){const e=t.options.offset,n=t._tickSize(),s=t._length/n+(e?0:1),r=t._maxLength/n;return Math.floor(Math.min(s,r))}function Fke(t,e,n){const s=Mke(t),r=e.length/n;if(!s)return Math.max(r,1);const o=Tve(s);for(let i=0,a=o.length-1;i<a;i++){const l=o[i];if(l>r)return l}return Math.max(r,1)}function Oke(t){const e=[];let n,s;for(n=0,s=t.length;n<s;n++)t[n].major&&e.push(n);return e}function Pke(t,e,n,s){let r=0,o=n[0],i;for(s=Math.ceil(s),i=0;i<t.length;i++)i===o&&(e.push(t[i]),r++,o=n[r*s])}function dm(t,e,n,s,r){const o=et(s,0),i=Math.min(et(r,t.length),t.length);let a=0,l,c,u;for(n=Math.ceil(n),r&&(l=r-s,n=l/Math.floor(l/n)),u=o;u<0;)a++,u=Math.round(o+a*n);for(c=Math.max(o,0);c<i;c++)c===u&&(e.push(t[c]),a++,u=Math.round(o+a*n))}function Mke(t){const e=t.length;let n,s;if(e<2)return!1;for(s=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==s)return!1;return s}const Lke=t=>t==="left"?"right":t==="right"?"left":t,qN=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,YN=(t,e)=>Math.min(e||t,t);function QN(t,e){const n=[],s=t.length/e,r=t.length;let o=0;for(;o<r;o+=s)n.push(t[Math.floor(o)]);return n}function zke(t,e,n){const s=t.ticks.length,r=Math.min(e,s-1),o=t._startPixel,i=t._endPixel,a=1e-6;let l=t.getPixelForTick(r),c;if(!(n&&(s===1?c=Math.max(l-o,i-l):e===0?c=(t.getPixelForTick(1)-l)/2:c=(l-t.getPixelForTick(r-1))/2,l+=r<e?c:-c,l<o-a||l>i+a)))return l}function Bke(t,e){mt(t,n=>{const s=n.gc,r=s.length/2;let o;if(r>e){for(o=0;o<r;++o)delete n.data[s[o]];s.splice(0,r)}})}function nd(t){return t.drawTicks?t.tickLength:0}function ZN(t,e){if(!t.display)return 0;const n=Rn(t.font,e),s=fs(t.padding);return(jt(t.text)?t.text.length:1)*n.lineHeight+s.height}function Vke(t,e){return Sa(t,{scale:e,type:"scale"})}function Wke(t,e,n){return Sa(t,{tick:n,index:e,type:"tick"})}function Uke(t,e,n){let s=nI(t);return(n&&e!=="right"||!n&&e==="right")&&(s=Lke(s)),s}function Hke(t,e,n,s){const{top:r,left:o,bottom:i,right:a,chart:l}=t,{chartArea:c,scales:u}=l;let d=0,h,f,p;const m=i-r,x=a-o;if(t.isHorizontal()){if(f=ss(s,o,a),dt(n)){const g=Object.keys(n)[0],y=n[g];p=u[g].getPixelForValue(y)+m-e}else n==="center"?p=(c.bottom+c.top)/2+m-e:p=qN(t,n,e);h=a-o}else{if(dt(n)){const g=Object.keys(n)[0],y=n[g];f=u[g].getPixelForValue(y)-x+e}else n==="center"?f=(c.left+c.right)/2-x+e:f=qN(t,n,e);p=ss(s,i,r),d=n==="left"?-Qs:Qs}return{titleX:f,titleY:p,maxWidth:h,rotation:d}}class Gl extends fi{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:s,_suggestedMax:r}=this;return e=Gs(e,Number.POSITIVE_INFINITY),n=Gs(n,Number.NEGATIVE_INFINITY),s=Gs(s,Number.POSITIVE_INFINITY),r=Gs(r,Number.NEGATIVE_INFINITY),{min:Gs(e,s),max:Gs(n,r),minDefined:On(e),maxDefined:On(n)}}getMinMax(e){let{min:n,max:s,minDefined:r,maxDefined:o}=this.getUserBounds(),i;if(r&&o)return{min:n,max:s};const a=this.getMatchingVisibleMetas();for(let l=0,c=a.length;l<c;++l)i=a[l].controller.getMinMax(this,e),r||(n=Math.min(n,i.min)),o||(s=Math.max(s,i.max));return n=o&&n>s?s:n,s=r&&n>s?n:s,{min:Gs(n,Gs(s,n)),max:Gs(s,Gs(n,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Tt(this.options.beforeUpdate,[this])}update(e,n,s){const{beginAtZero:r,grace:o,ticks:i}=this.options,a=i.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=awe(this,o,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const l=a<this.ticks.length;this._convertTicksToLabels(l?QN(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),i.display&&(i.autoSkip||i.source==="auto")&&(this.ticks=Ake(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),l&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,s;this.isHorizontal()?(n=this.left,s=this.right):(n=this.top,s=this.bottom,e=!e),this._startPixel=n,this._endPixel=s,this._reversePixels=e,this._length=s-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Tt(this.options.afterUpdate,[this])}beforeSetDimensions(){Tt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Tt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Tt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Tt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let s,r,o;for(s=0,r=e.length;s<r;s++)o=e[s],o.label=Tt(n.callback,[o.value,s,e],this)}afterTickToLabelConversion(){Tt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Tt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,s=YN(this.ticks.length,e.ticks.maxTicksLimit),r=n.minRotation||0,o=n.maxRotation;let i=r,a,l,c;if(!this._isVisible()||!n.display||r>=o||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const u=this._getLabelSizes(),d=u.widest.width,h=u.highest.height,f=Tr(this.chart.width-d,0,this.maxWidth);a=e.offset?this.maxWidth/s:f/(s-1),d+6>a&&(a=f/(s-(e.offset?.5:1)),l=this.maxHeight-nd(e.grid)-n.padding-ZN(e.title,this.chart.options.font),c=Math.sqrt(d*d+h*h),i=eI(Math.min(Math.asin(Tr((u.highest.height+6)/a,-1,1)),Math.asin(Tr(l/c,-1,1))-Math.asin(Tr(h/c,-1,1)))),i=Math.max(r,Math.min(o,i))),this.labelRotation=i}afterCalculateLabelRotation(){Tt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Tt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:s,title:r,grid:o}}=this,i=this._isVisible(),a=this.isHorizontal();if(i){const l=ZN(r,n.options.font);if(a?(e.width=this.maxWidth,e.height=nd(o)+l):(e.height=this.maxHeight,e.width=nd(o)+l),s.display&&this.ticks.length){const{first:c,last:u,widest:d,highest:h}=this._getLabelSizes(),f=s.padding*2,p=Bi(this.labelRotation),m=Math.cos(p),x=Math.sin(p);if(a){const g=s.mirror?0:x*d.width+m*h.height;e.height=Math.min(this.maxHeight,e.height+g+f)}else{const g=s.mirror?0:m*d.width+x*h.height;e.width=Math.min(this.maxWidth,e.width+g+f)}this._calculatePadding(c,u,x,m)}}this._handleMargins(),a?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,s,r){const{ticks:{align:o,padding:i},position:a}=this.options,l=this.labelRotation!==0,c=a!=="top"&&this.axis==="x";if(this.isHorizontal()){const u=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1);let h=0,f=0;l?c?(h=r*e.width,f=s*n.height):(h=s*e.height,f=r*n.width):o==="start"?f=n.width:o==="end"?h=e.width:o!=="inner"&&(h=e.width/2,f=n.width/2),this.paddingLeft=Math.max((h-u+i)*this.width/(this.width-u),0),this.paddingRight=Math.max((f-d+i)*this.width/(this.width-d),0)}else{let u=n.height/2,d=e.height/2;o==="start"?(u=0,d=e.height):o==="end"&&(u=n.height,d=0),this.paddingTop=u+i,this.paddingBottom=d+i}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Tt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,s;for(n=0,s=e.length;n<s;n++)gt(e[n].label)&&(e.splice(n,1),s--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let s=this.ticks;n<s.length&&(s=QN(s,n)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,s){const{ctx:r,_longestTextCache:o}=this,i=[],a=[],l=Math.floor(n/YN(n,s));let c=0,u=0,d,h,f,p,m,x,g,y,b,v,w;for(d=0;d<n;d+=l){if(p=e[d].label,m=this._resolveTickFontOptions(d),r.font=x=m.string,g=o[x]=o[x]||{data:{},gc:[]},y=m.lineHeight,b=v=0,!gt(p)&&!jt(p))b=r0(r,g.data,g.gc,b,p),v=y;else if(jt(p))for(h=0,f=p.length;h<f;++h)w=p[h],!gt(w)&&!jt(w)&&(b=r0(r,g.data,g.gc,b,w),v+=y);i.push(b),a.push(v),c=Math.max(b,c),u=Math.max(v,u)}Bke(o,n);const k=i.indexOf(c),C=a.indexOf(u),S=I=>({width:i[I]||0,height:a[I]||0});return{first:S(0),last:S(n-1),widest:S(k),highest:S(C),widths:i,heights:a}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Ave(this._alignToPixels?Na(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const s=n[e];return s.$context||(s.$context=Wke(this.getContext(),e,s))}return this.$context||(this.$context=Vke(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=Bi(this.labelRotation),s=Math.abs(Math.cos(n)),r=Math.abs(Math.sin(n)),o=this._getLabelSizes(),i=e.autoSkipPadding||0,a=o?o.widest.width+i:0,l=o?o.highest.height+i:0;return this.isHorizontal()?l*s>a*r?a/s:l/r:l*r<a*s?l/s:a/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,s=this.chart,r=this.options,{grid:o,position:i,border:a}=r,l=o.offset,c=this.isHorizontal(),d=this.ticks.length+(l?1:0),h=nd(o),f=[],p=a.setContext(this.getContext()),m=p.display?p.width:0,x=m/2,g=function(P){return Na(s,P,m)};let y,b,v,w,k,C,S,I,$,E,_,D;if(i==="top")y=g(this.bottom),C=this.bottom-h,I=y-x,E=g(e.top)+x,D=e.bottom;else if(i==="bottom")y=g(this.top),E=e.top,D=g(e.bottom)-x,C=y+x,I=this.top+h;else if(i==="left")y=g(this.right),k=this.right-h,S=y-x,$=g(e.left)+x,_=e.right;else if(i==="right")y=g(this.left),$=e.left,_=g(e.right)-x,k=y+x,S=this.left+h;else if(n==="x"){if(i==="center")y=g((e.top+e.bottom)/2+.5);else if(dt(i)){const P=Object.keys(i)[0],M=i[P];y=g(this.chart.scales[P].getPixelForValue(M))}E=e.top,D=e.bottom,C=y+x,I=C+h}else if(n==="y"){if(i==="center")y=g((e.left+e.right)/2);else if(dt(i)){const P=Object.keys(i)[0],M=i[P];y=g(this.chart.scales[P].getPixelForValue(M))}k=y-x,S=k-h,$=e.left,_=e.right}const F=et(r.ticks.maxTicksLimit,d),R=Math.max(1,Math.ceil(d/F));for(b=0;b<d;b+=R){const P=this.getContext(b),M=o.setContext(P),N=a.setContext(P),B=M.lineWidth,G=M.color,X=N.dash||[],Y=N.dashOffset,J=M.tickWidth,q=M.tickColor,ee=M.tickBorderDash||[],ne=M.tickBorderDashOffset;v=zke(this,b,l),v!==void 0&&(w=Na(s,v,B),c?k=S=$=_=w:C=I=E=D=w,f.push({tx1:k,ty1:C,tx2:S,ty2:I,x1:$,y1:E,x2:_,y2:D,width:B,color:G,borderDash:X,borderDashOffset:Y,tickWidth:J,tickColor:q,tickBorderDash:ee,tickBorderDashOffset:ne}))}return this._ticksLength=d,this._borderValue=y,f}_computeLabelItems(e){const n=this.axis,s=this.options,{position:r,ticks:o}=s,i=this.isHorizontal(),a=this.ticks,{align:l,crossAlign:c,padding:u,mirror:d}=o,h=nd(s.grid),f=h+u,p=d?-u:f,m=-Bi(this.labelRotation),x=[];let g,y,b,v,w,k,C,S,I,$,E,_,D="middle";if(r==="top")k=this.bottom-p,C=this._getXAxisLabelAlignment();else if(r==="bottom")k=this.top+p,C=this._getXAxisLabelAlignment();else if(r==="left"){const R=this._getYAxisLabelAlignment(h);C=R.textAlign,w=R.x}else if(r==="right"){const R=this._getYAxisLabelAlignment(h);C=R.textAlign,w=R.x}else if(n==="x"){if(r==="center")k=(e.top+e.bottom)/2+f;else if(dt(r)){const R=Object.keys(r)[0],P=r[R];k=this.chart.scales[R].getPixelForValue(P)+f}C=this._getXAxisLabelAlignment()}else if(n==="y"){if(r==="center")w=(e.left+e.right)/2-f;else if(dt(r)){const R=Object.keys(r)[0],P=r[R];w=this.chart.scales[R].getPixelForValue(P)}C=this._getYAxisLabelAlignment(h).textAlign}n==="y"&&(l==="start"?D="top":l==="end"&&(D="bottom"));const F=this._getLabelSizes();for(g=0,y=a.length;g<y;++g){b=a[g],v=b.label;const R=o.setContext(this.getContext(g));S=this.getPixelForTick(g)+o.labelOffset,I=this._resolveTickFontOptions(g),$=I.lineHeight,E=jt(v)?v.length:1;const P=E/2,M=R.color,N=R.textStrokeColor,B=R.textStrokeWidth;let G=C;i?(w=S,C==="inner"&&(g===y-1?G=this.options.reverse?"left":"right":g===0?G=this.options.reverse?"right":"left":G="center"),r==="top"?c==="near"||m!==0?_=-E*$+$/2:c==="center"?_=-F.highest.height/2-P*$+$:_=-F.highest.height+$/2:c==="near"||m!==0?_=$/2:c==="center"?_=F.highest.height/2-P*$:_=F.highest.height-E*$,d&&(_*=-1),m!==0&&!R.showLabelBackdrop&&(w+=$/2*Math.sin(m))):(k=S,_=(1-E)*$/2);let X;if(R.showLabelBackdrop){const Y=fs(R.backdropPadding),J=F.heights[g],q=F.widths[g];let ee=_-Y.top,ne=0-Y.left;switch(D){case"middle":ee-=J/2;break;case"bottom":ee-=J;break}switch(C){case"center":ne-=q/2;break;case"right":ne-=q;break;case"inner":g===y-1?ne-=q:g>0&&(ne-=q/2);break}X={left:ne,top:ee,width:q+Y.width,height:J+Y.height,color:R.backdropColor}}x.push({label:v,font:I,textOffset:_,options:{rotation:m,color:M,strokeColor:N,strokeWidth:B,textAlign:G,textBaseline:D,translation:[w,k],backdrop:X}})}return x}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-Bi(this.labelRotation))return e==="top"?"left":"right";let r="center";return n.align==="start"?r="left":n.align==="end"?r="right":n.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:s,mirror:r,padding:o}}=this.options,i=this._getLabelSizes(),a=e+o,l=i.widest.width;let c,u;return n==="left"?r?(u=this.right+o,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u+=l)):(u=this.right-a,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u=this.left)):n==="right"?r?(u=this.left+o,s==="near"?c="right":s==="center"?(c="center",u-=l/2):(c="left",u-=l)):(u=this.left+a,s==="near"?c="left":s==="center"?(c="center",u+=l/2):(c="right",u=this.right)):c="right",{textAlign:c,x:u}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:s,top:r,width:o,height:i}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(s,r,o,i),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const r=this.ticks.findIndex(o=>o.value===e);return r>=0?n.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const n=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let o,i;const a=(l,c,u)=>{!u.width||!u.color||(s.save(),s.lineWidth=u.width,s.strokeStyle=u.color,s.setLineDash(u.borderDash||[]),s.lineDashOffset=u.borderDashOffset,s.beginPath(),s.moveTo(l.x,l.y),s.lineTo(c.x,c.y),s.stroke(),s.restore())};if(n.display)for(o=0,i=r.length;o<i;++o){const l=r[o];n.drawOnChartArea&&a({x:l.x1,y:l.y1},{x:l.x2,y:l.y2},l),n.drawTicks&&a({x:l.tx1,y:l.ty1},{x:l.tx2,y:l.ty2},{color:l.tickColor,width:l.tickWidth,borderDash:l.tickBorderDash,borderDashOffset:l.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:s,grid:r}}=this,o=s.setContext(this.getContext()),i=s.display?o.width:0;if(!i)return;const a=r.setContext(this.getContext(0)).lineWidth,l=this._borderValue;let c,u,d,h;this.isHorizontal()?(c=Na(e,this.left,i)-i/2,u=Na(e,this.right,a)+a/2,d=h=l):(d=Na(e,this.top,i)-i/2,h=Na(e,this.bottom,a)+a/2,c=u=l),n.save(),n.lineWidth=o.width,n.strokeStyle=o.color,n.beginPath(),n.moveTo(c,d),n.lineTo(u,h),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&oI(s,r);const o=this.getLabelItems(e);for(const i of o){const a=i.options,l=i.font,c=i.label,u=i.textOffset;El(s,c,0,u,l,a)}r&&iI(s)}drawTitle(){const{ctx:e,options:{position:n,title:s,reverse:r}}=this;if(!s.display)return;const o=Rn(s.font),i=fs(s.padding),a=s.align;let l=o.lineHeight/2;n==="bottom"||n==="center"||dt(n)?(l+=i.bottom,jt(s.text)&&(l+=o.lineHeight*(s.text.length-1))):l+=i.top;const{titleX:c,titleY:u,maxWidth:d,rotation:h}=Hke(this,l,n,a);El(e,s.text,0,0,o,{color:s.color,maxWidth:d,rotation:h,textAlign:Uke(a,n,r),textBaseline:"middle",translation:[c,u]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,s=et(e.grid&&e.grid.z,-1),r=et(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Gl.prototype.draw?[{z:n,draw:o=>{this.draw(o)}}]:[{z:s,draw:o=>{this.drawBackground(),this.drawGrid(o),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:n,draw:o=>{this.drawLabels(o)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let o,i;for(o=0,i=n.length;o<i;++o){const a=n[o];a[s]===this.id&&(!e||a.type===e)&&r.push(a)}return r}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Rn(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class hm{constructor(e,n,s){this.type=e,this.scope=n,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let s;Kke(n)&&(s=this.register(n));const r=this.items,o=e.id,i=this.scope+"."+o;if(!o)throw new Error("class does not have id: "+e);return o in r||(r[o]=e,Gke(e,i,s),this.override&&en.override(e.id,e.overrides)),i}get(e){return this.items[e]}unregister(e){const n=this.items,s=e.id,r=this.scope;s in n&&delete n[s],r&&s in en[r]&&(delete en[r][s],this.override&&delete Tl[s])}}function Gke(t,e,n){const s=Ch(Object.create(null),[n?en.get(n):{},en.get(e),t.defaults]);en.set(e,s),t.defaultRoutes&&jke(e,t.defaultRoutes),t.descriptors&&en.describe(e,t.descriptors)}function jke(t,e){Object.keys(e).forEach(n=>{const s=n.split("."),r=s.pop(),o=[t].concat(s).join("."),i=e[n].split("."),a=i.pop(),l=i.join(".");en.route(o,r,l,a)})}function Kke(t){return"id"in t&&"defaults"in t}class Xke{constructor(){this.controllers=new hm(Ud,"datasets",!0),this.elements=new hm(fi,"elements"),this.plugins=new hm(Object,"plugins"),this.scales=new hm(Gl,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,s){[...n].forEach(r=>{const o=s||this._getRegistryForType(r);s||o.isForType(r)||o===this.plugins&&r.id?this._exec(e,o,r):mt(r,i=>{const a=s||this._getRegistryForType(i);this._exec(e,a,i)})})}_exec(e,n,s){const r=J$(e);Tt(s["before"+r],[],s),n[e](s),Tt(s["after"+r],[],s)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const s=this._typedRegistries[n];if(s.isForType(e))return s}return this.plugins}_get(e,n,s){const r=n.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var go=new Xke;class qke{constructor(){this._init=[]}notify(e,n,s,r){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const o=r?this._descriptors(e).filter(r):this._descriptors(e),i=this._notify(o,e,n,s);return n==="afterDestroy"&&(this._notify(o,e,"stop"),this._notify(this._init,e,"uninstall")),i}_notify(e,n,s,r){r=r||{};for(const o of e){const i=o.plugin,a=i[s],l=[n,r,o.options];if(Tt(a,l,i)===!1&&r.cancelable)return!1}return!0}invalidate(){gt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const s=e&&e.config,r=et(s.options&&s.options.plugins,{}),o=Yke(s);return r===!1&&!n?[]:Zke(e,o,r,n)}_notifyStateChanges(e){const n=this._oldCache||[],s=this._cache,r=(o,i)=>o.filter(a=>!i.some(l=>a.plugin.id===l.plugin.id));this._notify(r(n,s),e,"stop"),this._notify(r(s,n),e,"start")}}function Yke(t){const e={},n=[],s=Object.keys(go.plugins.items);for(let o=0;o<s.length;o++)n.push(go.getPlugin(s[o]));const r=t.plugins||[];for(let o=0;o<r.length;o++){const i=r[o];n.indexOf(i)===-1&&(n.push(i),e[i.id]=!0)}return{plugins:n,localIds:e}}function Qke(t,e){return!e&&t===!1?null:t===!0?{}:t}function Zke(t,{plugins:e,localIds:n},s,r){const o=[],i=t.getContext();for(const a of e){const l=a.id,c=Qke(s[l],r);c!==null&&o.push({plugin:a,options:Jke(t.config,{plugin:a,local:n[l]},c,i)})}return o}function Jke(t,{plugin:e,local:n},s,r){const o=t.pluginScopeKeys(e),i=t.getOptionScopes(s,o);return n&&e.defaults&&i.push(e.defaults),t.createResolver(i,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function kw(t,e){const n=en.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function eCe(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function tCe(t,e){return t===e?"_index_":"_value_"}function JN(t){if(t==="x"||t==="y"||t==="r")return t}function nCe(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function Cw(t,...e){if(JN(t))return t;for(const n of e){const s=n.axis||nCe(n.position)||t.length>1&&JN(t[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function e_(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function sCe(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(s=>s.xAxisID===t||s.yAxisID===t);if(n.length)return e_(t,"x",n[0])||e_(t,"y",n[0])}return{}}function rCe(t,e){const n=Tl[t.type]||{scales:{}},s=e.scales||{},r=kw(t.type,e),o=Object.create(null);return Object.keys(s).forEach(i=>{const a=s[i];if(!dt(a))return console.error(`Invalid scale configuration for scale: ${i}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${i}`);const l=Cw(i,a,sCe(i,t),en.scales[a.type]),c=tCe(l,r),u=n.scales||{};o[i]=zd(Object.create(null),[{axis:l},a,u[l],u[c]])}),t.data.datasets.forEach(i=>{const a=i.type||t.type,l=i.indexAxis||kw(a,e),u=(Tl[a]||{}).scales||{};Object.keys(u).forEach(d=>{const h=eCe(d,l),f=i[h+"AxisID"]||h;o[f]=o[f]||Object.create(null),zd(o[f],[{axis:h},s[f],u[d]])})}),Object.keys(o).forEach(i=>{const a=o[i];zd(a,[en.scales[a.type],en.scale])}),o}function OB(t){const e=t.options||(t.options={});e.plugins=et(e.plugins,{}),e.scales=rCe(t,e)}function PB(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function oCe(t){return t=t||{},t.data=PB(t.data),OB(t),t}const t_=new Map,MB=new Set;function fm(t,e){let n=t_.get(t);return n||(n=e(),t_.set(t,n),MB.add(n)),n}const sd=(t,e,n)=>{const s=t0(e,n);s!==void 0&&t.add(s)};class iCe{constructor(e){this._config=oCe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=PB(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),OB(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return fm(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return fm(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return fm(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,s=this.type;return fm(`${s}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const s=this._scopeCache;let r=s.get(e);return(!r||n)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,n,s){const{options:r,type:o}=this,i=this._cachedScopes(e,s),a=i.get(n);if(a)return a;const l=new Set;n.forEach(u=>{e&&(l.add(e),u.forEach(d=>sd(l,e,d))),u.forEach(d=>sd(l,r,d)),u.forEach(d=>sd(l,Tl[o]||{},d)),u.forEach(d=>sd(l,en,d)),u.forEach(d=>sd(l,vw,d))});const c=Array.from(l);return c.length===0&&c.push(Object.create(null)),MB.has(n)&&i.set(n,c),c}chartOptionScopes(){const{options:e,type:n}=this;return[e,Tl[n]||{},en.datasets[n]||{},{type:n},en,vw]}resolveNamedOptions(e,n,s,r=[""]){const o={$shared:!0},{resolver:i,subPrefixes:a}=n_(this._resolverCache,e,r);let l=i;if(lCe(i,n)){o.$shared=!1,s=ua(s)?s():s;const c=this.createResolver(e,s,a);l=au(i,s,c)}for(const c of n)o[c]=l[c];return o}createResolver(e,n,s=[""],r){const{resolver:o}=n_(this._resolverCache,e,s);return dt(n)?au(o,n,void 0,r):o}}function n_(t,e,n){let s=t.get(e);s||(s=new Map,t.set(e,s));const r=n.join();let o=s.get(r);return o||(o={resolver:aI(e,n),subPrefixes:n.filter(a=>!a.toLowerCase().includes("hover"))},s.set(r,o)),o}const aCe=t=>dt(t)&&Object.getOwnPropertyNames(t).some(e=>ua(t[e]));function lCe(t,e){const{isScriptable:n,isIndexable:s}=vB(t);for(const r of e){const o=n(r),i=s(r),a=(i||o)&&t[r];if(o&&(ua(a)||aCe(a))||i&&jt(a))return!0}return!1}var cCe="4.4.9";const uCe=["top","bottom","left","right","chartArea"];function s_(t,e){return t==="top"||t==="bottom"||uCe.indexOf(t)===-1&&e==="x"}function r_(t,e){return function(n,s){return n[t]===s[t]?n[e]-s[e]:n[t]-s[t]}}function o_(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),Tt(n&&n.onComplete,[t],e)}function dCe(t){const e=t.chart,n=e.options.animation;Tt(n&&n.onProgress,[t],e)}function LB(t){return uI()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const Vm={},i_=t=>{const e=LB(t);return Object.values(Vm).filter(n=>n.canvas===e).pop()};function hCe(t,e,n){const s=Object.keys(t);for(const r of s){const o=+r;if(o>=e){const i=t[r];delete t[r],(n>0||o>e)&&(t[o+n]=i)}}}function fCe(t,e,n,s){return!n||t.type==="mouseout"?null:s?e:t}var Si;let Zy=(Si=class{static register(...e){go.add(...e),a_()}static unregister(...e){go.remove(...e),a_()}constructor(e,n){const s=this.config=new iCe(n),r=LB(e),o=i_(r);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");const i=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||Rke(r)),this.platform.updateConfig(s);const a=this.platform.acquireContext(r,i.aspectRatio),l=a&&a.canvas,c=l&&l.height,u=l&&l.width;if(this.id=yve(),this.ctx=a,this.canvas=l,this.width=u,this.height=c,this._options=i,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new qke,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Mve(d=>this.update(d),i.resizeDelay||0),this._dataChanges=[],Vm[this.id]=this,!a||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Go.listen(this,"complete",o_),Go.listen(this,"progress",dCe),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:s,height:r,_aspectRatio:o}=this;return gt(e)?n&&o?o:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return go}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():AN(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return NN(this.canvas,this.ctx),this}stop(){return Go.stop(this),this}resize(e,n){Go.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const s=this.options,r=this.canvas,o=s.maintainAspectRatio&&this.aspectRatio,i=this.platform.getMaximumSize(r,e,n,o),a=s.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=i.width,this.height=i.height,this._aspectRatio=this.aspectRatio,AN(this,a,!0)&&(this.notifyPlugins("resize",{size:i}),Tt(s.onResize,[this,i],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};mt(n,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,n=e.scales,s=this.scales,r=Object.keys(s).reduce((i,a)=>(i[a]=!1,i),{});let o=[];n&&(o=o.concat(Object.keys(n).map(i=>{const a=n[i],l=Cw(i,a),c=l==="r",u=l==="x";return{options:a,dposition:c?"chartArea":u?"bottom":"left",dtype:c?"radialLinear":u?"category":"linear"}}))),mt(o,i=>{const a=i.options,l=a.id,c=Cw(l,a),u=et(a.type,i.dtype);(a.position===void 0||s_(a.position,c)!==s_(i.dposition))&&(a.position=i.dposition),r[l]=!0;let d=null;if(l in s&&s[l].type===u)d=s[l];else{const h=go.getScale(u);d=new h({id:l,type:u,ctx:this.ctx,chart:this}),s[d.id]=d}d.init(a,e)}),mt(r,(i,a)=>{i||delete s[a]}),mt(s,i=>{Er.configure(this,i,i.options),Er.addBox(this,i)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,s=e.length;if(e.sort((r,o)=>r.index-o.index),s>n){for(let r=n;r<s;++r)this._destroyDatasetMeta(r);e.splice(n,s-n)}this._sortedMetasets=e.slice(0).sort(r_("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((s,r)=>{n.filter(o=>o===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=n.length;s<r;s++){const o=n[s];let i=this.getDatasetMeta(s);const a=o.type||this.config.type;if(i.type&&i.type!==a&&(this._destroyDatasetMeta(s),i=this.getDatasetMeta(s)),i.type=a,i.indexAxis=o.indexAxis||kw(a,this.options),i.order=o.order||0,i.index=s,i.label=""+o.label,i.visible=this.isDatasetVisible(s),i.controller)i.controller.updateIndex(s),i.controller.linkScales();else{const l=go.getController(a),{datasetElementType:c,dataElementType:u}=en.datasets[a];Object.assign(l,{dataElementType:go.getElement(u),datasetElementType:c&&go.getElement(c)}),i.controller=new l(this,s),e.push(i.controller)}}return this._updateMetasets(),e}_resetElements(){mt(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const s=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let i=0;for(let c=0,u=this.data.datasets.length;c<u;c++){const{controller:d}=this.getDatasetMeta(c),h=!r&&o.indexOf(d)===-1;d.buildOrUpdateElements(h),i=Math.max(+d.getMaxOverflow(),i)}i=this._minPadding=s.layout.autoPadding?i:0,this._updateLayout(i),r||mt(o,c=>{c.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(r_("z","_idx"));const{_active:a,_lastEvent:l}=this;l?this._eventHandler(l,!0):a.length&&this._updateHoverStyles(a,a,!0),this.render()}_updateScales(){mt(this.scales,e=>{Er.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!vN(n,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:o}of n){const i=s==="_removeElements"?-o:o;hCe(e,r,i)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,s=o=>new Set(e.filter(i=>i[0]===o).map((i,a)=>a+","+i.splice(1).join(","))),r=s(0);for(let o=1;o<n;o++)if(!vN(r,s(o)))return;return Array.from(r).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Er.update(this,this.width,this.height,e);const n=this.chartArea,s=n.width<=0||n.height<=0;this._layers=[],mt(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,o)=>{r._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,s=this.data.datasets.length;n<s;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,s=this.data.datasets.length;n<s;++n)this._updateDataset(n,ua(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(n),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Go.has(this)?this.attached&&!Go.running(this)&&Go.start(this):(this.draw(),o_({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,s=[];let r,o;for(r=0,o=n.length;r<o;++r){const i=n[r];(!e||i.visible)&&s.push(i)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=Hwe(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&oI(n,r),e.controller.draw(),r&&iI(n),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return ti(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,s,r){const o=uke.modes[n];return typeof o=="function"?o(this,e,s,r):[]}getDatasetMeta(e){const n=this.data.datasets[e],s=this._metasets;let r=s.filter(o=>o&&o._dataset===n).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=Sa(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!n.hidden}setDatasetVisibility(e,n){const s=this.getDatasetMeta(e);s.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,s){const r=s?"show":"hide",o=this.getDatasetMeta(e),i=o.controller._resolveAnimations(void 0,r);n0(n)?(o.data[n].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),i.update(o,{visible:s}),this.update(a=>a.datasetIndex===e?r:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),Go.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),NN(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete Vm[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,s=(o,i)=>{n.addEventListener(this,o,i),e[o]=i},r=(o,i,a)=>{o.offsetX=i,o.offsetY=a,this._eventHandler(o)};mt(this.options.events,o=>s(o,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,s=(l,c)=>{n.addEventListener(this,l,c),e[l]=c},r=(l,c)=>{e[l]&&(n.removeEventListener(this,l,c),delete e[l])},o=(l,c)=>{this.canvas&&this.resize(l,c)};let i;const a=()=>{r("attach",a),this.attached=!0,this.resize(),s("resize",o),s("detach",i)};i=()=>{this.attached=!1,r("resize",o),this._stop(),this._resize(0,0),s("attach",a)},n.isAttached(this.canvas)?a():i()}unbindEvents(){mt(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},mt(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,s){const r=s?"set":"remove";let o,i,a,l;for(n==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+r+"DatasetHoverStyle"]()),a=0,l=e.length;a<l;++a){i=e[a];const c=i&&this.getDatasetMeta(i.datasetIndex).controller;c&&c[r+"HoverStyle"](i.element,i.datasetIndex,i.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],s=e.map(({datasetIndex:o,index:i})=>{const a=this.getDatasetMeta(o);if(!a)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:a.data[i],index:i}});!Jg(s,n)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,n))}notifyPlugins(e,n,s){return this._plugins.notify(this,e,n,s)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,s){const r=this.options.hover,o=(l,c)=>l.filter(u=>!c.some(d=>u.datasetIndex===d.datasetIndex&&u.index===d.index)),i=o(n,e),a=s?e:o(e,n);i.length&&this.updateHoverStyle(i,r.mode,!1),a.length&&r.mode&&this.updateHoverStyle(a,r.mode,!0)}_eventHandler(e,n){const s={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},r=i=>(i.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const o=this._handleEvent(e,n,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(o||s.changed)&&this.render(),this}_handleEvent(e,n,s){const{_active:r=[],options:o}=this,i=n,a=this._getActiveElements(e,r,s,i),l=Sve(e),c=fCe(e,this._lastEvent,s,l);s&&(this._lastEvent=null,Tt(o.onHover,[e,a,this],this),l&&Tt(o.onClick,[e,a,this],this));const u=!Jg(a,r);return(u||n)&&(this._active=a,this._updateHoverStyles(a,r,n)),this._lastEvent=c,u}_getActiveElements(e,n,s,r){if(e.type==="mouseout")return[];if(!s)return n;const o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,r)}},Me(Si,"defaults",en),Me(Si,"instances",Vm),Me(Si,"overrides",Tl),Me(Si,"registry",go),Me(Si,"version",cCe),Me(Si,"getChart",i_),Si);function a_(){return mt(Zy.instances,t=>t._plugins.invalidate())}function zB(t,e,n=e){t.lineCap=et(n.borderCapStyle,e.borderCapStyle),t.setLineDash(et(n.borderDash,e.borderDash)),t.lineDashOffset=et(n.borderDashOffset,e.borderDashOffset),t.lineJoin=et(n.borderJoinStyle,e.borderJoinStyle),t.lineWidth=et(n.borderWidth,e.borderWidth),t.strokeStyle=et(n.borderColor,e.borderColor)}function pCe(t,e,n){t.lineTo(n.x,n.y)}function mCe(t){return t.stepped?Qve:t.tension||t.cubicInterpolationMode==="monotone"?Zve:pCe}function BB(t,e,n={}){const s=t.length,{start:r=0,end:o=s-1}=n,{start:i,end:a}=e,l=Math.max(r,i),c=Math.min(o,a),u=r<i&&o<i||r>a&&o>a;return{count:s,start:l,loop:e.loop,ilen:c<l&&!u?s+c-l:c-l}}function gCe(t,e,n,s){const{points:r,options:o}=e,{count:i,start:a,loop:l,ilen:c}=BB(r,n,s),u=mCe(o);let{move:d=!0,reverse:h}=s||{},f,p,m;for(f=0;f<=c;++f)p=r[(a+(h?c-f:f))%i],!p.skip&&(d?(t.moveTo(p.x,p.y),d=!1):u(t,m,p,h,o.stepped),m=p);return l&&(p=r[(a+(h?c:0))%i],u(t,m,p,h,o.stepped)),!!l}function xCe(t,e,n,s){const r=e.points,{count:o,start:i,ilen:a}=BB(r,n,s),{move:l=!0,reverse:c}=s||{};let u=0,d=0,h,f,p,m,x,g;const y=v=>(i+(c?a-v:v))%o,b=()=>{m!==x&&(t.lineTo(u,x),t.lineTo(u,m),t.lineTo(u,g))};for(l&&(f=r[y(0)],t.moveTo(f.x,f.y)),h=0;h<=a;++h){if(f=r[y(h)],f.skip)continue;const v=f.x,w=f.y,k=v|0;k===p?(w<m?m=w:w>x&&(x=w),u=(d*u+v)/++d):(b(),t.lineTo(v,w),p=k,d=0,m=x=w),g=w}b()}function Sw(t){const e=t.options,n=e.borderDash&&e.borderDash.length;return!t._decimated&&!t._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!n?xCe:gCe}function yCe(t){return t.stepped?Rwe:t.tension||t.cubicInterpolationMode==="monotone"?Awe:za}function bCe(t,e,n,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,n,s)&&r.closePath()),zB(t,e.options),t.stroke(r)}function vCe(t,e,n,s){const{segments:r,options:o}=e,i=Sw(e);for(const a of r)zB(t,o,a.style),t.beginPath(),i(t,e,a,{start:n,end:n+s-1})&&t.closePath(),t.stroke()}const wCe=typeof Path2D=="function";function kCe(t,e,n,s){wCe&&!e.options.segment?bCe(t,e,n,s):vCe(t,e,n,s)}class bd extends fi{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,n){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;Cwe(this._points,s,e,r,n),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Bwe(this,this.options.segment))}first(){const e=this.segments,n=this.points;return e.length&&n[e[0].start]}last(){const e=this.segments,n=this.points,s=e.length;return s&&n[e[s-1].end]}interpolate(e,n){const s=this.options,r=e[n],o=this.points,i=Mwe(this,{property:n,start:r,end:r});if(!i.length)return;const a=[],l=yCe(s);let c,u;for(c=0,u=i.length;c<u;++c){const{start:d,end:h}=i[c],f=o[d],p=o[h];if(f===p){a.push(f);continue}const m=Math.abs((r-f[n])/(p[n]-f[n])),x=l(f,p,m,s.stepped);x[n]=e[n],a.push(x)}return a.length===1?a[0]:a}pathSegment(e,n,s){return Sw(this)(e,this,n,s)}path(e,n,s){const r=this.segments,o=Sw(this);let i=this._loop;n=n||0,s=s||this.points.length-n;for(const a of r)i&=o(e,this,a,{start:n,end:n+s-1});return!!i}draw(e,n,s,r){const o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),kCe(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}Me(bd,"id","line"),Me(bd,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),Me(bd,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),Me(bd,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function l_(t,e,n,s){const r=t.options,{[n]:o}=t.getProps([n],s);return Math.abs(e-o)<r.radius+r.hitRadius}class Wm extends fi{constructor(n){super();Me(this,"parsed");Me(this,"skip");Me(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,n&&Object.assign(this,n)}inRange(n,s,r){const o=this.options,{x:i,y:a}=this.getProps(["x","y"],r);return Math.pow(n-i,2)+Math.pow(s-a,2)<Math.pow(o.hitRadius+o.radius,2)}inXRange(n,s){return l_(this,n,"x",s)}inYRange(n,s){return l_(this,n,"y",s)}getCenterPoint(n){const{x:s,y:r}=this.getProps(["x","y"],n);return{x:s,y:r}}size(n){n=n||this.options||{};let s=n.radius||0;s=Math.max(s,s&&n.hoverRadius||0);const r=s&&n.borderWidth||0;return(s+r)*2}draw(n,s){const r=this.options;this.skip||r.radius<.1||!ti(this,s,this.size(r)/2)||(n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.fillStyle=r.backgroundColor,ww(n,r,this.x,this.y))}getRange(){const n=this.options||{};return n.radius+n.hitRadius}}Me(Wm,"id","point"),Me(Wm,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),Me(Wm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const c_=(t,e)=>{let{boxHeight:n=e,boxWidth:s=e}=t;return t.usePointStyle&&(n=Math.min(n,e),s=t.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:n,itemHeight:Math.max(e,n)}},CCe=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class u_ extends fi{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,s){this.maxWidth=e,this.maxHeight=n,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=Tt(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(s=>e.filter(s,this.chart.data))),e.sort&&(n=n.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=Rn(s.font),o=r.size,i=this._computeTitleHeight(),{boxWidth:a,itemHeight:l}=c_(s,o);let c,u;n.font=r.string,this.isHorizontal()?(c=this.maxWidth,u=this._fitRows(i,o,a,l)+10):(u=this.maxHeight,c=this._fitCols(i,r,a,l)+10),this.width=Math.min(c,e.maxWidth||this.maxWidth),this.height=Math.min(u,e.maxHeight||this.maxHeight)}_fitRows(e,n,s,r){const{ctx:o,maxWidth:i,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.lineWidths=[0],u=r+a;let d=e;o.textAlign="left",o.textBaseline="middle";let h=-1,f=-u;return this.legendItems.forEach((p,m)=>{const x=s+n/2+o.measureText(p.text).width;(m===0||c[c.length-1]+x+2*a>i)&&(d+=u,c[c.length-(m>0?0:1)]=0,f+=u,h++),l[m]={left:0,top:f,row:h,width:x,height:r},c[c.length-1]+=x+a}),d}_fitCols(e,n,s,r){const{ctx:o,maxHeight:i,options:{labels:{padding:a}}}=this,l=this.legendHitBoxes=[],c=this.columnSizes=[],u=i-e;let d=a,h=0,f=0,p=0,m=0;return this.legendItems.forEach((x,g)=>{const{itemWidth:y,itemHeight:b}=SCe(s,n,o,x,r);g>0&&f+b+2*a>u&&(d+=h+a,c.push({width:h,height:f}),p+=h+a,m++,h=f=0),l[g]={left:p,top:f,col:m,width:y,height:b},h=Math.max(h,y),f+=b+a}),d+=h,c.push({width:h,height:f}),d}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:s,labels:{padding:r},rtl:o}}=this,i=Pc(o,this.left,this.width);if(this.isHorizontal()){let a=0,l=ss(s,this.left+r,this.right-this.lineWidths[a]);for(const c of n)a!==c.row&&(a=c.row,l=ss(s,this.left+r,this.right-this.lineWidths[a])),c.top+=this.top+e+r,c.left=i.leftForLtr(i.x(l),c.width),l+=c.width+r}else{let a=0,l=ss(s,this.top+e+r,this.bottom-this.columnSizes[a].height);for(const c of n)c.col!==a&&(a=c.col,l=ss(s,this.top+e+r,this.bottom-this.columnSizes[a].height)),c.top=l,c.left+=this.left+r,c.left=i.leftForLtr(i.x(c.left),c.width),l+=c.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;oI(e,this),this._draw(),iI(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:s,ctx:r}=this,{align:o,labels:i}=e,a=en.color,l=Pc(e.rtl,this.left,this.width),c=Rn(i.font),{padding:u}=i,d=c.size,h=d/2;let f;this.drawTitle(),r.textAlign=l.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=c.string;const{boxWidth:p,boxHeight:m,itemHeight:x}=c_(i,d),g=function(k,C,S){if(isNaN(p)||p<=0||isNaN(m)||m<0)return;r.save();const I=et(S.lineWidth,1);if(r.fillStyle=et(S.fillStyle,a),r.lineCap=et(S.lineCap,"butt"),r.lineDashOffset=et(S.lineDashOffset,0),r.lineJoin=et(S.lineJoin,"miter"),r.lineWidth=I,r.strokeStyle=et(S.strokeStyle,a),r.setLineDash(et(S.lineDash,[])),i.usePointStyle){const $={radius:m*Math.SQRT2/2,pointStyle:S.pointStyle,rotation:S.rotation,borderWidth:I},E=l.xPlus(k,p/2),_=C+h;yB(r,$,E,_,i.pointStyleWidth&&p)}else{const $=C+Math.max((d-m)/2,0),E=l.leftForLtr(k,p),_=Oc(S.borderRadius);r.beginPath(),Object.values(_).some(D=>D!==0)?o0(r,{x:E,y:$,w:p,h:m,radius:_}):r.rect(E,$,p,m),r.fill(),I!==0&&r.stroke()}r.restore()},y=function(k,C,S){El(r,S.text,k,C+x/2,c,{strikethrough:S.hidden,textAlign:l.textAlign(S.textAlign)})},b=this.isHorizontal(),v=this._computeTitleHeight();b?f={x:ss(o,this.left+u,this.right-s[0]),y:this.top+u+v,line:0}:f={x:this.left+u,y:ss(o,this.top+v+u,this.bottom-n[0].height),line:0},$B(this.ctx,e.textDirection);const w=x+u;this.legendItems.forEach((k,C)=>{r.strokeStyle=k.fontColor,r.fillStyle=k.fontColor;const S=r.measureText(k.text).width,I=l.textAlign(k.textAlign||(k.textAlign=i.textAlign)),$=p+h+S;let E=f.x,_=f.y;l.setWidth(this.width),b?C>0&&E+$+u>this.right&&(_=f.y+=w,f.line++,E=f.x=ss(o,this.left+u,this.right-s[f.line])):C>0&&_+w>this.bottom&&(E=f.x=E+n[f.line].width+u,f.line++,_=f.y=ss(o,this.top+v+u,this.bottom-n[f.line].height));const D=l.x(E);if(g(D,_,k),E=Lve(I,E+p+h,b?E+$:this.right,e.rtl),y(l.x(E),_,k),b)f.x+=$+u;else if(typeof k.text!="string"){const F=c.lineHeight;f.y+=VB(k,F)+u}else f.y+=w}),IB(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,s=Rn(n.font),r=fs(n.padding);if(!n.display)return;const o=Pc(e.rtl,this.left,this.width),i=this.ctx,a=n.position,l=s.size/2,c=r.top+l;let u,d=this.left,h=this.width;if(this.isHorizontal())h=Math.max(...this.lineWidths),u=this.top+c,d=ss(e.align,d,this.right-h);else{const p=this.columnSizes.reduce((m,x)=>Math.max(m,x.height),0);u=c+ss(e.align,this.top,this.bottom-p-e.labels.padding-this._computeTitleHeight())}const f=ss(a,d,d+h);i.textAlign=o.textAlign(nI(a)),i.textBaseline="middle",i.strokeStyle=n.color,i.fillStyle=n.color,i.font=s.string,El(i,n.text,f,u,s)}_computeTitleHeight(){const e=this.options.title,n=Rn(e.font),s=fs(e.padding);return e.display?n.lineHeight+s.height:0}_getLegendItemAt(e,n){let s,r,o;if(xd(e,this.left,this.right)&&xd(n,this.top,this.bottom)){for(o=this.legendHitBoxes,s=0;s<o.length;++s)if(r=o[s],xd(e,r.left,r.left+r.width)&&xd(n,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const n=this.options;if(!TCe(e.type,n))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,o=CCe(r,s);r&&!o&&Tt(n.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!o&&Tt(n.onHover,[e,s,this],this)}else s&&Tt(n.onClick,[e,s,this],this)}}function SCe(t,e,n,s,r){const o=$Ce(s,t,e,n),i=ICe(r,s,e.lineHeight);return{itemWidth:o,itemHeight:i}}function $Ce(t,e,n,s){let r=t.text;return r&&typeof r!="string"&&(r=r.reduce((o,i)=>o.length>i.length?o:i)),e+n.size/2+s.measureText(r).width}function ICe(t,e,n){let s=t;return typeof e.text!="string"&&(s=VB(e,n)),s}function VB(t,e){const n=t.text?t.text.length:0;return e*n}function TCe(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var ECe={id:"legend",_element:u_,start(t,e,n){const s=t.legend=new u_({ctx:t.ctx,options:n,chart:t});Er.configure(t,s,n),Er.addBox(t,s)},stop(t){Er.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const s=t.legend;Er.configure(t,s,n),s.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const s=e.datasetIndex,r=n.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:s,textAlign:r,color:o,useBorderRadius:i,borderRadius:a}}=t.legend.options;return t._getSortedDatasetMetas().map(l=>{const c=l.controller.getStyle(n?0:void 0),u=fs(c.borderWidth);return{text:e[l.index].label,fillStyle:c.backgroundColor,fontColor:o,hidden:!l.visible,lineCap:c.borderCapStyle,lineDash:c.borderDash,lineDashOffset:c.borderDashOffset,lineJoin:c.borderJoinStyle,lineWidth:(u.width+u.height)/4,strokeStyle:c.borderColor,pointStyle:s||c.pointStyle,rotation:c.rotation,textAlign:r||c.textAlign,borderRadius:i&&(a||c.borderRadius),datasetIndex:l.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class WB extends fi{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const s=this.options;if(this.left=0,this.top=0,!s.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const r=jt(s.text)?s.text.length:1;this._padding=fs(s.padding);const o=r*Rn(s.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=o:this.width=o}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:s,bottom:r,right:o,options:i}=this,a=i.align;let l=0,c,u,d;return this.isHorizontal()?(u=ss(a,s,o),d=n+e,c=o-s):(i.position==="left"?(u=s+e,d=ss(a,r,n),l=Sn*-.5):(u=o-e,d=ss(a,n,r),l=Sn*.5),c=r-n),{titleX:u,titleY:d,maxWidth:c,rotation:l}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const s=Rn(n.font),o=s.lineHeight/2+this._padding.top,{titleX:i,titleY:a,maxWidth:l,rotation:c}=this._drawArgs(o);El(e,n.text,0,0,s,{color:n.color,maxWidth:l,rotation:c,textAlign:nI(n.align),textBaseline:"middle",translation:[i,a]})}}function NCe(t,e){const n=new WB({ctx:t.ctx,options:e,chart:t});Er.configure(t,n,e),Er.addBox(t,n),t.titleBlock=n}var _Ce={id:"title",_element:WB,start(t,e,n){NCe(t,n)},stop(t){const e=t.titleBlock;Er.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const s=t.titleBlock;Er.configure(t,s,n),s.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const vd={average(t){if(!t.length)return!1;let e,n,s=new Set,r=0,o=0;for(e=0,n=t.length;e<n;++e){const a=t[e].element;if(a&&a.hasValue()){const l=a.tooltipPosition();s.add(l.x),r+=l.y,++o}}return o===0||s.size===0?!1:{x:[...s].reduce((a,l)=>a+l)/s.size,y:r/o}},nearest(t,e){if(!t.length)return!1;let n=e.x,s=e.y,r=Number.POSITIVE_INFINITY,o,i,a;for(o=0,i=t.length;o<i;++o){const l=t[o].element;if(l&&l.hasValue()){const c=l.getCenterPoint(),u=bw(e,c);u<r&&(r=u,a=l)}}if(a){const l=a.tooltipPosition();n=l.x,s=l.y}return{x:n,y:s}}};function fo(t,e){return e&&(jt(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function jo(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function RCe(t,e){const{element:n,datasetIndex:s,index:r}=e,o=t.getDatasetMeta(s).controller,{label:i,value:a}=o.getLabelAndValue(r);return{chart:t,label:i,parsed:o.getParsed(r),raw:t.data.datasets[s].data[r],formattedValue:a,dataset:o.getDataset(),dataIndex:r,datasetIndex:s,element:n}}function d_(t,e){const n=t.chart.ctx,{body:s,footer:r,title:o}=t,{boxWidth:i,boxHeight:a}=e,l=Rn(e.bodyFont),c=Rn(e.titleFont),u=Rn(e.footerFont),d=o.length,h=r.length,f=s.length,p=fs(e.padding);let m=p.height,x=0,g=s.reduce((v,w)=>v+w.before.length+w.lines.length+w.after.length,0);if(g+=t.beforeBody.length+t.afterBody.length,d&&(m+=d*c.lineHeight+(d-1)*e.titleSpacing+e.titleMarginBottom),g){const v=e.displayColors?Math.max(a,l.lineHeight):l.lineHeight;m+=f*v+(g-f)*l.lineHeight+(g-1)*e.bodySpacing}h&&(m+=e.footerMarginTop+h*u.lineHeight+(h-1)*e.footerSpacing);let y=0;const b=function(v){x=Math.max(x,n.measureText(v).width+y)};return n.save(),n.font=c.string,mt(t.title,b),n.font=l.string,mt(t.beforeBody.concat(t.afterBody),b),y=e.displayColors?i+2+e.boxPadding:0,mt(s,v=>{mt(v.before,b),mt(v.lines,b),mt(v.after,b)}),y=0,n.font=u.string,mt(t.footer,b),n.restore(),x+=p.width,{width:x,height:m}}function ACe(t,e){const{y:n,height:s}=e;return n<s/2?"top":n>t.height-s/2?"bottom":"center"}function DCe(t,e,n,s){const{x:r,width:o}=s,i=n.caretSize+n.caretPadding;if(t==="left"&&r+o+i>e.width||t==="right"&&r-o-i<0)return!0}function FCe(t,e,n,s){const{x:r,width:o}=n,{width:i,chartArea:{left:a,right:l}}=t;let c="center";return s==="center"?c=r<=(a+l)/2?"left":"right":r<=o/2?c="left":r>=i-o/2&&(c="right"),DCe(c,t,e,n)&&(c="center"),c}function h_(t,e,n){const s=n.yAlign||e.yAlign||ACe(t,n);return{xAlign:n.xAlign||e.xAlign||FCe(t,e,n,s),yAlign:s}}function OCe(t,e){let{x:n,width:s}=t;return e==="right"?n-=s:e==="center"&&(n-=s/2),n}function PCe(t,e,n){let{y:s,height:r}=t;return e==="top"?s+=n:e==="bottom"?s-=r+n:s-=r/2,s}function f_(t,e,n,s){const{caretSize:r,caretPadding:o,cornerRadius:i}=t,{xAlign:a,yAlign:l}=n,c=r+o,{topLeft:u,topRight:d,bottomLeft:h,bottomRight:f}=Oc(i);let p=OCe(e,a);const m=PCe(e,l,c);return l==="center"?a==="left"?p+=c:a==="right"&&(p-=c):a==="left"?p-=Math.max(u,h)+r:a==="right"&&(p+=Math.max(d,f)+r),{x:Tr(p,0,s.width-e.width),y:Tr(m,0,s.height-e.height)}}function pm(t,e,n){const s=fs(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-s.right:t.x+s.left}function p_(t){return fo([],jo(t))}function MCe(t,e,n){return Sa(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function m_(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const UB={beforeTitle:Uo,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,s=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return n[e.dataIndex]}return""},afterTitle:Uo,beforeBody:Uo,beforeLabel:Uo,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return gt(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:Uo,afterBody:Uo,beforeFooter:Uo,footer:Uo,afterFooter:Uo};function Es(t,e,n,s){const r=t[e].call(n,s);return typeof r>"u"?UB[e].call(n,s):r}class $w extends fi{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&n.options.animation&&s.animations,o=new EB(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=MCe(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:s}=n,r=Es(s,"beforeTitle",this,e),o=Es(s,"title",this,e),i=Es(s,"afterTitle",this,e);let a=[];return a=fo(a,jo(r)),a=fo(a,jo(o)),a=fo(a,jo(i)),a}getBeforeBody(e,n){return p_(Es(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:s}=n,r=[];return mt(e,o=>{const i={before:[],lines:[],after:[]},a=m_(s,o);fo(i.before,jo(Es(a,"beforeLabel",this,o))),fo(i.lines,Es(a,"label",this,o)),fo(i.after,jo(Es(a,"afterLabel",this,o))),r.push(i)}),r}getAfterBody(e,n){return p_(Es(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:s}=n,r=Es(s,"beforeFooter",this,e),o=Es(s,"footer",this,e),i=Es(s,"afterFooter",this,e);let a=[];return a=fo(a,jo(r)),a=fo(a,jo(o)),a=fo(a,jo(i)),a}_createItems(e){const n=this._active,s=this.chart.data,r=[],o=[],i=[];let a=[],l,c;for(l=0,c=n.length;l<c;++l)a.push(RCe(this.chart,n[l]));return e.filter&&(a=a.filter((u,d,h)=>e.filter(u,d,h,s))),e.itemSort&&(a=a.sort((u,d)=>e.itemSort(u,d,s))),mt(a,u=>{const d=m_(e.callbacks,u);r.push(Es(d,"labelColor",this,u)),o.push(Es(d,"labelPointStyle",this,u)),i.push(Es(d,"labelTextColor",this,u))}),this.labelColors=r,this.labelPointStyles=o,this.labelTextColors=i,this.dataPoints=a,a}update(e,n){const s=this.options.setContext(this.getContext()),r=this._active;let o,i=[];if(!r.length)this.opacity!==0&&(o={opacity:0});else{const a=vd[s.position].call(this,r,this._eventPosition);i=this._createItems(s),this.title=this.getTitle(i,s),this.beforeBody=this.getBeforeBody(i,s),this.body=this.getBody(i,s),this.afterBody=this.getAfterBody(i,s),this.footer=this.getFooter(i,s);const l=this._size=d_(this,s),c=Object.assign({},a,l),u=h_(this.chart,s,c),d=f_(s,c,u,this.chart);this.xAlign=u.xAlign,this.yAlign=u.yAlign,o={opacity:1,x:d.x,y:d.y,width:l.width,height:l.height,caretX:a.x,caretY:a.y}}this._tooltipItems=i,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,s,r){const o=this.getCaretPosition(e,s,r);n.lineTo(o.x1,o.y1),n.lineTo(o.x2,o.y2),n.lineTo(o.x3,o.y3)}getCaretPosition(e,n,s){const{xAlign:r,yAlign:o}=this,{caretSize:i,cornerRadius:a}=s,{topLeft:l,topRight:c,bottomLeft:u,bottomRight:d}=Oc(a),{x:h,y:f}=e,{width:p,height:m}=n;let x,g,y,b,v,w;return o==="center"?(v=f+m/2,r==="left"?(x=h,g=x-i,b=v+i,w=v-i):(x=h+p,g=x+i,b=v-i,w=v+i),y=x):(r==="left"?g=h+Math.max(l,u)+i:r==="right"?g=h+p-Math.max(c,d)-i:g=this.caretX,o==="top"?(b=f,v=b-i,x=g-i,y=g+i):(b=f+m,v=b+i,x=g+i,y=g-i),w=b),{x1:x,x2:g,x3:y,y1:b,y2:v,y3:w}}drawTitle(e,n,s){const r=this.title,o=r.length;let i,a,l;if(o){const c=Pc(s.rtl,this.x,this.width);for(e.x=pm(this,s.titleAlign,s),n.textAlign=c.textAlign(s.titleAlign),n.textBaseline="middle",i=Rn(s.titleFont),a=s.titleSpacing,n.fillStyle=s.titleColor,n.font=i.string,l=0;l<o;++l)n.fillText(r[l],c.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+a,l+1===o&&(e.y+=s.titleMarginBottom-a)}}_drawColorBox(e,n,s,r,o){const i=this.labelColors[s],a=this.labelPointStyles[s],{boxHeight:l,boxWidth:c}=o,u=Rn(o.bodyFont),d=pm(this,"left",o),h=r.x(d),f=l<u.lineHeight?(u.lineHeight-l)/2:0,p=n.y+f;if(o.usePointStyle){const m={radius:Math.min(c,l)/2,pointStyle:a.pointStyle,rotation:a.rotation,borderWidth:1},x=r.leftForLtr(h,c)+c/2,g=p+l/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,ww(e,m,x,g),e.strokeStyle=i.borderColor,e.fillStyle=i.backgroundColor,ww(e,m,x,g)}else{e.lineWidth=dt(i.borderWidth)?Math.max(...Object.values(i.borderWidth)):i.borderWidth||1,e.strokeStyle=i.borderColor,e.setLineDash(i.borderDash||[]),e.lineDashOffset=i.borderDashOffset||0;const m=r.leftForLtr(h,c),x=r.leftForLtr(r.xPlus(h,1),c-2),g=Oc(i.borderRadius);Object.values(g).some(y=>y!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,o0(e,{x:m,y:p,w:c,h:l,radius:g}),e.fill(),e.stroke(),e.fillStyle=i.backgroundColor,e.beginPath(),o0(e,{x,y:p+1,w:c-2,h:l-2,radius:g}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(m,p,c,l),e.strokeRect(m,p,c,l),e.fillStyle=i.backgroundColor,e.fillRect(x,p+1,c-2,l-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,n,s){const{body:r}=this,{bodySpacing:o,bodyAlign:i,displayColors:a,boxHeight:l,boxWidth:c,boxPadding:u}=s,d=Rn(s.bodyFont);let h=d.lineHeight,f=0;const p=Pc(s.rtl,this.x,this.width),m=function(S){n.fillText(S,p.x(e.x+f),e.y+h/2),e.y+=h+o},x=p.textAlign(i);let g,y,b,v,w,k,C;for(n.textAlign=i,n.textBaseline="middle",n.font=d.string,e.x=pm(this,x,s),n.fillStyle=s.bodyColor,mt(this.beforeBody,m),f=a&&x!=="right"?i==="center"?c/2+u:c+2+u:0,v=0,k=r.length;v<k;++v){for(g=r[v],y=this.labelTextColors[v],n.fillStyle=y,mt(g.before,m),b=g.lines,a&&b.length&&(this._drawColorBox(n,e,v,p,s),h=Math.max(d.lineHeight,l)),w=0,C=b.length;w<C;++w)m(b[w]),h=d.lineHeight;mt(g.after,m)}f=0,h=d.lineHeight,mt(this.afterBody,m),e.y-=o}drawFooter(e,n,s){const r=this.footer,o=r.length;let i,a;if(o){const l=Pc(s.rtl,this.x,this.width);for(e.x=pm(this,s.footerAlign,s),e.y+=s.footerMarginTop,n.textAlign=l.textAlign(s.footerAlign),n.textBaseline="middle",i=Rn(s.footerFont),n.fillStyle=s.footerColor,n.font=i.string,a=0;a<o;++a)n.fillText(r[a],l.x(e.x),e.y+i.lineHeight/2),e.y+=i.lineHeight+s.footerSpacing}}drawBackground(e,n,s,r){const{xAlign:o,yAlign:i}=this,{x:a,y:l}=e,{width:c,height:u}=s,{topLeft:d,topRight:h,bottomLeft:f,bottomRight:p}=Oc(r.cornerRadius);n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,n.lineWidth=r.borderWidth,n.beginPath(),n.moveTo(a+d,l),i==="top"&&this.drawCaret(e,n,s,r),n.lineTo(a+c-h,l),n.quadraticCurveTo(a+c,l,a+c,l+h),i==="center"&&o==="right"&&this.drawCaret(e,n,s,r),n.lineTo(a+c,l+u-p),n.quadraticCurveTo(a+c,l+u,a+c-p,l+u),i==="bottom"&&this.drawCaret(e,n,s,r),n.lineTo(a+f,l+u),n.quadraticCurveTo(a,l+u,a,l+u-f),i==="center"&&o==="left"&&this.drawCaret(e,n,s,r),n.lineTo(a,l+d),n.quadraticCurveTo(a,l,a+d,l),n.closePath(),n.fill(),r.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,s=this.$animations,r=s&&s.x,o=s&&s.y;if(r||o){const i=vd[e.position].call(this,this._active,this._eventPosition);if(!i)return;const a=this._size=d_(this,e),l=Object.assign({},i,this._size),c=h_(n,e,l),u=f_(e,l,c,n);(r._to!==u.x||o._to!==u.y)&&(this.xAlign=c.xAlign,this.yAlign=c.yAlign,this.width=a.width,this.height=a.height,this.caretX=i.x,this.caretY=i.y,this._resolveAnimations().update(this,u))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(n);const r={width:this.width,height:this.height},o={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const i=fs(n.padding),a=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&a&&(e.save(),e.globalAlpha=s,this.drawBackground(o,e,r,n),$B(e,n.textDirection),o.y+=i.top,this.drawTitle(o,e,n),this.drawBody(o,e,n),this.drawFooter(o,e,n),IB(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const s=this._active,r=e.map(({datasetIndex:a,index:l})=>{const c=this.chart.getDatasetMeta(a);if(!c)throw new Error("Cannot find a dataset at index "+a);return{datasetIndex:a,element:c.data[l],index:l}}),o=!Jg(s,r),i=this._positionChanged(r,n);(o||i)&&(this._active=r,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,s=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,o=this._active||[],i=this._getActiveElements(e,o,n,s),a=this._positionChanged(i,e),l=n||!Jg(i,o)||a;return l&&(this._active=i,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),l}_getActiveElements(e,n,s,r){const o=this.options;if(e.type==="mouseout")return[];if(!r)return n.filter(a=>this.chart.data.datasets[a.datasetIndex]&&this.chart.getDatasetMeta(a.datasetIndex).controller.getParsed(a.index)!==void 0);const i=this.chart.getElementsAtEventForMode(e,o.mode,o,s);return o.reverse&&i.reverse(),i}_positionChanged(e,n){const{caretX:s,caretY:r,options:o}=this,i=vd[o.position].call(this,e,n);return i!==!1&&(s!==i.x||r!==i.y)}}Me($w,"positioners",vd);var LCe={id:"tooltip",_element:$w,positioners:vd,afterInit(t,e,n){n&&(t.tooltip=new $w({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:UB},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const zCe=(t,e,n,s)=>(typeof e=="string"?(n=t.push(e)-1,s.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function BCe(t,e,n,s){const r=t.indexOf(e);if(r===-1)return zCe(t,e,n,s);const o=t.lastIndexOf(e);return r!==o?n:r}const VCe=(t,e)=>t===null?null:Tr(Math.round(t),0,e);function g_(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class Iw extends Gl{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const s=this.getLabels();for(const{index:r,label:o}of n)s[r]===o&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(gt(e))return null;const s=this.getLabels();return n=isFinite(n)&&s[n]===e?n:BCe(s,e,et(n,e),this._addedLabels),VCe(n,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),n||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,n=this.max,s=this.options.offset,r=[];let o=this.getLabels();o=e===0&&n===o.length-1?o:o.slice(e,n+1),this._valueRange=Math.max(o.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let i=e;i<=n;i++)r.push({value:i});return r}getLabelForValue(e){return g_.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}Me(Iw,"id","category"),Me(Iw,"defaults",{ticks:{callback:g_}});function WCe(t,e){const n=[],{bounds:r,step:o,min:i,max:a,precision:l,count:c,maxTicks:u,maxDigits:d,includeBounds:h}=t,f=o||1,p=u-1,{min:m,max:x}=e,g=!gt(i),y=!gt(a),b=!gt(c),v=(x-m)/(d+1);let w=kN((x-m)/p/f)*f,k,C,S,I;if(w<1e-14&&!g&&!y)return[{value:m},{value:x}];I=Math.ceil(x/w)-Math.floor(m/w),I>p&&(w=kN(I*w/p/f)*f),gt(l)||(k=Math.pow(10,l),w=Math.ceil(w*k)/k),r==="ticks"?(C=Math.floor(m/w)*w,S=Math.ceil(x/w)*w):(C=m,S=x),g&&y&&o&&Nve((a-i)/o,w/1e3)?(I=Math.round(Math.min((a-i)/w,u)),w=(a-i)/I,C=i,S=a):b?(C=g?i:C,S=y?a:S,I=c-1,w=(S-C)/I):(I=(S-C)/w,Bd(I,Math.round(I),w/1e3)?I=Math.round(I):I=Math.ceil(I));const $=Math.max(CN(w),CN(C));k=Math.pow(10,gt(l)?$:l),C=Math.round(C*k)/k,S=Math.round(S*k)/k;let E=0;for(g&&(h&&C!==i?(n.push({value:i}),C<i&&E++,Bd(Math.round((C+E*w)*k)/k,i,x_(i,v,t))&&E++):C<i&&E++);E<I;++E){const _=Math.round((C+E*w)*k)/k;if(y&&_>a)break;n.push({value:_})}return y&&h&&S!==a?n.length&&Bd(n[n.length-1].value,a,x_(a,v,t))?n[n.length-1].value=a:n.push({value:a}):(!y||S===a)&&n.push({value:S}),n}function x_(t,e,{horizontal:n,minRotation:s}){const r=Bi(s),o=(n?Math.sin(r):Math.cos(r))||.001,i=.75*e*(""+t).length;return Math.min(e/o,i)}class l0 extends Gl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return gt(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:s}=this.getUserBounds();let{min:r,max:o}=this;const i=l=>r=n?r:l,a=l=>o=s?o:l;if(e){const l=iu(r),c=iu(o);l<0&&c<0?a(0):l>0&&c>0&&i(0)}if(r===o){let l=o===0?1:Math.abs(o*.05);a(o+l),e||i(r-l)}this.min=r,this.max=o}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),n=n||11),n&&(r=Math.min(n,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},o=this._range||this,i=WCe(r,o);return e.bounds==="ticks"&&hB(i,this,"value"),e.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}configure(){const e=this.ticks;let n=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-n)/Math.max(e.length-1,1)/2;n-=r,s+=r}this._startValue=n,this._endValue=s,this._valueRange=s-n}getLabelForValue(e){return rI(e,this.chart.options.locale,this.options.ticks.format)}}class Tw extends l0{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=On(e)?e:0,this.max=On(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,s=Bi(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,o=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,o.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}Me(Tw,"id","linear"),Me(Tw,"defaults",{ticks:{callback:Yy.formatters.numeric}});const Ih=t=>Math.floor(zi(t)),Ra=(t,e)=>Math.pow(10,Ih(t)+e);function y_(t){return t/Math.pow(10,Ih(t))===1}function b_(t,e,n){const s=Math.pow(10,n),r=Math.floor(t/s);return Math.ceil(e/s)-r}function UCe(t,e){const n=e-t;let s=Ih(n);for(;b_(t,e,s)>10;)s++;for(;b_(t,e,s)<10;)s--;return Math.min(s,Ih(t))}function HCe(t,{min:e,max:n}){e=Gs(t.min,e);const s=[],r=Ih(e);let o=UCe(e,n),i=o<0?Math.pow(10,Math.abs(o)):1;const a=Math.pow(10,o),l=r>o?Math.pow(10,r):0,c=Math.round((e-l)*i)/i,u=Math.floor((e-l)/a/10)*a*10;let d=Math.floor((c-u)/Math.pow(10,o)),h=Gs(t.min,Math.round((l+u+d*Math.pow(10,o))*i)/i);for(;h<n;)s.push({value:h,major:y_(h),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(o++,d=2,i=o>=0?1:i),h=Math.round((l+u+d*Math.pow(10,o))*i)/i;const f=Gs(t.max,h);return s.push({value:f,major:y_(f),significand:d}),s}class v_ extends Gl{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(e,n){const s=l0.prototype.parse.apply(this,[e,n]);if(s===0){this._zero=!0;return}return On(s)&&s>0?s:null}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=On(e)?Math.max(0,e):null,this.max=On(n)?Math.max(0,n):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!On(this._userMin)&&(this.min=e===Ra(this.min,0)?Ra(this.min,-1):Ra(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let s=this.min,r=this.max;const o=a=>s=e?s:a,i=a=>r=n?r:a;s===r&&(s<=0?(o(1),i(10)):(o(Ra(s,-1)),i(Ra(r,1)))),s<=0&&o(Ra(r,-1)),r<=0&&i(Ra(s,1)),this.min=s,this.max=r}buildTicks(){const e=this.options,n={min:this._userMin,max:this._userMax},s=HCe(n,this);return e.bounds==="ticks"&&hB(s,this,"value"),e.reverse?(s.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),s}getLabelForValue(e){return e===void 0?"0":rI(e,this.chart.options.locale,this.options.ticks.format)}configure(){const e=this.min;super.configure(),this._startValue=zi(e),this._valueRange=zi(this.max)-zi(e)}getPixelForValue(e){return(e===void 0||e===0)&&(e=this.min),e===null||isNaN(e)?NaN:this.getPixelForDecimal(e===this.min?0:(zi(e)-this._startValue)/this._valueRange)}getValueForPixel(e){const n=this.getDecimalForPixel(e);return Math.pow(10,this._startValue+n*this._valueRange)}}Me(v_,"id","logarithmic"),Me(v_,"defaults",{ticks:{callback:Yy.formatters.logarithmic,major:{enabled:!0}}});function Ew(t){const e=t.ticks;if(e.display&&t.display){const n=fs(e.backdropPadding);return et(e.font&&e.font.size,en.font.size)+n.height}return 0}function GCe(t,e,n){return n=jt(n)?n:[n],{w:Yve(t,e.string,n),h:n.length*e.lineHeight}}function w_(t,e,n,s,r){return t===s||t===r?{start:e-n/2,end:e+n/2}:t<s||t>r?{start:e-n,end:e}:{start:e,end:e+n}}function jCe(t){const e={l:t.left+t._padding.left,r:t.right-t._padding.right,t:t.top+t._padding.top,b:t.bottom-t._padding.bottom},n=Object.assign({},e),s=[],r=[],o=t._pointLabels.length,i=t.options.pointLabels,a=i.centerPointLabels?Sn/o:0;for(let l=0;l<o;l++){const c=i.setContext(t.getPointLabelContext(l));r[l]=c.padding;const u=t.getPointPosition(l,t.drawingArea+r[l],a),d=Rn(c.font),h=GCe(t.ctx,d,t._pointLabels[l]);s[l]=h;const f=jr(t.getIndexAngle(l)+a),p=Math.round(eI(f)),m=w_(p,u.x,h.w,0,180),x=w_(p,u.y,h.h,90,270);KCe(n,e,f,m,x)}t.setCenterPoint(e.l-n.l,n.r-e.r,e.t-n.t,n.b-e.b),t._pointLabelItems=YCe(t,s,r)}function KCe(t,e,n,s,r){const o=Math.abs(Math.sin(n)),i=Math.abs(Math.cos(n));let a=0,l=0;s.start<e.l?(a=(e.l-s.start)/o,t.l=Math.min(t.l,e.l-a)):s.end>e.r&&(a=(s.end-e.r)/o,t.r=Math.max(t.r,e.r+a)),r.start<e.t?(l=(e.t-r.start)/i,t.t=Math.min(t.t,e.t-l)):r.end>e.b&&(l=(r.end-e.b)/i,t.b=Math.max(t.b,e.b+l))}function XCe(t,e,n){const s=t.drawingArea,{extra:r,additionalAngle:o,padding:i,size:a}=n,l=t.getPointPosition(e,s+r+i,o),c=Math.round(eI(jr(l.angle+Qs))),u=JCe(l.y,a.h,c),d=QCe(c),h=ZCe(l.x,a.w,d);return{visible:!0,x:l.x,y:u,textAlign:d,left:h,top:u,right:h+a.w,bottom:u+a.h}}function qCe(t,e){if(!e)return!0;const{left:n,top:s,right:r,bottom:o}=t;return!(ti({x:n,y:s},e)||ti({x:n,y:o},e)||ti({x:r,y:s},e)||ti({x:r,y:o},e))}function YCe(t,e,n){const s=[],r=t._pointLabels.length,o=t.options,{centerPointLabels:i,display:a}=o.pointLabels,l={extra:Ew(o)/2,additionalAngle:i?Sn/r:0};let c;for(let u=0;u<r;u++){l.padding=n[u],l.size=e[u];const d=XCe(t,u,l);s.push(d),a==="auto"&&(d.visible=qCe(d,c),d.visible&&(c=d))}return s}function QCe(t){return t===0||t===180?"center":t<180?"left":"right"}function ZCe(t,e,n){return n==="right"?t-=e:n==="center"&&(t-=e/2),t}function JCe(t,e,n){return n===90||n===270?t-=e/2:(n>270||n<90)&&(t-=e),t}function eSe(t,e,n){const{left:s,top:r,right:o,bottom:i}=n,{backdropColor:a}=e;if(!gt(a)){const l=Oc(e.borderRadius),c=fs(e.backdropPadding);t.fillStyle=a;const u=s-c.left,d=r-c.top,h=o-s+c.width,f=i-r+c.height;Object.values(l).some(p=>p!==0)?(t.beginPath(),o0(t,{x:u,y:d,w:h,h:f,radius:l}),t.fill()):t.fillRect(u,d,h,f)}}function tSe(t,e){const{ctx:n,options:{pointLabels:s}}=t;for(let r=e-1;r>=0;r--){const o=t._pointLabelItems[r];if(!o.visible)continue;const i=s.setContext(t.getPointLabelContext(r));eSe(n,i,o);const a=Rn(i.font),{x:l,y:c,textAlign:u}=o;El(n,t._pointLabels[r],l,c+a.lineHeight/2,a,{color:i.color,textAlign:u,textBaseline:"middle"})}}function HB(t,e,n,s){const{ctx:r}=t;if(n)r.arc(t.xCenter,t.yCenter,e,0,_r);else{let o=t.getPointPosition(0,e);r.moveTo(o.x,o.y);for(let i=1;i<s;i++)o=t.getPointPosition(i,e),r.lineTo(o.x,o.y)}}function nSe(t,e,n,s,r){const o=t.ctx,i=e.circular,{color:a,lineWidth:l}=e;!i&&!s||!a||!l||n<0||(o.save(),o.strokeStyle=a,o.lineWidth=l,o.setLineDash(r.dash||[]),o.lineDashOffset=r.dashOffset,o.beginPath(),HB(t,n,i,s),o.closePath(),o.stroke(),o.restore())}function sSe(t,e,n){return Sa(t,{label:n,index:e,type:"pointLabel"})}class mm extends l0{constructor(e){super(e),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){const e=this._padding=fs(Ew(this.options)/2),n=this.width=this.maxWidth-e.width,s=this.height=this.maxHeight-e.height;this.xCenter=Math.floor(this.left+n/2+e.left),this.yCenter=Math.floor(this.top+s/2+e.top),this.drawingArea=Math.floor(Math.min(n,s)/2)}determineDataLimits(){const{min:e,max:n}=this.getMinMax(!1);this.min=On(e)&&!isNaN(e)?e:0,this.max=On(n)&&!isNaN(n)?n:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/Ew(this.options))}generateTickLabels(e){l0.prototype.generateTickLabels.call(this,e),this._pointLabels=this.getLabels().map((n,s)=>{const r=Tt(this.options.pointLabels.callback,[n,s],this);return r||r===0?r:""}).filter((n,s)=>this.chart.getDataVisibility(s))}fit(){const e=this.options;e.display&&e.pointLabels.display?jCe(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(e,n,s,r){this.xCenter+=Math.floor((e-n)/2),this.yCenter+=Math.floor((s-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(e,n,s,r))}getIndexAngle(e){const n=_r/(this._pointLabels.length||1),s=this.options.startAngle||0;return jr(e*n+Bi(s))}getDistanceFromCenterForValue(e){if(gt(e))return NaN;const n=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-e)*n:(e-this.min)*n}getValueForDistanceFromCenter(e){if(gt(e))return NaN;const n=e/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-n:this.min+n}getPointLabelContext(e){const n=this._pointLabels||[];if(e>=0&&e<n.length){const s=n[e];return sSe(this.getContext(),e,s)}}getPointPosition(e,n,s=0){const r=this.getIndexAngle(e)-Qs+s;return{x:Math.cos(r)*n+this.xCenter,y:Math.sin(r)*n+this.yCenter,angle:r}}getPointPositionForValue(e,n){return this.getPointPosition(e,this.getDistanceFromCenterForValue(n))}getBasePosition(e){return this.getPointPositionForValue(e||0,this.getBaseValue())}getPointLabelPosition(e){const{left:n,top:s,right:r,bottom:o}=this._pointLabelItems[e];return{left:n,top:s,right:r,bottom:o}}drawBackground(){const{backgroundColor:e,grid:{circular:n}}=this.options;if(e){const s=this.ctx;s.save(),s.beginPath(),HB(this,this.getDistanceFromCenterForValue(this._endValue),n,this._pointLabels.length),s.closePath(),s.fillStyle=e,s.fill(),s.restore()}}drawGrid(){const e=this.ctx,n=this.options,{angleLines:s,grid:r,border:o}=n,i=this._pointLabels.length;let a,l,c;if(n.pointLabels.display&&tSe(this,i),r.display&&this.ticks.forEach((u,d)=>{if(d!==0||d===0&&this.min<0){l=this.getDistanceFromCenterForValue(u.value);const h=this.getContext(d),f=r.setContext(h),p=o.setContext(h);nSe(this,f,l,i,p)}}),s.display){for(e.save(),a=i-1;a>=0;a--){const u=s.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:h}=u;!h||!d||(e.lineWidth=h,e.strokeStyle=d,e.setLineDash(u.borderDash),e.lineDashOffset=u.borderDashOffset,l=this.getDistanceFromCenterForValue(n.reverse?this.min:this.max),c=this.getPointPosition(a,l),e.beginPath(),e.moveTo(this.xCenter,this.yCenter),e.lineTo(c.x,c.y),e.stroke())}e.restore()}}drawBorder(){}drawLabels(){const e=this.ctx,n=this.options,s=n.ticks;if(!s.display)return;const r=this.getIndexAngle(0);let o,i;e.save(),e.translate(this.xCenter,this.yCenter),e.rotate(r),e.textAlign="center",e.textBaseline="middle",this.ticks.forEach((a,l)=>{if(l===0&&this.min>=0&&!n.reverse)return;const c=s.setContext(this.getContext(l)),u=Rn(c.font);if(o=this.getDistanceFromCenterForValue(this.ticks[l].value),c.showLabelBackdrop){e.font=u.string,i=e.measureText(a.label).width,e.fillStyle=c.backdropColor;const d=fs(c.backdropPadding);e.fillRect(-i/2-d.left,-o-u.size/2-d.top,i+d.width,u.size+d.height)}El(e,a.label,0,-o,u,{color:c.color,strokeColor:c.textStrokeColor,strokeWidth:c.textStrokeWidth})}),e.restore()}drawTitle(){}}Me(mm,"id","radialLinear"),Me(mm,"defaults",{display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:Yy.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(e){return e},padding:5,centerPointLabels:!1}}),Me(mm,"defaultRoutes",{"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"}),Me(mm,"descriptors",{angleLines:{_fallback:"grid"}});const Jy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},As=Object.keys(Jy);function k_(t,e){return t-e}function C_(t,e){if(gt(e))return null;const n=t._adapter,{parser:s,round:r,isoWeekday:o}=t._parseOpts;let i=e;return typeof s=="function"&&(i=s(i)),On(i)||(i=typeof s=="string"?n.parse(i,s):n.parse(i)),i===null?null:(r&&(i=r==="week"&&(Sh(o)||o===!0)?n.startOf(i,"isoWeek",o):n.startOf(i,r)),+i)}function S_(t,e,n,s){const r=As.length;for(let o=As.indexOf(t);o<r-1;++o){const i=Jy[As[o]],a=i.steps?i.steps:Number.MAX_SAFE_INTEGER;if(i.common&&Math.ceil((n-e)/(a*i.size))<=s)return As[o]}return As[r-1]}function rSe(t,e,n,s,r){for(let o=As.length-1;o>=As.indexOf(n);o--){const i=As[o];if(Jy[i].common&&t._adapter.diff(r,s,i)>=e-1)return i}return As[n?As.indexOf(n):0]}function oSe(t){for(let e=As.indexOf(t)+1,n=As.length;e<n;++e)if(Jy[As[e]].common)return As[e]}function $_(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:s,hi:r}=tI(n,e),o=n[s]>=e?n[s]:n[r];t[o]=!0}}function iSe(t,e,n,s){const r=t._adapter,o=+r.startOf(e[0].value,s),i=e[e.length-1].value;let a,l;for(a=o;a<=i;a=+r.add(a,1,s))l=n[a],l>=0&&(e[l].major=!0);return e}function I_(t,e,n){const s=[],r={},o=e.length;let i,a;for(i=0;i<o;++i)a=e[i],r[a]=i,s.push({value:a,major:!1});return o===0||!n?s:iSe(t,s,r,n)}class c0 extends Gl{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const s=e.time||(e.time={}),r=this._adapter=new oke._date(e.adapters.date);r.init(n),zd(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:C_(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,s=e.time.unit||"day";let{min:r,max:o,minDefined:i,maxDefined:a}=this.getUserBounds();function l(c){!i&&!isNaN(c.min)&&(r=Math.min(r,c.min)),!a&&!isNaN(c.max)&&(o=Math.max(o,c.max))}(!i||!a)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),r=On(r)&&!isNaN(r)?r:+n.startOf(Date.now(),s),o=On(o)&&!isNaN(o)?o:+n.endOf(Date.now(),s)+1,this.min=Math.min(r,o-1),this.max=Math.max(r+1,o)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],s=e[e.length-1]),{min:n,max:s}}buildTicks(){const e=this.options,n=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const o=this.min,i=this.max,a=Fve(r,o,i);return this._unit=n.unit||(s.autoSkip?S_(n.minUnit,this.min,this.max,this._getLabelCapacity(o)):rSe(this,a.length,n.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:oSe(this._unit),this.initOffsets(r),e.reverse&&a.reverse(),I_(this,a,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,s=0,r,o;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?n=1-r:n=(this.getDecimalForValue(e[1])-r)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?s=o:s=(o-this.getDecimalForValue(e[e.length-2]))/2);const i=e.length<3?.5:.25;n=Tr(n,0,i),s=Tr(s,0,i),this._offsets={start:n,end:s,factor:1/(n+1+s)}}_generate(){const e=this._adapter,n=this.min,s=this.max,r=this.options,o=r.time,i=o.unit||S_(o.minUnit,n,s,this._getLabelCapacity(n)),a=et(r.ticks.stepSize,1),l=i==="week"?o.isoWeekday:!1,c=Sh(l)||l===!0,u={};let d=n,h,f;if(c&&(d=+e.startOf(d,"isoWeek",l)),d=+e.startOf(d,c?"day":i),e.diff(s,n,i)>1e5*a)throw new Error(n+" and "+s+" are too far apart with stepSize of "+a+" "+i);const p=r.ticks.source==="data"&&this.getDataTimestamps();for(h=d,f=0;h<s;h=+e.add(h,a,i),f++)$_(u,h,p);return(h===s||r.bounds==="ticks"||f===1)&&$_(u,h,p),Object.keys(u).sort(k_).map(m=>+m)}getLabelForValue(e){const n=this._adapter,s=this.options.time;return s.tooltipFormat?n.format(e,s.tooltipFormat):n.format(e,s.displayFormats.datetime)}format(e,n){const r=this.options.time.displayFormats,o=this._unit,i=n||r[o];return this._adapter.format(e,i)}_tickFormatFunction(e,n,s,r){const o=this.options,i=o.ticks.callback;if(i)return Tt(i,[e,n,s],this);const a=o.time.displayFormats,l=this._unit,c=this._majorUnit,u=l&&a[l],d=c&&a[c],h=s[n],f=c&&d&&h&&h.major;return this._adapter.format(e,r||(f?d:u))}generateTickLabels(e){let n,s,r;for(n=0,s=e.length;n<s;++n)r=e[n],r.label=this._tickFormatFunction(r.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+s)*n.factor)}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,s=this.ctx.measureText(e).width,r=Bi(this.isHorizontal()?n.maxRotation:n.minRotation),o=Math.cos(r),i=Math.sin(r),a=this._resolveTickFontOptions(0).size;return{w:s*o+a*i,h:s*i+a*o}}_getLabelCapacity(e){const n=this.options.time,s=n.displayFormats,r=s[n.unit]||s.millisecond,o=this._tickFormatFunction(e,0,I_(this,[e],this._majorUnit),r),i=this._getLabelSize(o),a=Math.floor(this.isHorizontal()?this.width/i.w:this.height/i.h)-1;return a>0?a:1}getDataTimestamps(){let e=this._cache.data||[],n,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(n=0,s=r.length;n<s;++n)e=e.concat(r[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,s;if(e.length)return e;const r=this.getLabels();for(n=0,s=r.length;n<s;++n)e.push(C_(this,r[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Pve(e.sort(k_))}}Me(c0,"id","time"),Me(c0,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function gm(t,e,n){let s=0,r=t.length-1,o,i,a,l;n?(e>=t[s].pos&&e<=t[r].pos&&({lo:s,hi:r}=Ya(t,"pos",e)),{pos:o,time:a}=t[s],{pos:i,time:l}=t[r]):(e>=t[s].time&&e<=t[r].time&&({lo:s,hi:r}=Ya(t,"time",e)),{time:o,pos:a}=t[s],{time:i,pos:l}=t[r]);const c=i-o;return c?a+(l-a)*(e-o)/c:a}class T_ extends c0{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=gm(n,this.min),this._tableRange=gm(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:s}=this,r=[],o=[];let i,a,l,c,u;for(i=0,a=e.length;i<a;++i)c=e[i],c>=n&&c<=s&&r.push(c);if(r.length<2)return[{time:n,pos:0},{time:s,pos:1}];for(i=0,a=r.length;i<a;++i)u=r[i+1],l=r[i-1],c=r[i],Math.round((u+l)/2)!==c&&o.push({time:c,pos:i/(a-1)});return o}_generate(){const e=this.min,n=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(n)||s.length===1)&&s.push(n),s.sort((r,o)=>r-o)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),s=this.getLabelTimestamps();return n.length&&s.length?e=this.normalize(n.concat(s)):e=n.length?n:s,e=this._cache.all=e,e}getDecimalForValue(e){return(gm(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,s=this.getDecimalForPixel(e)/n.factor-n.end;return gm(this._table,s*this._tableRange+this._minPos,!0)}}Me(T_,"id","timeseries"),Me(T_,"defaults",c0.defaults);const GB="label";function E_(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function aSe(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function jB(t,e){t.labels=e}function KB(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:GB;const s=[];t.datasets=e.map(r=>{const o=t.datasets.find(i=>i[n]===r[n]);return!o||!r.data||s.includes(o)?{...r}:(s.push(o),Object.assign(o,r),o)})}function lSe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:GB;const n={labels:[],datasets:[]};return jB(n,t.labels),KB(n,t.datasets,e),n}function cSe(t,e){const{height:n=150,width:s=300,redraw:r=!1,datasetIdKey:o,type:i,data:a,options:l,plugins:c=[],fallbackContent:u,updateMode:d,...h}=t,f=A.useRef(null),p=A.useRef(null),m=()=>{f.current&&(p.current=new Zy(f.current,{type:i,data:lSe(a,o),options:l&&{...l},plugins:c}),E_(e,p.current))},x=()=>{E_(e,null),p.current&&(p.current.destroy(),p.current=null)};return A.useEffect(()=>{!r&&p.current&&l&&aSe(p.current,l)},[r,l]),A.useEffect(()=>{!r&&p.current&&jB(p.current.config.data,a.labels)},[r,a.labels]),A.useEffect(()=>{!r&&p.current&&a.datasets&&KB(p.current.config.data,a.datasets,o)},[r,a.datasets]),A.useEffect(()=>{p.current&&(r?(x(),setTimeout(m)):p.current.update(d))},[r,l,a.labels,a.datasets,d]),A.useEffect(()=>{p.current&&(x(),setTimeout(m))},[i]),A.useEffect(()=>(m(),()=>x()),[]),me.createElement("canvas",{ref:f,role:"img",height:n,width:s,...h},u)}const uSe=A.forwardRef(cSe);function dSe(t,e){return Zy.register(e),A.forwardRef((n,s)=>me.createElement(uSe,{...n,ref:s,type:t}))}const hSe=dSe("line",zm);var fSe={value:()=>{}};function XB(){for(var t=0,e=arguments.length,n={},s;t<e;++t){if(!(s=arguments[t]+"")||s in n||/[\s.]/.test(s))throw new Error("illegal type: "+s);n[s]=[]}return new Um(n)}function Um(t){this._=t}function pSe(t,e){return t.trim().split(/^|\s+/).map(function(n){var s="",r=n.indexOf(".");if(r>=0&&(s=n.slice(r+1),n=n.slice(0,r)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:s}})}Um.prototype=XB.prototype={constructor:Um,on:function(t,e){var n=this._,s=pSe(t+"",n),r,o=-1,i=s.length;if(arguments.length<2){for(;++o<i;)if((r=(t=s[o]).type)&&(r=mSe(n[r],t.name)))return r;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++o<i;)if(r=(t=s[o]).type)n[r]=N_(n[r],t.name,e);else if(e==null)for(r in n)n[r]=N_(n[r],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new Um(t)},call:function(t,e){if((r=arguments.length-2)>0)for(var n=new Array(r),s=0,r,o;s<r;++s)n[s]=arguments[s+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(o=this._[t],s=0,r=o.length;s<r;++s)o[s].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var s=this._[t],r=0,o=s.length;r<o;++r)s[r].value.apply(e,n)}};function mSe(t,e){for(var n=0,s=t.length,r;n<s;++n)if((r=t[n]).name===e)return r.value}function N_(t,e,n){for(var s=0,r=t.length;s<r;++s)if(t[s].name===e){t[s]=fSe,t=t.slice(0,s).concat(t.slice(s+1));break}return n!=null&&t.push({name:e,value:n}),t}var Nw="http://www.w3.org/1999/xhtml";const __={svg:"http://www.w3.org/2000/svg",xhtml:Nw,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function eb(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),__.hasOwnProperty(e)?{space:__[e],local:t}:t}function gSe(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Nw&&e.documentElement.namespaceURI===Nw?e.createElement(t):e.createElementNS(n,t)}}function xSe(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function qB(t){var e=eb(t);return(e.local?xSe:gSe)(e)}function ySe(){}function fI(t){return t==null?ySe:function(){return this.querySelector(t)}}function bSe(t){typeof t!="function"&&(t=fI(t));for(var e=this._groups,n=e.length,s=new Array(n),r=0;r<n;++r)for(var o=e[r],i=o.length,a=s[r]=new Array(i),l,c,u=0;u<i;++u)(l=o[u])&&(c=t.call(l,l.__data__,u,o))&&("__data__"in l&&(c.__data__=l.__data__),a[u]=c);return new rr(s,this._parents)}function vSe(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function wSe(){return[]}function YB(t){return t==null?wSe:function(){return this.querySelectorAll(t)}}function kSe(t){return function(){return vSe(t.apply(this,arguments))}}function CSe(t){typeof t=="function"?t=kSe(t):t=YB(t);for(var e=this._groups,n=e.length,s=[],r=[],o=0;o<n;++o)for(var i=e[o],a=i.length,l,c=0;c<a;++c)(l=i[c])&&(s.push(t.call(l,l.__data__,c,i)),r.push(l));return new rr(s,r)}function QB(t){return function(){return this.matches(t)}}function ZB(t){return function(e){return e.matches(t)}}var SSe=Array.prototype.find;function $Se(t){return function(){return SSe.call(this.children,t)}}function ISe(){return this.firstElementChild}function TSe(t){return this.select(t==null?ISe:$Se(typeof t=="function"?t:ZB(t)))}var ESe=Array.prototype.filter;function NSe(){return Array.from(this.children)}function _Se(t){return function(){return ESe.call(this.children,t)}}function RSe(t){return this.selectAll(t==null?NSe:_Se(typeof t=="function"?t:ZB(t)))}function ASe(t){typeof t!="function"&&(t=QB(t));for(var e=this._groups,n=e.length,s=new Array(n),r=0;r<n;++r)for(var o=e[r],i=o.length,a=s[r]=[],l,c=0;c<i;++c)(l=o[c])&&t.call(l,l.__data__,c,o)&&a.push(l);return new rr(s,this._parents)}function JB(t){return new Array(t.length)}function DSe(){return new rr(this._enter||this._groups.map(JB),this._parents)}function u0(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}u0.prototype={constructor:u0,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function FSe(t){return function(){return t}}function OSe(t,e,n,s,r,o){for(var i=0,a,l=e.length,c=o.length;i<c;++i)(a=e[i])?(a.__data__=o[i],s[i]=a):n[i]=new u0(t,o[i]);for(;i<l;++i)(a=e[i])&&(r[i]=a)}function PSe(t,e,n,s,r,o,i){var a,l,c=new Map,u=e.length,d=o.length,h=new Array(u),f;for(a=0;a<u;++a)(l=e[a])&&(h[a]=f=i.call(l,l.__data__,a,e)+"",c.has(f)?r[a]=l:c.set(f,l));for(a=0;a<d;++a)f=i.call(t,o[a],a,o)+"",(l=c.get(f))?(s[a]=l,l.__data__=o[a],c.delete(f)):n[a]=new u0(t,o[a]);for(a=0;a<u;++a)(l=e[a])&&c.get(h[a])===l&&(r[a]=l)}function MSe(t){return t.__data__}function LSe(t,e){if(!arguments.length)return Array.from(this,MSe);var n=e?PSe:OSe,s=this._parents,r=this._groups;typeof t!="function"&&(t=FSe(t));for(var o=r.length,i=new Array(o),a=new Array(o),l=new Array(o),c=0;c<o;++c){var u=s[c],d=r[c],h=d.length,f=zSe(t.call(u,u&&u.__data__,c,s)),p=f.length,m=a[c]=new Array(p),x=i[c]=new Array(p),g=l[c]=new Array(h);n(u,d,m,x,g,f,e);for(var y=0,b=0,v,w;y<p;++y)if(v=m[y]){for(y>=b&&(b=y+1);!(w=x[b])&&++b<p;);v._next=w||null}}return i=new rr(i,s),i._enter=a,i._exit=l,i}function zSe(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function BSe(){return new rr(this._exit||this._groups.map(JB),this._parents)}function VSe(t,e,n){var s=this.enter(),r=this,o=this.exit();return typeof t=="function"?(s=t(s),s&&(s=s.selection())):s=s.append(t+""),e!=null&&(r=e(r),r&&(r=r.selection())),n==null?o.remove():n(o),s&&r?s.merge(r).order():r}function WSe(t){for(var e=t.selection?t.selection():t,n=this._groups,s=e._groups,r=n.length,o=s.length,i=Math.min(r,o),a=new Array(r),l=0;l<i;++l)for(var c=n[l],u=s[l],d=c.length,h=a[l]=new Array(d),f,p=0;p<d;++p)(f=c[p]||u[p])&&(h[p]=f);for(;l<r;++l)a[l]=n[l];return new rr(a,this._parents)}function USe(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var s=t[e],r=s.length-1,o=s[r],i;--r>=0;)(i=s[r])&&(o&&i.compareDocumentPosition(o)^4&&o.parentNode.insertBefore(i,o),o=i);return this}function HSe(t){t||(t=GSe);function e(d,h){return d&&h?t(d.__data__,h.__data__):!d-!h}for(var n=this._groups,s=n.length,r=new Array(s),o=0;o<s;++o){for(var i=n[o],a=i.length,l=r[o]=new Array(a),c,u=0;u<a;++u)(c=i[u])&&(l[u]=c);l.sort(e)}return new rr(r,this._parents).order()}function GSe(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function jSe(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function KSe(){return Array.from(this)}function XSe(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],r=0,o=s.length;r<o;++r){var i=s[r];if(i)return i}return null}function qSe(){let t=0;for(const e of this)++t;return t}function YSe(){return!this.node()}function QSe(t){for(var e=this._groups,n=0,s=e.length;n<s;++n)for(var r=e[n],o=0,i=r.length,a;o<i;++o)(a=r[o])&&t.call(a,a.__data__,o,r);return this}function ZSe(t){return function(){this.removeAttribute(t)}}function JSe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function e$e(t,e){return function(){this.setAttribute(t,e)}}function t$e(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function n$e(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function s$e(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function r$e(t,e){var n=eb(t);if(arguments.length<2){var s=this.node();return n.local?s.getAttributeNS(n.space,n.local):s.getAttribute(n)}return this.each((e==null?n.local?JSe:ZSe:typeof e=="function"?n.local?s$e:n$e:n.local?t$e:e$e)(n,e))}function e4(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function o$e(t){return function(){this.style.removeProperty(t)}}function i$e(t,e,n){return function(){this.style.setProperty(t,e,n)}}function a$e(t,e,n){return function(){var s=e.apply(this,arguments);s==null?this.style.removeProperty(t):this.style.setProperty(t,s,n)}}function l$e(t,e,n){return arguments.length>1?this.each((e==null?o$e:typeof e=="function"?a$e:i$e)(t,e,n??"")):cu(this.node(),t)}function cu(t,e){return t.style.getPropertyValue(e)||e4(t).getComputedStyle(t,null).getPropertyValue(e)}function c$e(t){return function(){delete this[t]}}function u$e(t,e){return function(){this[t]=e}}function d$e(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function h$e(t,e){return arguments.length>1?this.each((e==null?c$e:typeof e=="function"?d$e:u$e)(t,e)):this.node()[t]}function t4(t){return t.trim().split(/^|\s+/)}function pI(t){return t.classList||new n4(t)}function n4(t){this._node=t,this._names=t4(t.getAttribute("class")||"")}n4.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function s4(t,e){for(var n=pI(t),s=-1,r=e.length;++s<r;)n.add(e[s])}function r4(t,e){for(var n=pI(t),s=-1,r=e.length;++s<r;)n.remove(e[s])}function f$e(t){return function(){s4(this,t)}}function p$e(t){return function(){r4(this,t)}}function m$e(t,e){return function(){(e.apply(this,arguments)?s4:r4)(this,t)}}function g$e(t,e){var n=t4(t+"");if(arguments.length<2){for(var s=pI(this.node()),r=-1,o=n.length;++r<o;)if(!s.contains(n[r]))return!1;return!0}return this.each((typeof e=="function"?m$e:e?f$e:p$e)(n,e))}function x$e(){this.textContent=""}function y$e(t){return function(){this.textContent=t}}function b$e(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function v$e(t){return arguments.length?this.each(t==null?x$e:(typeof t=="function"?b$e:y$e)(t)):this.node().textContent}function w$e(){this.innerHTML=""}function k$e(t){return function(){this.innerHTML=t}}function C$e(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function S$e(t){return arguments.length?this.each(t==null?w$e:(typeof t=="function"?C$e:k$e)(t)):this.node().innerHTML}function $$e(){this.nextSibling&&this.parentNode.appendChild(this)}function I$e(){return this.each($$e)}function T$e(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function E$e(){return this.each(T$e)}function N$e(t){var e=typeof t=="function"?t:qB(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function _$e(){return null}function R$e(t,e){var n=typeof t=="function"?t:qB(t),s=e==null?_$e:typeof e=="function"?e:fI(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),s.apply(this,arguments)||null)})}function A$e(){var t=this.parentNode;t&&t.removeChild(this)}function D$e(){return this.each(A$e)}function F$e(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function O$e(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function P$e(t){return this.select(t?O$e:F$e)}function M$e(t){return arguments.length?this.property("__data__",t):this.node().__data__}function L$e(t){return function(e){t.call(this,e,this.__data__)}}function z$e(t){return t.trim().split(/^|\s+/).map(function(e){var n="",s=e.indexOf(".");return s>=0&&(n=e.slice(s+1),e=e.slice(0,s)),{type:e,name:n}})}function B$e(t){return function(){var e=this.__on;if(e){for(var n=0,s=-1,r=e.length,o;n<r;++n)o=e[n],(!t.type||o.type===t.type)&&o.name===t.name?this.removeEventListener(o.type,o.listener,o.options):e[++s]=o;++s?e.length=s:delete this.__on}}}function V$e(t,e,n){return function(){var s=this.__on,r,o=L$e(e);if(s){for(var i=0,a=s.length;i<a;++i)if((r=s[i]).type===t.type&&r.name===t.name){this.removeEventListener(r.type,r.listener,r.options),this.addEventListener(r.type,r.listener=o,r.options=n),r.value=e;return}}this.addEventListener(t.type,o,n),r={type:t.type,name:t.name,value:e,listener:o,options:n},s?s.push(r):this.__on=[r]}}function W$e(t,e,n){var s=z$e(t+""),r,o=s.length,i;if(arguments.length<2){var a=this.node().__on;if(a){for(var l=0,c=a.length,u;l<c;++l)for(r=0,u=a[l];r<o;++r)if((i=s[r]).type===u.type&&i.name===u.name)return u.value}return}for(a=e?V$e:B$e,r=0;r<o;++r)this.each(a(s[r],e,n));return this}function o4(t,e,n){var s=e4(t),r=s.CustomEvent;typeof r=="function"?r=new r(e,n):(r=s.document.createEvent("Event"),n?(r.initEvent(e,n.bubbles,n.cancelable),r.detail=n.detail):r.initEvent(e,!1,!1)),t.dispatchEvent(r)}function U$e(t,e){return function(){return o4(this,t,e)}}function H$e(t,e){return function(){return o4(this,t,e.apply(this,arguments))}}function G$e(t,e){return this.each((typeof e=="function"?H$e:U$e)(t,e))}function*j$e(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var s=t[e],r=0,o=s.length,i;r<o;++r)(i=s[r])&&(yield i)}var i4=[null];function rr(t,e){this._groups=t,this._parents=e}function up(){return new rr([[document.documentElement]],i4)}function K$e(){return this}rr.prototype=up.prototype={constructor:rr,select:bSe,selectAll:CSe,selectChild:TSe,selectChildren:RSe,filter:ASe,data:LSe,enter:DSe,exit:BSe,join:VSe,merge:WSe,selection:K$e,order:USe,sort:HSe,call:jSe,nodes:KSe,node:XSe,size:qSe,empty:YSe,each:QSe,attr:r$e,style:l$e,property:h$e,classed:g$e,text:v$e,html:S$e,raise:I$e,lower:E$e,append:N$e,insert:R$e,remove:D$e,clone:P$e,datum:M$e,on:W$e,dispatch:G$e,[Symbol.iterator]:j$e};function X$e(t){return typeof t=="string"?new rr([[document.querySelector(t)]],[document.documentElement]):new rr([[t]],i4)}function mI(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function a4(t,e){var n=Object.create(t.prototype);for(var s in e)n[s]=e[s];return n}function dp(){}var Th=.7,d0=1/Th,Mc="\\s*([+-]?\\d+)\\s*",Eh="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Fo="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",q$e=/^#([0-9a-f]{3,8})$/,Y$e=new RegExp(`^rgb\\(${Mc},${Mc},${Mc}\\)$`),Q$e=new RegExp(`^rgb\\(${Fo},${Fo},${Fo}\\)$`),Z$e=new RegExp(`^rgba\\(${Mc},${Mc},${Mc},${Eh}\\)$`),J$e=new RegExp(`^rgba\\(${Fo},${Fo},${Fo},${Eh}\\)$`),eIe=new RegExp(`^hsl\\(${Eh},${Fo},${Fo}\\)$`),tIe=new RegExp(`^hsla\\(${Eh},${Fo},${Fo},${Eh}\\)$`),R_={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};mI(dp,Nh,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:A_,formatHex:A_,formatHex8:nIe,formatHsl:sIe,formatRgb:D_,toString:D_});function A_(){return this.rgb().formatHex()}function nIe(){return this.rgb().formatHex8()}function sIe(){return l4(this).formatHsl()}function D_(){return this.rgb().formatRgb()}function Nh(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=q$e.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?F_(e):n===3?new Ps(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?xm(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?xm(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=Y$e.exec(t))?new Ps(e[1],e[2],e[3],1):(e=Q$e.exec(t))?new Ps(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=Z$e.exec(t))?xm(e[1],e[2],e[3],e[4]):(e=J$e.exec(t))?xm(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=eIe.exec(t))?M_(e[1],e[2]/100,e[3]/100,1):(e=tIe.exec(t))?M_(e[1],e[2]/100,e[3]/100,e[4]):R_.hasOwnProperty(t)?F_(R_[t]):t==="transparent"?new Ps(NaN,NaN,NaN,0):null}function F_(t){return new Ps(t>>16&255,t>>8&255,t&255,1)}function xm(t,e,n,s){return s<=0&&(t=e=n=NaN),new Ps(t,e,n,s)}function rIe(t){return t instanceof dp||(t=Nh(t)),t?(t=t.rgb(),new Ps(t.r,t.g,t.b,t.opacity)):new Ps}function h0(t,e,n,s){return arguments.length===1?rIe(t):new Ps(t,e,n,s??1)}function Ps(t,e,n,s){this.r=+t,this.g=+e,this.b=+n,this.opacity=+s}mI(Ps,h0,a4(dp,{brighter(t){return t=t==null?d0:Math.pow(d0,t),new Ps(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Th:Math.pow(Th,t),new Ps(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ps(ol(this.r),ol(this.g),ol(this.b),f0(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:O_,formatHex:O_,formatHex8:oIe,formatRgb:P_,toString:P_}));function O_(){return`#${Qa(this.r)}${Qa(this.g)}${Qa(this.b)}`}function oIe(){return`#${Qa(this.r)}${Qa(this.g)}${Qa(this.b)}${Qa((isNaN(this.opacity)?1:this.opacity)*255)}`}function P_(){const t=f0(this.opacity);return`${t===1?"rgb(":"rgba("}${ol(this.r)}, ${ol(this.g)}, ${ol(this.b)}${t===1?")":`, ${t})`}`}function f0(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function ol(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Qa(t){return t=ol(t),(t<16?"0":"")+t.toString(16)}function M_(t,e,n,s){return s<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Yr(t,e,n,s)}function l4(t){if(t instanceof Yr)return new Yr(t.h,t.s,t.l,t.opacity);if(t instanceof dp||(t=Nh(t)),!t)return new Yr;if(t instanceof Yr)return t;t=t.rgb();var e=t.r/255,n=t.g/255,s=t.b/255,r=Math.min(e,n,s),o=Math.max(e,n,s),i=NaN,a=o-r,l=(o+r)/2;return a?(e===o?i=(n-s)/a+(n<s)*6:n===o?i=(s-e)/a+2:i=(e-n)/a+4,a/=l<.5?o+r:2-o-r,i*=60):a=l>0&&l<1?0:i,new Yr(i,a,l,t.opacity)}function iIe(t,e,n,s){return arguments.length===1?l4(t):new Yr(t,e,n,s??1)}function Yr(t,e,n,s){this.h=+t,this.s=+e,this.l=+n,this.opacity=+s}mI(Yr,iIe,a4(dp,{brighter(t){return t=t==null?d0:Math.pow(d0,t),new Yr(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Th:Math.pow(Th,t),new Yr(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,s=n+(n<.5?n:1-n)*e,r=2*n-s;return new Ps(w1(t>=240?t-240:t+120,r,s),w1(t,r,s),w1(t<120?t+240:t-120,r,s),this.opacity)},clamp(){return new Yr(L_(this.h),ym(this.s),ym(this.l),f0(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=f0(this.opacity);return`${t===1?"hsl(":"hsla("}${L_(this.h)}, ${ym(this.s)*100}%, ${ym(this.l)*100}%${t===1?")":`, ${t})`}`}}));function L_(t){return t=(t||0)%360,t<0?t+360:t}function ym(t){return Math.max(0,Math.min(1,t||0))}function w1(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}function aIe(t,e,n,s,r){var o=t*t,i=o*t;return((1-3*t+3*o-i)*e+(4-6*o+3*i)*n+(1+3*t+3*o-3*i)*s+i*r)/6}function lIe(t){var e=t.length-1;return function(n){var s=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),r=t[s],o=t[s+1],i=s>0?t[s-1]:2*r-o,a=s<e-1?t[s+2]:2*o-r;return aIe((n-s/e)*e,i,r,o,a)}}const c4=t=>()=>t;function cIe(t,e){return function(n){return t+n*e}}function uIe(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(s){return Math.pow(t+s*e,n)}}function dIe(t){return(t=+t)==1?u4:function(e,n){return n-e?uIe(e,n,t):c4(isNaN(e)?n:e)}}function u4(t,e){var n=e-t;return n?cIe(t,n):c4(isNaN(t)?e:t)}const z_=function t(e){var n=dIe(e);function s(r,o){var i=n((r=h0(r)).r,(o=h0(o)).r),a=n(r.g,o.g),l=n(r.b,o.b),c=u4(r.opacity,o.opacity);return function(u){return r.r=i(u),r.g=a(u),r.b=l(u),r.opacity=c(u),r+""}}return s.gamma=t,s}(1);function hIe(t){return function(e){var n=e.length,s=new Array(n),r=new Array(n),o=new Array(n),i,a;for(i=0;i<n;++i)a=h0(e[i]),s[i]=a.r||0,r[i]=a.g||0,o[i]=a.b||0;return s=t(s),r=t(r),o=t(o),a.opacity=1,function(l){return a.r=s(l),a.g=r(l),a.b=o(l),a+""}}}var fIe=hIe(lIe);function Ei(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}var _w=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,k1=new RegExp(_w.source,"g");function pIe(t){return function(){return t}}function mIe(t){return function(e){return t(e)+""}}function gIe(t,e){var n=_w.lastIndex=k1.lastIndex=0,s,r,o,i=-1,a=[],l=[];for(t=t+"",e=e+"";(s=_w.exec(t))&&(r=k1.exec(e));)(o=r.index)>n&&(o=e.slice(n,o),a[i]?a[i]+=o:a[++i]=o),(s=s[0])===(r=r[0])?a[i]?a[i]+=r:a[++i]=r:(a[++i]=null,l.push({i,x:Ei(s,r)})),n=k1.lastIndex;return n<e.length&&(o=e.slice(n),a[i]?a[i]+=o:a[++i]=o),a.length<2?l[0]?mIe(l[0].x):pIe(e):(e=l.length,function(c){for(var u=0,d;u<e;++u)a[(d=l[u]).i]=d.x(c);return a.join("")})}var B_=180/Math.PI,Rw={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function d4(t,e,n,s,r,o){var i,a,l;return(i=Math.sqrt(t*t+e*e))&&(t/=i,e/=i),(l=t*n+e*s)&&(n-=t*l,s-=e*l),(a=Math.sqrt(n*n+s*s))&&(n/=a,s/=a,l/=a),t*s<e*n&&(t=-t,e=-e,l=-l,i=-i),{translateX:r,translateY:o,rotate:Math.atan2(e,t)*B_,skewX:Math.atan(l)*B_,scaleX:i,scaleY:a}}var bm;function xIe(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Rw:d4(e.a,e.b,e.c,e.d,e.e,e.f)}function yIe(t){return t==null||(bm||(bm=document.createElementNS("http://www.w3.org/2000/svg","g")),bm.setAttribute("transform",t),!(t=bm.transform.baseVal.consolidate()))?Rw:(t=t.matrix,d4(t.a,t.b,t.c,t.d,t.e,t.f))}function h4(t,e,n,s){function r(c){return c.length?c.pop()+" ":""}function o(c,u,d,h,f,p){if(c!==d||u!==h){var m=f.push("translate(",null,e,null,n);p.push({i:m-4,x:Ei(c,d)},{i:m-2,x:Ei(u,h)})}else(d||h)&&f.push("translate("+d+e+h+n)}function i(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(r(d)+"rotate(",null,s)-2,x:Ei(c,u)})):u&&d.push(r(d)+"rotate("+u+s)}function a(c,u,d,h){c!==u?h.push({i:d.push(r(d)+"skewX(",null,s)-2,x:Ei(c,u)}):u&&d.push(r(d)+"skewX("+u+s)}function l(c,u,d,h,f,p){if(c!==d||u!==h){var m=f.push(r(f)+"scale(",null,",",null,")");p.push({i:m-4,x:Ei(c,d)},{i:m-2,x:Ei(u,h)})}else(d!==1||h!==1)&&f.push(r(f)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=t(c),u=t(u),o(c.translateX,c.translateY,u.translateX,u.translateY,d,h),i(c.rotate,u.rotate,d,h),a(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(f){for(var p=-1,m=h.length,x;++p<m;)d[(x=h[p]).i]=x.x(f);return d.join("")}}}var bIe=h4(xIe,"px, ","px)","deg)"),vIe=h4(yIe,", ",")",")"),uu=0,wd=0,rd=0,f4=1e3,p0,kd,m0=0,Nl=0,tb=0,_h=typeof performance=="object"&&performance.now?performance:Date,p4=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function gI(){return Nl||(p4(wIe),Nl=_h.now()+tb)}function wIe(){Nl=0}function g0(){this._call=this._time=this._next=null}g0.prototype=m4.prototype={constructor:g0,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?gI():+n)+(e==null?0:+e),!this._next&&kd!==this&&(kd?kd._next=this:p0=this,kd=this),this._call=t,this._time=n,Aw()},stop:function(){this._call&&(this._call=null,this._time=1/0,Aw())}};function m4(t,e,n){var s=new g0;return s.restart(t,e,n),s}function kIe(){gI(),++uu;for(var t=p0,e;t;)(e=Nl-t._time)>=0&&t._call.call(void 0,e),t=t._next;--uu}function V_(){Nl=(m0=_h.now())+tb,uu=wd=0;try{kIe()}finally{uu=0,SIe(),Nl=0}}function CIe(){var t=_h.now(),e=t-m0;e>f4&&(tb-=e,m0=t)}function SIe(){for(var t,e=p0,n,s=1/0;e;)e._call?(s>e._time&&(s=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:p0=n);kd=t,Aw(s)}function Aw(t){if(!uu){wd&&(wd=clearTimeout(wd));var e=t-Nl;e>24?(t<1/0&&(wd=setTimeout(V_,t-_h.now()-tb)),rd&&(rd=clearInterval(rd))):(rd||(m0=_h.now(),rd=setInterval(CIe,f4)),uu=1,p4(V_))}}function W_(t,e,n){var s=new g0;return e=e==null?0:+e,s.restart(r=>{s.stop(),t(r+e)},e,n),s}var $Ie=XB("start","end","cancel","interrupt"),IIe=[],g4=0,U_=1,Dw=2,Hm=3,H_=4,Fw=5,Gm=6;function nb(t,e,n,s,r,o){var i=t.__transition;if(!i)t.__transition={};else if(n in i)return;TIe(t,n,{name:e,index:s,group:r,on:$Ie,tween:IIe,time:o.time,delay:o.delay,duration:o.duration,ease:o.ease,timer:null,state:g4})}function xI(t,e){var n=uo(t,e);if(n.state>g4)throw new Error("too late; already scheduled");return n}function Vo(t,e){var n=uo(t,e);if(n.state>Hm)throw new Error("too late; already running");return n}function uo(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function TIe(t,e,n){var s=t.__transition,r;s[e]=n,n.timer=m4(o,0,n.time);function o(c){n.state=U_,n.timer.restart(i,n.delay,n.time),n.delay<=c&&i(c-n.delay)}function i(c){var u,d,h,f;if(n.state!==U_)return l();for(u in s)if(f=s[u],f.name===n.name){if(f.state===Hm)return W_(i);f.state===H_?(f.state=Gm,f.timer.stop(),f.on.call("interrupt",t,t.__data__,f.index,f.group),delete s[u]):+u<e&&(f.state=Gm,f.timer.stop(),f.on.call("cancel",t,t.__data__,f.index,f.group),delete s[u])}if(W_(function(){n.state===Hm&&(n.state=H_,n.timer.restart(a,n.delay,n.time),a(c))}),n.state=Dw,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Dw){for(n.state=Hm,r=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(f=n.tween[u].value.call(t,t.__data__,n.index,n.group))&&(r[++d]=f);r.length=d+1}}function a(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=Fw,1),d=-1,h=r.length;++d<h;)r[d].call(t,u);n.state===Fw&&(n.on.call("end",t,t.__data__,n.index,n.group),l())}function l(){n.state=Gm,n.timer.stop(),delete s[e];for(var c in s)return;delete t.__transition}}function EIe(t,e){var n=t.__transition,s,r,o=!0,i;if(n){e=e==null?null:e+"";for(i in n){if((s=n[i]).name!==e){o=!1;continue}r=s.state>Dw&&s.state<Fw,s.state=Gm,s.timer.stop(),s.on.call(r?"interrupt":"cancel",t,t.__data__,s.index,s.group),delete n[i]}o&&delete t.__transition}}function NIe(t){return this.each(function(){EIe(this,t)})}function _Ie(t,e){var n,s;return function(){var r=Vo(this,t),o=r.tween;if(o!==n){s=n=o;for(var i=0,a=s.length;i<a;++i)if(s[i].name===e){s=s.slice(),s.splice(i,1);break}}r.tween=s}}function RIe(t,e,n){var s,r;if(typeof n!="function")throw new Error;return function(){var o=Vo(this,t),i=o.tween;if(i!==s){r=(s=i).slice();for(var a={name:e,value:n},l=0,c=r.length;l<c;++l)if(r[l].name===e){r[l]=a;break}l===c&&r.push(a)}o.tween=r}}function AIe(t,e){var n=this._id;if(t+="",arguments.length<2){for(var s=uo(this.node(),n).tween,r=0,o=s.length,i;r<o;++r)if((i=s[r]).name===t)return i.value;return null}return this.each((e==null?_Ie:RIe)(n,t,e))}function yI(t,e,n){var s=t._id;return t.each(function(){var r=Vo(this,s);(r.value||(r.value={}))[e]=n.apply(this,arguments)}),function(r){return uo(r,s).value[e]}}function x4(t,e){var n;return(typeof e=="number"?Ei:e instanceof Nh?z_:(n=Nh(e))?(e=n,z_):gIe)(t,e)}function DIe(t){return function(){this.removeAttribute(t)}}function FIe(t){return function(){this.removeAttributeNS(t.space,t.local)}}function OIe(t,e,n){var s,r=n+"",o;return function(){var i=this.getAttribute(t);return i===r?null:i===s?o:o=e(s=i,n)}}function PIe(t,e,n){var s,r=n+"",o;return function(){var i=this.getAttributeNS(t.space,t.local);return i===r?null:i===s?o:o=e(s=i,n)}}function MIe(t,e,n){var s,r,o;return function(){var i,a=n(this),l;return a==null?void this.removeAttribute(t):(i=this.getAttribute(t),l=a+"",i===l?null:i===s&&l===r?o:(r=l,o=e(s=i,a)))}}function LIe(t,e,n){var s,r,o;return function(){var i,a=n(this),l;return a==null?void this.removeAttributeNS(t.space,t.local):(i=this.getAttributeNS(t.space,t.local),l=a+"",i===l?null:i===s&&l===r?o:(r=l,o=e(s=i,a)))}}function zIe(t,e){var n=eb(t),s=n==="transform"?vIe:x4;return this.attrTween(t,typeof e=="function"?(n.local?LIe:MIe)(n,s,yI(this,"attr."+t,e)):e==null?(n.local?FIe:DIe)(n):(n.local?PIe:OIe)(n,s,e))}function BIe(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function VIe(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function WIe(t,e){var n,s;function r(){var o=e.apply(this,arguments);return o!==s&&(n=(s=o)&&VIe(t,o)),n}return r._value=e,r}function UIe(t,e){var n,s;function r(){var o=e.apply(this,arguments);return o!==s&&(n=(s=o)&&BIe(t,o)),n}return r._value=e,r}function HIe(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var s=eb(t);return this.tween(n,(s.local?WIe:UIe)(s,e))}function GIe(t,e){return function(){xI(this,t).delay=+e.apply(this,arguments)}}function jIe(t,e){return e=+e,function(){xI(this,t).delay=e}}function KIe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?GIe:jIe)(e,t)):uo(this.node(),e).delay}function XIe(t,e){return function(){Vo(this,t).duration=+e.apply(this,arguments)}}function qIe(t,e){return e=+e,function(){Vo(this,t).duration=e}}function YIe(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?XIe:qIe)(e,t)):uo(this.node(),e).duration}function QIe(t,e){if(typeof e!="function")throw new Error;return function(){Vo(this,t).ease=e}}function ZIe(t){var e=this._id;return arguments.length?this.each(QIe(e,t)):uo(this.node(),e).ease}function JIe(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Vo(this,t).ease=n}}function e2e(t){if(typeof t!="function")throw new Error;return this.each(JIe(this._id,t))}function t2e(t){typeof t!="function"&&(t=QB(t));for(var e=this._groups,n=e.length,s=new Array(n),r=0;r<n;++r)for(var o=e[r],i=o.length,a=s[r]=[],l,c=0;c<i;++c)(l=o[c])&&t.call(l,l.__data__,c,o)&&a.push(l);return new pi(s,this._parents,this._name,this._id)}function n2e(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,s=e.length,r=n.length,o=Math.min(s,r),i=new Array(s),a=0;a<o;++a)for(var l=e[a],c=n[a],u=l.length,d=i[a]=new Array(u),h,f=0;f<u;++f)(h=l[f]||c[f])&&(d[f]=h);for(;a<s;++a)i[a]=e[a];return new pi(i,this._parents,this._name,this._id)}function s2e(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function r2e(t,e,n){var s,r,o=s2e(e)?xI:Vo;return function(){var i=o(this,t),a=i.on;a!==s&&(r=(s=a).copy()).on(e,n),i.on=r}}function o2e(t,e){var n=this._id;return arguments.length<2?uo(this.node(),n).on.on(t):this.each(r2e(n,t,e))}function i2e(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function a2e(){return this.on("end.remove",i2e(this._id))}function l2e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=fI(t));for(var s=this._groups,r=s.length,o=new Array(r),i=0;i<r;++i)for(var a=s[i],l=a.length,c=o[i]=new Array(l),u,d,h=0;h<l;++h)(u=a[h])&&(d=t.call(u,u.__data__,h,a))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,nb(c[h],e,n,h,c,uo(u,n)));return new pi(o,this._parents,e,n)}function c2e(t){var e=this._name,n=this._id;typeof t!="function"&&(t=YB(t));for(var s=this._groups,r=s.length,o=[],i=[],a=0;a<r;++a)for(var l=s[a],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=t.call(u,u.__data__,d,l),f,p=uo(u,n),m=0,x=h.length;m<x;++m)(f=h[m])&&nb(f,e,n,m,h,p);o.push(h),i.push(u)}return new pi(o,i,e,n)}var u2e=up.prototype.constructor;function d2e(){return new u2e(this._groups,this._parents)}function h2e(t,e){var n,s,r;return function(){var o=cu(this,t),i=(this.style.removeProperty(t),cu(this,t));return o===i?null:o===n&&i===s?r:r=e(n=o,s=i)}}function y4(t){return function(){this.style.removeProperty(t)}}function f2e(t,e,n){var s,r=n+"",o;return function(){var i=cu(this,t);return i===r?null:i===s?o:o=e(s=i,n)}}function p2e(t,e,n){var s,r,o;return function(){var i=cu(this,t),a=n(this),l=a+"";return a==null&&(l=a=(this.style.removeProperty(t),cu(this,t))),i===l?null:i===s&&l===r?o:(r=l,o=e(s=i,a))}}function m2e(t,e){var n,s,r,o="style."+e,i="end."+o,a;return function(){var l=Vo(this,t),c=l.on,u=l.value[o]==null?a||(a=y4(e)):void 0;(c!==n||r!==u)&&(s=(n=c).copy()).on(i,r=u),l.on=s}}function g2e(t,e,n){var s=(t+="")=="transform"?bIe:x4;return e==null?this.styleTween(t,h2e(t,s)).on("end.style."+t,y4(t)):typeof e=="function"?this.styleTween(t,p2e(t,s,yI(this,"style."+t,e))).each(m2e(this._id,t)):this.styleTween(t,f2e(t,s,e),n).on("end.style."+t,null)}function x2e(t,e,n){return function(s){this.style.setProperty(t,e.call(this,s),n)}}function y2e(t,e,n){var s,r;function o(){var i=e.apply(this,arguments);return i!==r&&(s=(r=i)&&x2e(t,i,n)),s}return o._value=e,o}function b2e(t,e,n){var s="style."+(t+="");if(arguments.length<2)return(s=this.tween(s))&&s._value;if(e==null)return this.tween(s,null);if(typeof e!="function")throw new Error;return this.tween(s,y2e(t,e,n??""))}function v2e(t){return function(){this.textContent=t}}function w2e(t){return function(){var e=t(this);this.textContent=e??""}}function k2e(t){return this.tween("text",typeof t=="function"?w2e(yI(this,"text",t)):v2e(t==null?"":t+""))}function C2e(t){return function(e){this.textContent=t.call(this,e)}}function S2e(t){var e,n;function s(){var r=t.apply(this,arguments);return r!==n&&(e=(n=r)&&C2e(r)),e}return s._value=t,s}function $2e(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,S2e(t))}function I2e(){for(var t=this._name,e=this._id,n=b4(),s=this._groups,r=s.length,o=0;o<r;++o)for(var i=s[o],a=i.length,l,c=0;c<a;++c)if(l=i[c]){var u=uo(l,e);nb(l,t,n,c,i,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new pi(s,this._parents,t,n)}function T2e(){var t,e,n=this,s=n._id,r=n.size();return new Promise(function(o,i){var a={value:i},l={value:function(){--r===0&&o()}};n.each(function(){var c=Vo(this,s),u=c.on;u!==t&&(e=(t=u).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(l)),c.on=e}),r===0&&o()})}var E2e=0;function pi(t,e,n,s){this._groups=t,this._parents=e,this._name=n,this._id=s}function b4(){return++E2e}var Ho=up.prototype;pi.prototype={constructor:pi,select:l2e,selectAll:c2e,selectChild:Ho.selectChild,selectChildren:Ho.selectChildren,filter:t2e,merge:n2e,selection:d2e,transition:I2e,call:Ho.call,nodes:Ho.nodes,node:Ho.node,size:Ho.size,empty:Ho.empty,each:Ho.each,on:o2e,attr:zIe,attrTween:HIe,style:g2e,styleTween:b2e,text:k2e,textTween:$2e,remove:a2e,tween:AIe,delay:KIe,duration:YIe,ease:ZIe,easeVarying:e2e,end:T2e,[Symbol.iterator]:Ho[Symbol.iterator]};function N2e(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var _2e={time:null,delay:0,duration:250,ease:N2e};function R2e(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function A2e(t){var e,n;t instanceof pi?(e=t._id,t=t._name):(e=b4(),(n=_2e).time=gI(),t=t==null?null:t+"");for(var s=this._groups,r=s.length,o=0;o<r;++o)for(var i=s[o],a=i.length,l,c=0;c<a;++c)(l=i[c])&&nb(l,t,e,c,i,n||R2e(l,e));return new pi(s,this._parents,t,e)}up.prototype.interrupt=NIe;up.prototype.transition=A2e;function D2e(t){for(var e=t.length/6|0,n=new Array(e),s=0;s<e;)n[s]="#"+t.slice(s*6,++s*6);return n}const F2e=t=>fIe(t[t.length-1]);var O2e=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(D2e);const P2e=F2e(O2e);function Cd(t,e,n){this.k=t,this.x=e,this.y=n}Cd.prototype={constructor:Cd,scale:function(t){return t===1?this:new Cd(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new Cd(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Cd.prototype;const M2e=({inputs:t,weights:e,activations:n})=>{const s=A.useRef(),[r,o]=A.useState({width:500,height:400}),i=[{nodes:4,name:"Input"},{nodes:6,name:"Hidden"},{nodes:1,name:"Output"}];return A.useEffect(()=>{const a=X$e(s.current);a.selectAll("*").remove();const l={top:20,right:20,bottom:20,left:20},c=r.width-l.left-l.right,u=r.height-l.top-l.bottom,d=a.append("g").attr("transform",`translate(${l.left},${l.top})`),h=c/(i.length-1),f=[],p=[];i.forEach((x,g)=>{var b;const y=u/(x.nodes+1);for(let v=0;v<x.nodes;v++)f.push({x:g*h,y:(v+1)*y,layer:g,index:v,value:((b=n==null?void 0:n[g])==null?void 0:b[v])||0})});for(let x=0;x<i.length-1;x++){const g=f.filter(b=>b.layer===x),y=f.filter(b=>b.layer===x+1);g.forEach(b=>{y.forEach(v=>{var w,k;p.push({source:b,target:v,weight:((k=(w=e==null?void 0:e[x])==null?void 0:w[b.index])==null?void 0:k[v.index])||0})})})}d.selectAll(".link").data(p).enter().append("line").attr("class","link").attr("x1",x=>x.source.x).attr("y1",x=>x.source.y).attr("x2",x=>x.target.x).attr("y2",x=>x.target.y).style("stroke","#999").style("stroke-opacity",.6).style("stroke-width",x=>Math.abs(x.weight)*2);const m=d.selectAll(".node").data(f).enter().append("g").attr("class","node").attr("transform",x=>`translate(${x.x},${x.y})`);m.append("circle").attr("r",20).style("fill",x=>P2e(x.value)).style("stroke","#666").style("stroke-width",1.5),m.append("text").attr("dy",".35em").style("text-anchor","middle").style("font-size","12px").text(x=>x.value.toFixed(2))},[r,e,n]),me.createElement("div",{className:"relative"},me.createElement("svg",{ref:s,width:r.width,height:r.height,className:"border rounded shadow-sm"}))};Zy.register(Iw,Tw,Wm,bd,_Ce,LCe,ECe);const G_=[[2,1.8,1.6,1.4,1.2,1],[-2,-1.8,-1.6,-1.4,-1.2,-1],[1.6,1.4,1.2,1,.8,.6],[-1.2,-1,-.8,-.6,-.4,-.2]],j_=[[1.2],[1],[.8],[.6],[.4],[.2]],L2e={currentTrend:{temperature:2,precipitation:-10,windspeed:2,humidity:-10},mitigation:{temperature:1,precipitation:10,windspeed:0,humidity:5},worstCase:{temperature:4,precipitation:-30,windspeed:5,humidity:-30}};function z2e(){var x,g;const[t,e]=A.useState(null),[n,s]=A.useState({temperature:25,precipitation:50,windspeed:10,humidity:60}),[r,o]=A.useState({temperature:0,precipitation:0,windspeed:0,humidity:0}),[i,a]=A.useState(0),[l,c]=A.useState([]),[u,d]=A.useState([]);A.useEffect(()=>{(async()=>{const b=m9();b.add(AT({inputShape:[4],units:6,activation:"relu",weights:[Rc(G_),hn([6])]})),b.add(AT({units:1,activation:"sigmoid",weights:[Rc(j_),hn([1])]})),e(b)})()},[]),A.useEffect(()=>{if(t){const y=[n.temperature/50,n.precipitation/100,n.windspeed/20,n.humidity/100],b=Rc([y]);(async()=>{const S=await p9({inputs:t.input,outputs:t.layers.map($=>$.output)}).predict(b),I=Array.isArray(S)?S.map($=>$.dataSync()):[S.dataSync()];d([y,...I])})();let k=t.predict(b).dataSync()[0]*100;n.precipitation>70&&(k*=.3),n.temperature>35&&(k*=1.2),n.windspeed>15&&(k*=1+(n.windspeed-15)/10),n.humidity<20&&(k*=1.3),k=Math.max(0,Math.min(100,k)),a(Math.round(k)),c(C=>[...C,{...n,risk:Math.round(k)}].slice(-20))}},[t,n]);const h=()=>{s(y=>({temperature:Math.max(0,Math.min(50,y.temperature+r.temperature)),precipitation:Math.max(0,Math.min(100,y.precipitation+r.precipitation)),windspeed:Math.max(0,Math.min(20,y.windspeed+r.windspeed)),humidity:Math.max(0,Math.min(100,y.humidity+r.humidity))}))},f=y=>{o(L2e[y])},p={labels:l.map((y,b)=>`${b+1}`),datasets:[{label:"Fire Risk %",data:l.map(y=>y.risk),borderColor:"rgb(255, 99, 132)",tension:.1}]},m={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Fire Risk History"}},scales:{y:{min:0,max:100}}};return me.createElement("div",{className:"min-h-screen bg-gray-100 p-8"},me.createElement("div",{className:"max-w-6xl mx-auto space-y-6"},me.createElement(Ma,{elevation:3,className:"p-6"},me.createElement(zt,{variant:"h4",gutterBottom:!0},"Simulation Panel"),me.createElement(Kp,{className:"mb-6"},me.createElement(zt,{variant:"h6",gutterBottom:!0},"Preset Scenarios"),me.createElement("div",{className:"flex gap-2 mb-4"},me.createElement(qp,{variant:"outlined",onClick:()=>f("currentTrend")},"Current Trend"),me.createElement(qp,{variant:"outlined",onClick:()=>f("mitigation")},"Mitigation Scenario"),me.createElement(qp,{variant:"outlined",onClick:()=>f("worstCase")},"Worst Case")),me.createElement(zt,{variant:"h6",gutterBottom:!0},"Custom Changes"),me.createElement("div",{className:"grid grid-cols-2 gap-4 mb-4"},me.createElement(tm,{label:"Temperature Change (C)",type:"number",value:r.temperature,onChange:y=>o(b=>({...b,temperature:Math.max(-4,Math.min(4,Number(y.target.value)))})),inputProps:{min:-4,max:4}}),me.createElement(tm,{label:"Precipitation Change (%)",type:"number",value:r.precipitation,onChange:y=>o(b=>({...b,precipitation:Math.max(-30,Math.min(30,Number(y.target.value)))})),inputProps:{min:-30,max:30}}),me.createElement(tm,{label:"Wind Speed Change (m/s)",type:"number",value:r.windspeed,onChange:y=>o(b=>({...b,windspeed:Math.max(-5,Math.min(5,Number(y.target.value)))})),inputProps:{min:-5,max:5}}),me.createElement(tm,{label:"Humidity Change (%)",type:"number",value:r.humidity,onChange:y=>o(b=>({...b,humidity:Math.max(-30,Math.min(30,Number(y.target.value)))})),inputProps:{min:-30,max:30}})),me.createElement(qp,{variant:"contained",color:"primary",onClick:h,fullWidth:!0},"Run Simulation"))),me.createElement(Ma,{elevation:3,className:"p-6"},me.createElement(zt,{variant:"h4",gutterBottom:!0},"Forest Fire Risk Assessment"),me.createElement(Kp,{className:"mb-6"},me.createElement(zt,{gutterBottom:!0},"Temperature (C)"),me.createElement(em,{value:n.temperature,onChange:(y,b)=>s(v=>({...v,temperature:b})),min:0,max:50,valueLabelDisplay:"auto"}),me.createElement(zt,{gutterBottom:!0},"Precipitation (%)"),me.createElement(em,{value:n.precipitation,onChange:(y,b)=>s(v=>({...v,precipitation:b})),min:0,max:100,valueLabelDisplay:"auto"}),me.createElement(zt,{gutterBottom:!0},"Wind Speed (m/s)"),me.createElement(em,{value:n.windspeed,onChange:(y,b)=>s(v=>({...v,windspeed:b})),min:0,max:20,valueLabelDisplay:"auto"}),me.createElement(zt,{gutterBottom:!0},"Humidity (%)"),me.createElement(em,{value:n.humidity,onChange:(y,b)=>s(v=>({...v,humidity:b})),min:0,max:100,valueLabelDisplay:"auto"})),me.createElement(Ma,{elevation:6,className:"p-4 mb-6 bg-gradient-to-r from-green-100 to-red-100"},me.createElement(zt,{variant:"h5",align:"center"},"Current Fire Risk: ",i,"%"))),me.createElement(Ma,{elevation:3,className:"p-6"},me.createElement(zt,{variant:"h4",gutterBottom:!0},"Neural Network Visualization"),me.createElement(M2e,{inputs:[n.temperature/50,n.precipitation/100,n.windspeed/20,n.humidity/100],weights:[G_,j_],activations:u}),me.createElement(Kp,{className:"mt-4"},me.createElement(zt,{variant:"h6",gutterBottom:!0},"Calculation Steps"),me.createElement(zt,{variant:"body2"},"1. Input Layer Normalization: - Temperature: ",(n.temperature/50).toFixed(2),"- Precipitation: ",(n.precipitation/100).toFixed(2),"- Wind Speed: ",(n.windspeed/20).toFixed(2),"- Humidity: ",(n.humidity/100).toFixed(2)),me.createElement(zt,{variant:"body2",className:"mt-2"},"2. Hidden Layer Activation Values:",(x=u[1])==null?void 0:x.map((y,b)=>me.createElement("div",{key:b},"Node ",b+1,": ",y.toFixed(3)))),me.createElement(zt,{variant:"body2",className:"mt-2"},"3. Output Layer (Before Adjustments):",(g=u[2])==null?void 0:g.map((y,b)=>me.createElement("div",{key:b},"Risk: ",(y*100).toFixed(1),"%"))))),me.createElement(Ma,{elevation:3,className:"p-6"},me.createElement("div",{className:"h-80"},me.createElement(hSe,{data:p,options:m}))),me.createElement(Ma,{elevation:3,className:"p-6"},me.createElement(zt,{variant:"h4",gutterBottom:!0},"Understanding the Fire Risk Assessment"),me.createElement(Kp,{className:"space-y-4"},me.createElement("div",null,me.createElement(zt,{variant:"h6",gutterBottom:!0},"Input Variables and Their Impact"),me.createElement(zt,{variant:"body1"}," Temperature (Weight: 2.0): The most critical factor. Higher temperatures increase fire risk by: - Drying out vegetation - Increasing evaporation rates - Creating conditions favorable for fire spread",n.temperature>35&&" Currently at critical levels, significantly increasing risk!"),me.createElement(zt,{variant:"body1",className:"mt-2"}," Precipitation (Weight: -2.0): Strong negative correlation with fire risk: - Higher precipitation reduces risk by increasing moisture content - Extended dry periods increase vulnerability",n.precipitation>70&&" Current precipitation levels are helping to suppress fire risk."),me.createElement(zt,{variant:"body1",className:"mt-2"}," Wind Speed (Weight: 1.6): Significant positive correlation: - Accelerates fire spread - Affects oxygen availability - Influences fire direction",n.windspeed>15&&" High wind speeds are creating dangerous conditions!"),me.createElement(zt,{variant:"body1",className:"mt-2"}," Humidity (Weight: -1.2): Moderate negative impact: - Higher humidity reduces fire risk - Low humidity makes vegetation more flammable",n.humidity<20&&" Dangerously low humidity levels detected!")),me.createElement("div",null,me.createElement(zt,{variant:"h6",gutterBottom:!0},"Neural Network Analysis"),me.createElement(zt,{variant:"body1"},"The network processes these inputs through: 1. Normalization: Scaling inputs to comparable ranges 2. Hidden Layer: Combining factors to identify complex patterns 3. Output Layer: Converting patterns into a final risk score 4. Post-processing: Adjusting for extreme conditions")),me.createElement("div",null,me.createElement(zt,{variant:"h6",gutterBottom:!0},"Current Risk Assessment"),me.createElement(zt,{variant:"body1"},"The current fire risk of ",i,"% is ",i<30?"low, suggesting safe conditions":i<60?"moderate, requiring regular monitoring":"high, indicating dangerous conditions",". This assessment is based on the combination of all environmental factors and their interactions."))))))}S1.createRoot(document.getElementById("root")).render(me.createElement(me.StrictMode,null,me.createElement(z2e,null)));
